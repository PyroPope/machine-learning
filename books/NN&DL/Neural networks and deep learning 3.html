<!DOCTYPE html>
<!-- saved from url=(0051)http://neuralnetworksanddeeplearning.com/chap3.html -->
<html lang="en"><!-- Produced from a LaTeX source file.  Note that the production is done --><!-- by a very rough-and-ready (and buggy) script, so the HTML and other  --><!-- code is quite ugly!  Later versions should be better.                --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8">
    <meta name="citation_title" content="Neural Networks and Deep Learning">
    <meta name="citation_author" content="Nielsen, Michael A.">
    <meta name="citation_publication_date" content="2015">
    <meta name="citation_fulltext_html_url" content="http://neuralnetworksanddeeplearning.com">
    <meta name="citation_publisher" content="Determination Press">
    <link rel="icon" href="http://neuralnetworksanddeeplearning.com/nnadl_favicon.ICO">
    <title>Neural networks and deep learning</title>
    <script async="" src="./Neural networks and deep learning 3_files/analytics.js"></script><script style="display:none">
<!--
/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.2.min.map
*/
(function(e,t){var n,r,i=typeof t,o=e.location,a=e.document,s=a.documentElement,l=e.jQuery,u=e.$,c={},p=[],f="1.10.2",d=p.concat,h=p.push,g=p.slice,m=p.indexOf,y=c.toString,v=c.hasOwnProperty,b=f.trim,x=function(e,t){return new x.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^[\],:{}\s]*$/,S=/(?:^|:|,)(?:\s*\[)+/g,A=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,j=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,D=/^-ms-/,L=/-([\da-z])/gi,H=function(e,t){return t.toUpperCase()},q=function(e){(a.addEventListener||"load"===e.type||"complete"===a.readyState)&&(_(),x.ready())},_=function(){a.addEventListener?(a.removeEventListener("DOMContentLoaded",q,!1),e.removeEventListener("load",q,!1)):(a.detachEvent("onreadystatechange",q),e.detachEvent("onload",q))};x.fn=x.prototype={jquery:f,constructor:x,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:a,!0)),k.test(i[1])&&x.isPlainObject(n))for(i in n)x.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=a.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=a,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||x.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(o=arguments[l]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(x.isPlainObject(r)||(n=x.isArray(r)))?(n?(n=!1,a=e&&x.isArray(e)?e:[]):a=e&&x.isPlainObject(e)?e:{},s[i]=x.extend(c,a,r)):r!==t&&(s[i]=r));return s},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=l),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){if(e===!0?!--x.readyWait:!x.isReady){if(!a.body)return setTimeout(x.ready);x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(a,[x]),x.fn.trigger&&x(a).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray||function(e){return"array"===x.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[y.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!v.call(e,"constructor")&&!v.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(x.support.ownLast)for(n in e)return v.call(e,n);for(n in e);return n===t||v.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||a;var r=k.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=x.trim(n),n&&E.test(n.replace(A,"@").replace(j,"]").replace(S,"")))?Function("return "+n)():(x.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&x.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(D,"ms-").replace(L,H)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("\ufeff\u00a0")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(C,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return d.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),x.isFunction(e)?(r=g.call(arguments,2),i=function(){return e.apply(n||this,r.concat(g.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):t},access:function(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;if("object"===x.type(r)){o=!0;for(l in r)x.access(e,n,l,r[l],!0,a,s)}else if(i!==t&&(o=!0,x.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(x(e),n)})),n))for(;u>l;l++)n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)));return o?e:c?n.call(e):u?n(e[0],r):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),x.ready.promise=function(t){if(!n)if(n=x.Deferred(),"complete"===a.readyState)setTimeout(x.ready);else if(a.addEventListener)a.addEventListener("DOMContentLoaded",q,!1),e.addEventListener("load",q,!1);else{a.attachEvent("onreadystatechange",q),e.attachEvent("onload",q);var r=!1;try{r=null==e.frameElement&&a.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!x.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}_(),x.ready()}}()}return n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=x(a),function(e,t){var n,r,i,o,a,s,l,u,c,p,f,d,h,g,m,y,v,b="sizzle"+-new Date,w=e.document,T=0,C=0,N=st(),k=st(),E=st(),S=!1,A=function(e,t){return e===t?(S=!0,0):0},j=typeof t,D=1<<31,L={}.hasOwnProperty,H=[],q=H.pop,_=H.push,M=H.push,O=H.slice,F=H.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=R.replace("w","w#"),$="\\["+P+"*("+R+")"+P+"*(?:([*^$|!~]?=)"+P+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+P+"*\\]",I=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),X=RegExp("^"+P+"*,"+P+"*"),U=RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),V=RegExp(P+"*[+~]"),Y=RegExp("="+P+"*([^\\]'\"]*)"+P+"*\\]","g"),J=RegExp(I),G=RegExp("^"+W+"$"),Q={ID:RegExp("^#("+R+")"),CLASS:RegExp("^\\.("+R+")"),TAG:RegExp("^("+R.replace("w","w*")+")"),ATTR:RegExp("^"+$),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:RegExp("^(?:"+B+")$","i"),needsContext:RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{M.apply(H=O.call(w.childNodes),w.childNodes),H[w.childNodes.length].nodeType}catch(ot){M={apply:H.length?function(e,t){_.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function at(e,t,n,i){var o,a,s,l,u,c,d,m,y,x;if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,n=n||[],!e||"string"!=typeof e)return n;if(1!==(l=t.nodeType)&&9!==l)return[];if(h&&!i){if(o=Z.exec(e))if(s=o[1]){if(9===l){if(a=t.getElementById(s),!a||!a.parentNode)return n;if(a.id===s)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(s))&&v(t,a)&&a.id===s)return n.push(a),n}else{if(o[2])return M.apply(n,t.getElementsByTagName(e)),n;if((s=o[3])&&r.getElementsByClassName&&t.getElementsByClassName)return M.apply(n,t.getElementsByClassName(s)),n}if(r.qsa&&(!g||!g.test(e))){if(m=d=b,y=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){c=mt(e),(d=t.getAttribute("id"))?m=d.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",u=c.length;while(u--)c[u]=m+yt(c[u]);y=V.test(e)&&t.parentNode||t,x=c.join(",")}if(x)try{return M.apply(n,y.querySelectorAll(x)),n}catch(T){}finally{d||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,n,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>o.cacheLength&&delete t[e.shift()],t[n]=r}return t}function lt(e){return e[b]=!0,e}function ut(e){var t=f.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ct(e,t){var n=e.split("|"),r=e.length;while(r--)o.attrHandle[n[r]]=t}function pt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function dt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return lt(function(t){return t=+t,lt(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}s=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=at.support={},p=at.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==f&&9===n.nodeType&&n.documentElement?(f=n,d=n.documentElement,h=!s(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){p()}),r.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ut(function(e){return d.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(o.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),o.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==j?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},o.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==j&&h?n.getElementsByClassName(e):t},m=[],g=[],(r.qsa=K.test(n.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||g.push("\\["+P+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||g.push(":checked")}),ut(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&g.push("[*^$]="+P+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(r.matchesSelector=K.test(y=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut(function(e){r.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),m.push("!=",I)}),g=g.length&&RegExp(g.join("|")),m=m.length&&RegExp(m.join("|")),v=K.test(d.contains)||d.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},A=d.compareDocumentPosition?function(e,t){if(e===t)return S=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||v(w,e)?-1:t===n||v(w,t)?1:c?F.call(c,e)-F.call(c,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return S=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:c?F.call(c,e)-F.call(c,t):0;if(o===a)return pt(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?pt(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},n):f},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(Y,"='$1']"),!(!r.matchesSelector||!h||m&&m.test(t)||g&&g.test(t)))try{var n=y.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return at(t,f,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),v(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==f&&p(e);var i=o.attrHandle[n.toLowerCase()],a=i&&L.call(o.attrHandle,n.toLowerCase())?i(e,n,!h):t;return a===t?r.attributes||!h?e.getAttribute(n):(a=e.getAttributeNode(n))&&a.specified?a.value:null:a},at.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],i=0,o=0;if(S=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(A),S){while(t=e[o++])t===e[o]&&(i=n.push(o));while(i--)e.splice(n[i],1)}return e},a=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=a(t);return n},o=at.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=N[e+" "];return t||(t=RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&N(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[b]||(m[b]={}),u=c[e]||[],d=u[0]===T&&u[1],f=u[0]===T&&u[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[T,d,f];break}}else if(v&&(u=(t[b]||(t[b]={}))[e])&&u[0]===T)f=u[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[b]||(p[b]={}))[e]=[T,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=F.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:lt(function(e){var t=[],n=[],r=l(e.replace(z,"$1"));return r[b]?lt(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:lt(function(e){return function(t){return at(e,t).length>0}}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}}),lang:lt(function(e){return G.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!o.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},o.pseudos.nth=o.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[n]=ft(n);for(n in{submit:!0,reset:!0})o.pseudos[n]=dt(n);function gt(){}gt.prototype=o.filters=o.pseudos,o.setFilters=new gt;function mt(e,t){var n,r,i,a,s,l,u,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,l=[],u=o.preFilter;while(s){(!n||(r=X.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length));for(a in o.filter)!(r=Q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?at.error(e):k(e,l).slice(0)}function yt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function vt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,s){var l,u,c,p=T+" "+a;if(s){while(t=t[r])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[r])if(1===t.nodeType||o)if(c=t[b]||(t[b]={}),(u=c[r])&&u[0]===p){if((l=u[1])===!0||l===i)return l===!0}else if(u=c[r]=[p],u[1]=e(t,n,s)||i,u[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=null!=t;for(;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function wt(e,t,n,r,i,o){return r&&!r[b]&&(r=wt(r)),i&&!i[b]&&(i=wt(i,o)),lt(function(o,a,s,l){var u,c,p,f=[],d=[],h=a.length,g=o||Nt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:xt(g,f,e,s,l),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,l),r){u=xt(y,d),r(u,[],s,l),c=u.length;while(c--)(p=u[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){u=[],c=y.length;while(c--)(p=y[c])&&u.push(m[c]=p);i(null,y=[],u,l)}c=y.length;while(c--)(p=y[c])&&(u=i?F.call(o,p):f[c])>-1&&(o[u]=!(a[u]=p))}}else y=xt(y===a?y.splice(h,y.length):y),i?i(null,a,y,l):M.apply(a,y)})}function Tt(e){var t,n,r,i=e.length,a=o.relative[e[0].type],s=a||o.relative[" "],l=a?1:0,c=vt(function(e){return e===t},s,!0),p=vt(function(e){return F.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;i>l;l++)if(n=o.relative[e[l].type])f=[vt(bt(f),n)];else{if(n=o.filter[e[l].type].apply(null,e[l].matches),n[b]){for(r=++l;i>r;r++)if(o.relative[e[r].type])break;return wt(l>1&&bt(f),l>1&&yt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&Tt(e.slice(l,r)),i>r&&Tt(e=e.slice(r)),i>r&&yt(e))}f.push(n)}return bt(f)}function Ct(e,t){var n=0,r=t.length>0,a=e.length>0,s=function(s,l,c,p,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,C=u,N=s||a&&o.find.TAG("*",d&&l.parentNode||l),k=T+=null==C?1:Math.random()||.1;for(w&&(u=l!==f&&l,i=n);null!=(h=N[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,l,c)){p.push(h);break}w&&(T=k,i=++n)}r&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,r&&b!==v){g=0;while(m=t[g++])m(x,y,l,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=q.call(p));y=xt(y)}M.apply(p,y),w&&!s&&y.length>0&&v+t.length>1&&at.uniqueSort(p)}return w&&(T=k,u=C),x};return r?lt(s):s}l=at.compile=function(e,t){var n,r=[],i=[],o=E[e+" "];if(!o){t||(t=mt(e)),n=t.length;while(n--)o=Tt(t[n]),o[b]?r.push(o):i.push(o);o=E(e,Ct(i,r))}return o};function Nt(e,t,n){var r=0,i=t.length;for(;i>r;r++)at(e,t[r],n);return n}function kt(e,t,n,i){var a,s,u,c,p,f=mt(e);if(!i&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(u=s[0]).type&&r.getById&&9===t.nodeType&&h&&o.relative[s[1].type]){if(t=(o.find.ID(u.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}a=Q.needsContext.test(e)?0:s.length;while(a--){if(u=s[a],o.relative[c=u.type])break;if((p=o.find[c])&&(i=p(u.matches[0].replace(rt,it),V.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=i.length&&yt(s),!e)return M.apply(n,i),n;break}}}return l(e,f)(i,t,!h,n,V.test(e)),n}r.sortStable=b.split("").sort(A).join("")===b,r.detectDuplicates=S,p(),r.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ct("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ct("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||ct(B,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=at,x.expr=at.selectors,x.expr[":"]=x.expr.pseudos,x.unique=at.uniqueSort,x.text=at.getText,x.isXMLDoc=at.isXML,x.contains=at.contains}(e);var O={};function F(e){var t=O[e]={};return x.each(e.match(T)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?O[e]||F(e):x.extend({},e);var n,r,i,o,a,s,l=[],u=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=l.length,n=!0;l&&o>a;a++)if(l[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,l&&(u?u.length&&c(u.shift()):r?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;(function i(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=l.length:r&&(s=t,c(r))}return this},remove:function(){return l&&x.each(arguments,function(e,t){var r;while((r=x.inArray(t,l,r))>-1)l.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?x.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=u=r=t,this},disabled:function(){return!l},lock:function(){return u=t,r||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||i&&!u||(t=t||[],t=[e,t.slice?t.slice():t],n?u.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var a=o[0],s=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=g.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?g.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,l,u;if(r>1)for(s=Array(r),l=Array(r),u=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i;return i||o.resolveWith(u,n),o.promise()}}),x.support=function(t){var n,r,o,s,l,u,c,p,f,d=a.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],r=d.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;s=a.createElement("select"),u=s.appendChild(a.createElement("option")),o=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!o.value,t.optSelected=u.selected,t.enctype=!!a.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==a.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}o=a.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),l=a.createDocumentFragment(),l.appendChild(o),t.appendChecked=o.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;for(f in x(t))break;return t.ownLast="0"!==f,x(function(){var n,r,o,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];l&&(n=a.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=p&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",x.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(a.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(n),n=d=o=r=null)}),n=s=l=u=r=o=null,t
}({});var B=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;function R(e,n,r,i){if(x.acceptData(e)){var o,a,s=x.expando,l=e.nodeType,u=l?x.cache:e,c=l?e[s]:e[s]&&s;if(c&&u[c]&&(i||u[c].data)||r!==t||"string"!=typeof n)return c||(c=l?e[s]=p.pop()||x.guid++:s),u[c]||(u[c]=l?{}:{toJSON:x.noop}),("object"==typeof n||"function"==typeof n)&&(i?u[c]=x.extend(u[c],n):u[c].data=x.extend(u[c].data,n)),a=u[c],i||(a.data||(a.data={}),a=a.data),r!==t&&(a[x.camelCase(n)]=r),"string"==typeof n?(o=a[n],null==o&&(o=a[x.camelCase(n)])):o=a,o}}function W(e,t,n){if(x.acceptData(e)){var r,i,o=e.nodeType,a=o?x.cache:e,s=o?e[x.expando]:x.expando;if(a[s]){if(t&&(r=n?a[s]:a[s].data)){x.isArray(t)?t=t.concat(x.map(t,x.camelCase)):t in r?t=[t]:(t=x.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!I(r):!x.isEmptyObject(r))return}(n||(delete a[s].data,I(a[s])))&&(o?x.cleanData([e],!0):x.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}x.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?x.cache[e[x.expando]]:e[x.expando],!!e&&!I(e)},data:function(e,t,n){return R(e,t,n)},removeData:function(e,t){return W(e,t)},_data:function(e,t,n){return R(e,t,n,!0)},_removeData:function(e,t){return W(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&x.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),x.fn.extend({data:function(e,n){var r,i,o=null,a=0,s=this[0];if(e===t){if(this.length&&(o=x.data(s),1===s.nodeType&&!x._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>a;a++)i=r[a].name,0===i.indexOf("data-")&&(i=x.camelCase(i.slice(5)),$(s,i,o[i]));x._data(s,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){x.data(this,e)}):arguments.length>1?this.each(function(){x.data(this,e,n)}):s?$(s,e,x.data(s,e)):null},removeData:function(e){return this.each(function(){x.removeData(this,e)})}});function $(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(P,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:B.test(r)?x.parseJSON(r):r}catch(o){}x.data(e,n,r)}else r=t}return r}function I(e){var t;for(t in e)if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}x.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=x._data(e,n),r&&(!i||x.isArray(r)?i=x._data(e,n,x.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),a=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return x._data(e,n)||x._data(e,n,{empty:x.Callbacks("once memory").add(function(){x._removeData(e,t+"queue"),x._removeData(e,n)})})}}),x.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?x.queue(this[0],e):n===t?this:this.each(function(){var t=x.queue(this,e,n);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=x.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=x._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var z,X,U=/[\t\r\n\f]/g,V=/\r/g,Y=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,G=/^(?:checked|selected)$/i,Q=x.support.getSetAttribute,K=x.support.input;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,l="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,r=0,o=x(this),a=e.match(T)||[];while(t=a[r++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===i||"boolean"===n)&&(this.className&&x._data(this,"__className__",this.className),this.className=this.className||e===!1?"":x._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(U," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=x.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,x(this).val()):e,null==o?o="":"number"==typeof o?o+="":x.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""})),r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(V,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;for(;s>l;l++)if(n=r[l],!(!n.selected&&l!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),a=i.length;while(a--)r=i[a],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,r){var o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===i?x.prop(e,n,r):(1===s&&x.isXMLDoc(e)||(n=n.toLowerCase(),o=x.attrHooks[n]||(x.expr.match.bool.test(n)?X:z)),r===t?o&&"get"in o&&null!==(a=o.get(e,n))?a:(a=x.find.attr(e,n),null==a?t:a):null!==r?o&&"set"in o&&(a=o.set(e,r,n))!==t?a:(e.setAttribute(n,r+""),r):(x.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(T);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)?K&&Q||!G.test(n)?e[r]=!1:e[x.camelCase("default-"+n)]=e[r]=!1:x.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!x.isXMLDoc(e),a&&(n=x.propFix[n]||n,o=x.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):Y.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?x.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&x.propFix[n]||n,n):e[x.camelCase("default-"+n)]=e[n]=!0,n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,n){var r=x.expr.attrHandle[n]||x.find.attr;x.expr.attrHandle[n]=K&&Q||!G.test(n)?function(e,n,i){var o=x.expr.attrHandle[n],a=i?t:(x.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return x.expr.attrHandle[n]=o,a}:function(e,n,r){return r?t:e[x.camelCase("default-"+n)]?n.toLowerCase():null}}),K&&Q||(x.attrHooks.value={set:function(e,n,r){return x.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)}}),Q||(z={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},x.expr.attrHandle.id=x.expr.attrHandle.name=x.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},x.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:z.set},x.attrHooks.contenteditable={set:function(e,t,n){z.set(e,""===t?!1:t,n)}},x.each(["width","height"],function(e,n){x.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),x.support.hrefNormalized||x.each(["href","src"],function(e,t){x.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.support.enctype||(x.propFix.enctype="encoding"),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,n){return x.isArray(n)?e.checked=x.inArray(x(e).val(),n)>=0:t}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}function at(){try{return a.activeElement}catch(e){}}x.event={global:{},add:function(e,n,r,o,a){var s,l,u,c,p,f,d,h,g,m,y,v=x._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=x.guid++),(l=v.events)||(l=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof x===i||e&&x.event.triggered===e.type?t:x.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(T)||[""],u=n.length;while(u--)s=rt.exec(n[u])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),g&&(p=x.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=x.event.special[g]||{},d=x.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=l[g])||(h=l[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),x.event.global[g]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,p,f,d,h,g,m=x.hasData(e)&&x._data(e);if(m&&(c=m.events)){t=(t||"").match(T)||[""],u=t.length;while(u--)if(s=rt.exec(t[u])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=x.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));l&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||x.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)x.event.remove(e,d+t[u],n,r,!0);x.isEmptyObject(c)&&(delete m.handle,x._removeData(e,"events"))}},trigger:function(n,r,i,o){var s,l,u,c,p,f,d,h=[i||a],g=v.call(n,"type")?n.type:n,m=v.call(n,"namespace")?n.namespace.split("."):[];if(u=f=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+x.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),l=0>g.indexOf(":")&&"on"+g,n=n[x.expando]?n:new x.Event(g,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:x.makeArray(r,[n]),p=x.event.special[g]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!x.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(u=u.parentNode);u;u=u.parentNode)h.push(u),f=u;f===(i.ownerDocument||a)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((u=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(x._data(u,"events")||{})[n.type]&&x._data(u,"handle"),s&&s.apply(u,r),s=l&&u[l],s&&x.acceptData(u)&&s.apply&&s.apply(u,r)===!1&&n.preventDefault();if(n.type=g,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(h.pop(),r)===!1)&&x.acceptData(i)&&l&&i[g]&&!x.isWindow(i)){f=i[l],f&&(i[l]=null),x.event.triggered=g;try{i[g]()}catch(y){}x.event.triggered=t,f&&(i[l]=f)}return n.result}},dispatch:function(e){e=x.event.fix(e);var n,r,i,o,a,s=[],l=g.call(arguments),u=(x._data(this,"events")||{})[e.type]||[],c=x.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((x.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],l=n.delegateCount,u=e.target;if(l&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?x(r,this).index(u)>=0:x.find(r,this,null,[u]).length),o[r]&&o.push(i);o.length&&s.push({elem:u,handlers:o})}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new x.Event(o),t=r.length;while(t--)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||a),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,s=n.button,l=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||a,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?n.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===at()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return x.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=a.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},x.Event=function(e,n){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,t):new x.Event(e,n)},x.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.submitBubbles||(x.event.special.submit={setup:function(){return x.nodeName(this,"form")?!1:(x.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=x.nodeName(n,"input")||x.nodeName(n,"button")?n.form:t;r&&!x._data(r,"submitBubbles")&&(x.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),x._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return x.nodeName(this,"form")?!1:(x.event.remove(this,"._submit"),t)}}),x.support.changeBubbles||(x.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),x.event.simulate("change",this,e,!0)})),!1):(x.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!x._data(t,"changeBubbles")&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)}),x._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return x.event.remove(this,"._change"),!Z.test(this.nodeName)}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&a.addEventListener(e,r,!0)},teardown:function(){0===--n&&a.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return x().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){x.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?x.event.trigger(e,n,r,!0):t}});var st=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ut=x.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=x(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(x.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e||[],!0))},filter:function(e){return this.pushStack(ft(this,e||[],!1))},is:function(e){return!!ft(this,"string"==typeof e&&ut.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],a=ut.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(ct[e]||(i=x.unique(i)),lt.test(e)&&(i=i.reverse())),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!x(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(st.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return x.inArray(e,t)>=0!==n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Ct=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:x.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(a),Dt=jt.appendChild(a.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===t?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(Ft(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&_t(Ft(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&x.cleanData(Ft(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&x.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!x.support.htmlSerialize&&mt.test(e)||!x.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(x.cleanData(Ft(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=d.apply([],e);var r,i,o,a,s,l,u=0,c=this.length,p=this,f=c-1,h=e[0],g=x.isFunction(h);if(g||!(1>=c||"string"!=typeof h||x.support.checkClone)&&Nt.test(h))return this.each(function(r){var i=p.eq(r);g&&(e[0]=h.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(l=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=l.firstChild,1===l.childNodes.length&&(l=r),r)){for(a=x.map(Ft(l,"script"),Ht),o=a.length;c>u;u++)i=l,u!==f&&(i=x.clone(i,!0,!0),o&&x.merge(a,Ft(i,"script"))),t.call(this[u],i,u);if(o)for(s=a[a.length-1].ownerDocument,x.map(a,qt),u=0;o>u;u++)i=a[u],kt.test(i.type||"")&&!x._data(i,"globalEval")&&x.contains(s,i)&&(i.src?x._evalUrl(i.src):x.globalEval((i.text||i.textContent||i.innerHTML||"").replace(St,"")));l=r=null}return this}});function Lt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ht(e){return e.type=(null!==x.find.attr(e,"type"))+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _t(e,t){var n,r=0;for(;null!=(n=e[r]);r++)x._data(n,"globalEval",!t||x._data(t[r],"globalEval"))}function Mt(e,t){if(1===t.nodeType&&x.hasData(e)){var n,r,i,o=x._data(e),a=x._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)x.event.add(t,n,s[n][r])}a.data&&(a.data=x.extend({},a.data))}}function Ot(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!x.support.noCloneEvent&&t[x.expando]){i=x._data(t);for(r in i.events)x.removeEvent(t,r,i.handle);t.removeAttribute(x.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),x.support.html5Clone&&e.innerHTML&&!x.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ct.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=0,i=[],o=x(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),x(o[r])[t](n),h.apply(i,n.get());return this.pushStack(i)}});function Ft(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||x.nodeName(o,n)?s.push(o):x.merge(s,Ft(o,n));return n===t||n&&x.nodeName(e,n)?x.merge([e],s):s}function Bt(e){Ct.test(e.type)&&(e.defaultChecked=e.checked)}x.extend({clone:function(e,t,n){var r,i,o,a,s,l=x.contains(e.ownerDocument,e);if(x.support.html5Clone||x.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(r=Ft(o),s=Ft(e),a=0;null!=(i=s[a]);++a)r[a]&&Ot(i,r[a]);if(t)if(n)for(s=s||Ft(e),r=r||Ft(o),a=0;null!=(i=s[a]);a++)Mt(i,r[a]);else Mt(e,o);return r=Ft(o,"script"),r.length>0&&_t(r,!l&&Ft(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,l,u,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===x.type(o))x.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),l=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[l]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!x.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!x.support.tbody){o="table"!==l||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)x.nodeName(u=o.childNodes[i],"tbody")&&!u.childNodes.length&&o.removeChild(u)}x.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),x.support.appendChecked||x.grep(Ft(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===x.inArray(o,r))&&(a=x.contains(o.ownerDocument,o),s=Ft(f.appendChild(o),"script"),a&&_t(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,l=x.expando,u=x.cache,c=x.support.deleteExpando,f=x.event.special;for(;null!=(n=e[s]);s++)if((t||x.acceptData(n))&&(o=n[l],a=o&&u[o])){if(a.events)for(r in a.events)f[r]?x.event.remove(n,r):x.removeEvent(n,r,a.handle);
u[o]&&(delete u[o],c?delete n[l]:typeof n.removeAttribute!==i?n.removeAttribute(l):n[l]=null,p.push(o))}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){if(x.isFunction(e))return this.each(function(t){x(this).wrapAll(e.call(this,t))});if(this[0]){var t=x(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+w+")(.*)$","i"),Yt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+w+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=x._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=x._data(r,"olddisplay",ln(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&x._data(r,"olddisplay",i?n:x.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}x.fn.extend({css:function(e,n){return x.access(this,function(e,n,r){var i,o,a={},s=0;if(x.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=x.css(e,n[s],!1,o);return a}return r!==t?x.style(e,n,r):x.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=x.camelCase(n),u=e.style;if(n=x.cssProps[l]||(x.cssProps[l]=tn(u,l)),s=x.cssHooks[n]||x.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(x.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||x.cssNumber[l]||(r+="px"),x.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(u[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,l=x.camelCase(n);return n=x.cssProps[l]||(x.cssProps[l]=tn(e.style,l)),s=x.cssHooks[n]||x.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||x.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s.getPropertyValue(n)||s[n]:t,u=e.style;return s&&(""!==l||x.contains(e.ownerDocument,e)||(l=x.style(e,n)),Yt.test(l)&&Ut.test(n)&&(i=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=s.width,u.width=i,u.minWidth=o,u.maxWidth=a)),l}):a.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s[n]:t,u=e.style;return null==l&&u&&u[n]&&(l=u[n]),Yt.test(l)&&!zt.test(n)&&(i=u.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),u.left="fontSize"===n?"1em":l,l=u.pixelLeft+"px",u.left=i,a&&(o.left=a)),""===l?"auto":l});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=x.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=x.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=x.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=x.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=x.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function ln(e){var t=a,n=Gt[e];return n||(n=un(e,t),"none"!==n&&n||(Pt=(Pt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=un(e,t),Pt.detach()),Gt[e]=n),n}function un(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,n){x.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(x.css(e,"display"))?x.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===x.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,n){return n?x.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,n){x.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?x(e).position()[n]+"px":r):t}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(x.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Ct.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),x.param=function(e,n){var r,i=[],o=function(e,t){t=x.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,yn,vn=x.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Cn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=o.href}catch(Ln){yn=a.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(T)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(l){var u;return o[l]=!0,x.each(e[l]||[],function(e,l){var c=l(n,r,i);return"string"!=typeof c||a||o[c]?a?!(u=c):t:(n.dataTypes.unshift(c),s(c),!1)}),u}return s(n.dataTypes[0])||!o["*"]&&s("*")}function _n(e,n){var r,i,o=x.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),x.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&x.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Cn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_n(_n(e,x.ajaxSettings),t):_n(x.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,l,u,c,p=x.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?x(f):x.event,h=x.Deferred(),g=x.Callbacks("once memory"),m=p.statusCode||{},y={},v={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),k(0,t),this}};if(h.promise(C).complete=g.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=x.trim(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),qn(An,p,n,C),2===b)return C;l=p.global,l&&0===x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Nn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(x.lastModified[o]&&C.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&C.setRequestHeader("If-None-Match",x.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)C.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,C,p)===!1||2===b))return C.abort();w="abort";for(i in{success:1,error:1,complete:1})C[i](p[i]);if(u=qn(jn,p,n,C)){C.readyState=1,l&&d.trigger("ajaxSend",[C,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){C.abort("timeout")},p.timeout));try{b=1,u.send(y,k)}catch(N){if(!(2>b))throw N;k(-1,N)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,N=n;2!==b&&(b=2,s&&clearTimeout(s),u=t,a=i||"",C.readyState=e>0?4:0,c=e>=200&&300>e||304===e,r&&(w=Mn(p,C,r)),w=On(p,w,C,c),c?(p.ifModified&&(T=C.getResponseHeader("Last-Modified"),T&&(x.lastModified[o]=T),T=C.getResponseHeader("etag"),T&&(x.etag[o]=T)),204===e||"HEAD"===p.type?N="nocontent":304===e?N="notmodified":(N=w.state,y=w.data,v=w.error,c=!v)):(v=N,(e||!N)&&(N="error",0>e&&(e=0))),C.status=e,C.statusText=(n||N)+"",c?h.resolveWith(f,[y,N,C]):h.rejectWith(f,[C,N,v]),C.statusCode(m),m=t,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,p,c?y:v]),g.fireWith(f,[C,N]),l&&(d.trigger("ajaxComplete",[C,p]),--x.active||x.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,n){return x.get(e,t,n,"script")}}),x.each(["get","post"],function(e,n){x[n]=function(e,r,i,o){return x.isFunction(r)&&(o=o||i,i=r,r=t),x.ajax({url:e,type:n,dataType:o,data:r,success:i})}});function Mn(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){u.unshift(s);break}if(u[0]in r)a=u[0];else{for(s in r){if(!u[0]||e.converters[s+" "+u[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==u[0]&&u.unshift(a),r[a]):t}function On(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a)for(i in u)if(s=i.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(p){return{state:"parsererror",error:a?p:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),x.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=a.head||x("head")[0]||a.documentElement;return{send:function(t,i){n=a.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Fn=[],Bn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||x.expando+"_"+vn++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=x.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&x.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}x.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=x.ajaxSettings.xhr(),x.support.cors=!!Rn&&"withCredentials"in Rn,Rn=x.support.ajax=!!Rn,Rn&&x.ajaxTransport(function(n){if(!n.crossDomain||x.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,p;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=x.noop,$n&&delete Pn[a]),i)4!==l.readyState&&l.abort();else{p={},s=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);try{c=l.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,u)},n.async?4===l.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},x(e).unload($n)),Pn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Yn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),a=(x.cssNumber[e]||"px"!==o&&+r)&&Yn.exec(x.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;do s=s||".5",a/=s,x.style(n.elem,e,a+o);while(s!==(s=n.cur()/r)&&1!==s&&--l)}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=x.now()}function Zn(e,t,n){var r,i=(Qn[t]||[]).concat(Qn["*"]),o=0,a=i.length;for(;a>o;o++)if(r=i[o].call(n,t,e))return r}function er(e,t,n){var r,i,o=0,a=Gn.length,s=x.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,l=u.tweens.length;for(;l>a;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(tr(c,u.opts.specialEasing);a>o;o++)if(r=Gn[o].call(u,e,c,u.opts))return r;return x.map(c,Zn,u),x.isFunction(u.opts.start)&&u.opts.start.call(e,u),x.fx.timer(x.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function tr(e,t){var n,r,i,o,a;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=x.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(er,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,l,u=this,c={},p=e.style,f=e.nodeType&&nn(e),d=x._data(e,"fxshow");n.queue||(s=x._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ln(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",x.support.shrinkWrapBlocks||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Vn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show"))continue;c[r]=d&&d[r]||x.style(e,r)}if(!x.isEmptyObject(c)){d?"hidden"in d&&(f=d.hidden):d=x._data(e,"fxshow",{}),o&&(d.hidden=!f),f?x(e).show():u.done(function(){x(e).hide()}),u.done(function(){var t;x._removeData(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)a=Zn(f?d[r]:0,r,u),r in d||(d[r]=a.start,f&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}x.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),a=function(){var t=er(this,x.extend({},e),o);(i||x._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=x.timers,a=x._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=x._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,a=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=rr.prototype.init,x.fx.tick=function(){var e,n=x.timers,r=0;for(Xn=x.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||x.fx.stop(),Xn=t},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){Un||(Un=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(Un),Un=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){x.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,x.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},x.offset={setOffset:function(e,t,n){var r=x.css(e,"position");"static"===r&&(e.style.position="relative");var i=x(e),o=i.offset(),a=x.css(e,"top"),s=x.css(e,"left"),l=("absolute"===r||"fixed"===r)&&x.inArray("auto",[a,s])>-1,u={},c={},p,f;l?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),x.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(u.top=t.top-o.top+p),null!=t.left&&(u.left=t.left-o.left+f),"using"in t?t.using.call(e,u):i.css(u)}},x.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===x.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(n=e.offset()),n.top+=x.css(e[0],"borderTopWidth",!0),n.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-x.css(r,"marginTop",!0),left:t.left-n.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);x.fn[e]=function(i){return x.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?x(a).scrollLeft():o,r?o:x(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return x.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}x.each({Height:"height",Width:"width"},function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){x.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return x.access(this,function(n,r,i){var o;return x.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?x.css(n,r,s):x.style(n,r,i,s)},n,a?i:t,a,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:(e.jQuery=e.$=x,"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}))})(window);

//-->
</script>
    <script type="text/x-mathjax-config;executed=true">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$']]},
        "HTML-CSS": 
          {scale: 92},
        TeX: { equationNumbers: { autoNumber: "AMS" }}});
    </script>
    <script type="text/javascript" src="./Neural networks and deep learning 3_files/MathJax.js"></script>


    <style style="display:none">/* Layout: 980px fixed-width: 40px margin, 600px main tex,           */
/* 40px margin, 240px for toc and marginalia, 40px margin            */
/*                                                                   */
/*                                                                   */
/* Colours:                                                          */
/*                                                                   */
/* #1C3950: header and h1 background, h2, h3 foreground, main links  */
/* HSV: 207, 65, 31                                                  */
/* Decimal RGB: 28, 57, 80                                           */
/*                                                                   */
/* #2A6EA6; link colour, graph line colour, d3 paths, widgets        */
/* HSV: 207, 75, 65                                                  */
/* Decimal RGB: 42, 110, 166                                         */
/*                                                                   */
/* #FFA933: complement to #2A6EA6, for use on graphs                 */
/*                                                                   */
/* Triad: #2A6EA6, #FFCD33, #FF7033                                  */
/*                                                                   */
/* #eee: header text                                                 */


/* Reset */

body {
    background: #fff;
    font-style: normal;
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    /* font-family: "Helvetica", "Arial", sans-serif; */
    color: #000;
    width: 100%;
    margin: 0;
    padding: 0;
    text-align: left;
    position: relative;
}


/* Header */

.header, .nonumber_header {
    position: relative;
    top: 0px;
    width: 100%;
    margin: 0;
    background-color: #1C3950;
}

.header {
    height: 120px;
}

.nonumber_header {
    height: 80px;
}

h1 {
    position: absolute;
    top: 0px;
    left: 40px;
    right: 40px;
    padding: 0px;
    margin: 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 34px;
    line-height: 1.2;
    color: #eee;
    white-space: nowrap;
    font-weight: 400;
}

h1.chapter_number {
    margin-top: 10px;
    font-size: 24px;
    border-bottom: 1px solid #BBB;
}

h1.chapter_number a {
    color: #eee;
}

h1.chapter_title {
    margin-top: 56px;
    font-size: 34px;
}

h1.chapter_title a {
    color: #eee;
}

h2 {
    position: absolute;
    top: 0px;
    left: 40px;
    right: 40px;
    padding: 0px;
    margin: 16px 0px 0px 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 34px;
    line-height: 1.2;
    color: #eee;
    white-space: nowrap;
}

h2 a {
    color: #eee;
}

/********/
/* Main */
/********/

#insertion {
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    color: #333;
    padding: 5px 10px 5px 10px;
    background: #ccaaaa;
    border: 1px solid;
    margin: 10px 0px 0px 0px;
}

p {
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    color: #333;
    margin: 0 0 1 0;
}

h3 {
    color: #1C3950;
    margin: 40px 0px 20px 0px;
    padding: 0;
    font-size: 32px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
    border-bottom: 1px solid #666;
}

h4 {
    color: #1C3950;
    margin: 30px 0px 15px 0px;
    padding: 0;
    padding-left: 0px;
    font-size: 26px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
}

h5 {
    color: #1C3950;
    margin: 20px 0px 10px 0px;
    padding: 0;
    padding-left: 0px;
    font-size: 26px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
}

.section {
    width: 600px;
    margin-left: 40px;
}

a { 
    color: #2A6EA6;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

.equation_link {
    color: #2A6EA6;
}

.equation_link:hover {
    text-decoration: underline;
    cursor: pointer;
}

.MathJax {
    color: #2A2A2A;
}

/* Set the font size for Pygments */
.highlight {
    font-size: 10pt;
}

/* Set the font size for code */
tt {
    font-size: 12pt;
    font-style: monospace;
}


/* d3 styling */
path {
    stroke: rgb(42, 110, 166);
    stroke-width: 1;
    fill: none;
}
.axis {
    shape-rendering: crispEdges;
}
.axis text {
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 11px;
}
.axis line, .axis path {
    stroke: grey;
}

.axisLabel {
  font-size: 18px;
  font-family: "Helvetica", "Arial", sans-serif;
  font-style: italic;
  font-weight: bold;
}


/* Table of contents, and margin notes */

#toc, .marginnote, .marginequation {
    position: absolute;
    left: 680px;
    width: 260px;
    padding: 0;
    margin: 0;
}

.sidebar {
    margin: 0 0 5px 0;
    padding: 0;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_title {
    margin: 0; 
    padding: 0;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_not_mainchapter {
    margin: 0;
    padding: 0 0 0 15px;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_mainchapter {
    margin: 0; 
    padding: 0 0 0 15px; 
    text-indent: -15px;
    font-size: 12pt;
    line-height: 1.5;
}


.toc_reveal {
    cursor: pointer;
}

.toc_section {
    padding: 0 0 0 15px; 
    margin: 0;
}

#toc ul {
    padding: 0 0 0 15px;
    list-style-position: inside;
    margin: 0;
    line-height: 1.5;
}

.sidebar_title {
    font-size: 18pt;
    font-family: "Helvetica", "Arial", sans-serif;
}

.marginnote {
    font-size: 9pt;
    color: #666;
    display: inline-block;
}

.marginnote .MathJax {
    color: #666;
}

.marginnote tt {
    font-size: 9pt
}

.marginequation .MathJax {
    color: #2A6EA6;
}

#toc {
    font-size: 12pt;
    color: #000;
}

/* Footer */

.footer {
    position: relative;
    top: 0px;
    width: 100%;
    height: 130px;
    margin: 0;
    background-color: #1C3950;
}

span.left_footer, span.right_footer {
    position: absolute;
    top: 12px;
    left: 40px;
    padding: 0px;
    margin: 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 9pt;
    font-style: bold;
    line-height: 1.5;
    color: #eee;
}

span.left_footer {
    display: block;
    width: 600px;
    word-wrap:break-word;
}

span.right_footer {
    right: 40px;
    text-align: right;
}

.MathJax_Display {
    color: #333 !important;
}



/* Adapted from http://worrydream.com/ScrubbingCalculator/style.css, */
/* by Bret Victor */
.videoOverlay {
    position: absolute;
    cursor: pointer;
    background-color: white;
    z-index: 100;
}

.videoOverlay img {
    position: absolute;
    display: block;
}

/* class for text labels on the 3d graphs */
.graph3D {
    position: absolute;
    font: 15px MJX_Math;
    background-color: white;
    border-radius: 5px;
    line-height: 18px;
    padding-top: 0;
    padding-right: 3px;
    padding-bottom: 0px;
    padding-left: 3px;
}

</style>

    <style style="display:none">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

    <style style="display:none">/*! jQuery UI - v1.11.2 - 2014-10-16
* http://jqueryui.com
* Includes: core.css, accordion.css, autocomplete.css, button.css, datepicker.css, dialog.css, draggable.css, menu.css, progressbar.css, resizable.css, selectable.css, selectmenu.css, slider.css, sortable.css, spinner.css, tabs.css, tooltip.css, theme.css
* To view and modify this theme, visit http://jqueryui.com/themeroller/?ffDefault=Verdana%2CArial%2Csans-serif&fwDefault=normal&fsDefault=1.1em&cornerRadius=4px&bgColorHeader=cccccc&bgTextureHeader=highlight_soft&bgImgOpacityHeader=75&borderColorHeader=aaaaaa&fcHeader=222222&iconColorHeader=222222&bgColorContent=ffffff&bgTextureContent=flat&bgImgOpacityContent=75&borderColorContent=aaaaaa&fcContent=222222&iconColorContent=222222&bgColorDefault=e6e6e6&bgTextureDefault=glass&bgImgOpacityDefault=75&borderColorDefault=d3d3d3&fcDefault=555555&iconColorDefault=888888&bgColorHover=dadada&bgTextureHover=glass&bgImgOpacityHover=75&borderColorHover=999999&fcHover=212121&iconColorHover=454545&bgColorActive=ffffff&bgTextureActive=glass&bgImgOpacityActive=65&borderColorActive=aaaaaa&fcActive=212121&iconColorActive=454545&bgColorHighlight=fbf9ee&bgTextureHighlight=glass&bgImgOpacityHighlight=55&borderColorHighlight=fcefa1&fcHighlight=363636&iconColorHighlight=2e83ff&bgColorError=fef1ec&bgTextureError=glass&bgImgOpacityError=95&borderColorError=cd0a0a&fcError=cd0a0a&iconColorError=cd0a0a&bgColorOverlay=aaaaaa&bgTextureOverlay=flat&bgImgOpacityOverlay=0&opacityOverlay=30&bgColorShadow=aaaaaa&bgTextureShadow=flat&bgImgOpacityShadow=0&opacityShadow=30&thicknessShadow=8px&offsetTopShadow=-8px&offsetLeftShadow=-8px&cornerRadiusShadow=8px
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/* Layout helpers
----------------------------------*/
.ui-helper-hidden {
	display: none;
}
.ui-helper-hidden-accessible {
	border: 0;
	clip: rect(0 0 0 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}
.ui-helper-reset {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	line-height: 1.3;
	text-decoration: none;
	font-size: 100%;
	list-style: none;
}
.ui-helper-clearfix:before,
.ui-helper-clearfix:after {
	content: "";
	display: table;
	border-collapse: collapse;
}
.ui-helper-clearfix:after {
	clear: both;
}
.ui-helper-clearfix {
	min-height: 0; /* support: IE7 */
}
.ui-helper-zfix {
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	position: absolute;
	opacity: 0;
	filter:Alpha(Opacity=0); /* support: IE8 */
}

.ui-front {
	z-index: 100;
}


/* Interaction Cues
----------------------------------*/
.ui-state-disabled {
	cursor: default !important;
}


/* Icons
----------------------------------*/

/* states and images */
.ui-icon {
	display: block;
	text-indent: -99999px;
	overflow: hidden;
	background-repeat: no-repeat;
}


/* Misc visuals
----------------------------------*/

/* Overlays */
.ui-widget-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}
.ui-accordion .ui-accordion-header {
	display: block;
	cursor: pointer;
	position: relative;
	margin: 2px 0 0 0;
	padding: .5em .5em .5em .7em;
	min-height: 0; /* support: IE7 */
	font-size: 100%;
}
.ui-accordion .ui-accordion-icons {
	padding-left: 2.2em;
}
.ui-accordion .ui-accordion-icons .ui-accordion-icons {
	padding-left: 2.2em;
}
.ui-accordion .ui-accordion-header .ui-accordion-header-icon {
	position: absolute;
	left: .5em;
	top: 50%;
	margin-top: -8px;
}
.ui-accordion .ui-accordion-content {
	padding: 1em 2.2em;
	border-top: 0;
	overflow: auto;
}
.ui-autocomplete {
	position: absolute;
	top: 0;
	left: 0;
	cursor: default;
}
.ui-button {
	display: inline-block;
	position: relative;
	padding: 0;
	line-height: normal;
	margin-right: .1em;
	cursor: pointer;
	vertical-align: middle;
	text-align: center;
	overflow: visible; /* removes extra width in IE */
}
.ui-button,
.ui-button:link,
.ui-button:visited,
.ui-button:hover,
.ui-button:active {
	text-decoration: none;
}
/* to make room for the icon, a width needs to be set here */
.ui-button-icon-only {
	width: 2.2em;
}
/* button elements seem to need a little more width */
button.ui-button-icon-only {
	width: 2.4em;
}
.ui-button-icons-only {
	width: 3.4em;
}
button.ui-button-icons-only {
	width: 3.7em;
}

/* button text element */
.ui-button .ui-button-text {
	display: block;
	line-height: normal;
}
.ui-button-text-only .ui-button-text {
	padding: .4em 1em;
}
.ui-button-icon-only .ui-button-text,
.ui-button-icons-only .ui-button-text {
	padding: .4em;
	text-indent: -9999999px;
}
.ui-button-text-icon-primary .ui-button-text,
.ui-button-text-icons .ui-button-text {
	padding: .4em 1em .4em 2.1em;
}
.ui-button-text-icon-secondary .ui-button-text,
.ui-button-text-icons .ui-button-text {
	padding: .4em 2.1em .4em 1em;
}
.ui-button-text-icons .ui-button-text {
	padding-left: 2.1em;
	padding-right: 2.1em;
}
/* no icon support for input elements, provide padding by default */
input.ui-button {
	padding: .4em 1em;
}

/* button icon element(s) */
.ui-button-icon-only .ui-icon,
.ui-button-text-icon-primary .ui-icon,
.ui-button-text-icon-secondary .ui-icon,
.ui-button-text-icons .ui-icon,
.ui-button-icons-only .ui-icon {
	position: absolute;
	top: 50%;
	margin-top: -8px;
}
.ui-button-icon-only .ui-icon {
	left: 50%;
	margin-left: -8px;
}
.ui-button-text-icon-primary .ui-button-icon-primary,
.ui-button-text-icons .ui-button-icon-primary,
.ui-button-icons-only .ui-button-icon-primary {
	left: .5em;
}
.ui-button-text-icon-secondary .ui-button-icon-secondary,
.ui-button-text-icons .ui-button-icon-secondary,
.ui-button-icons-only .ui-button-icon-secondary {
	right: .5em;
}

/* button sets */
.ui-buttonset {
	margin-right: 7px;
}
.ui-buttonset .ui-button {
	margin-left: 0;
	margin-right: -.3em;
}

/* workarounds */
/* reset extra padding in Firefox, see h5bp.com/l */
input.ui-button::-moz-focus-inner,
button.ui-button::-moz-focus-inner {
	border: 0;
	padding: 0;
}
.ui-datepicker {
	width: 17em;
	padding: .2em .2em 0;
	display: none;
}
.ui-datepicker .ui-datepicker-header {
	position: relative;
	padding: .2em 0;
}
.ui-datepicker .ui-datepicker-prev,
.ui-datepicker .ui-datepicker-next {
	position: absolute;
	top: 2px;
	width: 1.8em;
	height: 1.8em;
}
.ui-datepicker .ui-datepicker-prev-hover,
.ui-datepicker .ui-datepicker-next-hover {
	top: 1px;
}
.ui-datepicker .ui-datepicker-prev {
	left: 2px;
}
.ui-datepicker .ui-datepicker-next {
	right: 2px;
}
.ui-datepicker .ui-datepicker-prev-hover {
	left: 1px;
}
.ui-datepicker .ui-datepicker-next-hover {
	right: 1px;
}
.ui-datepicker .ui-datepicker-prev span,
.ui-datepicker .ui-datepicker-next span {
	display: block;
	position: absolute;
	left: 50%;
	margin-left: -8px;
	top: 50%;
	margin-top: -8px;
}
.ui-datepicker .ui-datepicker-title {
	margin: 0 2.3em;
	line-height: 1.8em;
	text-align: center;
}
.ui-datepicker .ui-datepicker-title select {
	font-size: 1em;
	margin: 1px 0;
}
.ui-datepicker select.ui-datepicker-month,
.ui-datepicker select.ui-datepicker-year {
	width: 45%;
}
.ui-datepicker table {
	width: 100%;
	font-size: .9em;
	border-collapse: collapse;
	margin: 0 0 .4em;
}
.ui-datepicker th {
	padding: .7em .3em;
	text-align: center;
	font-weight: bold;
	border: 0;
}
.ui-datepicker td {
	border: 0;
	padding: 1px;
}
.ui-datepicker td span,
.ui-datepicker td a {
	display: block;
	padding: .2em;
	text-align: right;
	text-decoration: none;
}
.ui-datepicker .ui-datepicker-buttonpane {
	background-image: none;
	margin: .7em 0 0 0;
	padding: 0 .2em;
	border-left: 0;
	border-right: 0;
	border-bottom: 0;
}
.ui-datepicker .ui-datepicker-buttonpane button {
	float: right;
	margin: .5em .2em .4em;
	cursor: pointer;
	padding: .2em .6em .3em .6em;
	width: auto;
	overflow: visible;
}
.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current {
	float: left;
}

/* with multiple calendars */
.ui-datepicker.ui-datepicker-multi {
	width: auto;
}
.ui-datepicker-multi .ui-datepicker-group {
	float: left;
}
.ui-datepicker-multi .ui-datepicker-group table {
	width: 95%;
	margin: 0 auto .4em;
}
.ui-datepicker-multi-2 .ui-datepicker-group {
	width: 50%;
}
.ui-datepicker-multi-3 .ui-datepicker-group {
	width: 33.3%;
}
.ui-datepicker-multi-4 .ui-datepicker-group {
	width: 25%;
}
.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header,
.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header {
	border-left-width: 0;
}
.ui-datepicker-multi .ui-datepicker-buttonpane {
	clear: left;
}
.ui-datepicker-row-break {
	clear: both;
	width: 100%;
	font-size: 0;
}

/* RTL support */
.ui-datepicker-rtl {
	direction: rtl;
}
.ui-datepicker-rtl .ui-datepicker-prev {
	right: 2px;
	left: auto;
}
.ui-datepicker-rtl .ui-datepicker-next {
	left: 2px;
	right: auto;
}
.ui-datepicker-rtl .ui-datepicker-prev:hover {
	right: 1px;
	left: auto;
}
.ui-datepicker-rtl .ui-datepicker-next:hover {
	left: 1px;
	right: auto;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane {
	clear: right;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane button {
	float: left;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current,
.ui-datepicker-rtl .ui-datepicker-group {
	float: right;
}
.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header,
.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header {
	border-right-width: 0;
	border-left-width: 1px;
}
.ui-dialog {
	overflow: hidden;
	position: absolute;
	top: 0;
	left: 0;
	padding: .2em;
	outline: 0;
}
.ui-dialog .ui-dialog-titlebar {
	padding: .4em 1em;
	position: relative;
}
.ui-dialog .ui-dialog-title {
	float: left;
	margin: .1em 0;
	white-space: nowrap;
	width: 90%;
	overflow: hidden;
	text-overflow: ellipsis;
}
.ui-dialog .ui-dialog-titlebar-close {
	position: absolute;
	right: .3em;
	top: 50%;
	width: 20px;
	margin: -10px 0 0 0;
	padding: 1px;
	height: 20px;
}
.ui-dialog .ui-dialog-content {
	position: relative;
	border: 0;
	padding: .5em 1em;
	background: none;
	overflow: auto;
}
.ui-dialog .ui-dialog-buttonpane {
	text-align: left;
	border-width: 1px 0 0 0;
	background-image: none;
	margin-top: .5em;
	padding: .3em 1em .5em .4em;
}
.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset {
	float: right;
}
.ui-dialog .ui-dialog-buttonpane button {
	margin: .5em .4em .5em 0;
	cursor: pointer;
}
.ui-dialog .ui-resizable-se {
	width: 12px;
	height: 12px;
	right: -5px;
	bottom: -5px;
	background-position: 16px 16px;
}
.ui-draggable .ui-dialog-titlebar {
	cursor: move;
}
.ui-draggable-handle {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-menu {
	list-style: none;
	padding: 0;
	margin: 0;
	display: block;
	outline: none;
}
.ui-menu .ui-menu {
	position: absolute;
}
.ui-menu .ui-menu-item {
	position: relative;
	margin: 0;
	padding: 3px 1em 3px .4em;
	cursor: pointer;
	min-height: 0; /* support: IE7 */
	/* support: IE10, see #8844 */
	list-style-image: url("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");
}
.ui-menu .ui-menu-divider {
	margin: 5px 0;
	height: 0;
	font-size: 0;
	line-height: 0;
	border-width: 1px 0 0 0;
}
.ui-menu .ui-state-focus,
.ui-menu .ui-state-active {
	margin: -1px;
}

/* icon support */
.ui-menu-icons {
	position: relative;
}
.ui-menu-icons .ui-menu-item {
	padding-left: 2em;
}

/* left-aligned */
.ui-menu .ui-icon {
	position: absolute;
	top: 0;
	bottom: 0;
	left: .2em;
	margin: auto 0;
}

/* right-aligned */
.ui-menu .ui-menu-icon {
	left: auto;
	right: 0;
}
.ui-progressbar {
	height: 2em;
	text-align: left;
	overflow: hidden;
}
.ui-progressbar .ui-progressbar-value {
	margin: -1px;
	height: 100%;
}
.ui-progressbar .ui-progressbar-overlay {
	background: url("data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==");
	height: 100%;
	filter: alpha(opacity=25); /* support: IE8 */
	opacity: 0.25;
}
.ui-progressbar-indeterminate .ui-progressbar-value {
	background-image: none;
}
.ui-resizable {
	position: relative;
}
.ui-resizable-handle {
	position: absolute;
	font-size: 0.1px;
	display: block;
	-ms-touch-action: none;
	touch-action: none;
}
.ui-resizable-disabled .ui-resizable-handle,
.ui-resizable-autohide .ui-resizable-handle {
	display: none;
}
.ui-resizable-n {
	cursor: n-resize;
	height: 7px;
	width: 100%;
	top: -5px;
	left: 0;
}
.ui-resizable-s {
	cursor: s-resize;
	height: 7px;
	width: 100%;
	bottom: -5px;
	left: 0;
}
.ui-resizable-e {
	cursor: e-resize;
	width: 7px;
	right: -5px;
	top: 0;
	height: 100%;
}
.ui-resizable-w {
	cursor: w-resize;
	width: 7px;
	left: -5px;
	top: 0;
	height: 100%;
}
.ui-resizable-se {
	cursor: se-resize;
	width: 12px;
	height: 12px;
	right: 1px;
	bottom: 1px;
}
.ui-resizable-sw {
	cursor: sw-resize;
	width: 9px;
	height: 9px;
	left: -5px;
	bottom: -5px;
}
.ui-resizable-nw {
	cursor: nw-resize;
	width: 9px;
	height: 9px;
	left: -5px;
	top: -5px;
}
.ui-resizable-ne {
	cursor: ne-resize;
	width: 9px;
	height: 9px;
	right: -5px;
	top: -5px;
}
.ui-selectable {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-selectable-helper {
	position: absolute;
	z-index: 100;
	border: 1px dotted black;
}
.ui-selectmenu-menu {
	padding: 0;
	margin: 0;
	position: absolute;
	top: 0;
	left: 0;
	display: none;
}
.ui-selectmenu-menu .ui-menu {
	overflow: auto;
	/* Support: IE7 */
	overflow-x: hidden;
	padding-bottom: 1px;
}
.ui-selectmenu-menu .ui-menu .ui-selectmenu-optgroup {
	font-size: 1em;
	font-weight: bold;
	line-height: 1.5;
	padding: 2px 0.4em;
	margin: 0.5em 0 0 0;
	height: auto;
	border: 0;
}
.ui-selectmenu-open {
	display: block;
}
.ui-selectmenu-button {
	display: inline-block;
	overflow: hidden;
	position: relative;
	text-decoration: none;
	cursor: pointer;
}
.ui-selectmenu-button span.ui-icon {
	right: 0.5em;
	left: auto;
	margin-top: -8px;
	position: absolute;
	top: 50%;
}
.ui-selectmenu-button span.ui-selectmenu-text {
	text-align: left;
	padding: 0.4em 2.1em 0.4em 1em;
	display: block;
	line-height: 1.4;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}
.ui-slider {
	position: relative;
	text-align: left;
}
.ui-slider .ui-slider-handle {
	position: absolute;
	z-index: 2;
	width: 1.2em;
	height: 1.2em;
	cursor: default;
	-ms-touch-action: none;
	touch-action: none;
}
.ui-slider .ui-slider-range {
	position: absolute;
	z-index: 1;
	font-size: .7em;
	display: block;
	border: 0;
	background-position: 0 0;
}

/* support: IE8 - See #6727 */
.ui-slider.ui-state-disabled .ui-slider-handle,
.ui-slider.ui-state-disabled .ui-slider-range {
	filter: inherit;
}

.ui-slider-horizontal {
	height: .8em;
}
.ui-slider-horizontal .ui-slider-handle {
	top: -.3em;
	margin-left: -.6em;
}
.ui-slider-horizontal .ui-slider-range {
	top: 0;
	height: 100%;
}
.ui-slider-horizontal .ui-slider-range-min {
	left: 0;
}
.ui-slider-horizontal .ui-slider-range-max {
	right: 0;
}

.ui-slider-vertical {
	width: .8em;
	height: 100px;
}
.ui-slider-vertical .ui-slider-handle {
	left: -.3em;
	margin-left: 0;
	margin-bottom: -.6em;
}
.ui-slider-vertical .ui-slider-range {
	left: 0;
	width: 100%;
}
.ui-slider-vertical .ui-slider-range-min {
	bottom: 0;
}
.ui-slider-vertical .ui-slider-range-max {
	top: 0;
}
.ui-sortable-handle {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-spinner {
	position: relative;
	display: inline-block;
	overflow: hidden;
	padding: 0;
	vertical-align: middle;
}
.ui-spinner-input {
	border: none;
	background: none;
	color: inherit;
	padding: 0;
	margin: .2em 0;
	vertical-align: middle;
	margin-left: .4em;
	margin-right: 22px;
}
.ui-spinner-button {
	width: 16px;
	height: 50%;
	font-size: .5em;
	padding: 0;
	margin: 0;
	text-align: center;
	position: absolute;
	cursor: default;
	display: block;
	overflow: hidden;
	right: 0;
}
/* more specificity required here to override default borders */
.ui-spinner a.ui-spinner-button {
	border-top: none;
	border-bottom: none;
	border-right: none;
}
/* vertically center icon */
.ui-spinner .ui-icon {
	position: absolute;
	margin-top: -8px;
	top: 50%;
	left: 0;
}
.ui-spinner-up {
	top: 0;
}
.ui-spinner-down {
	bottom: 0;
}

/* TR overrides */
.ui-spinner .ui-icon-triangle-1-s {
	/* need to fix icons sprite */
	background-position: -65px -16px;
}
.ui-tabs {
	position: relative;/* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as "fixed") */
	padding: .2em;
}
.ui-tabs .ui-tabs-nav {
	margin: 0;
	padding: .2em .2em 0;
}
.ui-tabs .ui-tabs-nav li {
	list-style: none;
	float: left;
	position: relative;
	top: 0;
	margin: 1px .2em 0 0;
	border-bottom-width: 0;
	padding: 0;
	white-space: nowrap;
}
.ui-tabs .ui-tabs-nav .ui-tabs-anchor {
	float: left;
	padding: .5em 1em;
	text-decoration: none;
}
.ui-tabs .ui-tabs-nav li.ui-tabs-active {
	margin-bottom: -1px;
	padding-bottom: 1px;
}
.ui-tabs .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor,
.ui-tabs .ui-tabs-nav li.ui-state-disabled .ui-tabs-anchor,
.ui-tabs .ui-tabs-nav li.ui-tabs-loading .ui-tabs-anchor {
	cursor: text;
}
.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor {
	cursor: pointer;
}
.ui-tabs .ui-tabs-panel {
	display: block;
	border-width: 0;
	padding: 1em 1.4em;
	background: none;
}
.ui-tooltip {
	padding: 8px;
	position: absolute;
	z-index: 9999;
	max-width: 300px;
	-webkit-box-shadow: 0 0 5px #aaa;
	box-shadow: 0 0 5px #aaa;
}
body .ui-tooltip {
	border-width: 2px;
}

/* Component containers
----------------------------------*/
.ui-widget {
	font-family: Verdana,Arial,sans-serif;
	font-size: 1.1em;
}
.ui-widget .ui-widget {
	font-size: 1em;
}
.ui-widget input,
.ui-widget select,
.ui-widget textarea,
.ui-widget button {
	font-family: Verdana,Arial,sans-serif;
	font-size: 1em;
}
.ui-widget-content {
	border: 1px solid #aaaaaa;
	background: #ffffff url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_75_ffffff_40x100.png") 50% 50% repeat-x;
	color: #222222;
}
.ui-widget-content a {
	color: #222222;
}
.ui-widget-header {
	border: 1px solid #aaaaaa;
	background: #cccccc url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png") 50% 50% repeat-x;
	color: #222222;
	font-weight: bold;
}
.ui-widget-header a {
	color: #222222;
}

/* Interaction states
----------------------------------*/
.ui-state-default,
.ui-widget-content .ui-state-default,
.ui-widget-header .ui-state-default {
	border: 1px solid #d3d3d3;
	background: #e6e6e6 url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #555555;
}
.ui-state-default a,
.ui-state-default a:link,
.ui-state-default a:visited {
	color: #555555;
	text-decoration: none;
}
.ui-state-hover,
.ui-widget-content .ui-state-hover,
.ui-widget-header .ui-state-hover,
.ui-state-focus,
.ui-widget-content .ui-state-focus,
.ui-widget-header .ui-state-focus {
	border: 1px solid #999999;
	background: #dadada url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_75_dadada_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #212121;
}
.ui-state-hover a,
.ui-state-hover a:hover,
.ui-state-hover a:link,
.ui-state-hover a:visited,
.ui-state-focus a,
.ui-state-focus a:hover,
.ui-state-focus a:link,
.ui-state-focus a:visited {
	color: #212121;
	text-decoration: none;
}
.ui-state-active,
.ui-widget-content .ui-state-active,
.ui-widget-header .ui-state-active {
	border: 1px solid #aaaaaa;
	background: #ffffff url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_65_ffffff_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #212121;
}
.ui-state-active a,
.ui-state-active a:link,
.ui-state-active a:visited {
	color: #212121;
	text-decoration: none;
}

/* Interaction Cues
----------------------------------*/
.ui-state-highlight,
.ui-widget-content .ui-state-highlight,
.ui-widget-header .ui-state-highlight {
	border: 1px solid #fcefa1;
	background: #fbf9ee url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png") 50% 50% repeat-x;
	color: #363636;
}
.ui-state-highlight a,
.ui-widget-content .ui-state-highlight a,
.ui-widget-header .ui-state-highlight a {
	color: #363636;
}
.ui-state-error,
.ui-widget-content .ui-state-error,
.ui-widget-header .ui-state-error {
	border: 1px solid #cd0a0a;
	background: #fef1ec url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png") 50% 50% repeat-x;
	color: #cd0a0a;
}
.ui-state-error a,
.ui-widget-content .ui-state-error a,
.ui-widget-header .ui-state-error a {
	color: #cd0a0a;
}
.ui-state-error-text,
.ui-widget-content .ui-state-error-text,
.ui-widget-header .ui-state-error-text {
	color: #cd0a0a;
}
.ui-priority-primary,
.ui-widget-content .ui-priority-primary,
.ui-widget-header .ui-priority-primary {
	font-weight: bold;
}
.ui-priority-secondary,
.ui-widget-content .ui-priority-secondary,
.ui-widget-header .ui-priority-secondary {
	opacity: .7;
	filter:Alpha(Opacity=70); /* support: IE8 */
	font-weight: normal;
}
.ui-state-disabled,
.ui-widget-content .ui-state-disabled,
.ui-widget-header .ui-state-disabled {
	opacity: .35;
	filter:Alpha(Opacity=35); /* support: IE8 */
	background-image: none;
}
.ui-state-disabled .ui-icon {
	filter:Alpha(Opacity=35); /* support: IE8 - See #6059 */
}

/* Icons
----------------------------------*/

/* states and images */
.ui-icon {
	width: 16px;
	height: 16px;
}
.ui-icon,
.ui-widget-content .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_222222_256x240.png");
}
.ui-widget-header .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_222222_256x240.png");
}
.ui-state-default .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_888888_256x240.png");
}
.ui-state-hover .ui-icon,
.ui-state-focus .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_454545_256x240.png");
}
.ui-state-active .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_454545_256x240.png");
}
.ui-state-highlight .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_2e83ff_256x240.png");
}
.ui-state-error .ui-icon,
.ui-state-error-text .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_cd0a0a_256x240.png");
}

/* positioning */
.ui-icon-blank { background-position: 16px 16px; }
.ui-icon-carat-1-n { background-position: 0 0; }
.ui-icon-carat-1-ne { background-position: -16px 0; }
.ui-icon-carat-1-e { background-position: -32px 0; }
.ui-icon-carat-1-se { background-position: -48px 0; }
.ui-icon-carat-1-s { background-position: -64px 0; }
.ui-icon-carat-1-sw { background-position: -80px 0; }
.ui-icon-carat-1-w { background-position: -96px 0; }
.ui-icon-carat-1-nw { background-position: -112px 0; }
.ui-icon-carat-2-n-s { background-position: -128px 0; }
.ui-icon-carat-2-e-w { background-position: -144px 0; }
.ui-icon-triangle-1-n { background-position: 0 -16px; }
.ui-icon-triangle-1-ne { background-position: -16px -16px; }
.ui-icon-triangle-1-e { background-position: -32px -16px; }
.ui-icon-triangle-1-se { background-position: -48px -16px; }
.ui-icon-triangle-1-s { background-position: -64px -16px; }
.ui-icon-triangle-1-sw { background-position: -80px -16px; }
.ui-icon-triangle-1-w { background-position: -96px -16px; }
.ui-icon-triangle-1-nw { background-position: -112px -16px; }
.ui-icon-triangle-2-n-s { background-position: -128px -16px; }
.ui-icon-triangle-2-e-w { background-position: -144px -16px; }
.ui-icon-arrow-1-n { background-position: 0 -32px; }
.ui-icon-arrow-1-ne { background-position: -16px -32px; }
.ui-icon-arrow-1-e { background-position: -32px -32px; }
.ui-icon-arrow-1-se { background-position: -48px -32px; }
.ui-icon-arrow-1-s { background-position: -64px -32px; }
.ui-icon-arrow-1-sw { background-position: -80px -32px; }
.ui-icon-arrow-1-w { background-position: -96px -32px; }
.ui-icon-arrow-1-nw { background-position: -112px -32px; }
.ui-icon-arrow-2-n-s { background-position: -128px -32px; }
.ui-icon-arrow-2-ne-sw { background-position: -144px -32px; }
.ui-icon-arrow-2-e-w { background-position: -160px -32px; }
.ui-icon-arrow-2-se-nw { background-position: -176px -32px; }
.ui-icon-arrowstop-1-n { background-position: -192px -32px; }
.ui-icon-arrowstop-1-e { background-position: -208px -32px; }
.ui-icon-arrowstop-1-s { background-position: -224px -32px; }
.ui-icon-arrowstop-1-w { background-position: -240px -32px; }
.ui-icon-arrowthick-1-n { background-position: 0 -48px; }
.ui-icon-arrowthick-1-ne { background-position: -16px -48px; }
.ui-icon-arrowthick-1-e { background-position: -32px -48px; }
.ui-icon-arrowthick-1-se { background-position: -48px -48px; }
.ui-icon-arrowthick-1-s { background-position: -64px -48px; }
.ui-icon-arrowthick-1-sw { background-position: -80px -48px; }
.ui-icon-arrowthick-1-w { background-position: -96px -48px; }
.ui-icon-arrowthick-1-nw { background-position: -112px -48px; }
.ui-icon-arrowthick-2-n-s { background-position: -128px -48px; }
.ui-icon-arrowthick-2-ne-sw { background-position: -144px -48px; }
.ui-icon-arrowthick-2-e-w { background-position: -160px -48px; }
.ui-icon-arrowthick-2-se-nw { background-position: -176px -48px; }
.ui-icon-arrowthickstop-1-n { background-position: -192px -48px; }
.ui-icon-arrowthickstop-1-e { background-position: -208px -48px; }
.ui-icon-arrowthickstop-1-s { background-position: -224px -48px; }
.ui-icon-arrowthickstop-1-w { background-position: -240px -48px; }
.ui-icon-arrowreturnthick-1-w { background-position: 0 -64px; }
.ui-icon-arrowreturnthick-1-n { background-position: -16px -64px; }
.ui-icon-arrowreturnthick-1-e { background-position: -32px -64px; }
.ui-icon-arrowreturnthick-1-s { background-position: -48px -64px; }
.ui-icon-arrowreturn-1-w { background-position: -64px -64px; }
.ui-icon-arrowreturn-1-n { background-position: -80px -64px; }
.ui-icon-arrowreturn-1-e { background-position: -96px -64px; }
.ui-icon-arrowreturn-1-s { background-position: -112px -64px; }
.ui-icon-arrowrefresh-1-w { background-position: -128px -64px; }
.ui-icon-arrowrefresh-1-n { background-position: -144px -64px; }
.ui-icon-arrowrefresh-1-e { background-position: -160px -64px; }
.ui-icon-arrowrefresh-1-s { background-position: -176px -64px; }
.ui-icon-arrow-4 { background-position: 0 -80px; }
.ui-icon-arrow-4-diag { background-position: -16px -80px; }
.ui-icon-extlink { background-position: -32px -80px; }
.ui-icon-newwin { background-position: -48px -80px; }
.ui-icon-refresh { background-position: -64px -80px; }
.ui-icon-shuffle { background-position: -80px -80px; }
.ui-icon-transfer-e-w { background-position: -96px -80px; }
.ui-icon-transferthick-e-w { background-position: -112px -80px; }
.ui-icon-folder-collapsed { background-position: 0 -96px; }
.ui-icon-folder-open { background-position: -16px -96px; }
.ui-icon-document { background-position: -32px -96px; }
.ui-icon-document-b { background-position: -48px -96px; }
.ui-icon-note { background-position: -64px -96px; }
.ui-icon-mail-closed { background-position: -80px -96px; }
.ui-icon-mail-open { background-position: -96px -96px; }
.ui-icon-suitcase { background-position: -112px -96px; }
.ui-icon-comment { background-position: -128px -96px; }
.ui-icon-person { background-position: -144px -96px; }
.ui-icon-print { background-position: -160px -96px; }
.ui-icon-trash { background-position: -176px -96px; }
.ui-icon-locked { background-position: -192px -96px; }
.ui-icon-unlocked { background-position: -208px -96px; }
.ui-icon-bookmark { background-position: -224px -96px; }
.ui-icon-tag { background-position: -240px -96px; }
.ui-icon-home { background-position: 0 -112px; }
.ui-icon-flag { background-position: -16px -112px; }
.ui-icon-calendar { background-position: -32px -112px; }
.ui-icon-cart { background-position: -48px -112px; }
.ui-icon-pencil { background-position: -64px -112px; }
.ui-icon-clock { background-position: -80px -112px; }
.ui-icon-disk { background-position: -96px -112px; }
.ui-icon-calculator { background-position: -112px -112px; }
.ui-icon-zoomin { background-position: -128px -112px; }
.ui-icon-zoomout { background-position: -144px -112px; }
.ui-icon-search { background-position: -160px -112px; }
.ui-icon-wrench { background-position: -176px -112px; }
.ui-icon-gear { background-position: -192px -112px; }
.ui-icon-heart { background-position: -208px -112px; }
.ui-icon-star { background-position: -224px -112px; }
.ui-icon-link { background-position: -240px -112px; }
.ui-icon-cancel { background-position: 0 -128px; }
.ui-icon-plus { background-position: -16px -128px; }
.ui-icon-plusthick { background-position: -32px -128px; }
.ui-icon-minus { background-position: -48px -128px; }
.ui-icon-minusthick { background-position: -64px -128px; }
.ui-icon-close { background-position: -80px -128px; }
.ui-icon-closethick { background-position: -96px -128px; }
.ui-icon-key { background-position: -112px -128px; }
.ui-icon-lightbulb { background-position: -128px -128px; }
.ui-icon-scissors { background-position: -144px -128px; }
.ui-icon-clipboard { background-position: -160px -128px; }
.ui-icon-copy { background-position: -176px -128px; }
.ui-icon-contact { background-position: -192px -128px; }
.ui-icon-image { background-position: -208px -128px; }
.ui-icon-video { background-position: -224px -128px; }
.ui-icon-script { background-position: -240px -128px; }
.ui-icon-alert { background-position: 0 -144px; }
.ui-icon-info { background-position: -16px -144px; }
.ui-icon-notice { background-position: -32px -144px; }
.ui-icon-help { background-position: -48px -144px; }
.ui-icon-check { background-position: -64px -144px; }
.ui-icon-bullet { background-position: -80px -144px; }
.ui-icon-radio-on { background-position: -96px -144px; }
.ui-icon-radio-off { background-position: -112px -144px; }
.ui-icon-pin-w { background-position: -128px -144px; }
.ui-icon-pin-s { background-position: -144px -144px; }
.ui-icon-play { background-position: 0 -160px; }
.ui-icon-pause { background-position: -16px -160px; }
.ui-icon-seek-next { background-position: -32px -160px; }
.ui-icon-seek-prev { background-position: -48px -160px; }
.ui-icon-seek-end { background-position: -64px -160px; }
.ui-icon-seek-start { background-position: -80px -160px; }
/* ui-icon-seek-first is deprecated, use ui-icon-seek-start instead */
.ui-icon-seek-first { background-position: -80px -160px; }
.ui-icon-stop { background-position: -96px -160px; }
.ui-icon-eject { background-position: -112px -160px; }
.ui-icon-volume-off { background-position: -128px -160px; }
.ui-icon-volume-on { background-position: -144px -160px; }
.ui-icon-power { background-position: 0 -176px; }
.ui-icon-signal-diag { background-position: -16px -176px; }
.ui-icon-signal { background-position: -32px -176px; }
.ui-icon-battery-0 { background-position: -48px -176px; }
.ui-icon-battery-1 { background-position: -64px -176px; }
.ui-icon-battery-2 { background-position: -80px -176px; }
.ui-icon-battery-3 { background-position: -96px -176px; }
.ui-icon-circle-plus { background-position: 0 -192px; }
.ui-icon-circle-minus { background-position: -16px -192px; }
.ui-icon-circle-close { background-position: -32px -192px; }
.ui-icon-circle-triangle-e { background-position: -48px -192px; }
.ui-icon-circle-triangle-s { background-position: -64px -192px; }
.ui-icon-circle-triangle-w { background-position: -80px -192px; }
.ui-icon-circle-triangle-n { background-position: -96px -192px; }
.ui-icon-circle-arrow-e { background-position: -112px -192px; }
.ui-icon-circle-arrow-s { background-position: -128px -192px; }
.ui-icon-circle-arrow-w { background-position: -144px -192px; }
.ui-icon-circle-arrow-n { background-position: -160px -192px; }
.ui-icon-circle-zoomin { background-position: -176px -192px; }
.ui-icon-circle-zoomout { background-position: -192px -192px; }
.ui-icon-circle-check { background-position: -208px -192px; }
.ui-icon-circlesmall-plus { background-position: 0 -208px; }
.ui-icon-circlesmall-minus { background-position: -16px -208px; }
.ui-icon-circlesmall-close { background-position: -32px -208px; }
.ui-icon-squaresmall-plus { background-position: -48px -208px; }
.ui-icon-squaresmall-minus { background-position: -64px -208px; }
.ui-icon-squaresmall-close { background-position: -80px -208px; }
.ui-icon-grip-dotted-vertical { background-position: 0 -224px; }
.ui-icon-grip-dotted-horizontal { background-position: -16px -224px; }
.ui-icon-grip-solid-vertical { background-position: -32px -224px; }
.ui-icon-grip-solid-horizontal { background-position: -48px -224px; }
.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px; }
.ui-icon-grip-diagonal-se { background-position: -80px -224px; }


/* Misc visuals
----------------------------------*/

/* Corner radius */
.ui-corner-all,
.ui-corner-top,
.ui-corner-left,
.ui-corner-tl {
	border-top-left-radius: 4px;
}
.ui-corner-all,
.ui-corner-top,
.ui-corner-right,
.ui-corner-tr {
	border-top-right-radius: 4px;
}
.ui-corner-all,
.ui-corner-bottom,
.ui-corner-left,
.ui-corner-bl {
	border-bottom-left-radius: 4px;
}
.ui-corner-all,
.ui-corner-bottom,
.ui-corner-right,
.ui-corner-br {
	border-bottom-right-radius: 4px;
}

/* Overlays */
.ui-widget-overlay {
	background: #aaaaaa url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png") 50% 50% repeat-x;
	opacity: .3;
	filter: Alpha(Opacity=30); /* support: IE8 */
}
.ui-widget-shadow {
	margin: -8px 0 0 -8px;
	padding: 8px;
	background: #aaaaaa url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png") 50% 50% repeat-x;
	opacity: .3;
	filter: Alpha(Opacity=30); /* support: IE8 */
	border-radius: 8px;
}

</style>


<style>
/* Adapted from */
/* https://groups.google.com/d/msg/mathjax-users/jqQxrmeG48o/oAaivLgLN90J, */
/* by David Cervone */

@font-face {
    font-family: 'MJX_Math';
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); /* IE9 Compat Modes */
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot?iefix') format('eot'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff')  format('woff'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf')  format('opentype'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Math-Italic.svg#MathJax_Math-Italic') format('svg');
}

@font-face {
    font-family: 'MJX_Main';
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); /* IE9 Compat Modes */
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot?iefix') format('eot'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff')  format('woff'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf')  format('opentype'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Main-Regular.svg#MathJax_Main-Regular') format('svg');
}
</style>

  <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.5.1') format('opentype')}
</style></head>
  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div class="header"><h1 class="chapter_number">
  <a href="">CHAPTER 3</a></h1>
  <h1 class="chapter_title"><a href="">Improving the way neural networks learn</a></h1></div><div class="section"><div id="toc"> 
<p class="toc_title"><a href="http://neuralnetworksanddeeplearning.com/index.html">Neural Networks and Deep Learning</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/about.html">What this book is about</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/exercises_and_problems.html">On the exercises and problems</a></p><p class="toc_mainchapter"><a id="toc_using_neural_nets_to_recognize_handwritten_digits_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_using_neural_nets_to_recognize_handwritten_digits" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html">Using neural nets to recognize handwritten digits</a></p><div id="toc_using_neural_nets_to_recognize_handwritten_digits" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons"><li>Perceptrons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons"><li>Sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#the_architecture_of_neural_networks"><li>The architecture of neural networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#a_simple_network_to_classify_handwritten_digits"><li>A simple network to classify handwritten digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent"><li>Learning with gradient descent</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits"><li>Implementing our network to classify digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#toward_deep_learning"><li>Toward deep learning</li></a></ul><p></p></div>
<script>
$('#toc_using_neural_nets_to_recognize_handwritten_digits_reveal').click(function() { 
   var src = $('#toc_img_using_neural_nets_to_recognize_handwritten_digits').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow.png');
   };
   $('#toc_using_neural_nets_to_recognize_handwritten_digits').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_how_the_backpropagation_algorithm_works_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_how_the_backpropagation_algorithm_works" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html">How the backpropagation algorithm works</a></p><div id="toc_how_the_backpropagation_algorithm_works" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap2.html#warm_up_a_fast_matrix-based_approach_to_computing_the_output_from_a_neural_network"><li>Warm up: a fast matrix-based approach to computing the output
  from a neural network</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_two_assumptions_we_need_about_the_cost_function"><li>The two assumptions we need about the cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_hadamard_product_$s_\odot_t$"><li>The Hadamard product, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" role="math" style="width: 2.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">t</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">s \odot t</script></li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation"><li>The four fundamental equations behind backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#proof_of_the_four_fundamental_equations_(optional)"><li>Proof of the four fundamental equations (optional)</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_backpropagation_algorithm"><li>The backpropagation algorithm</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_code_for_backpropagation"><li>The code for backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#in_what_sense_is_backpropagation_a_fast_algorithm"><li>In what sense is backpropagation a fast algorithm?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#backpropagation_the_big_picture"><li>Backpropagation: the big picture</li></a></ul><p></p></div>
<script>
$('#toc_how_the_backpropagation_algorithm_works_reveal').click(function() { 
   var src = $('#toc_img_how_the_backpropagation_algorithm_works').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow.png');
   };
   $('#toc_how_the_backpropagation_algorithm_works').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_improving_the_way_neural_networks_learn_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_improving_the_way_neural_networks_learn" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a><a href="./Neural networks and deep learning 3_files/Neural networks and deep learning 3.html">Improving the way neural networks learn</a></p><div id="toc_improving_the_way_neural_networks_learn" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function"><li>The cross-entropy cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization"><li>Overfitting and regularization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization"><li>Weight initialization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code"><li>Handwriting recognition revisited: the code</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters"><li>How to choose a neural network's hyper-parameters?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques"><li>Other techniques</li></a></ul><p></p></div>
<script>
$('#toc_improving_the_way_neural_networks_learn_reveal').click(function() { 
   var src = $('#toc_img_improving_the_way_neural_networks_learn').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow.png');
   };
   $('#toc_improving_the_way_neural_networks_learn').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_a_visual_proof_that_neural_nets_can_compute_any_function" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html">A visual proof that neural nets can compute any function</a></p><div id="toc_a_visual_proof_that_neural_nets_can_compute_any_function" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap4.html#two_caveats"><li>Two caveats</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#universality_with_one_input_and_one_output"><li>Universality with one input and one output</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#many_input_variables"><li>Many input variables</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#extension_beyond_sigmoid_neurons"><li>Extension beyond sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#fixing_up_the_step_functions"><li>Fixing up the step functions</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#conclusion"><li>Conclusion</li></a></ul><p></p></div>
<script>
$('#toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal').click(function() { 
   var src = $('#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow.png');
   };
   $('#toc_a_visual_proof_that_neural_nets_can_compute_any_function').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_why_are_deep_neural_networks_hard_to_train_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_why_are_deep_neural_networks_hard_to_train" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html">Why are deep neural networks hard to train?</a></p><div id="toc_why_are_deep_neural_networks_hard_to_train" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap5.html#the_vanishing_gradient_problem"><li>The vanishing gradient problem</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets"><li>What's causing the vanishing gradient problem?  Unstable gradients in deep neural nets</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#unstable_gradients_in_more_complex_networks"><li>Unstable gradients in more complex networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#other_obstacles_to_deep_learning"><li>Other obstacles to deep learning</li></a></ul><p></p></div>
<script>
$('#toc_why_are_deep_neural_networks_hard_to_train_reveal').click(function() { 
   var src = $('#toc_img_why_are_deep_neural_networks_hard_to_train').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow.png');
   };
   $('#toc_why_are_deep_neural_networks_hard_to_train').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_deep_learning_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_deep_learning" src="./Neural networks and deep learning 3_files/arrow.png" width="15px"></a>Deep learning</p><div id="toc_deep_learning" style="display: none;"><p class="toc_section"></p><ul><li>Convolutional neural networks</li><li>Pretraining</li><li>Recurrent neural networks, Boltzmann machines, and other
  models</li><li>Is there a universal thinking algorithm?</li><li>On the future of neural networks</li></ul><p></p></div>
<script>
$('#toc_deep_learning_reveal').click(function() { 
   var src = $('#toc_img_deep_learning').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_deep_learning").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_deep_learning").attr('src', 'images/arrow.png');
   };
   $('#toc_deep_learning').toggle('fast', function() {});  
});</script><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/acknowledgements.html">Acknowledgements</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/faq.html">Frequently Asked Questions</a></p>
<hr>
<span class="sidebar_title">Sponsors</span>
<br>
<a href="http://www.ersatz1.com/"><img src="./Neural networks and deep learning 3_files/ersatz.png" width="140px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://gsquaredcapital.com/"><img src="./Neural networks and deep learning 3_files/gsquared.png" width="150px" style="padding: 0px 0px 10px 10px; border-style: none;"></a>

<a href="http://www.tineye.com/"><img src="./Neural networks and deep learning 3_files/tineye.png" width="150px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://www.visionsmarts.com/"><img src="./Neural networks and deep learning 3_files/visionsmarts.png" width="160px" style="padding: 0px 0px
0px 0px; border-style: none;"></a> <br> 

<p class="sidebar">Thanks to all the <a href="http://neuralnetworksanddeeplearning.com/supporters.html">supporters</a> who made the book possible.
Thanks also to all the contributors to the <a href="http://neuralnetworksanddeeplearning.com/bugfinder.html">Bugfinder Hall of Fame</a>.  </p>

<p class="sidebar">The book is currently a beta release, and is still
under active development.  Please send error reports to
mn@michaelnielsen.org.  For other enquiries, please see the <a href="http://neuralnetworksanddeeplearning.com/faq.html">FAQ</a> first.</p>

<hr>
<span class="sidebar_title">Resources</span>

<p class="sidebar">
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning">Code repository</a></p>

<p class="sidebar">
<a href="http://eepurl.com/BYr9L">Mailing list for book announcements</a>
</p>

<p class="sidebar">
<a href="http://eepurl.com/0Xxjb">Michael Nielsen's project announcement mailing list</a>
</p>

<hr>
<a href="http://michaelnielsen.org/"><img src="./Neural networks and deep learning 3_files/Michael_Nielsen_Web_Small.jpg" width="160px" style="border-style: none;"></a>

<p class="sidebar">
By <a href="http://michaelnielsen.org/">Michael Nielsen</a> / Dec 2014
</p>
</div>
<p></p><p>When a golf player is first learning to play golf, they usually spend
most of their time developing a basic swing.  Only gradually do they
develop other shots, learning to chip, draw and fade the ball,
building on and modifying their basic swing.  In a similar way, up to
now we've focused on understanding the backpropagation algorithm.
It's our "basic swing", the foundation for learning in most work on
neural networks.  In this chapter I explain a suite of techniques
which can be used to improve on our vanilla implementation of
backpropagation, and so improve the way our networks learn.</p><p>The techniques we'll develop in this chapter include: a better choice
of cost function, known as
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function">the
  cross-entropy</a> cost function; four so-called
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">"regularization"
  methods</a> (L1 and L2 regularization, dropout, and artificial
expansion of the training data), which make our networks better at
generalizing beyond the training data; a
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">better method for
  initializing the weights</a> in the network; and a
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">set
  of heuristics to help choose good hyper-parameters</a> for the network.
I'll also overview <a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques">several other
  techniques</a> in less depth.  The discussions are largely independent
of one another, and so you may jump ahead if you wish.  We'll also
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code">implement</a>
many of the techniques in running code, and use them to improve the
results obtained on the handwriting classification problem studied in
<a href="http://neuralnetworksanddeeplearning.com/chap1.html">Chapter 1</a>.</p><p>Of course, we're only covering a few of the many, many techniques
which have been developed for use in neural nets.  The philosophy is
that the best entree to the plethora of available techniques is
in-depth study of a few of the most important.  Mastering those
important techniques is not just useful in its own right, but will
also deepen your understanding of what problems can arise when you use
neural networks.  That will leave you well prepared to quickly pick up
other techniques, as you need them.</p><p></p><p></p><p></p><p></p><h3><a name="the_cross-entropy_cost_function"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function">The cross-entropy cost function</a></h3><p></p><p>Most of us find it unpleasant to be wrong.  Soon after beginning to
learn the piano I gave my first performance before an audience.  I was
nervous, and began playing the piece an octave too low.  I got
confused, and couldn't continue until someone pointed out my error.  I
was very embarassed.  Yet while unpleasant, we also learn quickly when
we're decisively wrong.  You can bet that the next time I played
before an audience I played in the correct octave!  By contrast, we
learn more slowly when our errors are less well-defined.</p><p>Ideally, we hope and expect that our neural networks will learn fast
from their errors.  Is this what happens in practice?  To answer this
question, let's look at a toy example.  The example involves a neuron
with just one input:</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz28.png">
</center><p></p><p>We'll train this neuron to do something ridiculously easy: take the
input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-6" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-7"><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">1</script> to the output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-9" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-10"><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">0</script>.  Of course, this is such a trivial task
that we could easily figure out an appropriate weight and bias by
hand, without using a learning algorithm.  However, it turns out to be
illuminating to use gradient descent to attempt to learn a weight and
bias.  So let's take a look at how the neuron learns.</p><p>To make things definite, I'll pick the initial weight to be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-12" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-13"><span class="mn" id="MathJax-Span-14" style="font-family: MathJax_Main;">0.6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">0.6</script> and
the initial bias to be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-15" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-16"><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">0.9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">0.9</script>.  These are generic choices used as a
place to begin learning, I wasn't picking them to be special in any
way.  The initial output from the neuron is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame"><nobr><span class="math" id="MathJax-Span-18" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-19"><span class="mn" id="MathJax-Span-20" style="font-family: MathJax_Main;">0.82</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">0.82</script>, so quite a bit of
learning will be needed before our neuron gets near the desired
output, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-21" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-22"><span class="mn" id="MathJax-Span-23" style="font-family: MathJax_Main;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">0.0</script>.  Click on "Run" in the bottom right corner below to
see how the neuron learns an output much closer to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-24" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-25"><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">0.0</script>.  Note that
this isn't a pre-recorded animation, your browser is actually
computing the gradient, then using the gradient to update the weight
and bias, and displaying the result.  The learning rate is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-27" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.297em;">0.15</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\eta =
0.15</script>, which turns out to be slow enough that we can follow what's
happening, but fast enough that we can get substantial learning in
just a few seconds.  The cost is the quadratic cost function, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-32" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">C</script>,
introduced back in Chapter 1.  I'll remind you of the exact form of
the cost function shortly, so there's no need to go and dig up the
definition.  Note that you can run the animation multiple times by
clicking on "Run" again.</p><p>
<script type="text/javascript" src="./Neural networks and deep learning 3_files/paper.js"></script>
<script type="text/paperscript" style="display:none" canvas="saturation1" id="paperscope-1">
<!--
// This is a paper.js widget to show a single neuron learning.  In
// particular, the widget is used to show the learning slowdown that
// occurs when the output is saturated.
//
// The same basic widget is used several times, in slightly different
// configurations.  paper.js makes it somewhat complex to reuse the
// code, so I have simply duplicated the code.  This can give rise to
// bugs if one is not careful to keep the code in sync, so I have
// separated the code into two pieces.
//
// The first piece is the header code.  This changes between widgets.
// It sets up things like the starting weight, bias, cost function,
// and so on -- things which may vary betweens widgets.
//
// The second piece is the body code.  This is almost exactly the same
// for the different widgets.  Note, however, that the costGraphX and
// epochX variables change name, due to a bug in the way paperjs
// handles scope.
//
// We can make these changes by searching on costGraph1 and replacing
// with costGraph2, costGraph3 etc, by replacing epoch1 with epoch2,
// epoch3 etc, and by replcacing cost1 with cost2, cost3 etc.
//
// This separation makes it easy to maintain the duplicated code.

// HEADER CODE

var startingWeight = 0.6;
var startingBias = 0.9;
var eta = 0.15;
var numFrames = 300;

quadratic_cost = {
    fn: function(a) {return a*a/2;},
    derivative: function(a) {return a*a*(1-a);},
    scaling: 240 // used to scale on the graph
}

cross_entropy_cost = {
    fn: function(a) {return -Math.log(1-a);},
    derivative: function(a) {return 1/(1-a);},
    scaling: 30
}

cost1 = quadratic_cost;

// A path for the graph.  
costGraph1 = new Path();
costGraph1.strokeColor = "#2A6EA6";


// BODY CODE

// STATIC ELEMENTS
//
// Note that this includes some paper.js items which will later be
// modified, e.g., the variables output and weightText.  This section
// merely sets the static parts of the elements.

var input = new PointText(new Point(8, 40));
input.fontSize = 18;
input.content = "Input: 1.0";

arrow(new Point(100, 35), new Point(230, 35), 0.8); // input arrow

var neuron = new Path.Circle(new Point(260, 35), 30);
neuron.strokeColor = "black";

arrow(new Point(290, 35), new Point(380, 35), 0.8); // output arrow

// The output text's content will be set dynamically, later
var output = new PointText(new Point(390, 40)); 
output.fontSize = 18;

// The weight text and bar
var weightText = new PointText(new Point(120, 52));
weightText.fontSize=14;
var weightBar = new Path.Rectangle(new Rectangle(120, 57, 90, 9));
weightBar.strokeColor = "grey";
weightBar.strokeWidth = 1;
var weightTick = new Path(new Point(165, 57), new Point(165, 71));
weightTick.strokeColor = "black";
var weightSlider = new Path.Line(
    new Point(165, 61.5), new Point(165+weight*20, 61.5));
weightSlider.strokeColor = "#2A6EA6";
weightSlider.strokeWidth = 9;

// The bias text and bar
var biasText = new PointText(new Point(230, 82));
biasText.fontSize = 14;
var biasBar = new Path.Rectangle(new Rectangle(230, 88, 90, 9));
biasBar.strokeColor = "grey";
biasBar.strokeWidth = 1;
var biasTick = new Path(new Point(275, 88), new Point(275, 102));
biasTick.strokeColor = "black";
var biasSlider = new Path.Line(
    new Point(275, 92.5), new Point(275+bias*20, 92.5));
biasSlider.strokeColor = "#2A6EA6";
biasSlider.strokeWidth = 9;

// Axes for the graph
arrow(new Point(100, 250), new Point(100, 120));
arrow(new Point(100, 250), new Point(130+numFrames/2, 250));

// Labels on the axes
var costText = new PointText(new Point(60, 145));
costText.fontSize = 18;
costText.content = "Cost";

var epoch1LabelText = new PointText(new Point(140+numFrames/2, 255));
epoch1LabelText.fontSize = 18;
epoch1LabelText.content = "Epoch";

// Marker for the current epoch
var epoch1Tick = new Path(new Point(100, 250), new Point(100, 255));
epoch1Tick.strokeColor = "black";

var epoch1Number = new PointText(new Point(100, 267));
epoch1Number.fontSize = 14;
epoch1Number.justification = "center";

// We group the epochTick and epochNumber, to make it easy to move
epoch1 = new Group([epoch1Tick, epoch1Number]);

// Initialize the dynamic elements.  It's convenient to do this in a
// function, so that function can also be called upon a (re)start of
// the widget.

var weight, bias;
initDynamicElements();

function initDynamicElements() {
    weight = startingWeight;
    bias = startingBias;
    weightText.content = paramContent("w = ", weight);
    weightSlider.segments[1].point.x = 165+weight*20;
    biasText.content = paramContent("b = ", bias);
    biasSlider.segments[1].point.x = 275+bias*20;
    output.content = outputContent(weight, bias);
    epoch1.position.x = 100;
    epoch1Number.content = "0";
    costGraph1.removeSegments();
}

function paramContent(s, x) {
    sign = (x >= 0)? "+": "";
    return s+sign+x.toFixed(2);
}

// The run button

var runBox = new Path.Rectangle(new Rectangle(430, 230, 60, 30), 5);
runBox.fillColor = "#dddddd";

var runText = new PointText(new Point(460, 250));
runText.justification = "center";
runText.fontSize = 18;
runText.content = "Run";

var runIcon = new Group([runBox, runText]);

runIcon.onMouseEnter = function(event) {
    runBox.fillColor = "#aaaaaa";
}

runIcon.onMouseLeave = function(event) {
    runBox.fillColor = "#dddddd";
}

var playing = false;
var count = 0;

runIcon.onClick = function(event) {
    initDynamicElements();
    this.visible = false;
    weight = startingWeight;
    bias = startingBias;
    playing = true;
}

// The actual procedure

function onFrame(event) {
    if (playing) {
	a = outputValue(weight, bias);
	delta = cost1.derivative(a);
	weight += -eta*delta;
	bias += -eta*delta;
	weightText.content = paramContent("w = ", weight);
	weightSlider.segments[1].point.x = 165+weight*20;
	biasText.content = paramContent("b = ", bias);
	biasSlider.segments[1].point.x = 275+bias*20;
	output.content = outputContent(weight, bias);
	if (count % 2 === 0) {epoch1.position.x += 1;}
	costGraph1.add(new Point(epoch1.position.x, 250-cost1.scaling*cost1.fn(a)));
	epoch1Number.content = count;
	count += 1;
	if (count > numFrames) {
	    count = 0;
	    runIcon.visible = true;
	    playing = false;
	}
	}
}

function outputValue(weight, bias) {
    return sigmoid(weight+bias);
}

function outputContent(weight, bias) {
    return "Output: "+outputValue(weight, bias).toFixed(2);
}

function sigmoid(z) {
    return 1/(1+Math.exp(-z));
}

function arrow(point1, point2, width, color) {
    if (typeof width === 'undefined') {width=1};
    if (typeof color === 'undefined') {color='black'};
    delta = point1 - point2;
    n = delta/delta.length;
    nperp = new Point(-n.y, n.x);
    line = new Path(point1, point2);
    line.strokeColor = color;
    line.strokeWidth = width;
    arrow_stroke_1 = new Path(point2, point2+(n+nperp)*6);
    arrow_stroke_1.strokeWidth = width;
    arrow_stroke_1.strokeColor = color;
    arrow_stroke_2 = new Path(point2, point2+(n-nperp)*6);
    arrow_stroke_2.strokeWidth = width;
    arrow_stroke_2.strokeColor = color;
}

//-->
</script>
</p><center>
<canvas id="saturation1" width="1040" height="600" style="-webkit-user-select: none; touch-action: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 520px; height: 300px;"></canvas>
</center><p></p><p>As you can see, the neuron rapidly learns a weight and bias that
drives down the cost, and gives an output from the neuron of about
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-35" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-36"><span class="mn" id="MathJax-Span-37" style="font-family: MathJax_Main;">0.09</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">0.09</script>.  That's not quite the desired output, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame"><nobr><span class="math" id="MathJax-Span-38" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-39"><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">0.0</script>, but it is pretty
good.  Suppose, however, that we instead choose both the starting
weight and the starting bias to be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame"><nobr><span class="math" id="MathJax-Span-41" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-42"><span class="mn" id="MathJax-Span-43" style="font-family: MathJax_Main;">2.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">2.0</script>.  In this case the initial
output is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-44" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-45"><span class="mn" id="MathJax-Span-46" style="font-family: MathJax_Main;">0.98</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">0.98</script>, which is very badly wrong.  Let's look at how the
neuron learns to output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame"><nobr><span class="math" id="MathJax-Span-47" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-48"><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">0</script> in this case.  Click on "Run" again:</p><p>
<script type="text/paperscript" style="display:none" canvas="saturation2">
<!--
// This is a paper.js widget to show a single neuron learning.  In
// particular, the widget is used to show the learning slowdown that
// occurs when the output is saturated.
//
// The same basic widget is used several times, in slightly different
// configurations.  paper.js makes it somewhat complex to reuse the
// code, so I have simply duplicated the code.  This can give rise to
// bugs if one is not careful to keep the code in sync, so I have
// separated the code into two pieces.
//
// The first piece is the header code.  This changes between widgets.
// It sets up things like the starting weight, bias, cost function,
// and so on -- things which may vary betweens widgets.
//
// The second piece is the body code.  This is almost exactly the same
// for the different widgets.  Note, however, that the costGraphX and
// epochX variables change name, due to a bug in the way paperjs
// handles scope.
//
// We can make these changes by searching on costGraph1 and replacing
// with costGraph2, costGraph3 etc, and by replacing epoch1 with
// epoch2, epoch3 etc.
//
// This separation makes it easy to maintain the duplicated code.

// HEADER CODE

var startingWeight = 2.0;
var startingBias = 2.0;
var eta = 0.15;
var numFrames = 300;

quadratic_cost = {
    fn: function(a) {return a*a/2;},
    derivative: function(a) {return a*a*(1-a);},
    scaling: 240 // used to scale on the graph
}

cross_entropy_cost = {
    fn: function(a) {return -Math.log(1-a);},
    derivative: function(a) {return 1/(1-a);},
    scaling: 30
}

cost2 = quadratic_cost;

// A path for the graph.  
costGraph2 = new Path();
costGraph2.strokeColor = "#2A6EA6";


// BODY CODE

// STATIC ELEMENTS
//
// Note that this includes some paper.js items which will later be
// modified, e.g., the variables output and weightText.  This section
// merely sets the static parts of the elements.

var input = new PointText(new Point(8, 40));
input.fontSize = 18;
input.content = "Input: 1.0";

arrow(new Point(100, 35), new Point(230, 35), 0.8); // input arrow

var neuron = new Path.Circle(new Point(260, 35), 30);
neuron.strokeColor = "black";

arrow(new Point(290, 35), new Point(380, 35), 0.8); // output arrow

// The output text's content will be set dynamically, later
var output = new PointText(new Point(390, 40)); 
output.fontSize = 18;

// The weight text and bar
var weightText = new PointText(new Point(120, 52));
weightText.fontSize=14;
var weightBar = new Path.Rectangle(new Rectangle(120, 57, 90, 9));
weightBar.strokeColor = "grey";
weightBar.strokeWidth = 1;
var weightTick = new Path(new Point(165, 57), new Point(165, 71));
weightTick.strokeColor = "black";
var weightSlider = new Path.Line(
    new Point(165, 61.5), new Point(165+weight*20, 61.5));
weightSlider.strokeColor = "#2A6EA6";
weightSlider.strokeWidth = 9;

// The bias text and bar
var biasText = new PointText(new Point(230, 82));
biasText.fontSize = 14;
var biasBar = new Path.Rectangle(new Rectangle(230, 88, 90, 9));
biasBar.strokeColor = "grey";
biasBar.strokeWidth = 1;
var biasTick = new Path(new Point(275, 88), new Point(275, 102));
biasTick.strokeColor = "black";
var biasSlider = new Path.Line(
    new Point(275, 92.5), new Point(275+bias*20, 92.5));
biasSlider.strokeColor = "#2A6EA6";
biasSlider.strokeWidth = 9;

// Axes for the graph
arrow(new Point(100, 250), new Point(100, 120));
arrow(new Point(100, 250), new Point(130+numFrames/2, 250));

// Labels on the axes
var costText = new PointText(new Point(60, 145));
costText.fontSize = 18;
costText.content = "Cost";

var epoch2LabelText = new PointText(new Point(140+numFrames/2, 255));
epoch2LabelText.fontSize = 18;
epoch2LabelText.content = "Epoch";

// Marker for the current epoch
var epoch2Tick = new Path(new Point(100, 250), new Point(100, 255));
epoch2Tick.strokeColor = "black";

var epoch2Number = new PointText(new Point(100, 267));
epoch2Number.fontSize = 14;
epoch2Number.justification = "center";

// We group the epochTick and epochNumber, to make it easy to move
epoch2 = new Group([epoch2Tick, epoch2Number]);

// Initialize the dynamic elements.  It's convenient to do this in a
// function, so that function can also be called upon a (re)start of
// the widget.

var weight, bias;
initDynamicElements();

function initDynamicElements() {
    weight = startingWeight;
    bias = startingBias;
    weightText.content = paramContent("w = ", weight);
    weightSlider.segments[1].point.x = 165+weight*20;
    biasText.content = paramContent("b = ", bias);
    biasSlider.segments[1].point.x = 275+bias*20;
    output.content = outputContent(weight, bias);
    epoch2.position.x = 100;
    epoch2Number.content = "0";
    costGraph2.removeSegments();
}

function paramContent(s, x) {
    sign = (x >= 0)? "+": "";
    return s+sign+x.toFixed(2);
}

// The run button

var runBox = new Path.Rectangle(new Rectangle(430, 230, 60, 30), 5);
runBox.fillColor = "#dddddd";

var runText = new PointText(new Point(460, 250));
runText.justification = "center";
runText.fontSize = 18;
runText.content = "Run";

var runIcon = new Group([runBox, runText]);

runIcon.onMouseEnter = function(event) {
    runBox.fillColor = "#aaaaaa";
}

runIcon.onMouseLeave = function(event) {
    runBox.fillColor = "#dddddd";
}

var playing = false;
var count = 0;

runIcon.onClick = function(event) {
    initDynamicElements();
    this.visible = false;
    weight = startingWeight;
    bias = startingBias;
    playing = true;
}

// The actual procedure

function onFrame(event) {
    if (playing) {
	a = outputValue(weight, bias);
	delta = cost2.derivative(a);
	weight += -eta*delta;
	bias += -eta*delta;
	weightText.content = paramContent("w = ", weight);
	weightSlider.segments[1].point.x = 165+weight*20;
	biasText.content = paramContent("b = ", bias);
	biasSlider.segments[1].point.x = 275+bias*20;
	output.content = outputContent(weight, bias);
	if (count % 2 === 0) {epoch2.position.x += 1;}
	costGraph2.add(new Point(epoch2.position.x, 250-cost2.scaling*cost2.fn(a)));
	epoch2Number.content = count;
	count += 1;
	if (count > numFrames) {
	    count = 0;
	    runIcon.visible = true;
	    playing = false;
	}
	}
}

function outputValue(weight, bias) {
    return sigmoid(weight+bias);
}

function outputContent(weight, bias) {
    return "Output: "+outputValue(weight, bias).toFixed(2);
}

function sigmoid(z) {
    return 1/(1+Math.exp(-z));
}

function arrow(point1, point2, width, color) {
    if (typeof width === 'undefined') {width=1};
    if (typeof color === 'undefined') {color='black'};
    delta = point1 - point2;
    n = delta/delta.length;
    nperp = new Point(-n.y, n.x);
    line = new Path(point1, point2);
    line.strokeColor = color;
    line.strokeWidth = width;
    arrow_stroke_1 = new Path(point2, point2+(n+nperp)*6);
    arrow_stroke_1.strokeWidth = width;
    arrow_stroke_1.strokeColor = color;
    arrow_stroke_2 = new Path(point2, point2+(n-nperp)*6);
    arrow_stroke_2.strokeWidth = width;
    arrow_stroke_2.strokeColor = color;
}

//-->
</script>
<a id="saturation2_anchor"></a>
</p><center>
<canvas id="saturation2" width="520" height="300"></canvas>
</center><p></p><p>Although this example uses the same learning rate (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-50" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.297em;">0.15</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\eta = 0.15</script>), we
can see that learning starts out much more slowly.  Indeed, for the
first 150 or so learning epochs, the weights and biases don't change
much at all.  Then the learning kicks in and, much as in our first
example, the neuron's output rapidly moves closer to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-55" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-56"><span class="mn" id="MathJax-Span-57" style="font-family: MathJax_Main;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">0.0</script>.</p><p>This behaviour is strange when contrasted to human learning.  As I
said at the beginning of this section, we often learn fastest when
we're badly wrong about something.  But we've just seen that our
artificial neuron has a lot of difficulty learning when it's badly
wrong - far more difficulty than when it's just a little wrong.
What's more, it turns out that this behaviour occurs not just in this
toy model, but in more general networks.  Why is learning so slow?
And can we find a way of avoiding this slowdown?</p><p>To understand the origin of the problem, consider that our neuron
learns by changing the weight and bias at a rate determined by the
partial derivatives of the cost function, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame"><nobr><span class="math" id="MathJax-Span-58" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\partial C/\partial w</script> and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame"><nobr><span class="math" id="MathJax-Span-67" role="math" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.846em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\partial C / \partial b</script>.  So saying "learning is slow" is really
the same as saying that those partial derivatives are small.  The
challenge is to understand why they are small.  To understand that,
let's compute the partial derivatives.  Recall that we're using the
quadratic cost function, which, from
Equation <span id="margin_132622183436_reveal" class="equation_link">(6)</span><span id="margin_132622183436" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame"><nobr><span class="math" id="MathJax-Span-76" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-77"><span class="mtable" id="MathJax-Span-78" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-88" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-89" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-90"><span class="mn" id="MathJax-Span-91" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-93" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_132622183436_reveal').click(function() {$('#margin_132622183436').toggle('slow', function() {});});</script>, is given by
<a class="displaced_anchor" name="eqtn54"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-21-Frame"><nobr><span class="math" id="MathJax-Span-106" role="math" style="width: 100%; display: inline-block; min-width: 12.797em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.797em;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-107"><span class="mtable" id="MathJax-Span-108" style="min-width: 13.042em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.797em;"><span style="display: inline-block; position: absolute; width: 6.277em; height: 0px; clip: rect(-1.517em 1000.002em 1.032em -999.998em); top: 0.002em; left: 50%; margin-left: -3.135em;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.277em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 4.855em -999.998em); top: -3.821em; right: 0.002em;"><span class="mtd" id="MathJax-Span-112"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-116" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.63em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -1.762em;"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mn" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-125" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.63em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.733em 1000.002em 0.591em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.821em; right: 0.002em;"><span class="mtd" id="mjx-eqn-54"><span class="mrow" id="MathJax-Span-110"><span class="mtext" id="MathJax-Span-111" style="font-family: MathJax_Main;">(54)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.402em; vertical-align: -0.948em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{eqnarray}
  C = \frac{(y-a)^2}{2},
\tag{54}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame"><nobr><span class="math" id="MathJax-Span-127" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">a</script> is the neuron's output when the training input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame"><nobr><span class="math" id="MathJax-Span-130" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">x = 1</script> is
used, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame"><nobr><span class="math" id="MathJax-Span-135" role="math" style="width: 2.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-136"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">y = 0</script> is the corresponding desired output.  To write this
more explicitly in terms of the weight and bias, recall that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame"><nobr><span class="math" id="MathJax-Span-140" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">a =
\sigma(z)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame"><nobr><span class="math" id="MathJax-Span-148" role="math" style="width: 4.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.855em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">z = wx+b</script>.  Using the chain rule to differentiate
with respect to the weight and bias we get
<a class="displaced_anchor" name="eqtn55"></a><a class="displaced_anchor" name="eqtn56"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-27-Frame"><nobr><span class="math" id="MathJax-Span-156" role="math" style="width: 100%; display: inline-block; min-width: 19.512em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 19.512em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 7.65em -999.998em); top: -5.488em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-157"><span class="mtable" id="MathJax-Span-158" style="min-width: 19.904em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.512em;"><span style="display: inline-block; position: absolute; width: 13.14em; height: 0px; clip: rect(-2.645em 1000.002em 2.159em -999.998em); top: 0.002em; left: 50%; margin-left: -6.566em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 7.65em -999.998em); top: -5.488em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -5.145em; right: 0.002em;"><span class="mtd" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mfrac" id="MathJax-Span-164"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mfrac" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.493em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 5.444em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.145em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173"></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.743em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212"></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 6.13em -999.998em); top: -4.458em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.806em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -5.145em; left: 0.002em;"><span class="mtd" id="MathJax-Span-175"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177"></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-192"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -2.743em; left: 0.002em;"><span class="mtd" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216"></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.463em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.007em 1000.002em 1.669em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.145em; right: 0.002em;"><span class="mtd" id="mjx-eqn-55"><span class="mrow" id="MathJax-Span-160"><span class="mtext" id="MathJax-Span-161" style="font-family: MathJax_Main;">(55)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="mjx-eqn-56"><span class="mrow" id="MathJax-Span-199"><span class="mtext" id="MathJax-Span-200" style="font-family: MathJax_Main;">(56)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.493em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.702em; vertical-align: -2.098em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\begin{eqnarray} 
  \frac{\partial C}{\partial w} & = & (a-y)\sigma'(z) x = a \sigma'(z) \tag{55}\\
  
  \frac{\partial C}{\partial b} & = & (a-y)\sigma'(z) = a \sigma'(z),
\tag{56}\end{eqnarray}</script>
where I have substituted <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame"><nobr><span class="math" id="MathJax-Span-237" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-241" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">x = 1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame"><nobr><span class="math" id="MathJax-Span-242" role="math" style="width: 2.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-246" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">y = 0</script>.  To understand the
behaviour of these expressions, let's look more closely at the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame"><nobr><span class="math" id="MathJax-Span-247" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-248"><span class="msup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\sigma'(z)</script> term on the right-hand side.  Recall the shape of the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame"><nobr><span class="math" id="MathJax-Span-255" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">\sigma</script> function:</p><p>

</p><div id="sigmoid_graph"><a name="sigmoid_graph"></a><svg width="600" height="290"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 200)"><g class="tick" transform="translate(36,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(72,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(144,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(180,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(251.99999999999997,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(288,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><path class="domain" d="M0,6V0H360V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.0</text></g><g class="tick" transform="translate(0,160)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.2</text></g><g class="tick" transform="translate(0,120)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.4</text></g><g class="tick" transform="translate(0,80)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.6</text></g><g class="tick" transform="translate(0,39.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.8</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1.0</text></g><path class="domain" d="M-6,0H0V200H-6"></path></g><path d="M0,198.66142981514304L0.8999999999999808,198.62777624590345L1.8000000000000256,198.59328256900096L2.6999999999999744,198.5579281173962L3.5999999999999868,198.5216917311436L4.5,198.48455174642783L5.400000000000013,198.44648598439701L6.299999999999993,198.40747173979165L7.1999999999999735,198.36748576936802L8.099999999999987,198.32650428011408L9,198.2845029172576L9.900000000000013,198.241456752065L10.800000000000026,198.19734026943044L11.699999999999976,198.15212735525424L12.599999999999985,198.10579128361078L13.5,198.05830470370518L14.400000000000013,198.00963962661913L15.300000000000026,197.95976741184606L16.200000000000006,197.90865875361638L17.099999999999987,197.8562836670134L18,197.80261147388137L18.900000000000013,197.74761078852686L19.800000000000026,197.69124950321554L20.699999999999974,197.63349477346625L21.60000000000002,197.57431300314514L22.5,197.5136698293628L23.39999999999998,197.4515301071777L24.300000000000026,197.3878578941094L25.200000000000006,197.32261643446705L26.099999999999987,197.25576814349623L27,197.1872745913509L27.900000000000016,197.11709648689578L28.799999999999997,197.0451936613454L29.699999999999978,196.97152505174753L30.599999999999987,196.89604868431823L31.499999999999996,196.81872165763704L32.40000000000001,196.73950012571183L33.300000000000026,196.65833928092235L34.199999999999974,196.57519333685445L35.09999999999999,196.49001551103512L36,196.4027580075817L36.90000000000001,196.31337199977804L37.80000000000001,196.2218076125922L38.700000000000024,196.12801390515048L39.59999999999999,196.0319388531845L40.5,195.93352933146826L41.40000000000001,195.8327310962639L42.299999999999976,195.72948876779589L43.19999999999999,195.6237458127739L44.10000000000002,195.51544452698747L45,195.40452601799487L45.89999999999998,195.2909301879319L46.80000000000001,195.17459571646617L47.700000000000024,195.05546004392485L48.59999999999998,194.93345935462565L49.50000000000001,194.80852856044064L50.40000000000001,194.68060128462682L51.299999999999976,194.5496098459568L52.19999999999999,194.4154852431854L53.09999999999999,194.2781571398908L54,194.13755384972873L54.900000000000006,193.99360232214235L55.80000000000001,193.8462281285704L56.69999999999999,193.69535544919972L57.599999999999994,193.5409070603099L58.5,193.38280432225918L59.40000000000001,193.22096716816438L60.30000000000001,193.0553140933285L61.200000000000024,192.88576214547274L62.09999999999999,192.71222691583196L62.99999999999999,192.5346225311741L63.90000000000002,192.35286164680835L64.79999999999998,192.16685544064714L65.69999999999999,191.9765136083909L66.60000000000002,191.781744359907L67.5,191.58245441687623L68.39999999999998,191.37854901178278L69.30000000000001,191.16993188832708L70.20000000000002,190.95650530334248L71.09999999999998,190.73817003029993L72,190.51482536448665L72.90000000000002,190.28636912994875L73.8,190.05269768828865L74.7,189.8137059494113L75.6,189.56928738431645L76.5,189.31933404003516L77.39999999999998,189.06373655681185L78.30000000000001,188.80238418763565L79.19999999999999,188.53516482022624L80.10000000000002,188.26196500158176L81,187.98266996519848L81.9,187.6971636610731L82.8,187.4053287886007L83.7,187.10704683248207L84.59999999999998,186.80219810175623L85.5,186.4906617720742L86.40000000000002,186.17231593133064L87.29999999999998,185.84703762877183L88.2,185.51470292769645L89.10000000000002,185.17518696186735L90,184.8283639957513L90.89999999999998,184.47410748870232L91.8,184.1122901632043L92.70000000000002,183.7427840772854L93.59999999999998,183.36546070121554L94.5,182.98019099859596L95.4,182.58684551194574L96.30000000000003,182.18529445288735L97.2,181.77540779702878L98.1,181.3570553836353L99.00000000000001,180.9301070201781L99.9,180.49443259184147L100.80000000000003,180.04990217606297L101.69999999999997,179.59638616217393L102.6,179.13375537619976L103.49999999999999,178.66188121086978L104.4,178.1806357608774L105.3,177.68989196342073L106.19999999999997,177.18952374404185L107.1,176.67940616777213L108,176.1594155955765L108.90000000000002,175.62942984607636L109.79999999999998,175.08932836251674L110.7,174.53899238492565L111.60000000000002,173.97830512740043L112.5,173.40715196043413L113.39999999999998,172.82542059818115L114.3,172.23300129053857L115.20000000000002,171.62978701990244L116.09999999999998,171.01567370243544L117,170.39056039366213L117.9,169.75434949818515L118.80000000000003,169.10694698329306L119.7,168.448262596206L120.6,167.77821008468297L121.50000000000001,167.09670742068735L122.4,166.4036770267849L123.30000000000003,165.69904600491984L124.19999999999997,164.98274636719205L125.1,164.25471526822992L125.99999999999999,163.51489523872874L126.9,162.76323441969828L127.8,161.99968679693743L128.7,161.22421243522805L129.6,160.43677771171636L130.5,159.63735554792424L131.4,158.82592563981052L132.29999999999998,158.0024746852795L133.2,157.1669966085117L134.10000000000002,156.3194927804731L135,155.45997223493825L135.89999999999998,154.5884518793477L136.8,153.70495669980352L137.70000000000002,152.8095199594932L138.6,151.90218338982223L139.5,150.98299737352565L140.4,150.05202111902352L141.3,149.10932282528051L142.20000000000002,148.15497983643078L143.1,147.1890787854297L144,146.211715726001L144.9,145.2229962521558L145.80000000000004,144.2230356045726L146.69999999999996,143.21195876314198L147.6,142.18990052500084L148.5,141.15700556740225L149.4,140.1134284947946L150.29999999999998,139.05933386951307L151.2,137.9948962255225L152.1,136.92030006468616L153,135.83573983507858L153.9,134.74141989090427L154.79999999999995,133.63755443363323L155.7,132.5243674340165L156.59999999999997,131.40209253469973L157.5,130.27097293321086L158.40000000000003,129.13126124515907L159.3,127.98321934754684L160.20000000000005,126.82711820216011L161.1,125.66323765907326L162,124.49186624037092L162.9,123.31330090426384L163.8,122.12784678984438L164.70000000000002,120.93581694280186L165.6,119.7375320224904L166.5,118.53331999081398L167.4,117.32351578346601L168.30000000000004,116.1084609641319L169.19999999999996,114.88850336233185L170.1,113.66399669564964L171,112.43530017715963L171.9,111.20277810892398L172.79999999999998,109.96679946249559L173.7,108.72773744741579L174.6,107.48596906874992L175.5,106.24187467475126L176.4,104.99583749578795L177.29999999999995,103.74824317570707L178.2,102.49947929684207L179.09999999999997,101.24993489990209L180,100L180.89999999999998,98.75006510009794L181.8,97.50052070315793L182.7,96.25175682429298L183.6,95.00416250421202L184.49999999999997,93.75812532524874L185.4,92.51403093125006L186.29999999999998,91.27226255258425L187.20000000000002,90.03320053750441L188.1,88.79722189107602L189,87.56469982284037L189.89999999999998,86.33600330435043L190.8,85.11149663766817L191.7,83.8915390358681L192.60000000000002,82.67648421653398L193.5,81.46668000918605L194.4,80.26246797750957L195.29999999999998,79.06418305719814L196.20000000000002,77.87215321015559L197.1,76.68669909573616L198.00000000000003,75.50813375962908L198.9,74.33676234092674L199.8,73.17288179783984L200.7,72.01678065245316L201.60000000000002,70.86873875484088L202.5,69.72902706678916L203.39999999999998,68.59790746530025L204.3,67.4756325659835L205.2,66.36244556636682L206.1,65.25858010909573L206.99999999999997,64.1642601649214L207.9,63.07969993531384L208.79999999999998,62.0051037744775L209.70000000000002,60.94066613048692L210.6,59.886571505205424L211.5,58.84299443259775L212.39999999999998,57.81009947499922L213.3,56.78804123685799L214.2,55.776964395427406L215.10000000000002,54.777003747844155L216,53.78828427399902L216.9,52.81092121457029L217.79999999999998,51.845020163569224L218.70000000000002,50.89067717471947L219.6,49.94797888097651L220.50000000000003,49.01700262647435L221.4,48.0978166101778L222.3,47.19048004050676L223.2,46.29504330019649L224.10000000000002,45.41154812065229L225,44.54002776506179L225.89999999999998,43.68050721952692L226.8,42.833003391488276L227.7,41.99752531472054L228.6,41.17407436018945L229.49999999999997,40.362644452075756L230.4,39.56322228828364L231.29999999999998,38.77578756477196L232.20000000000002,38.00031320306259L233.1,37.236765580301736L234,36.48510476127127L234.89999999999998,35.74528473177012L235.8,35.01725363280794L236.7,34.3009539950802L237.60000000000002,33.59632297321509L238.5,32.90329257931261L239.4,32.22178991531705L240.29999999999998,31.551737403794L241.20000000000002,30.89305301670695L242.1,30.245650501814847L243.00000000000003,29.609439606337883L243.9,28.98432629756458L244.8,28.37021298009754L245.7,27.766998709461443L246.60000000000002,27.174579401818843L247.5,26.592848039565876L248.39999999999998,26.021694872599575L249.3,25.46100761507435L250.2,24.910671637483283L251.1,24.37057015392361L251.99999999999997,23.840584404423538L252.9,23.320593832227885L253.79999999999998,22.81047625595818L254.70000000000002,22.31010803657929L255.6,21.819364239122585L256.5,21.338118789130256L257.4,20.866244623800267L258.3,20.40361383782605L259.2,19.950097823937043L260.1,19.505567408158498L261,19.06989297982189L261.90000000000003,18.64294461636473L262.8,18.224592202971234L263.7,17.81470554711264L264.6,17.41315448805427L265.5,17.019809001404052L266.4,16.634539298784468L267.3,16.257215922714565L268.2,15.887709836795683L269.1,15.525892511297702L270,15.17163600424869L270.9,14.824813038132634L271.8,14.485297072303549L272.7,14.152962371228185L273.6,13.827684068669388L274.5,13.509338227925817L275.4,13.197801898243755L276.3,12.892953167517929L277.2,12.5946712113993L278.09999999999997,12.302836338926904L279,12.017330034801521L279.9,11.738034998418257L280.8,11.464835179773747L281.7,11.197615812364337L282.6,10.936263443188166L283.5,10.680665959964863L284.40000000000003,10.430712615683536L285.3,10.186294050588707L286.2,9.947302311711326L287.1,9.713630870051237L288,9.48517463551337L288.9,9.261829969700063L289.8,9.043494696657506L290.69999999999993,8.830068111672906L291.6000000000001,8.621450988217227L292.5,8.417545583123776L293.3999999999999,8.21825564009302L294.30000000000007,8.023486391609126L295.2,7.833144559352867L296.1,7.647138353191618L297,7.465377468825873L297.9,7.287773084168037L298.79999999999995,7.114237854527228L299.7,6.944685906671522L300.59999999999997,6.77903283183563L301.5,6.617195677740839L302.40000000000003,6.459092939690114L303.3,6.304644550800287L304.2,6.153771871429603L305.09999999999997,6.0063976778576444L306,5.862446150271272L306.90000000000003,5.721842860109216L307.8,5.584514756814585L308.70000000000005,5.450390154043205L309.6,5.319398715373191L310.5,5.191471439559381L311.4,5.066540645374329L312.3,4.9445399560751335L313.19999999999993,4.825404283533841L314.1000000000001,4.70906981206809L315,4.595473982005127L315.8999999999999,4.484555473012519L316.80000000000007,4.376254187226114L317.7,4.2705112322040994L318.6,4.167268903736088L319.5,4.066470668531763L320.4,3.9680611468154936L321.29999999999995,3.871986094849511L322.2,3.7781923874078194L323.09999999999997,3.68662800022197L324,3.5972419924183097L324.90000000000003,3.509984488964868L325.8,3.42480666314553L326.7,3.3416607190776437L327.59999999999997,3.2604998742881808L328.5,3.1812783423629476L329.40000000000003,3.1039513156817744L330.3,3.0284749482524465L331.20000000000005,2.954806338654614L332.1,2.882903513104207L333,2.8127254086491194L333.9,2.744231856503787L334.8,2.677383565532976L335.69999999999993,2.6121421058906247L336.6000000000001,2.5484698928223137L337.5,2.4863301706371743L338.3999999999999,2.425686996854859L339.30000000000007,2.366505226533766L340.2,2.3087504967844508L341.1,2.252389211473149L342,2.1973885261186377L342.9,2.1437163329866227L343.79999999999995,2.091341246383638L344.7,2.040232588153934L345.59999999999997,1.9903603733808506L346.5,1.9416952962948208L347.40000000000003,1.894208716389234L348.3,1.8478726447457516L349.2,1.802659730569589L350.09999999999997,1.758543247934985L351,1.7154970827423899L351.90000000000003,1.6734957198859313L352.8,1.6325142306319762L353.70000000000005,1.592528260208348L354.6,1.5535140156030192L355.5,1.5154482535721492L356.4,1.4783082688563765L357.3,1.4420718826037904L358.19999999999993,1.4067174309990271L359.1000000000001,1.3722237540965354"></path><text class="x label" text-anchor="end" x="180" y="235">z</text><text x="180" y="-10" text-anchor="middle" style="font-size: 16px;">sigmoid function</text></g></svg></div>
<script type="text/javascript" style="display:none">
<!--
!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return t>n?-1:n>t?1:n>=t?0:0/0}function r(n){return null===n?0/0:+n}function u(n){return!isNaN(n)}function i(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)<0?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)>0?u=i:r=i+1}return r}}}function o(n){return n.length}function a(n){for(var t=1;n*t%1;)t*=10;return t}function c(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function l(){this._=Object.create(null)}function s(n){return(n+="")===pa||n[0]===va?va+n:n}function f(n){return(n+="")[0]===va?n.slice(1):n}function h(n){return s(n)in this._}function g(n){return(n=s(n))in this._&&delete this._[n]}function p(){var n=[];for(var t in this._)n.push(f(t));return n}function v(){var n=0;for(var t in this._)++n;return n}function d(){for(var n in this._)return!1;return!0}function m(){this._=Object.create(null)}function y(n){return n}function M(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function x(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=da.length;r>e;++e){var u=da[e]+t;if(u in n)return u}}function b(){}function _(){}function w(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new l;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function S(){ta.event.preventDefault()}function k(){for(var n,t=ta.event;n=t.sourceEvent;)t=n;return t}function E(n){for(var t=new _,e=0,r=arguments.length;++e<r;)t[arguments[e]]=w(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=ta.event;u.target=n,ta.event=u,t[u.type].apply(e,r)}finally{ta.event=i}}},t}function A(n){return ya(n,_a),n}function N(n){return"function"==typeof n?n:function(){return Ma(n,this)}}function C(n){return"function"==typeof n?n:function(){return xa(n,this)}}function z(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=ta.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function q(n){return n.trim().replace(/\s+/g," ")}function L(n){return new RegExp("(?:^|\\s+)"+ta.requote(n)+"(?:\\s+|$)","g")}function T(n){return(n+"").trim().split(/^|\s+/)}function R(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=T(n).map(D);var u=n.length;return"function"==typeof t?r:e}function D(n){var t=L(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",q(u+" "+n))):e.setAttribute("class",q(u.replace(t," ")))}}function P(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function U(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function j(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e?t.createElementNS(e,n):t.createElement(n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=ta.ns.qualify(n)).local?e:t}function F(){var n=this.parentNode;n&&n.removeChild(this)}function H(n){return{__data__:n}}function O(n){return function(){return ba(this,n)}}function I(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],o=0,a=i.length;a>o;o++)(u=i[o])&&t(u,o,e);return n}function Z(n){return ya(n,Sa),n}function V(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;);return o}}function X(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=c(t,ra(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+ta.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),c=$;a>0&&(n=n.slice(0,a));var l=ka.get(n);return l&&(n=l,c=B),a?t?u:r:t?b:i}function $(n,t){return function(e){var r=ta.event;ta.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{ta.event=r}}}function B(n,t){var e=$(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function W(e){var r=".dragsuppress-"+ ++Aa,u="click"+r,i=ta.select(t(e)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==Ea&&(Ea="onselectstart"in e?!1:x(e.style,"userSelect")),Ea){var o=n(e).style,a=o[Ea];o[Ea]="none"}return function(n){if(i.on(r,null),Ea&&(o[Ea]=a),n){var t=function(){i.on(u,null)};i.on(u,function(){S(),t()},!0),setTimeout(t,0)}}}function J(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var u=r.createSVGPoint();if(0>Na){var i=t(n);if(i.scrollX||i.scrollY){r=ta.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=r[0][0].getScreenCTM();Na=!(o.f||o.e),r.remove()}}return Na?(u.x=e.pageX,u.y=e.pageY):(u.x=e.clientX,u.y=e.clientY),u=u.matrixTransform(n.getScreenCTM().inverse()),[u.x,u.y]}var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}function G(){return ta.event.changedTouches[0].identifier}function K(n){return n>0?1:0>n?-1:0}function Q(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function nt(n){return n>1?0:-1>n?qa:Math.acos(n)}function tt(n){return n>1?Ra:-1>n?-Ra:Math.asin(n)}function et(n){return((n=Math.exp(n))-1/n)/2}function rt(n){return((n=Math.exp(n))+1/n)/2}function ut(n){return((n=Math.exp(2*n))-1)/(n+1)}function it(n){return(n=Math.sin(n/2))*n}function ot(){}function at(n,t,e){return this instanceof at?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof at?new at(n.h,n.s,n.l):bt(""+n,_t,at):new at(n,t,e)}function ct(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,i=2*e-o,new mt(u(n+120),u(n),u(n-120))}function lt(n,t,e){return this instanceof lt?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof lt?new lt(n.h,n.c,n.l):n instanceof ft?gt(n.l,n.a,n.b):gt((n=wt((n=ta.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new lt(n,t,e)}function st(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new ft(e,Math.cos(n*=Da)*t,Math.sin(n)*t)}function ft(n,t,e){return this instanceof ft?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof ft?new ft(n.l,n.a,n.b):n instanceof lt?st(n.h,n.c,n.l):wt((n=mt(n)).r,n.g,n.b):new ft(n,t,e)}function ht(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=pt(u)*Xa,r=pt(r)*$a,i=pt(i)*Ba,new mt(dt(3.2404542*u-1.5371385*r-.4985314*i),dt(-.969266*u+1.8760108*r+.041556*i),dt(.0556434*u-.2040259*r+1.0572252*i))}function gt(n,t,e){return n>0?new lt(Math.atan2(e,t)*Pa,Math.sqrt(t*t+e*e),n):new lt(0/0,0/0,n)}function pt(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function vt(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function dt(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function mt(n,t,e){return this instanceof mt?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof mt?new mt(n.r,n.g,n.b):bt(""+n,mt,ct):new mt(n,t,e)}function yt(n){return new mt(n>>16,n>>8&255,255&n)}function Mt(n){return yt(n)+""}function xt(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function bt(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(kt(u[0]),kt(u[1]),kt(u[2]))}return(i=Ga.get(n.toLowerCase()))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&i)>>4,o=o>>4|o,a=240&i,a=a>>4|a,c=15&i,c=c<<4|c):7===n.length&&(o=(16711680&i)>>16,a=(65280&i)>>8,c=255&i)),t(o,a,c))}function _t(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),new at(r,u,c)}function wt(n,t,e){n=St(n),t=St(t),e=St(e);var r=vt((.4124564*n+.3575761*t+.1804375*e)/Xa),u=vt((.2126729*n+.7151522*t+.072175*e)/$a),i=vt((.0193339*n+.119192*t+.9503041*e)/Ba);return ft(116*u-16,500*(r-u),200*(u-i))}function St(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function kt(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function Et(n){return"function"==typeof n?n:function(){return n}}function At(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Nt(t,e,n,r)}}function Nt(n,t,e,r){function u(){var n,t=c.status;if(!t&&zt(c)||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return void o.error.call(i,r)}o.load.call(i,n)}else o.error.call(i,c)}var i={},o=ta.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=ta.event;ta.event=n;try{o.progress.call(i,c)}finally{ta.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(l=n,i):l},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(ra(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),c.setRequestHeader)for(var s in a)c.setRequestHeader(s,a[s]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=l&&(c.responseType=l),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},ta.rebind(i,o,"on"),null==r?i:i.get(Ct(r))}function Ct(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function zt(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qt(){var n=Lt(),t=Tt()-n;t>24?(isFinite(t)&&(clearTimeout(tc),tc=setTimeout(qt,t)),nc=0):(nc=1,rc(qt))}function Lt(){var n=Date.now();for(ec=Ka;ec;)n>=ec.t&&(ec.f=ec.c(n-ec.t)),ec=ec.n;return n}function Tt(){for(var n,t=Ka,e=1/0;t;)t.f?t=n?n.n=t.n:Ka=t.n:(t.t<e&&(e=t.t),t=(n=t).n);return Qa=n,e}function Rt(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Dt(n,t){var e=Math.pow(10,3*ga(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function Pt(n){var t=n.decimal,e=n.thousands,r=n.grouping,u=n.currency,i=r&&e?function(n,t){for(var u=n.length,i=[],o=0,a=r[0],c=0;u>0&&a>0&&(c+a+1>t&&(a=Math.max(1,t-c)),i.push(n.substring(u-=a,u+a)),!((c+=a+1)>t));)a=r[o=(o+1)%r.length];return i.reverse().join(e)}:y;return function(n){var e=ic.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",c=e[4]||"",l=e[5],s=+e[6],f=e[7],h=e[8],g=e[9],p=1,v="",d="",m=!1,y=!0;switch(h&&(h=+h.substring(1)),(l||"0"===r&&"="===o)&&(l=r="0",o="="),g){case"n":f=!0,g="g";break;case"%":p=100,d="%",g="f";break;case"p":p=100,d="%",g="r";break;case"b":case"o":case"x":case"X":"#"===c&&(v="0"+g.toLowerCase());case"c":y=!1;case"d":m=!0,h=0;break;case"s":p=-1,g="r"}"$"===c&&(v=u[0],d=u[1]),"r"!=g||h||(g="g"),null!=h&&("g"==g?h=Math.max(1,Math.min(21,h)):("e"==g||"f"==g)&&(h=Math.max(0,Math.min(20,h)))),g=oc.get(g)||Ut;var M=l&&f;return function(n){var e=d;if(m&&n%1)return"";var u=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===a?"":a;if(0>p){var c=ta.formatPrefix(n,h);n=c.scale(n),e=c.symbol+d}else n*=p;n=g(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=y?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!l&&f&&(x=i(x,1/0));var S=v.length+x.length+b.length+(M?0:u.length),k=s>S?new Array(S=s-S+1).join(r):"";return M&&(x=i(k+x,k.length?s-b.length:1/0)),u+=v,n=x+b,("<"===o?u+n+k:">"===o?k+u+n:"^"===o?k.substring(0,S>>=1)+u+n+k.substring(S):u+(M?n:k+n))+e}}}function Ut(n){return n+""}function jt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ft(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new cc(e-1)),1),e}function i(n,e){return t(n=new cc(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1)for(;r>o;)e(o)%i||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{cc=jt;var r=new jt;return r._=n,o(r,t,e)}finally{cc=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=Ht(n);return c.floor=c,c.round=Ht(r),c.ceil=Ht(u),c.offset=Ht(i),c.range=a,n}function Ht(n){return function(t,e){try{cc=jt;var r=new jt;return r._=t,n(r,e)._}finally{cc=Date}}}function Ot(n){function t(n){function t(t){for(var e,u,i,o=[],a=-1,c=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(c,a)),null!=(u=sc[e=n.charAt(++a)])&&(e=n.charAt(++a)),(i=N[e])&&(e=i(t,null==u?"e"===e?" ":"0":u)),o.push(e),c=a+1);return o.push(n.slice(c,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},u=e(r,n,t,0);if(u!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&cc!==jt,o=new(i?jt:cc);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),i?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var u,i,o,a=0,c=t.length,l=e.length;c>a;){if(r>=l)return-1;if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=C[o in sc?t.charAt(a++):o],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){E.lastIndex=0;var r=E.exec(t.slice(e));return r?(n.m=A.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,N.c.toString(),t,r)}function c(n,t,r){return e(n,N.x.toString(),t,r)}function l(n,t,r){return e(n,N.X.toString(),t,r)}function s(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var f=n.dateTime,h=n.date,g=n.time,p=n.periods,v=n.days,d=n.shortDays,m=n.months,y=n.shortMonths;t.utc=function(n){function e(n){try{cc=jt;var t=new cc;return t._=n,r(t)}finally{cc=Date}}var r=t(n);return e.parse=function(n){try{cc=jt;var t=r.parse(n);return t&&t._}finally{cc=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ae;var M=ta.map(),x=Yt(v),b=Zt(v),_=Yt(d),w=Zt(d),S=Yt(m),k=Zt(m),E=Yt(y),A=Zt(y);p.forEach(function(n,t){M.set(n.toLowerCase(),t)});var N={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return y[n.getMonth()]},B:function(n){return m[n.getMonth()]},c:t(f),d:function(n,t){return It(n.getDate(),t,2)},e:function(n,t){return It(n.getDate(),t,2)},H:function(n,t){return It(n.getHours(),t,2)},I:function(n,t){return It(n.getHours()%12||12,t,2)},j:function(n,t){return It(1+ac.dayOfYear(n),t,3)},L:function(n,t){return It(n.getMilliseconds(),t,3)},m:function(n,t){return It(n.getMonth()+1,t,2)},M:function(n,t){return It(n.getMinutes(),t,2)},p:function(n){return p[+(n.getHours()>=12)]},S:function(n,t){return It(n.getSeconds(),t,2)},U:function(n,t){return It(ac.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return It(ac.mondayOfYear(n),t,2)},x:t(h),X:t(g),y:function(n,t){return It(n.getFullYear()%100,t,2)},Y:function(n,t){return It(n.getFullYear()%1e4,t,4)},Z:ie,"%":function(){return"%"}},C={a:r,A:u,b:i,B:o,c:a,d:Qt,e:Qt,H:te,I:te,j:ne,L:ue,m:Kt,M:ee,p:s,S:re,U:Xt,w:Vt,W:$t,x:c,X:l,y:Wt,Y:Bt,Z:Jt,"%":oe};return t}function It(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function Yt(n){return new RegExp("^(?:"+n.map(ta.requote).join("|")+")","i")}function Zt(n){for(var t=new l,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Vt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Xt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function $t(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Bt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Wt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.y=Gt(+r[0]),e+r[0].length):-1}function Jt(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Gt(n){return n+(n>68?1900:2e3)}function Kt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Qt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function ne(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function te(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function ee(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function re(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ue(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function ie(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=ga(t)/60|0,u=ga(t)%60;return e+It(r,"0",2)+It(u,"0",2)}function oe(n,t,e){hc.lastIndex=0;var r=hc.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ae(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ce(){}function le(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function se(n,t){n&&dc.hasOwnProperty(n.type)&&dc[n.type](n,t)}function fe(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function he(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)fe(n[e],t,1);t.polygonEnd()}function ge(){function n(n,t){n*=Da,t=t*Da/2+qa/4;var e=n-r,o=e>=0?1:-1,a=o*e,c=Math.cos(t),l=Math.sin(t),s=i*l,f=u*c+s*Math.cos(a),h=s*o*Math.sin(a);yc.add(Math.atan2(h,f)),r=n,u=c,i=l}var t,e,r,u,i;Mc.point=function(o,a){Mc.point=n,r=(t=o)*Da,u=Math.cos(a=(e=a)*Da/2+qa/4),i=Math.sin(a)},Mc.lineEnd=function(){n(t,e)}}function pe(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function ve(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function de(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function me(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ye(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Me(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function xe(n){return[Math.atan2(n[1],n[0]),tt(n[2])]}function be(n,t){return ga(n[0]-t[0])<Ca&&ga(n[1]-t[1])<Ca}function _e(n,t){n*=Da;var e=Math.cos(t*=Da);we(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function we(n,t,e){++xc,_c+=(n-_c)/xc,wc+=(t-wc)/xc,Sc+=(e-Sc)/xc}function Se(){function n(n,u){n*=Da;var i=Math.cos(u*=Da),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),l=Math.atan2(Math.sqrt((l=e*c-r*a)*l+(l=r*o-t*c)*l+(l=t*a-e*o)*l),t*o+e*a+r*c);bc+=l,kc+=l*(t+(t=o)),Ec+=l*(e+(e=a)),Ac+=l*(r+(r=c)),we(t,e,r)}var t,e,r;qc.point=function(u,i){u*=Da;var o=Math.cos(i*=Da);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),qc.point=n,we(t,e,r)}}function ke(){qc.point=_e}function Ee(){function n(n,t){n*=Da;var e=Math.cos(t*=Da),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),l=u*c-i*a,s=i*o-r*c,f=r*a-u*o,h=Math.sqrt(l*l+s*s+f*f),g=r*o+u*a+i*c,p=h&&-nt(g)/h,v=Math.atan2(h,g);Nc+=p*l,Cc+=p*s,zc+=p*f,bc+=v,kc+=v*(r+(r=o)),Ec+=v*(u+(u=a)),Ac+=v*(i+(i=c)),we(r,u,i)}var t,e,r,u,i;qc.point=function(o,a){t=o,e=a,qc.point=n,o*=Da;var c=Math.cos(a*=Da);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),we(r,u,i)},qc.lineEnd=function(){n(t,e),qc.lineEnd=ke,qc.point=_e}}function Ae(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function Ne(){return!0}function Ce(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(be(e,r)){u.lineStart();for(var a=0;t>a;++a)u.point((e=n[a])[0],e[1]);return void u.lineEnd()}var c=new qe(e,n,null,!0),l=new qe(e,null,c,!1);c.o=l,i.push(c),o.push(l),c=new qe(r,n,null,!1),l=new qe(r,null,c,!0),c.o=l,i.push(c),o.push(l)}}),o.sort(t),ze(i),ze(o),i.length){for(var a=0,c=e,l=o.length;l>a;++a)o[a].e=c=!c;for(var s,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;s=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var a=0,l=s.length;l>a;++a)u.point((f=s[a])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){s=g.p.z;for(var a=s.length-1;a>=0;--a)u.point((f=s[a])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,s=g.z,p=!p}while(!g.v);u.lineEnd()}}}function ze(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function qe(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Le(n,t,e,r){return function(u,i){function o(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function a(n,t){var e=u(n,t);d.point(e[0],e[1])}function c(){y.point=a,d.lineStart()}function l(){y.point=o,d.lineEnd()}function s(n,t){v.push([n,t]);var e=u(n,t);x.point(e[0],e[1])}function f(){x.lineStart(),v=[]}function h(){s(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r)if(1&t){n=e[0];var u,r=n.length-1,o=-1;if(r>0){for(b||(i.polygonStart(),b=!0),i.lineStart();++o<r;)i.point((u=n[o])[0],u[1]);i.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Te))}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:o,lineStart:c,lineEnd:l,polygonStart:function(){y.point=s,y.lineStart=f,y.lineEnd=h,g=[],p=[]},polygonEnd:function(){y.point=o,y.lineStart=c,y.lineEnd=l,g=ta.merge(g);var n=Fe(m,p);g.length?(b||(i.polygonStart(),b=!0),Ce(g,De,n,e,i)):n&&(b||(i.polygonStart(),b=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),b&&(i.polygonEnd(),b=!1),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},M=Re(),x=t(M),b=!1;return y}}function Te(n){return n.length>1}function Re(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:b,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function De(n,t){return((n=n.x)[0]<0?n[1]-Ra-Ca:Ra-n[1])-((t=t.x)[0]<0?t[1]-Ra-Ca:Ra-t[1])}function Pe(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?qa:-qa,c=ga(i-e);ga(c-qa)<Ca?(n.point(e,r=(r+o)/2>0?Ra:-Ra),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=qa&&(ga(e-u)<Ca&&(e-=u*Ca),ga(i-a)<Ca&&(i-=a*Ca),r=Ue(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function Ue(n,t,e,r){var u,i,o=Math.sin(n-e);return ga(o)>Ca?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function je(n,t,e,r){var u;if(null==n)u=e*Ra,r.point(-qa,u),r.point(0,u),r.point(qa,u),r.point(qa,0),r.point(qa,-u),r.point(0,-u),r.point(-qa,-u),r.point(-qa,0),r.point(-qa,u);else if(ga(n[0]-t[0])>Ca){var i=n[0]<t[0]?qa:-qa;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function Fe(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=0;yc.reset();for(var a=0,c=t.length;c>a;++a){var l=t[a],s=l.length;if(s)for(var f=l[0],h=f[0],g=f[1]/2+qa/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===s&&(d=0),n=l[d];var m=n[0],y=n[1]/2+qa/4,M=Math.sin(y),x=Math.cos(y),b=m-h,_=b>=0?1:-1,w=_*b,S=w>qa,k=p*M;if(yc.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),i+=S?b+_*La:b,S^h>=e^m>=e){var E=de(pe(f),pe(n));Me(E);var A=de(u,E);Me(A);var N=(S^b>=0?-1:1)*tt(A[2]);(r>N||r===N&&(E[0]||E[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=m,p=M,v=x,f=n}}return(-Ca>i||Ca>i&&0>yc)^1&o}function He(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,c,l,s;return{lineStart:function(){l=c=!1,s=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=o?v?0:u(f,h):v?u(f+(0>f?qa:-qa),h):0;if(!e&&(l=c=v)&&n.lineStart(),v!==c&&(g=r(e,p),(be(e,g)||be(p,g))&&(p[0]+=Ca,p[1]+=Ca,v=t(p[0],p[1]))),v!==c)s=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(a&&e&&o^v){var m;d&i||!(m=r(p,e,!0))||(s=0,o?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&be(e,p)||n.point(p[0],p[1]),e=p,c=v,i=d},lineEnd:function(){c&&n.lineEnd(),e=null},clean:function(){return s|(l&&c)<<1}}}function r(n,t,e){var r=pe(n),u=pe(t),o=[1,0,0],a=de(r,u),c=ve(a,a),l=a[0],s=c-l*l;if(!s)return!e&&n;var f=i*c/s,h=-i*l/s,g=de(o,a),p=ye(o,f),v=ye(a,h);me(p,v);var d=g,m=ve(p,d),y=ve(d,d),M=m*m-y*(ve(p,p)-1);if(!(0>M)){var x=Math.sqrt(M),b=ye(d,(-m-x)/y);if(me(b,p),b=xe(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],E=t[1];w>S&&(_=w,w=S,S=_);var A=S-w,N=ga(A-qa)<Ca,C=N||Ca>A;if(!N&&k>E&&(_=k,k=E,E=_),C?N?k+E>0^b[1]<(ga(b[0]-w)<Ca?k:E):k<=b[1]&&b[1]<=E:A>qa^(w<=b[0]&&b[0]<=S)){var z=ye(d,(-m+x)/y);return me(z,p),[b,xe(z)]}}}function u(t,e){var r=o?n:qa-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),o=i>0,a=ga(i)>Ca,c=gr(n,6*Da);return Le(t,e,c,o?[0,-n]:[-qa,n-qa])}function Oe(n,t,e,r){return function(u){var i,o=u.a,a=u.b,c=o.x,l=o.y,s=a.x,f=a.y,h=0,g=1,p=s-c,v=f-l;if(i=n-c,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-c,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-l,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-l,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:c+h*p,y:l+h*v}),1>g&&(u.b={x:c+g*p,y:l+g*v}),u}}}}}}function Ie(n,t,e,r){function u(r,u){return ga(r[0]-n)<Ca?u>0?0:3:ga(r[0]-e)<Ca?u>0?2:1:ga(r[1]-t)<Ca?u>0?1:0:u>0?3:2}function i(n,t){return o(n.x,t.x)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n){for(var t=0,e=d.length,r=n[1],u=0;e>u;++u)for(var i,o=1,a=d[u],c=a.length,l=a[0];c>o;++o)i=a[o],l[1]<=r?i[1]>r&&Q(l,i,n)>0&&++t:i[1]<=r&&Q(l,i,n)<0&&--t,l=i;return 0!==t}function l(i,a,c,l){var s=0,f=0;if(null==i||(s=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do l.point(0===s||3===s?n:e,s>1?r:t);while((s=(s+c+4)%4)!==f)}else l.point(a[0],a[1])}function s(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function f(n,t){s(n,t)&&a.point(n,t)}function h(){C.point=p,d&&d.push(m=[]),S=!0,w=!1,b=_=0/0}function g(){v&&(p(y,M),x&&w&&A.rejoin(),v.push(A.buffer())),C.point=f,w&&a.lineEnd()}function p(n,t){n=Math.max(-Tc,Math.min(Tc,n)),t=Math.max(-Tc,Math.min(Tc,t));var e=s(n,t);if(d&&m.push([n,t]),S)y=n,M=t,x=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};N(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,m,y,M,x,b,_,w,S,k,E=a,A=Re(),N=Oe(n,t,e,r),C={point:f,lineStart:h,lineEnd:g,polygonStart:function(){a=A,v=[],d=[],k=!0},polygonEnd:function(){a=E,v=ta.merge(v);var t=c([n,r]),e=k&&t,u=v.length;(e||u)&&(a.polygonStart(),e&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),u&&Ce(v,i,t,l,a),a.polygonEnd()),v=d=m=null}};return C}}function Ye(n){var t=0,e=qa/3,r=ir(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*qa/180,e=n[1]*qa/180):[t/qa*180,e/qa*180]},u}function Ze(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,tt((i-(n*n+e*e)*u*u)/(2*u))]},e}function Ve(){function n(n,t){Dc+=u*n-r*t,r=n,u=t}var t,e,r,u;Hc.point=function(i,o){Hc.point=n,t=r=i,e=u=o},Hc.lineEnd=function(){n(t,e)}}function Xe(n,t){Pc>n&&(Pc=n),n>jc&&(jc=n),Uc>t&&(Uc=t),t>Fc&&(Fc=t)}function $e(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=Be(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=Be(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Be(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function We(n,t){_c+=n,wc+=t,++Sc}function Je(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);kc+=o*(t+n)/2,Ec+=o*(e+r)/2,Ac+=o,We(t=n,e=r)}var t,e;Ic.point=function(r,u){Ic.point=n,We(t=r,e=u)}}function Ge(){Ic.point=We}function Ke(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);kc+=o*(r+n)/2,Ec+=o*(u+t)/2,Ac+=o,o=u*n-r*t,Nc+=o*(r+n),Cc+=o*(u+t),zc+=3*o,We(r=n,u=t)}var t,e,r,u;Ic.point=function(i,o){Ic.point=n,We(t=r=i,e=u=o)},Ic.lineEnd=function(){n(t,e)}}function Qe(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,La)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:b};return a}function nr(n){function t(n){return(a?r:e)(n)}function e(t){return rr(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=0/0,S.point=i,t.lineStart()}function i(e,r){var i=pe([e,r]),o=n(e,r);u(M,x,y,b,_,w,M=o[0],x=o[1],y=e,b=i[0],_=i[1],w=i[2],a,t),t.point(M,x)}function o(){S.point=e,t.lineEnd()}function c(){r(),S.point=l,S.lineEnd=s}function l(n,t){i(f=n,h=t),g=M,p=x,v=b,d=_,m=w,S.point=i}function s(){u(M,x,y,b,_,w,g,p,f,v,d,m,a,t),S.lineEnd=o,o()}var f,h,g,p,v,d,m,y,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=c
},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function u(t,e,r,a,c,l,s,f,h,g,p,v,d,m){var y=s-t,M=f-e,x=y*y+M*M;if(x>4*i&&d--){var b=a+g,_=c+p,w=l+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),E=ga(ga(w)-1)<Ca||ga(r-h)<Ca?(r+h)/2:Math.atan2(_,b),A=n(E,k),N=A[0],C=A[1],z=N-t,q=C-e,L=M*z-y*q;(L*L/x>i||ga((y*z+M*q)/x-.5)>.3||o>a*g+c*p+l*v)&&(u(t,e,r,a,c,l,N,C,E,b/=S,_/=S,w,d,m),m.point(N,C),u(N,C,E,b,_,w,s,f,h,g,p,v,d,m))}}var i=.5,o=Math.cos(30*Da),a=16;return t.precision=function(n){return arguments.length?(a=(i=n*n)>0&&16,t):Math.sqrt(i)},t}function tr(n){var t=nr(function(t,e){return n([t*Pa,e*Pa])});return function(n){return or(t(n))}}function er(n){this.stream=n}function rr(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function ur(n){return ir(function(){return n})()}function ir(n){function t(n){return n=a(n[0]*Da,n[1]*Da),[n[0]*h+c,l-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(l-n[1])/h),n&&[n[0]*Pa,n[1]*Pa]}function r(){a=Ae(o=lr(m,M,x),i);var n=i(v,d);return c=g-n[0]*h,l=p+n[1]*h,u()}function u(){return s&&(s.valid=!1,s=null),t}var i,o,a,c,l,s,f=nr(function(n,t){return n=i(n,t),[n[0]*h+c,l-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,M=0,x=0,b=Lc,_=y,w=null,S=null;return t.stream=function(n){return s&&(s.valid=!1),s=or(b(o,f(_(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(b=null==n?(w=n,Lc):He((w=+n)*Da),u()):w},t.clipExtent=function(n){return arguments.length?(S=n,_=n?Ie(n[0][0],n[0][1],n[1][0],n[1][1]):y,u()):S},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Da,d=n[1]%360*Da,r()):[v*Pa,d*Pa]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Da,M=n[1]%360*Da,x=n.length>2?n[2]%360*Da:0,r()):[m*Pa,M*Pa,x*Pa]},ta.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function or(n){return rr(n,function(t,e){n.point(t*Da,e*Da)})}function ar(n,t){return[n,t]}function cr(n,t){return[n>qa?n-La:-qa>n?n+La:n,t]}function lr(n,t,e){return n?t||e?Ae(fr(n),hr(t,e)):fr(n):t||e?hr(t,e):cr}function sr(n){return function(t,e){return t+=n,[t>qa?t-La:-qa>t?t+La:t,e]}}function fr(n){var t=sr(n);return t.invert=sr(-n),t}function hr(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*r+a*u;return[Math.atan2(c*i-s*o,a*r-l*u),tt(s*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*i-c*o;return[Math.atan2(c*i+l*o,a*r+s*u),tt(s*r-a*u)]},e}function gr(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=pr(e,u),i=pr(e,i),(o>0?i>u:u>i)&&(u+=o*La)):(u=n+o*La,i=n-.5*c);for(var l,s=u;o>0?s>i:i>s;s-=c)a.point((l=xe([e,-r*Math.cos(s),-r*Math.sin(s)]))[0],l[1])}}function pr(n,t){var e=pe(t);e[0]-=n,Me(e);var r=nt(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Ca)%(2*Math.PI)}function vr(n,t,e){var r=ta.range(n,t-Ca,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function dr(n,t,e){var r=ta.range(n,t-Ca,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function mr(n){return n.source}function yr(n){return n.target}function Mr(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),l=u*Math.sin(n),s=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(it(r-t)+u*o*it(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*s,u=e*l+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Pa,Math.atan2(o,Math.sqrt(r*r+u*u))*Pa]}:function(){return[n*Pa,t*Pa]};return p.distance=h,p}function xr(){function n(n,u){var i=Math.sin(u*=Da),o=Math.cos(u),a=ga((n*=Da)-t),c=Math.cos(a);Yc+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;Zc.point=function(u,i){t=u*Da,e=Math.sin(i*=Da),r=Math.cos(i),Zc.point=n},Zc.lineEnd=function(){Zc.point=Zc.lineEnd=b}}function br(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function _r(n,t){function e(n,t){o>0?-Ra+Ca>t&&(t=-Ra+Ca):t>Ra-Ca&&(t=Ra-Ca);var e=o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(qa/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=K(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Ra]},e):Sr}function wr(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return ga(u)<Ca?ar:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-K(u)*Math.sqrt(n*n+e*e)]},e)}function Sr(n,t){return[n,Math.log(Math.tan(qa/4+t/2))]}function kr(n){var t,e=ur(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=qa*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Er(n,t){return[Math.log(Math.tan(qa/4+t/2)),-n]}function Ar(n){return n[0]}function Nr(n){return n[1]}function Cr(n){for(var t=n.length,e=[0,1],r=2,u=2;t>u;u++){for(;r>1&&Q(n[e[r-2]],n[e[r-1]],n[u])<=0;)--r;e[r++]=u}return e.slice(0,r)}function zr(n,t){return n[0]-t[0]||n[1]-t[1]}function qr(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Lr(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],l=e[1],s=t[1]-c,f=r[1]-l,h=(a*(c-l)-f*(u-i))/(f*o-a*s);return[u+h*o,c+h*s]}function Tr(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Rr(){tu(this),this.edge=this.site=this.circle=null}function Dr(n){var t=el.pop()||new Rr;return t.site=n,t}function Pr(n){Xr(n),Qc.remove(n),el.push(n),tu(n)}function Ur(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,o=n.N,a=[n];Pr(n);for(var c=i;c.circle&&ga(e-c.circle.x)<Ca&&ga(r-c.circle.cy)<Ca;)i=c.P,a.unshift(c),Pr(c),c=i;a.unshift(c),Xr(c);for(var l=o;l.circle&&ga(e-l.circle.x)<Ca&&ga(r-l.circle.cy)<Ca;)o=l.N,a.push(l),Pr(l),l=o;a.push(l),Xr(l);var s,f=a.length;for(s=1;f>s;++s)l=a[s],c=a[s-1],Kr(l.edge,c.site,l.site,u);c=a[0],l=a[f-1],l.edge=Jr(c.site,l.site,null,u),Vr(c),Vr(l)}function jr(n){for(var t,e,r,u,i=n.x,o=n.y,a=Qc._;a;)if(r=Fr(a,o)-i,r>Ca)a=a.L;else{if(u=i-Hr(a,o),!(u>Ca)){r>-Ca?(t=a.P,e=a):u>-Ca?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var c=Dr(n);if(Qc.insert(t,c),t||e){if(t===e)return Xr(t),e=Dr(t.site),Qc.insert(c,e),c.edge=e.edge=Jr(t.site,c.site),Vr(t),void Vr(e);if(!e)return void(c.edge=Jr(t.site,c.site));Xr(t),Xr(e);var l=t.site,s=l.x,f=l.y,h=n.x-s,g=n.y-f,p=e.site,v=p.x-s,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,M=v*v+d*d,x={x:(d*y-g*M)/m+s,y:(h*M-v*y)/m+f};Kr(e.edge,l,p,x),c.edge=Jr(l,n,null,x),e.edge=Jr(n,p,null,x),Vr(t),Vr(e)}}function Fr(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var o=n.P;if(!o)return-1/0;e=o.site;var a=e.x,c=e.y,l=c-t;if(!l)return a;var s=a-r,f=1/i-1/l,h=s/l;return f?(-h+Math.sqrt(h*h-2*f*(s*s/(-2*l)-c+l/2+u-i/2)))/f+r:(r+a)/2}function Hr(n,t){var e=n.N;if(e)return Fr(e,t);var r=n.site;return r.y===t?r.x:1/0}function Or(n){this.site=n,this.edges=[]}function Ir(n){for(var t,e,r,u,i,o,a,c,l,s,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=Kc,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(a=i.edges,c=a.length,o=0;c>o;)s=a[o].end(),r=s.x,u=s.y,l=a[++o%c].start(),t=l.x,e=l.y,(ga(r-t)>Ca||ga(u-e)>Ca)&&(a.splice(o,0,new Qr(Gr(i.site,s,ga(r-f)<Ca&&p-u>Ca?{x:f,y:ga(t-f)<Ca?e:p}:ga(u-p)<Ca&&h-r>Ca?{x:ga(e-p)<Ca?t:h,y:p}:ga(r-h)<Ca&&u-g>Ca?{x:h,y:ga(t-h)<Ca?e:g}:ga(u-g)<Ca&&r-f>Ca?{x:ga(e-g)<Ca?t:f,y:g}:null),i.site,null)),++c)}function Yr(n,t){return t.angle-n.angle}function Zr(){tu(this),this.x=this.y=this.arc=this.site=this.cy=null}function Vr(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var o=u.x,a=u.y,c=r.x-o,l=r.y-a,s=i.x-o,f=i.y-a,h=2*(c*f-l*s);if(!(h>=-za)){var g=c*c+l*l,p=s*s+f*f,v=(f*g-l*p)/h,d=(c*p-s*g)/h,f=d+a,m=rl.pop()||new Zr;m.arc=n,m.site=u,m.x=v+o,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,M=tl._;M;)if(m.y<M.y||m.y===M.y&&m.x<=M.x){if(!M.L){y=M.P;break}M=M.L}else{if(!M.R){y=M;break}M=M.R}tl.insert(y,m),y||(nl=m)}}}}function Xr(n){var t=n.circle;t&&(t.P||(nl=t.N),tl.remove(t),rl.push(t),tu(t),n.circle=null)}function $r(n){for(var t,e=Gc,r=Oe(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!Br(t,n)||!r(t)||ga(t.a.x-t.b.x)<Ca&&ga(t.a.y-t.b.y)<Ca)&&(t.a=t.b=null,e.splice(u,1))}function Br(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,o=t[0][0],a=t[1][0],c=t[0][1],l=t[1][1],s=n.l,f=n.r,h=s.x,g=s.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(o>d||d>=a)return;if(h>p){if(i){if(i.y>=l)return}else i={x:d,y:c};e={x:d,y:l}}else{if(i){if(i.y<c)return}else i={x:d,y:l};e={x:d,y:c}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=l)return}else i={x:(c-u)/r,y:c};e={x:(l-u)/r,y:l}}else{if(i){if(i.y<c)return}else i={x:(l-u)/r,y:l};e={x:(c-u)/r,y:c}}else if(v>g){if(i){if(i.x>=a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}else{if(i){if(i.x<o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}return n.a=i,n.b=e,!0}function Wr(n,t){this.l=n,this.r=t,this.a=this.b=null}function Jr(n,t,e,r){var u=new Wr(n,t);return Gc.push(u),e&&Kr(u,n,t,e),r&&Kr(u,t,n,r),Kc[n.i].edges.push(new Qr(u,n,t)),Kc[t.i].edges.push(new Qr(u,t,n)),u}function Gr(n,t,e){var r=new Wr(n,null);return r.a=t,r.b=e,Gc.push(r),r}function Kr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function Qr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function nu(){this._=null}function tu(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function eu(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ru(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function uu(n){for(;n.L;)n=n.L;return n}function iu(n,t){var e,r,u,i=n.sort(ou).pop();for(Gc=[],Kc=new Array(n.length),Qc=new nu,tl=new nu;;)if(u=nl,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(Kc[i.i]=new Or(i),jr(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;Ur(u.arc)}t&&($r(t),Ir(t));var o={cells:Kc,edges:Gc};return Qc=tl=Gc=Kc=null,o}function ou(n,t){return t.y-n.y||t.x-n.x}function au(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function cu(n){return n.x}function lu(n){return n.y}function su(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fu(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=.5*(e+u),a=.5*(r+i),c=t.nodes;c[0]&&fu(n,c[0],e,r,o,a),c[1]&&fu(n,c[1],o,r,u,a),c[2]&&fu(n,c[2],e,a,o,i),c[3]&&fu(n,c[3],o,a,u,i)}}function hu(n,t,e,r,u,i,o){var a,c=1/0;return function l(n,s,f,h,g){if(!(s>i||f>o||r>h||u>g)){if(p=n.point){var p,v=t-n.x,d=e-n.y,m=v*v+d*d;if(c>m){var y=Math.sqrt(c=m);r=t-y,u=e-y,i=t+y,o=e+y,a=p}}for(var M=n.nodes,x=.5*(s+h),b=.5*(f+g),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:l(n,s,f,x,b);break;case 1:l(n,x,f,h,b);break;case 2:l(n,s,b,x,g);break;case 3:l(n,x,b,h,g)}}}(n,r,u,i,o),a}function gu(n,t){n=ta.rgb(n),t=ta.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+xt(Math.round(e+i*n))+xt(Math.round(r+o*n))+xt(Math.round(u+a*n))}}function pu(n,t){var e,r={},u={};for(e in n)e in t?r[e]=mu(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function vu(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function du(n,t){var e,r,u,i=il.lastIndex=ol.lastIndex=0,o=-1,a=[],c=[];for(n+="",t+="";(e=il.exec(n))&&(r=ol.exec(t));)(u=r.index)>i&&(u=t.slice(i,u),a[o]?a[o]+=u:a[++o]=u),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:vu(e,r)})),i=ol.lastIndex;return i<t.length&&(u=t.slice(i),a[o]?a[o]+=u:a[++o]=u),a.length<2?c[0]?(t=c[0].x,function(n){return t(n)+""}):function(){return t}:(t=c.length,function(n){for(var e,r=0;t>r;++r)a[(e=c[r]).i]=e.x(n);return a.join("")})}function mu(n,t){for(var e,r=ta.interpolators.length;--r>=0&&!(e=ta.interpolators[r](n,t)););return e}function yu(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(mu(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;o>e;++e)u[e]=t[e];return function(n){for(e=0;a>e;++e)u[e]=r[e](n);return u}}function Mu(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function xu(n){return function(t){return 1-n(1-t)}}function bu(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function _u(n){return n*n}function wu(n){return n*n*n}function Su(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function ku(n){return function(t){return Math.pow(t,n)}}function Eu(n){return 1-Math.cos(n*Ra)}function Au(n){return Math.pow(2,10*(n-1))}function Nu(n){return 1-Math.sqrt(1-n*n)}function Cu(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/La*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*La/t)}}function zu(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function qu(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Lu(n,t){n=ta.hcl(n),t=ta.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return st(e+i*n,r+o*n,u+a*n)+""}}function Tu(n,t){n=ta.hsl(n),t=ta.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return ct(e+i*n,r+o*n,u+a*n)+""}}function Ru(n,t){n=ta.lab(n),t=ta.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return ht(e+i*n,r+o*n,u+a*n)+""}}function Du(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Pu(n){var t=[n.a,n.b],e=[n.c,n.d],r=ju(t),u=Uu(t,e),i=ju(Fu(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Pa,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Pa:0}function Uu(n,t){return n[0]*t[0]+n[1]*t[1]}function ju(n){var t=Math.sqrt(Uu(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Fu(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Hu(n,t){var e,r=[],u=[],i=ta.transform(n),o=ta.transform(t),a=i.translate,c=o.translate,l=i.rotate,s=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:vu(a[0],c[0])},{i:3,x:vu(a[1],c[1])})):r.push(c[0]||c[1]?"translate("+c+")":""),l!=s?(l-s>180?s+=360:s-l>180&&(l+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:vu(l,s)})):s&&r.push(r.pop()+"rotate("+s+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:vu(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:vu(g[0],p[0])},{i:e-2,x:vu(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function Ou(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Iu(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Yu(n){for(var t=n.source,e=n.target,r=Vu(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function Zu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Vu(n,t){if(n===t)return n;for(var e=Zu(n),r=Zu(t),u=e.pop(),i=r.pop(),o=null;u===i;)o=u,u=e.pop(),i=r.pop();return o}function Xu(n){n.fixed|=2}function $u(n){n.fixed&=-7}function Bu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function Wu(n){n.fixed&=-5}function Ju(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,o=n.nodes,a=o.length,c=-1;++c<a;)i=o[c],null!=i&&(Ju(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var l=t*e[n.point.index];n.charge+=n.pointCharge=l,r+=l*n.point.x,u+=l*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function Gu(n,t){return ta.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=ri,n}function Ku(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(u=n.children)&&(r=u.length))for(var r,u;--r>=0;)e.push(u[r])}function Qu(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(i=n.children)&&(u=i.length))for(var u,i,o=-1;++o<u;)e.push(i[o]);for(;null!=(n=r.pop());)t(n)}function ni(n){return n.children}function ti(n){return n.value}function ei(n,t){return t.value-n.value}function ri(n){return ta.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function ui(n){return n.x}function ii(n){return n.y}function oi(n,t,e){n.y0=t,n.y=e}function ai(n){return ta.range(n.length)}function ci(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function li(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function si(n){return n.reduce(fi,0)}function fi(n,t){return n+t[1]}function hi(n,t){return gi(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function gi(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function pi(n){return[ta.min(n),ta.max(n)]}function vi(n,t){return n.value-t.value}function di(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function mi(n,t){n._pack_next=t,t._pack_prev=n}function yi(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function Mi(n){function t(n){s=Math.min(n.x-n.r,s),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(l=e.length)){var e,r,u,i,o,a,c,l,s=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(xi),r=e[0],r.x=-r.r,r.y=0,t(r),l>1&&(u=e[1],u.x=u.r,u.y=0,t(u),l>2))for(i=e[2],wi(r,u,i),t(i),di(r,i),r._pack_prev=i,di(i,u),u=r._pack_next,o=3;l>o;o++){wi(r,u,i=e[o]);var p=0,v=1,d=1;for(a=u._pack_next;a!==u;a=a._pack_next,v++)if(yi(a,i)){p=1;break}if(1==p)for(c=r._pack_prev;c!==a._pack_prev&&!yi(c,i);c=c._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?mi(r,u=a):mi(r=c,u),o--):(di(r,i),u=i,t(i))}var m=(s+f)/2,y=(h+g)/2,M=0;for(o=0;l>o;o++)i=e[o],i.x-=m,i.y-=y,M=Math.max(M,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=M,e.forEach(bi)}}function xi(n){n._pack_next=n._pack_prev=n}function bi(n){delete n._pack_next,delete n._pack_prev}function _i(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,o=u.length;++i<o;)_i(u[i],t,e,r)}function wi(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=.5+(r-o)/(2*a),l=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+l*i,e.y=n.y+c*i-l*u}else e.x=n.x+r,e.y=n.y}function Si(n,t){return n.parent==t.parent?1:2}function ki(n){var t=n.children;return t.length?t[0]:n.t}function Ei(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ai(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Ni(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Ci(n,t,e){return n.a.parent===t.parent?n.a:e}function zi(n){return 1+ta.max(n,function(n){return n.y})}function qi(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Li(n){var t=n.children;return t&&t.length?Li(t[0]):n}function Ti(n){var t,e=n.children;return e&&(t=e.length)?Ti(e[t-1]):n}function Ri(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Di(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Pi(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Ui(n){return n.rangeExtent?n.rangeExtent():Pi(n.range())}function ji(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Fi(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function Hi(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:ml}function Oi(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]));return function(t){var e=ta.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function Ii(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Oi:ji,c=r?Iu:Ou;return o=u(n,t,c,e),a=u(t,n,c,mu),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Du)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return Xi(n,t)},i.tickFormat=function(t,e){return $i(n,t,e)},i.nice=function(t){return Zi(n,t),u()},i.copy=function(){return Ii(n,t,e,r)},u()}function Yi(n,t){return ta.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Zi(n,t){return Fi(n,Hi(Vi(n,t)[2]))}function Vi(n,t){null==t&&(t=10);var e=Pi(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function Xi(n,t){return ta.range.apply(ta,Vi(n,t))}function $i(n,t,e){var r=Vi(n,t);if(e){var u=ic.exec(e);if(u.shift(),"s"===u[8]){var i=ta.formatPrefix(Math.max(ga(r[0]),ga(r[1])));return u[7]||(u[7]="."+Bi(i.scale(r[2]))),u[8]="f",e=ta.format(u.join("")),function(n){return e(i.scale(n))+i.symbol}}u[7]||(u[7]="."+Wi(u[8],r)),e=u.join("")}else e=",."+Bi(r[2])+"f";return ta.format(e)}function Bi(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function Wi(n,t){var e=Bi(t[2]);return n in yl?Math.abs(e-Bi(Math.max(ga(t[0]),ga(t[1]))))+ +("e"!==n):e-2*("%"===n)}function Ji(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=Fi(r.map(u),e?Math:xl);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=Pi(r),o=[],a=n[0],c=n[1],l=Math.floor(u(a)),s=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(s-l)){if(e){for(;s>l;l++)for(var h=1;f>h;h++)o.push(i(l)*h);o.push(i(l))}else for(o.push(i(l));l++<s;)for(var h=f-1;h>0;h--)o.push(i(l)*h);for(l=0;o[l]<a;l++);for(s=o.length;o[s-1]>c;s--);o=o.slice(l,s)}return o},o.tickFormat=function(n,t){if(!arguments.length)return Ml;arguments.length<2?t=Ml:"function"!=typeof t&&(t=ta.format(t));var r,a=Math.max(.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return Ji(n.copy(),t,e,r)},Yi(o,n)}function Gi(n,t,e){function r(t){return n(u(t))}var u=Ki(t),i=Ki(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return Xi(e,n)},r.tickFormat=function(n,t){return $i(e,n,t)},r.nice=function(n){return r.domain(Zi(e,n))},r.exponent=function(o){return arguments.length?(u=Ki(t=o),i=Ki(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return Gi(n.copy(),t,e)},Yi(r,n)}function Ki(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function Qi(n,t){function e(e){return i[((u.get(e)||("range"===t.t?u.set(e,n.push(e)):0/0))-1)%i.length]}function r(t,e){return ta.range(n.length).map(function(n){return t+e*n})}var u,i,o;return e.domain=function(r){if(!arguments.length)return n;n=[],u=new l;for(var i,o=-1,a=r.length;++o<a;)u.has(i=r[o])||u.set(i,n.push(i));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(i=n,o=0,t={t:"range",a:arguments},e):i},e.rangePoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=(c+l)/2,0):(l-c)/(n.length-1+a);return i=r(c+s*a/2,s),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=l=Math.round((c+l)/2),0):(l-c)/(n.length-1+a)|0;return i=r(c+Math.round(s*a/2+(l-c-(n.length-1+a)*s)/2),s),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=(f-s)/(n.length-a+2*c);return i=r(s+h*c,h),l&&i.reverse(),o=h*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=Math.floor((f-s)/(n.length-a+2*c));return i=r(s+Math.round((f-s-(n.length-a)*h)/2),h),l&&i.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Pi(t.a[0])},e.copy=function(){return Qi(n,t)},e.domain(n)}function no(n,t){function i(){var e=0,r=t.length;for(a=[];++e<r;)a[e-1]=ta.quantile(n,e/r);return o}function o(n){return isNaN(n=+n)?void 0:t[ta.bisect(a,n)]}var a;return o.domain=function(t){return arguments.length?(n=t.map(r).filter(u).sort(e),i()):n},o.range=function(n){return arguments.length?(t=n,i()):t},o.quantiles=function(){return a},o.invertExtent=function(e){return e=t.indexOf(e),0>e?[0/0,0/0]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},o.copy=function(){return no(n,t)},i()}function to(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return to(n,t,e)},u()}function eo(n,t){function e(e){return e>=e?t[ta.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return eo(n,t)},e}function ro(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Xi(n,t)},t.tickFormat=function(t,e){return $i(n,t,e)},t.copy=function(){return ro(n)},t}function uo(){return 0}function io(n){return n.innerRadius}function oo(n){return n.outerRadius}function ao(n){return n.startAngle}function co(n){return n.endAngle}function lo(n){return n&&n.padAngle}function so(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function fo(n,t,e,r,u){var i=n[0]-t[0],o=n[1]-t[1],a=(u?r:-r)/Math.sqrt(i*i+o*o),c=a*o,l=-a*i,s=n[0]+c,f=n[1]+l,h=t[0]+c,g=t[1]+l,p=(s+h)/2,v=(f+g)/2,d=h-s,m=g-f,y=d*d+m*m,M=e-r,x=s*g-h*f,b=(0>m?-1:1)*Math.sqrt(M*M*y-x*x),_=(x*m-d*b)/y,w=(-x*d-m*b)/y,S=(x*m+d*b)/y,k=(-x*d+m*b)/y,E=_-p,A=w-v,N=S-p,C=k-v;return E*E+A*A>N*N+C*C&&(_=S,w=k),[[_-c,w-l],[_*e/M,w*e/M]]}function ho(n){function t(t){function o(){l.push("M",i(n(s),a))}for(var c,l=[],s=[],f=-1,h=t.length,g=Et(e),p=Et(r);++f<h;)u.call(this,c=t[f],f)?s.push([+g.call(this,c,f),+p.call(this,c,f)]):s.length&&(o(),s=[]);return s.length&&o(),l.length?l.join(""):null}var e=Ar,r=Nr,u=Ne,i=go,o=i.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=El.get(n)||go).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function go(n){return n.join("L")}function po(n){return go(n)+"Z"}function vo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function mo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function yo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function Mo(n,t){return n.length<4?go(n):n[1]+_o(n.slice(1,-1),wo(n,t))}function xo(n,t){return n.length<3?go(n):n[0]+_o((n.push(n[0]),n),wo([n[n.length-2]].concat(n,[n[1]]),t))}function bo(n,t){return n.length<3?go(n):n[0]+_o(n,wo(n,t))}function _o(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return go(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var l=2;l<t.length;l++,c++)i=n[c],a=t[l],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}if(e){var s=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+s[0]+","+s[1]}return r}function wo(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;)e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])]);return r}function So(n){if(n.length<3)return go(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",No(Cl,o),",",No(Cl,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Co(c,o,a);return n.pop(),c.push("L",r),c.join("")}function ko(n){if(n.length<4)return go(n);for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;)t=n[r],i.push(t[0]),o.push(t[1]);for(e.push(No(Cl,i)+","+No(Cl,o)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),Co(e,i,o);return e.join("")}function Eo(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;)e=n[r%u],o.push(e[0]),a.push(e[1]);for(t=[No(Cl,o),",",No(Cl,a)],--r;++r<i;)e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Co(t,o,a);return t.join("")}function Ao(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,l=-1;++l<=e;)r=n[l],u=l/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c);return So(n)}function No(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Co(n,t,e){n.push("C",No(Al,t),",",No(Al,e),",",No(Nl,t),",",No(Nl,e),",",No(Cl,t),",",No(Cl,e))}function zo(n,t){return(t[1]-n[1])/(t[0]-n[0])}function qo(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=zo(u,i);++t<e;)r[t]=(o+(o=zo(u=i,i=n[t+1])))/2;return r[t]=o,r}function Lo(n){for(var t,e,r,u,i=[],o=qo(n),a=-1,c=n.length-1;++a<c;)t=zo(n[a],n[a+1]),ga(t)<Ca?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r));for(a=-1;++a<=c;)u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0]);return i}function To(n){return n.length<3?go(n):n[0]+_o(n,Lo(n))}function Ro(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]-Ra,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Do(n){function t(t){function c(){v.push("M",a(n(m),f),s,l(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,M=t.length,x=Et(e),b=Et(u),_=e===r?function(){return g}:Et(r),w=u===i?function(){return p}:Et(i);++y<M;)o.call(this,h=t[y],y)?(d.push([g=+x.call(this,h,y),p=+b.call(this,h,y)]),m.push([+_.call(this,h,y),+w.call(this,h,y)])):d.length&&(c(),d=[],m=[]);return d.length&&c(),v.length?v.join(""):null}var e=Ar,r=Ar,u=0,i=Nr,o=Ne,a=go,c=a.key,l=a,s="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r
},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=El.get(n)||go).key,l=a.reverse||a,s=a.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Po(n){return n.radius}function Uo(n){return[n.x,n.y]}function jo(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Ra;return[e*Math.cos(r),e*Math.sin(r)]}}function Fo(){return 64}function Ho(){return"circle"}function Oo(n){var t=Math.sqrt(n/qa);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Io(n){return function(){var t,e;(t=this[n])&&(e=t[t.active])&&(--t.count?delete t[t.active]:delete this[n],t.active+=.5,e.event&&e.event.interrupt.call(this,this.__data__,e.index))}}function Yo(n,t,e){return ya(n,Pl),n.namespace=t,n.id=e,n}function Zo(n,t,e,r){var u=n.id,i=n.namespace;return Y(n,"function"==typeof e?function(n,o,a){n[i][u].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[i][u].tween.set(t,e)}))}function Vo(n){return null==n&&(n=""),function(){this.textContent=n}}function Xo(n){return null==n?"__transition__":"__transition_"+n+"__"}function $o(n,t,e,r,u){var i=n[e]||(n[e]={active:0,count:0}),o=i[r];if(!o){var a=u.time;o=i[r]={tween:new l,time:a,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++i.count,ta.timer(function(u){function c(e){if(i.active>r)return s();var u=i[i.active];u&&(--i.count,delete i[i.active],u.event&&u.event.interrupt.call(n,n.__data__,u.index)),i.active=r,o.event&&o.event.start.call(n,n.__data__,t),o.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&v.push(r)}),h=o.ease,f=o.duration,ta.timer(function(){return p.c=l(e||1)?Ne:l,1},0,a)}function l(e){if(i.active!==r)return 1;for(var u=e/f,a=h(u),c=v.length;c>0;)v[--c].call(n,a);return u>=1?(o.event&&o.event.end.call(n,n.__data__,t),s()):void 0}function s(){return--i.count?delete i[r]:delete n[e],1}var f,h,g=o.delay,p=ec,v=[];return p.t=g+a,u>=g?c(u-g):void(p.c=c)},0,a)}}function Bo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function Wo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function Jo(n){return n.toISOString()}function Go(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=ta.bisect(Vl,u);return i==Vl.length?[t.year,Vi(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/Vl[i-1]<Vl[i]/u?i-1:i]:[Bl,Vi(n,e)[2]]}return r.invert=function(t){return Ko(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Ko)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Ko(+e+1),t).length}var i=r.domain(),o=Pi(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(Fi(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Ko(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Ko(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Pi(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],Ko(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Go(n.copy(),t,e)},Yi(r,n)}function Ko(n){return new Date(n)}function Qo(n){return JSON.parse(n.responseText)}function na(n){var t=ua.createRange();return t.selectNode(ua.body),t.createContextualFragment(n.responseText)}var ta={version:"3.5.5"},ea=[].slice,ra=function(n){return ea.call(n)},ua=this.document;if(ua)try{ra(ua.documentElement.childNodes)[0].nodeType}catch(ia){ra=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),ua)try{ua.createElement("DIV").style.setProperty("opacity",0,"")}catch(oa){var aa=this.Element.prototype,ca=aa.setAttribute,la=aa.setAttributeNS,sa=this.CSSStyleDeclaration.prototype,fa=sa.setProperty;aa.setAttribute=function(n,t){ca.call(this,n,t+"")},aa.setAttributeNS=function(n,t,e){la.call(this,n,t,e+"")},sa.setProperty=function(n,t,e){fa.call(this,n,t+"",e)}}ta.ascending=e,ta.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},ta.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},ta.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},ta.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=n[i])&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<o;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},ta.sum=function(n,t){var e,r=0,i=n.length,o=-1;if(1===arguments.length)for(;++o<i;)u(e=+n[o])&&(r+=e);else for(;++o<i;)u(e=+t.call(n,n[o],o))&&(r+=e);return r},ta.mean=function(n,t){var e,i=0,o=n.length,a=-1,c=o;if(1===arguments.length)for(;++a<o;)u(e=r(n[a]))?i+=e:--c;else for(;++a<o;)u(e=r(t.call(n,n[a],a)))?i+=e:--c;return c?i/c:void 0},ta.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},ta.median=function(n,t){var i,o=[],a=n.length,c=-1;if(1===arguments.length)for(;++c<a;)u(i=r(n[c]))&&o.push(i);else for(;++c<a;)u(i=r(t.call(n,n[c],c)))&&o.push(i);return o.length?ta.quantile(o.sort(e),.5):void 0},ta.variance=function(n,t){var e,i,o=n.length,a=0,c=0,l=-1,s=0;if(1===arguments.length)for(;++l<o;)u(e=r(n[l]))&&(i=e-a,a+=i/++s,c+=i*(e-a));else for(;++l<o;)u(e=r(t.call(n,n[l],l)))&&(i=e-a,a+=i/++s,c+=i*(e-a));return s>1?c/(s-1):void 0},ta.deviation=function(){var n=ta.variance.apply(this,arguments);return n?Math.sqrt(n):n};var ha=i(e);ta.bisectLeft=ha.left,ta.bisect=ta.bisectRight=ha.right,ta.bisector=function(n){return i(1===n.length?function(t,r){return e(n(t),r)}:n)},ta.shuffle=function(n,t,e){(i=arguments.length)<3&&(e=n.length,2>i&&(t=0));for(var r,u,i=e-t;i;)u=Math.random()*i--|0,r=n[i+t],n[i+t]=n[u+t],n[u+t]=r;return n},ta.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},ta.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},ta.zip=function(){if(!(r=arguments.length))return[];for(var n=-1,t=ta.min(arguments,o),e=new Array(t);++n<t;)for(var r,u=-1,i=e[n]=new Array(r);++u<r;)i[u]=arguments[u][n];return e},ta.transpose=function(n){return ta.zip.apply(ta,n)},ta.keys=function(n){var t=[];for(var e in n)t.push(e);return t},ta.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},ta.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},ta.merge=function(n){for(var t,e,r,u=n.length,i=-1,o=0;++i<u;)o+=n[i].length;for(e=new Array(o);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--o]=r[t];return e};var ga=Math.abs;ta.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e===1/0)throw new Error("infinite range");var r,u=[],i=a(ga(e)),o=-1;if(n*=i,t*=i,e*=i,0>e)for(;(r=n+e*++o)>t;)u.push(r/i);else for(;(r=n+e*++o)<t;)u.push(r/i);return u},ta.map=function(n,t){var e=new l;if(n instanceof l)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,u=-1,i=n.length;if(1===arguments.length)for(;++u<i;)e.set(u,n[u]);else for(;++u<i;)e.set(t.call(n,r=n[u],u),r)}else for(var o in n)e.set(o,n[o]);return e};var pa="__proto__",va="\x00";c(l,{has:h,get:function(n){return this._[s(n)]},set:function(n,t){return this._[s(n)]=t},remove:g,keys:p,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:f(t),value:this._[t]});return n},size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t),this._[t])}}),ta.nest=function(){function n(t,o,a){if(a>=i.length)return r?r.call(u,o):e?o.sort(e):o;for(var c,s,f,h,g=-1,p=o.length,v=i[a++],d=new l;++g<p;)(h=d.get(c=v(s=o[g])))?h.push(s):d.set(c,[s]);return t?(s=t(),f=function(e,r){s.set(e,n(t,r,a))}):(s={},f=function(e,r){s[e]=n(t,r,a)}),d.forEach(f),s}function t(n,e){if(e>=i.length)return n;var r=[],u=o[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,u={},i=[],o=[];return u.map=function(t,e){return n(e,t,0)},u.entries=function(e){return t(n(ta.map,e,0),0)},u.key=function(n){return i.push(n),u},u.sortKeys=function(n){return o[i.length-1]=n,u},u.sortValues=function(n){return e=n,u},u.rollup=function(n){return r=n,u},u},ta.set=function(n){var t=new m;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},c(m,{has:h,add:function(n){return this._[s(n+="")]=!0,n},remove:g,values:p,size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t))}}),ta.behavior={},ta.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=M(n,t,t[e]);return n};var da=["webkit","ms","moz","Moz","o","O"];ta.dispatch=function(){for(var n=new _,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=w(n);return n},_.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},ta.event=null,ta.requote=function(n){return n.replace(ma,"\\$&")};var ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ya={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},Ma=function(n,t){return t.querySelector(n)},xa=function(n,t){return t.querySelectorAll(n)},ba=function(n,t){var e=n.matches||n[x(n,"matchesSelector")];return(ba=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(Ma=function(n,t){return Sizzle(n,t)[0]||null},xa=Sizzle,ba=Sizzle.matchesSelector),ta.selection=function(){return ta.select(ua.documentElement)};var _a=ta.selection.prototype=[];_a.select=function(n){var t,e,r,u,i=[];n=N(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,l=r.length;++c<l;)(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return A(i)},_a.selectAll=function(n){var t,e,r=[];n=C(n);for(var u=-1,i=this.length;++u<i;)for(var o=this[u],a=-1,c=o.length;++a<c;)(e=o[a])&&(r.push(t=ra(n.call(e,e.__data__,a,u))),t.parentNode=e);return A(r)};var wa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ta.ns={prefix:wa,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.slice(0,t),n=n.slice(t+1)),wa.hasOwnProperty(e)?{space:wa[e],local:n}:n}},_a.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=ta.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(z(t,n[t]));return this}return this.each(z(n,t))},_a.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=T(n)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!L(n[u]).test(t))return!1;return!0}for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},_a.style=function(n,e,r){var u=arguments.length;if(3>u){if("string"!=typeof n){2>u&&(e="");for(r in n)this.each(P(r,n[r],e));return this}if(2>u){var i=this.node();return t(i).getComputedStyle(i,null).getPropertyValue(n)}r=""}return this.each(P(n,e,r))},_a.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(U(t,n[t]));return this}return this.each(U(n,t))},_a.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},_a.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},_a.append=function(n){return n=j(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},_a.insert=function(n,t){return n=j(n),t=N(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},_a.remove=function(){return this.each(F)},_a.data=function(n,t){function e(n,e){var r,u,i,o=n.length,f=e.length,h=Math.min(o,f),g=new Array(f),p=new Array(f),v=new Array(o);if(t){var d,m=new l,y=new Array(o);for(r=-1;++r<o;)m.has(d=t.call(u=n[r],u.__data__,r))?v[r]=u:m.set(d,u),y[r]=d;for(r=-1;++r<f;)(u=m.get(d=t.call(e,i=e[r],r)))?u!==!0&&(g[r]=u,u.__data__=i):p[r]=H(i),m.set(d,!0);for(r=-1;++r<o;)m.get(y[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)u=n[r],i=e[r],u?(u.__data__=i,g[r]=u):p[r]=H(i);for(;f>r;++r)p[r]=H(e[r]);for(;o>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,a.push(p),c.push(g),s.push(v)}var r,u,i=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++i<o;)(u=r[i])&&(n[i]=u.__data__);return n}var a=Z([]),c=A([]),s=A([]);if("function"==typeof n)for(;++i<o;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<o;)e(r=this[i],n);return c.enter=function(){return a},c.exit=function(){return s},c},_a.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},_a.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return A(u)},_a.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},_a.sort=function(n){n=I.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},_a.each=function(n){return Y(this,function(t,e,r){n.call(t,t.__data__,e,r)})},_a.call=function(n){var t=ra(arguments);return n.apply(t[0]=this,t),this},_a.empty=function(){return!this.node()},_a.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},_a.size=function(){var n=0;return Y(this,function(){++n}),n};var Sa=[];ta.selection.enter=Z,ta.selection.enter.prototype=Sa,Sa.append=_a.append,Sa.empty=_a.empty,Sa.node=_a.node,Sa.call=_a.call,Sa.size=_a.size,Sa.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var l=-1,s=u.length;++l<s;)(i=u[l])?(t.push(r[l]=e=n.call(u.parentNode,i.__data__,l,a)),e.__data__=i.__data__):t.push(null)}return A(o)},Sa.insert=function(n,t){return arguments.length<2&&(t=V(this)),_a.insert.call(this,n,t)},ta.select=function(t){var e;return"string"==typeof t?(e=[Ma(t,ua)],e.parentNode=ua.documentElement):(e=[t],e.parentNode=n(t)),A([e])},ta.selectAll=function(n){var t;return"string"==typeof n?(t=ra(xa(n,ua)),t.parentNode=ua.documentElement):(t=n,t.parentNode=null),A([t])},_a.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(X(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(X(n,t,e))};var ka=ta.map({mouseenter:"mouseover",mouseleave:"mouseout"});ua&&ka.forEach(function(n){"on"+n in ua&&ka.remove(n)});var Ea,Aa=0;ta.mouse=function(n){return J(n,k())};var Na=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ta.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=k().changedTouches),t)for(var r,u=0,i=t.length;i>u;++u)if((r=t[u]).identifier===e)return J(n,r)},ta.behavior.drag=function(){function n(){this.on("mousedown.drag",i).on("touchstart.drag",o)}function e(n,t,e,i,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],p|=n|e,M=r,g({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:n,dy:e}))}function c(){t(h,v)&&(m.on(i+d,null).on(o+d,null),y(p&&ta.event.target===f),g({type:"dragend"}))}var l,s=this,f=ta.event.target,h=s.parentNode,g=r.of(s,arguments),p=0,v=n(),d=".drag"+(null==v?"":"-"+v),m=ta.select(e(f)).on(i+d,a).on(o+d,c),y=W(f),M=t(h,v);u?(l=u.apply(s,arguments),l=[l.x-M[0],l.y-M[1]]):l=[0,0],g({type:"dragstart"})}}var r=E(n,"drag","dragstart","dragend"),u=null,i=e(b,ta.mouse,t,"mousemove","mouseup"),o=e(G,ta.touch,y,"touchmove","touchend");return n.origin=function(t){return arguments.length?(u=t,n):u},ta.rebind(n,r,"on")},ta.touches=function(n,t){return arguments.length<2&&(t=k().touches),t?ra(t).map(function(t){var e=J(n,t);return e.identifier=t.identifier,e}):[]};var Ca=1e-6,za=Ca*Ca,qa=Math.PI,La=2*qa,Ta=La-Ca,Ra=qa/2,Da=qa/180,Pa=180/qa,Ua=Math.SQRT2,ja=2,Fa=4;ta.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=rt(v),o=i/(ja*h)*(e*ut(Ua*t+v)-et(v));return[r+o*l,u+o*s,i*e/rt(Ua*t+v)]}return[r+n*l,u+n*s,i*Math.exp(Ua*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],l=o-r,s=a-u,f=l*l+s*s,h=Math.sqrt(f),g=(c*c-i*i+Fa*f)/(2*i*ja*h),p=(c*c-i*i-Fa*f)/(2*c*ja*h),v=Math.log(Math.sqrt(g*g+1)-g),d=Math.log(Math.sqrt(p*p+1)-p),m=d-v,y=(m||Math.log(c/i))/Ua;return e.duration=1e3*y,e},ta.behavior.zoom=function(){function n(n){n.on(q,f).on(Oa+".zoom",g).on("dblclick.zoom",p).on(R,h)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function u(n){k.k=Math.max(N[0],Math.min(N[1],n))}function i(n,t){t=r(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function o(t,e,r,o){t.__chart__={x:k.x,y:k.y,k:k.k},u(Math.pow(2,o)),i(d=e,r),t=ta.select(t),C>0&&(t=t.transition().duration(C)),t.call(n.event)}function a(){b&&b.domain(x.range().map(function(n){return(n-k.x)/k.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function c(n){z++||n({type:"zoomstart"})}function l(n){a(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function s(n){--z||n({type:"zoomend"}),d=null}function f(){function n(){f=1,i(ta.mouse(u),g),l(a)}function r(){h.on(L,null).on(T,null),p(f&&ta.event.target===o),s(a)}var u=this,o=ta.event.target,a=D.of(u,arguments),f=0,h=ta.select(t(u)).on(L,n).on(T,r),g=e(ta.mouse(u)),p=W(u);Dl.call(u),c(a)}function h(){function n(){var n=ta.touches(p);return g=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=ta.event.target;ta.select(t).on(x,r).on(b,a),_.push(t);for(var e=ta.event.changedTouches,u=0,i=e.length;i>u;++u)d[e[u].identifier]=null;var c=n(),l=Date.now();if(1===c.length){if(500>l-M){var s=c[0];o(p,s,d[s.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),S()}M=l}else if(c.length>1){var s=c[0],f=c[1],h=s[0]-f[0],g=s[1]-f[1];m=h*h+g*g}}function r(){var n,t,e,r,o=ta.touches(p);Dl.call(p);for(var a=0,c=o.length;c>a;++a,r=null)if(e=o[a],r=d[e.identifier]){if(t)break;n=e,t=r}if(r){var s=(s=e[0]-n[0])*s+(s=e[1]-n[1])*s,f=m&&Math.sqrt(s/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],u(f*g)}M=null,i(n,t),l(v)}function a(){if(ta.event.touches.length){for(var t=ta.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var u in d)return void n()}ta.selectAll(_).on(y,null),w.on(q,f).on(R,h),E(),s(v)}var g,p=this,v=D.of(p,arguments),d={},m=0,y=".zoom-"+ta.event.changedTouches[0].identifier,x="touchmove"+y,b="touchend"+y,_=[],w=ta.select(p),E=W(p);t(),c(v),w.on(q,null).on(R,t)}function g(){var n=D.of(this,arguments);y?clearTimeout(y):(v=e(d=m||ta.mouse(this)),Dl.call(this),c(n)),y=setTimeout(function(){y=null,s(n)},50),S(),u(Math.pow(2,.002*Ha())*k.k),i(d,v),l(n)}function p(){var n=ta.mouse(this),t=Math.log(k.k)/Math.LN2;o(this,n,e(n),ta.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var v,d,m,y,M,x,b,_,w,k={x:0,y:0,k:1},A=[960,500],N=Ia,C=250,z=0,q="mousedown.zoom",L="mousemove.zoom",T="mouseup.zoom",R="touchstart.zoom",D=E(n,"zoomstart","zoom","zoomend");return Oa||(Oa="onwheel"in ua?(Ha=function(){return-ta.event.deltaY*(ta.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ua?(Ha=function(){return ta.event.wheelDelta},"mousewheel"):(Ha=function(){return-ta.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=D.of(this,arguments),t=k;Tl?ta.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},c(n)}).tween("zoom:zoom",function(){var e=A[0],r=A[1],u=d?d[0]:e/2,i=d?d[1]:r/2,o=ta.interpolateZoom([(u-k.x)/k.k,(i-k.y)/k.k,e/k.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:u-r[0]*a,y:i-r[1]*a,k:a},l(n)}}).each("interrupt.zoom",function(){s(n)}).each("end.zoom",function(){s(n)}):(this.__chart__=k,c(n),l(n),s(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},a(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:+t},a(),n):k.k},n.scaleExtent=function(t){return arguments.length?(N=null==t?Ia:[+t[0],+t[1]],n):N},n.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],n):m},n.size=function(t){return arguments.length?(A=t&&[+t[0],+t[1]],n):A},n.duration=function(t){return arguments.length?(C=+t,n):C},n.x=function(t){return arguments.length?(b=t,x=t.copy(),k={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),k={x:0,y:0,k:1},n):w},ta.rebind(n,D,"on")};var Ha,Oa,Ia=[0,1/0];ta.color=ot,ot.prototype.toString=function(){return this.rgb()+""},ta.hsl=at;var Ya=at.prototype=new ot;Ya.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new at(this.h,this.s,this.l/n)},Ya.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new at(this.h,this.s,n*this.l)},Ya.rgb=function(){return ct(this.h,this.s,this.l)},ta.hcl=lt;var Za=lt.prototype=new ot;Za.brighter=function(n){return new lt(this.h,this.c,Math.min(100,this.l+Va*(arguments.length?n:1)))},Za.darker=function(n){return new lt(this.h,this.c,Math.max(0,this.l-Va*(arguments.length?n:1)))},Za.rgb=function(){return st(this.h,this.c,this.l).rgb()},ta.lab=ft;var Va=18,Xa=.95047,$a=1,Ba=1.08883,Wa=ft.prototype=new ot;Wa.brighter=function(n){return new ft(Math.min(100,this.l+Va*(arguments.length?n:1)),this.a,this.b)},Wa.darker=function(n){return new ft(Math.max(0,this.l-Va*(arguments.length?n:1)),this.a,this.b)},Wa.rgb=function(){return ht(this.l,this.a,this.b)},ta.rgb=mt;var Ja=mt.prototype=new ot;Ja.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),new mt(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new mt(u,u,u)},Ja.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new mt(n*this.r,n*this.g,n*this.b)},Ja.hsl=function(){return _t(this.r,this.g,this.b)},Ja.toString=function(){return"#"+xt(this.r)+xt(this.g)+xt(this.b)};var Ga=ta.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ga.forEach(function(n,t){Ga.set(n,yt(t))}),ta.functor=Et,ta.xhr=At(y),ta.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=Nt(n,t,null==e?r:u(e),i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function i(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),c=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(s>=l)return o;if(u)return u=!1,i;var t=s;if(34===n.charCodeAt(t)){for(var e=t;e++<l;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}s=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++s):10===r&&(u=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;l>s;){var r=n.charCodeAt(s++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(s)&&(++s,++a);else if(r!==c)continue;return n.slice(t,s-a)}return n.slice(t)}for(var r,u,i={},o={},a=[],l=n.length,s=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,f++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new m,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(o).join(n)].concat(t.map(function(t){return u.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(i).join("\n")},e},ta.csv=ta.dsv(",","text/csv"),ta.tsv=ta.dsv("	","text/tab-separated-values");var Ka,Qa,nc,tc,ec,rc=this[x(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};ta.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,f:!1,n:null};Qa?Qa.n=i:Ka=i,Qa=i,nc||(tc=clearTimeout(tc),nc=1,rc(qt))},ta.timer.flush=function(){Lt(),Tt()},ta.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var uc=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Dt);ta.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=ta.round(n,Rt(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),uc[8+e/3]};var ic=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,oc=ta.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=ta.round(n,Rt(n,t))).toFixed(Math.max(0,Math.min(20,Rt(n*(1+1e-15),t))))}}),ac=ta.time={},cc=Date;jt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){lc.setUTCDate.apply(this._,arguments)},setDay:function(){lc.setUTCDay.apply(this._,arguments)},setFullYear:function(){lc.setUTCFullYear.apply(this._,arguments)},setHours:function(){lc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){lc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){lc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){lc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){lc.setUTCSeconds.apply(this._,arguments)},setTime:function(){lc.setTime.apply(this._,arguments)}};var lc=Date.prototype;ac.year=Ft(function(n){return n=ac.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),ac.years=ac.year.range,ac.years.utc=ac.year.utc.range,ac.day=Ft(function(n){var t=new cc(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),ac.days=ac.day.range,ac.days.utc=ac.day.utc.range,ac.dayOfYear=function(n){var t=ac.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=ac[n]=Ft(function(n){return(n=ac.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=ac.year(n).getDay();return Math.floor((ac.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});ac[n+"s"]=e.range,ac[n+"s"].utc=e.utc.range,ac[n+"OfYear"]=function(n){var e=ac.year(n).getDay();return Math.floor((ac.dayOfYear(n)+(e+t)%7)/7)}}),ac.week=ac.sunday,ac.weeks=ac.sunday.range,ac.weeks.utc=ac.sunday.utc.range,ac.weekOfYear=ac.sundayOfYear;var sc={"-":"",_:" ",0:"0"},fc=/^\s*\d+/,hc=/^%/;ta.locale=function(n){return{numberFormat:Pt(n),timeFormat:Ot(n)}};var gc=ta.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ta.format=gc.numberFormat,ta.geo={},ce.prototype={s:0,t:0,add:function(n){le(n,this.t,pc),le(pc.s,this.s,this),this.s?this.t+=pc.t:this.s=pc.t
},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var pc=new ce;ta.geo.stream=function(n,t){n&&vc.hasOwnProperty(n.type)?vc[n.type](n,t):se(n,t)};var vc={Feature:function(n,t){se(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)se(e[r].geometry,t)}},dc={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){fe(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)fe(e[r],t,0)},Polygon:function(n,t){he(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)he(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)se(e[r],t)}};ta.geo.area=function(n){return mc=0,ta.geo.stream(n,Mc),mc};var mc,yc=new ce,Mc={sphere:function(){mc+=4*qa},point:b,lineStart:b,lineEnd:b,polygonStart:function(){yc.reset(),Mc.lineStart=ge},polygonEnd:function(){var n=2*yc;mc+=0>n?4*qa+n:n,Mc.lineStart=Mc.lineEnd=Mc.point=b}};ta.geo.bounds=function(){function n(n,t){M.push(x=[s=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=pe([t*Da,e*Da]);if(m){var u=de(m,r),i=[u[1],-u[0],0],o=de(i,u);Me(o),o=xe(o);var c=t-p,l=c>0?1:-1,v=o[0]*Pa*l,d=ga(c)>180;if(d^(v>l*p&&l*t>v)){var y=o[1]*Pa;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>l*p&&l*t>v)){var y=-o[1]*Pa;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t):h>=s?(s>t&&(s=t),t>h&&(h=t)):t>p?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t)}else n(t,e);m=r,p=t}function e(){b.point=t}function r(){x[0]=s,x[1]=h,b.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=ga(r)>180?r+(r>0?360:-360):r}else v=n,d=e;Mc.point(n,e),t(n,e)}function i(){Mc.lineStart()}function o(){u(v,d),Mc.lineEnd(),ga(y)>Ca&&(s=-(h=180)),x[0]=s,x[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var s,f,h,g,p,v,d,m,y,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=u,b.lineStart=i,b.lineEnd=o,y=0,Mc.polygonStart()},polygonEnd:function(){Mc.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>yc?(s=-(h=180),f=-(g=90)):y>Ca?g=90:-Ca>y&&(f=-90),x[0]=s,x[1]=h}};return function(n){g=h=-(s=f=1/0),M=[],ta.geo.stream(n,b);var t=M.length;if(t){M.sort(c);for(var e,r=1,u=M[0],i=[u];t>r;++r)e=M[r],l(e[0],u)||l(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(o=a(u[1],e[0]))>p&&(p=o,s=e[0],h=u[1])}return M=x=null,1/0===s||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[s,f],[h,g]]}}(),ta.geo.centroid=function(n){xc=bc=_c=wc=Sc=kc=Ec=Ac=Nc=Cc=zc=0,ta.geo.stream(n,qc);var t=Nc,e=Cc,r=zc,u=t*t+e*e+r*r;return za>u&&(t=kc,e=Ec,r=Ac,Ca>bc&&(t=_c,e=wc,r=Sc),u=t*t+e*e+r*r,za>u)?[0/0,0/0]:[Math.atan2(e,t)*Pa,tt(r/Math.sqrt(u))*Pa]};var xc,bc,_c,wc,Sc,kc,Ec,Ac,Nc,Cc,zc,qc={sphere:b,point:_e,lineStart:Se,lineEnd:ke,polygonStart:function(){qc.lineStart=Ee},polygonEnd:function(){qc.lineStart=Se}},Lc=Le(Ne,Pe,je,[-qa,-qa/2]),Tc=1e9;ta.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=Ie(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(ta.geo.conicEqualArea=function(){return Ye(Ze)}).raw=Ze,ta.geo.albers=function(){return ta.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ta.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=ta.geo.albers(),o=ta.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ta.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?o:u>=.166&&.234>u&&r>=-.214&&-.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var l=i.scale(),s=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[s-.455*l,f-.238*l],[s+.455*l,f+.238*l]]).stream(c).point,r=o.translate([s-.307*l,f+.201*l]).clipExtent([[s-.425*l+Ca,f+.12*l+Ca],[s-.214*l-Ca,f+.234*l-Ca]]).stream(c).point,u=a.translate([s-.205*l,f+.212*l]).clipExtent([[s-.214*l+Ca,f+.166*l+Ca],[s-.115*l-Ca,f+.234*l-Ca]]).stream(c).point,n},n.scale(1070)};var Rc,Dc,Pc,Uc,jc,Fc,Hc={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Dc=0,Hc.lineStart=Ve},polygonEnd:function(){Hc.lineStart=Hc.lineEnd=Hc.point=b,Rc+=ga(Dc/2)}},Oc={point:Xe,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Ic={point:We,lineStart:Je,lineEnd:Ge,polygonStart:function(){Ic.lineStart=Ke},polygonEnd:function(){Ic.point=We,Ic.lineStart=Je,Ic.lineEnd=Ge}};ta.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),ta.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return Rc=0,ta.geo.stream(n,u(Hc)),Rc},n.centroid=function(n){return _c=wc=Sc=kc=Ec=Ac=Nc=Cc=zc=0,ta.geo.stream(n,u(Ic)),zc?[Nc/zc,Cc/zc]:Ac?[kc/Ac,Ec/Ac]:Sc?[_c/Sc,wc/Sc]:[0/0,0/0]},n.bounds=function(n){return jc=Fc=-(Pc=Uc=1/0),ta.geo.stream(n,u(Oc)),[[Pc,Uc],[jc,Fc]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||tr(n):y,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new $e:new Qe(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(ta.geo.albersUsa()).context(null)},ta.geo.transform=function(n){return{stream:function(t){var e=new er(t);for(var r in n)e[r]=n[r];return e}}},er.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ta.geo.projection=ur,ta.geo.projectionMutator=ir,(ta.geo.equirectangular=function(){return ur(ar)}).raw=ar.invert=ar,ta.geo.rotation=function(n){function t(t){return t=n(t[0]*Da,t[1]*Da),t[0]*=Pa,t[1]*=Pa,t}return n=lr(n[0]%360*Da,n[1]*Da,n.length>2?n[2]*Da:0),t.invert=function(t){return t=n.invert(t[0]*Da,t[1]*Da),t[0]*=Pa,t[1]*=Pa,t},t},cr.invert=ar,ta.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=lr(-n[0]*Da,-n[1]*Da,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Pa,n[1]*=Pa}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=gr((t=+r)*Da,u*Da),n):t},n.precision=function(r){return arguments.length?(e=gr(t*Da,(u=+r)*Da),n):u},n.angle(90)},ta.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Da,u=n[1]*Da,i=t[1]*Da,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),l=Math.cos(u),s=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=l*s-c*f*a)*e),c*s+l*f*a)},ta.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return ta.range(Math.ceil(i/d)*d,u,d).map(h).concat(ta.range(Math.ceil(l/m)*m,c,m).map(g)).concat(ta.range(Math.ceil(r/p)*p,e,p).filter(function(n){return ga(n%d)>Ca}).map(s)).concat(ta.range(Math.ceil(a/v)*v,o,v).filter(function(n){return ga(n%m)>Ca}).map(f))}var e,r,u,i,o,a,c,l,s,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(l).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],l=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),l>c&&(t=l,l=c,c=t),n.precision(y)):[[i,l],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,s=vr(a,o,90),f=dr(r,e,y),h=vr(l,c,90),g=dr(i,u,y),n):y},n.majorExtent([[-180,-90+Ca],[180,90-Ca]]).minorExtent([[-180,-80-Ca],[180,80+Ca]])},ta.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=mr,u=yr;return n.distance=function(){return ta.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},ta.geo.interpolate=function(n,t){return Mr(n[0]*Da,n[1]*Da,t[0]*Da,t[1]*Da)},ta.geo.length=function(n){return Yc=0,ta.geo.stream(n,Zc),Yc};var Yc,Zc={sphere:b,point:b,lineStart:xr,lineEnd:b,polygonStart:b,polygonEnd:b},Vc=br(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(ta.geo.azimuthalEqualArea=function(){return ur(Vc)}).raw=Vc;var Xc=br(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},y);(ta.geo.azimuthalEquidistant=function(){return ur(Xc)}).raw=Xc,(ta.geo.conicConformal=function(){return Ye(_r)}).raw=_r,(ta.geo.conicEquidistant=function(){return Ye(wr)}).raw=wr;var $c=br(function(n){return 1/n},Math.atan);(ta.geo.gnomonic=function(){return ur($c)}).raw=$c,Sr.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Ra]},(ta.geo.mercator=function(){return kr(Sr)}).raw=Sr;var Bc=br(function(){return 1},Math.asin);(ta.geo.orthographic=function(){return ur(Bc)}).raw=Bc;var Wc=br(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(ta.geo.stereographic=function(){return ur(Wc)}).raw=Wc,Er.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Ra]},(ta.geo.transverseMercator=function(){var n=kr(Er),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Er,ta.geom={},ta.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u=Et(e),i=Et(r),o=n.length,a=[],c=[];for(t=0;o>t;t++)a.push([+u.call(this,n[t],t),+i.call(this,n[t],t),t]);for(a.sort(zr),t=0;o>t;t++)c.push([a[t][0],-a[t][1]]);var l=Cr(a),s=Cr(c),f=s[0]===l[0],h=s[s.length-1]===l[l.length-1],g=[];for(t=l.length-1;t>=0;--t)g.push(n[a[l[t]][2]]);for(t=+f;t<s.length-h;++t)g.push(n[a[s[t]][2]]);return g}var e=Ar,r=Nr;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},ta.geom.polygon=function(n){return ya(n,Jc),n};var Jc=ta.geom.polygon.prototype=[];Jc.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},Jc.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[i*n,o*n]},Jc.clip=function(n){for(var t,e,r,u,i,o,a=Tr(n),c=-1,l=this.length-Tr(this),s=this[l-1];++c<l;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],qr(o,s,u)?(qr(i,s,u)||n.push(Lr(i,o,s,u)),n.push(o)):qr(i,s,u)&&n.push(Lr(i,o,s,u)),i=o;a&&n.push(n[0]),s=u}return n};var Gc,Kc,Qc,nl,tl,el=[],rl=[];Or.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Yr),t.length},Qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},nu.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=uu(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(eu(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ru(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(ru(this,e),n=e,e=n.U),e.C=!1,r.C=!0,eu(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,o=n.R;if(e=i?o?uu(o):i:o,u?u.L===n?u.L=e:u.R=e:this._=e,i&&o?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==o?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=o,o.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,eu(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ru(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,eu(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,ru(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,eu(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,ru(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},ta.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],u=a[0][1],i=a[1][0],o=a[1][1];return iu(e(n),a).cells.forEach(function(e,a){var c=e.edges,l=e.site,s=t[a]=c.length?c.map(function(n){var t=n.start();return[t.x,t.y]}):l.x>=r&&l.x<=i&&l.y>=u&&l.y<=o?[[r,o],[i,o],[i,u],[r,u]]:[];s.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/Ca)*Ca,y:Math.round(o(n,t)/Ca)*Ca,i:t}})}var r=Ar,u=Nr,i=r,o=u,a=ul;return n?t(n):(t.links=function(n){return iu(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return iu(e(n)).cells.forEach(function(e,r){for(var u,i,o=e.site,a=e.edges.sort(Yr),c=-1,l=a.length,s=a[l-1].edge,f=s.l===o?s.r:s.l;++c<l;)u=s,i=f,s=a[c].edge,f=s.l===o?s.r:s.l,r<i.i&&r<f.i&&au(o,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=Et(r=n),t):r},t.y=function(n){return arguments.length?(o=Et(u=n),t):u},t.clipExtent=function(n){return arguments.length?(a=null==n?ul:n,t):a===ul?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===ul?null:a&&a[1]},t)};var ul=[[-1e6,-1e6],[1e6,1e6]];ta.geom.delaunay=function(n){return ta.geom.voronoi().triangles(n)},ta.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var c=n.x,s=n.y;if(null!=c)if(ga(c-e)+ga(s-r)<.01)l(n,t,e,r,u,i,o,a);else{var f=n.point;n.x=n.y=n.point=null,l(n,f,c,s,u,i,o,a),l(n,t,e,r,u,i,o,a)}else n.x=e,n.y=r,n.point=t}else l(n,t,e,r,u,i,o,a)}function l(n,t,e,r,u,o,a,c){var l=.5*(u+a),s=.5*(o+c),f=e>=l,h=r>=s,g=h<<1|f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=su()),f?u=l:a=l,h?o=s:c=s,i(n,t,e,r,u,o,a,c)}var s,f,h,g,p,v,d,m,y,M=Et(a),x=Et(c);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,o)for(g=0;p>g;++g)s=n[g],s.x<v&&(v=s.x),s.y<d&&(d=s.y),s.x>m&&(m=s.x),s.y>y&&(y=s.y),f.push(s.x),h.push(s.y);else for(g=0;p>g;++g){var b=+M(s=n[g],g),_=+x(s,g);v>b&&(v=b),d>_&&(d=_),b>m&&(m=b),_>y&&(y=_),f.push(b),h.push(_)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=su();if(k.add=function(n){i(k,n,+M(n,++g),+x(n,g),v,d,m,y)},k.visit=function(n){fu(n,k,v,d,m,y)},k.find=function(n){return hu(k,n[0],n[1],v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=s=null,k}var o,a=Ar,c=Nr;return(o=arguments.length)?(a=cu,c=lu,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},ta.interpolateRgb=gu,ta.interpolateObject=pu,ta.interpolateNumber=vu,ta.interpolateString=du;var il=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ol=new RegExp(il.source,"g");ta.interpolate=mu,ta.interpolators=[function(n,t){var e=typeof t;return("string"===e?Ga.has(t)||/^(#|rgb\(|hsl\()/.test(t)?gu:du:t instanceof ot?gu:Array.isArray(t)?yu:"object"===e&&isNaN(t)?pu:vu)(n,t)}],ta.interpolateArray=yu;var al=function(){return y},cl=ta.map({linear:al,poly:ku,quad:function(){return _u},cubic:function(){return wu},sin:function(){return Eu},exp:function(){return Au},circle:function(){return Nu},elastic:Cu,back:zu,bounce:function(){return qu}}),ll=ta.map({"in":y,out:xu,"in-out":bu,"out-in":function(n){return bu(xu(n))}});ta.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=cl.get(e)||al,r=ll.get(r)||y,Mu(r(e.apply(null,ea.call(arguments,1))))},ta.interpolateHcl=Lu,ta.interpolateHsl=Tu,ta.interpolateLab=Ru,ta.interpolateRound=Du,ta.transform=function(n){var t=ua.createElementNS(ta.ns.prefix.svg,"g");return(ta.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Pu(e?e.matrix:sl)})(n)},Pu.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var sl={a:1,b:0,c:0,d:1,e:0,f:0};ta.interpolateTransform=Hu,ta.layout={},ta.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Yu(n[e]));return t}},ta.layout.chord=function(){function n(){var n,l,f,h,g,p={},v=[],d=ta.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(l=0,g=-1;++g<i;)l+=u[h][g];v.push(l),m.push(ta.range(i)),n+=l}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(La-s*i)/n,l=0,h=-1;++h<i;){for(f=l,g=-1;++g<i;){var y=d[h],M=m[y][g],x=u[y][M],b=l,_=l+=x*n;p[y+"-"+M]={index:y,subindex:M,startAngle:b,endAngle:_,value:x}}r[y]={index:y,startAngle:f,endAngle:l,value:(l-f)/n},l+=s}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,l={},s=0;return l.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,l):u},l.padding=function(n){return arguments.length?(s=n,e=r=null,l):s},l.sortGroups=function(n){return arguments.length?(o=n,e=r=null,l):o},l.sortSubgroups=function(n){return arguments.length?(a=n,e=null,l):a},l.sortChords=function(n){return arguments.length?(c=n,e&&t(),l):c},l.chords=function(){return e||n(),e},l.groups=function(){return r||n(),r},l},ta.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=u-e,c=i*i+o*o;if(c>a*a/d){if(p>c){var l=t.charge/c;n.px-=i*l,n.py-=o*l}return!0}if(t.point&&c&&p>c){var l=t.pointCharge/c;n.px-=i*l,n.py-=o*l}}return!t.charge}}function t(n){n.px=ta.event.x,n.py=ta.event.y,a.resume()}var e,r,u,i,o,a={},c=ta.dispatch("start","tick","end"),l=[1,1],s=.9,f=fl,h=hl,g=-30,p=gl,v=.1,d=.64,m=[],M=[];return a.tick=function(){if((r*=.99)<.005)return c.end({type:"end",alpha:r=0}),!0;var t,e,a,f,h,p,d,y,x,b=m.length,_=M.length;for(e=0;_>e;++e)a=M[e],f=a.source,h=a.target,y=h.x-f.x,x=h.y-f.y,(p=y*y+x*x)&&(p=r*i[e]*((p=Math.sqrt(p))-u[e])/p,y*=p,x*=p,h.x-=y*(d=f.weight/(h.weight+f.weight)),h.y-=x*d,f.x+=y*(d=1-d),f.y+=x*d);if((d=r*v)&&(y=l[0]/2,x=l[1]/2,e=-1,d))for(;++e<b;)a=m[e],a.x+=(y-a.x)*d,a.y+=(x-a.y)*d;if(g)for(Ju(t=ta.geom.quadtree(m),r,o),e=-1;++e<b;)(a=m[e]).fixed||t.visit(n(a));for(e=-1;++e<b;)a=m[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*s,a.y-=(a.py-(a.py=a.y))*s);c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(m=n,a):m},a.links=function(n){return arguments.length?(M=n,a):M},a.size=function(n){return arguments.length?(l=n,a):l},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(s=+n,a):s},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.chargeDistance=function(n){return arguments.length?(p=n*n,a):Math.sqrt(p)},a.gravity=function(n){return arguments.length?(v=+n,a):v},a.theta=function(n){return arguments.length?(d=n*n,a):Math.sqrt(d)},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),ta.timer(a.tick)),a):r},a.start=function(){function n(n,r){if(!e){for(e=new Array(c),a=0;c>a;++a)e[a]=[];for(a=0;s>a;++a){var u=M[a];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var i,o=e[t],a=-1,l=o.length;++a<l;)if(!isNaN(i=o[a][n]))return i;return Math.random()*r}var t,e,r,c=m.length,s=M.length,p=l[0],v=l[1];for(t=0;c>t;++t)(r=m[t]).index=t,r.weight=0;for(t=0;s>t;++t)r=M[t],"number"==typeof r.source&&(r.source=m[r.source]),"number"==typeof r.target&&(r.target=m[r.target]),++r.source.weight,++r.target.weight;for(t=0;c>t;++t)r=m[t],isNaN(r.x)&&(r.x=n("x",p)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof f)for(t=0;s>t;++t)u[t]=+f.call(this,M[t],t);else for(t=0;s>t;++t)u[t]=f;if(i=[],"function"==typeof h)for(t=0;s>t;++t)i[t]=+h.call(this,M[t],t);else for(t=0;s>t;++t)i[t]=h;if(o=[],"function"==typeof g)for(t=0;c>t;++t)o[t]=+g.call(this,m[t],t);else for(t=0;c>t;++t)o[t]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=ta.behavior.drag().origin(y).on("dragstart.force",Xu).on("drag.force",t).on("dragend.force",$u)),arguments.length?void this.on("mouseover.force",Bu).on("mouseout.force",Wu).call(e):e},ta.rebind(a,c,"on")};var fl=20,hl=1,gl=1/0;ta.layout.hierarchy=function(){function n(u){var i,o=[u],a=[];for(u.depth=0;null!=(i=o.pop());)if(a.push(i),(l=e.call(n,i,i.depth))&&(c=l.length)){for(var c,l,s;--c>=0;)o.push(s=l[c]),s.parent=i,s.depth=i.depth+1;r&&(i.value=0),i.children=l}else r&&(i.value=+r.call(n,i,i.depth)||0),delete i.children;return Qu(u,function(n){var e,u;t&&(e=n.children)&&e.sort(t),r&&(u=n.parent)&&(u.value+=n.value)}),a}var t=ei,e=ni,r=ti;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(Ku(t,function(n){n.children&&(n.value=0)}),Qu(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},ta.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,l=-1;for(r=t.value?r/t.value:0;++l<o;)n(a=i[l],e,c=a.value*r,u),e+=c}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=ta.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},Gu(e,r)},ta.layout.pie=function(){function n(o){var a,c=o.length,l=o.map(function(e,r){return+t.call(n,e,r)}),s=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof u?u.apply(this,arguments):u)-s,h=Math.min(Math.abs(f)/c,+("function"==typeof i?i.apply(this,arguments):i)),g=h*(0>f?-1:1),p=(f-c*g)/ta.sum(l),v=ta.range(c),d=[];return null!=e&&v.sort(e===pl?function(n,t){return l[t]-l[n]}:function(n,t){return e(o[n],o[t])}),v.forEach(function(n){d[n]={data:o[n],value:a=l[n],startAngle:s,endAngle:s+=a*p+g,padAngle:h}}),d}var t=Number,e=pl,r=0,u=La,i=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n.padAngle=function(t){return arguments.length?(i=t,n):i},n};var pl={};ta.layout.stack=function(){function n(a,c){if(!(h=a.length))return a;var l=a.map(function(e,r){return t.call(n,e,r)}),s=l.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,s,c);l=ta.permute(l,f),s=ta.permute(s,f);var h,g,p,v,d=r.call(n,s,c),m=l[0].length;for(p=0;m>p;++p)for(u.call(n,l[0][p],v=d[p],s[0][p][1]),g=1;h>g;++g)u.call(n,l[g][p],v+=s[g-1][p][1],s[g][p][1]);return a}var t=y,e=ai,r=ci,u=oi,i=ui,o=ii;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:vl.get(t)||ai,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:dl.get(t)||ci,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var vl=ta.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(li),i=n.map(si),o=ta.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,l=[],s=[];for(t=0;r>t;++t)e=o[t],c>a?(a+=i[e],l.push(e)):(c+=i[e],s.push(e));return s.reverse().concat(l)},reverse:function(n){return ta.range(n.length).reverse()},"default":ai}),dl=ta.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;i>e;++e)c[e]=(a-o[e])/2;return c},wiggle:function(n){var t,e,r,u,i,o,a,c,l,s=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=l=0,e=1;h>e;++e){for(t=0,u=0;s>t;++t)u+=n[t][e][1];for(t=0,i=0,a=f[e][0]-f[e-1][0];s>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,l>c&&(l=c)}for(e=0;h>e;++e)g[e]-=l;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=o}for(e=0;i>e;++e)a[e]=0;return a},zero:ci});ta.layout.histogram=function(){function n(n,i){for(var o,a,c=[],l=n.map(e,this),s=r.call(this,l,i),f=u.call(this,s,l,i),i=-1,h=l.length,g=f.length-1,p=t?1:1/h;++i<g;)o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0;if(g>0)for(i=-1;++i<h;)a=l[i],a>=s[0]&&a<=s[1]&&(o=c[ta.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]));return c}var t=!0,e=Number,r=pi,u=hi;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=Et(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return gi(n,t)}:Et(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},ta.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],l=u[1],s=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Qu(a,function(n){n.r=+s(n.value)}),Qu(a,Mi),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/l))/2;Qu(a,function(n){n.r+=f}),Qu(a,Mi),Qu(a,function(n){n.r-=f})}return _i(a,c/2,l/2,t?1:1/Math.max(2*a.r/c,2*a.r/l)),o}var t,e=ta.layout.hierarchy().sort(vi),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},Gu(n,e)},ta.layout.tree=function(){function n(n,u){var s=o.call(this,n,u),f=s[0],h=t(f);if(Qu(h,e),h.parent.m=-h.z,Ku(h,r),l)Ku(f,i);else{var g=f,p=f,v=f;Ku(f,function(n){n.x<g.x&&(g=n),n.x>p.x&&(p=n),n.depth>v.depth&&(v=n)});var d=a(g,p)/2-g.x,m=c[0]/(p.x+a(p,g)/2+d),y=c[1]/(v.depth||1);Ku(f,function(n){n.x=(n.x+d)*m,n.y=n.depth*y})}return s}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var u,i=t.children,o=0,a=i.length;a>o;++o)r.push((i[o]=u={_:i[o],parent:t,children:(u=i[o].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=u);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Ni(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+a(n._,r._));n.parent.A=u(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,t,e){if(t){for(var r,u=n,i=n,o=t,c=u.parent.children[0],l=u.m,s=i.m,f=o.m,h=c.m;o=Ei(o),u=ki(u),o&&u;)c=ki(c),i=Ei(i),i.a=n,r=o.z+f-u.z-l+a(o._,u._),r>0&&(Ai(Ci(o,n,e),n,r),l+=r,s+=r),f+=o.m,l+=u.m,h+=c.m,s+=i.m;o&&!Ei(i)&&(i.t=o,i.m+=f-s),u&&!ki(c)&&(c.t=u,c.m+=l-h,e=n)}return e}function i(n){n.x*=c[0],n.y=n.depth*c[1]}var o=ta.layout.hierarchy().sort(null).value(null),a=Si,c=[1,1],l=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(l=null==(c=t)?i:null,n):l?null:c},n.nodeSize=function(t){return arguments.length?(l=null==(c=t)?null:i,n):l?c:null},Gu(n,o)},ta.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],l=0;Qu(c,function(n){var t=n.children;t&&t.length?(n.x=qi(t),n.y=zi(t)):(n.x=o?l+=e(n,o):0,n.y=0,o=n)});var s=Li(c),f=Ti(c),h=s.x-e(s,f)/2,g=f.x+e(f,s)/2;return Qu(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=ta.layout.hierarchy().sort(null).value(null),e=Si,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},Gu(n,t)},ta.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var o,a,c,l=f(e),s=[],h=i.slice(),p=1/0,v="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(n(h,l.dx*l.dy/e.value),s.area=0;(c=h.length)>0;)s.push(o=h[c-1]),s.area+=o.area,"squarify"!==g||(a=r(s,v))<=p?(h.pop(),p=a):(s.area-=s.pop().area,u(s,v,l,!1),v=Math.min(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(u(s,v,l,!0),s.length=s.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();)c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,l=e.y,s=t?c(n.area/t):0;if(t==e.dx){for((r||s>e.dy)&&(s=e.dy);++i<o;)u=n[i],u.x=a,u.y=l,u.dy=s,a+=u.dx=Math.min(e.x+e.dx-a,s?c(u.area/s):0);u.z=!0,u.dx+=e.x+e.dx-a,e.y+=s,e.dy-=s}else{for((r||s>e.dx)&&(s=e.dx);++i<o;)u=n[i],u.x=a,u.y=l,u.dx=s,l+=u.dy=Math.min(e.y+e.dy-l,s?c(u.area/s):0);u.z=!1,u.dy+=e.y+e.dy-l,e.x+=s,e.dx-=s}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=l[0],i.dy=l[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=ta.layout.hierarchy(),c=Math.round,l=[1,1],s=null,f=Ri,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));
return i.size=function(n){return arguments.length?(l=n,i):l},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Ri(t):Di(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Di(t,n)}if(!arguments.length)return s;var r;return f=null==(s=n)?Ri:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},Gu(i,a)},ta.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=ta.random.normal.apply(ta,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=ta.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},ta.scale={};var ml={floor:y,ceil:y};ta.scale.linear=function(){return Ii([0,1],[0,1],mu,!1)};var yl={s:1,g:1,p:1,r:1,e:1};ta.scale.log=function(){return Ji(ta.scale.linear().domain([0,1]),10,!0,[1,10])};var Ml=ta.format(".0e"),xl={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};ta.scale.pow=function(){return Gi(ta.scale.linear(),1,[0,1])},ta.scale.sqrt=function(){return ta.scale.pow().exponent(.5)},ta.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},ta.scale.category10=function(){return ta.scale.ordinal().range(bl)},ta.scale.category20=function(){return ta.scale.ordinal().range(_l)},ta.scale.category20b=function(){return ta.scale.ordinal().range(wl)},ta.scale.category20c=function(){return ta.scale.ordinal().range(Sl)};var bl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Mt),_l=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Mt),wl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Mt),Sl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Mt);ta.scale.quantile=function(){return no([],[])},ta.scale.quantize=function(){return to(0,1,[0,1])},ta.scale.threshold=function(){return eo([.5],[0,1])},ta.scale.identity=function(){return ro([0,1])},ta.svg={},ta.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),l=Math.max(0,+r.apply(this,arguments)),s=o.apply(this,arguments)-Ra,f=a.apply(this,arguments)-Ra,h=Math.abs(f-s),g=s>f?0:1;if(n>l&&(p=l,l=n,n=p),h>=Ta)return t(l,g)+(n?t(n,1-g):"")+"Z";var p,v,d,m,y,M,x,b,_,w,S,k,E=0,A=0,N=[];if((m=(+c.apply(this,arguments)||0)/2)&&(d=i===kl?Math.sqrt(n*n+l*l):+i.apply(this,arguments),g||(A*=-1),l&&(A=tt(d/l*Math.sin(m))),n&&(E=tt(d/n*Math.sin(m)))),l){y=l*Math.cos(s+A),M=l*Math.sin(s+A),x=l*Math.cos(f-A),b=l*Math.sin(f-A);var C=Math.abs(f-s-2*A)<=qa?0:1;if(A&&so(y,M,x,b)===g^C){var z=(s+f)/2;y=l*Math.cos(z),M=l*Math.sin(z),x=b=null}}else y=M=0;if(n){_=n*Math.cos(f-E),w=n*Math.sin(f-E),S=n*Math.cos(s+E),k=n*Math.sin(s+E);var q=Math.abs(s-f+2*E)<=qa?0:1;if(E&&so(_,w,S,k)===1-g^q){var L=(s+f)/2;_=n*Math.cos(L),w=n*Math.sin(L),S=k=null}}else _=w=0;if((p=Math.min(Math.abs(l-n)/2,+u.apply(this,arguments)))>.001){v=l>n^g?0:1;var T=null==S?[_,w]:null==x?[y,M]:Lr([y,M],[S,k],[x,b],[_,w]),R=y-T[0],D=M-T[1],P=x-T[0],U=b-T[1],j=1/Math.sin(Math.acos((R*P+D*U)/(Math.sqrt(R*R+D*D)*Math.sqrt(P*P+U*U)))/2),F=Math.sqrt(T[0]*T[0]+T[1]*T[1]);if(null!=x){var H=Math.min(p,(l-F)/(j+1)),O=fo(null==S?[_,w]:[S,k],[y,M],l,H,g),I=fo([x,b],[_,w],l,H,g);p===H?N.push("M",O[0],"A",H,",",H," 0 0,",v," ",O[1],"A",l,",",l," 0 ",1-g^so(O[1][0],O[1][1],I[1][0],I[1][1]),",",g," ",I[1],"A",H,",",H," 0 0,",v," ",I[0]):N.push("M",O[0],"A",H,",",H," 0 1,",v," ",I[0])}else N.push("M",y,",",M);if(null!=S){var Y=Math.min(p,(n-F)/(j-1)),Z=fo([y,M],[S,k],n,-Y,g),V=fo([_,w],null==x?[y,M]:[x,b],n,-Y,g);p===Y?N.push("L",V[0],"A",Y,",",Y," 0 0,",v," ",V[1],"A",n,",",n," 0 ",g^so(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-g," ",Z[1],"A",Y,",",Y," 0 0,",v," ",Z[0]):N.push("L",V[0],"A",Y,",",Y," 0 0,",v," ",Z[0])}else N.push("L",_,",",w)}else N.push("M",y,",",M),null!=x&&N.push("A",l,",",l," 0 ",C,",",g," ",x,",",b),N.push("L",_,",",w),null!=S&&N.push("A",n,",",n," 0 ",q,",",1-g," ",S,",",k);return N.push("Z"),N.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=io,r=oo,u=uo,i=kl,o=ao,a=co,c=lo;return n.innerRadius=function(t){return arguments.length?(e=Et(t),n):e},n.outerRadius=function(t){return arguments.length?(r=Et(t),n):r},n.cornerRadius=function(t){return arguments.length?(u=Et(t),n):u},n.padRadius=function(t){return arguments.length?(i=t==kl?kl:Et(t),n):i},n.startAngle=function(t){return arguments.length?(o=Et(t),n):o},n.endAngle=function(t){return arguments.length?(a=Et(t),n):a},n.padAngle=function(t){return arguments.length?(c=Et(t),n):c},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Ra;return[Math.cos(t)*n,Math.sin(t)*n]},n};var kl="auto";ta.svg.line=function(){return ho(y)};var El=ta.map({linear:go,"linear-closed":po,step:vo,"step-before":mo,"step-after":yo,basis:So,"basis-open":ko,"basis-closed":Eo,bundle:Ao,cardinal:bo,"cardinal-open":Mo,"cardinal-closed":xo,monotone:To});El.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Al=[0,2/3,1/3,0],Nl=[0,1/3,2/3,0],Cl=[0,1/6,2/3,1/6];ta.svg.line.radial=function(){var n=ho(Ro);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},mo.reverse=yo,yo.reverse=mo,ta.svg.area=function(){return Do(y)},ta.svg.area.radial=function(){var n=Do(Ro);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},ta.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),l=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,l)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)-Ra,s=l.call(n,u,r)-Ra;return{r:i,a0:o,a1:s,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(s),i*Math.sin(s)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>qa)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=mr,o=yr,a=Po,c=ao,l=co;return n.radius=function(t){return arguments.length?(a=Et(t),n):a},n.source=function(t){return arguments.length?(i=Et(t),n):i},n.target=function(t){return arguments.length?(o=Et(t),n):o},n.startAngle=function(t){return arguments.length?(c=Et(t),n):c},n.endAngle=function(t){return arguments.length?(l=Et(t),n):l},n},ta.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=mr,e=yr,r=Uo;return n.source=function(e){return arguments.length?(t=Et(e),n):t},n.target=function(t){return arguments.length?(e=Et(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},ta.svg.diagonal.radial=function(){var n=ta.svg.diagonal(),t=Uo,e=n.projection;return n.projection=function(n){return arguments.length?e(jo(t=n)):t},n},ta.svg.symbol=function(){function n(n,r){return(zl.get(t.call(this,n,r))||Oo)(e.call(this,n,r))}var t=Ho,e=Fo;return n.type=function(e){return arguments.length?(t=Et(e),n):t},n.size=function(t){return arguments.length?(e=Et(t),n):e},n};var zl=ta.map({circle:Oo,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*Ll)),e=t*Ll;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/ql),e=t*ql/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/ql),e=t*ql/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});ta.svg.symbolTypes=zl.keys();var ql=Math.sqrt(3),Ll=Math.tan(30*Da);_a.transition=function(n){for(var t,e,r=Tl||++Ul,u=Xo(n),i=[],o=Rl||{time:Date.now(),ease:Su,delay:0,duration:250},a=-1,c=this.length;++a<c;){i.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(e=l[s])&&$o(e,s,u,r,o),t.push(e)}return Yo(i,u,r)},_a.interrupt=function(n){return this.each(null==n?Dl:Io(Xo(n)))};var Tl,Rl,Dl=Io(Xo()),Pl=[],Ul=0;Pl.call=_a.call,Pl.empty=_a.empty,Pl.node=_a.node,Pl.size=_a.size,ta.transition=function(n,t){return n&&n.transition?Tl?n.transition(t):n:ta.selection().transition(n)},ta.transition.prototype=Pl,Pl.select=function(n){var t,e,r,u=this.id,i=this.namespace,o=[];n=N(n);for(var a=-1,c=this.length;++a<c;){o.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(r=l[s])&&(e=n.call(r,r.__data__,s,a))?("__data__"in r&&(e.__data__=r.__data__),$o(e,s,i,u,r[i][u]),t.push(e)):t.push(null)}return Yo(o,i,u)},Pl.selectAll=function(n){var t,e,r,u,i,o=this.id,a=this.namespace,c=[];n=C(n);for(var l=-1,s=this.length;++l<s;)for(var f=this[l],h=-1,g=f.length;++h<g;)if(r=f[h]){i=r[a][o],e=n.call(r,r.__data__,h,l),c.push(t=[]);for(var p=-1,v=e.length;++p<v;)(u=e[p])&&$o(u,p,a,o,i),t.push(u)}return Yo(c,a,o)},Pl.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return Yo(u,this.namespace,this.id)},Pl.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):Y(this,null==t?function(t){t[r][e].tween.remove(n)}:function(u){u[r][e].tween.set(n,t)})},Pl.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?Hu:mu,a=ta.ns.qualify(n);return Zo(this,"attr."+n,t,a.local?i:u)},Pl.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=ta.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Pl.style=function(n,e,r){function u(){this.style.removeProperty(n)}function i(e){return null==e?u:(e+="",function(){var u,i=t(this).getComputedStyle(this,null).getPropertyValue(n);return i!==e&&(u=mu(i,e),function(t){this.style.setProperty(n,u(t),r)})})}var o=arguments.length;if(3>o){if("string"!=typeof n){2>o&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Zo(this,"style."+n,e,i)},Pl.styleTween=function(n,e,r){function u(u,i){var o=e.call(this,u,i,t(this).getComputedStyle(this,null).getPropertyValue(n));return o&&function(t){this.style.setProperty(n,o(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+n,u)},Pl.text=function(n){return Zo(this,"text",n,Vo)},Pl.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Pl.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=ta.ease.apply(ta,arguments)),Y(this,function(r){r[e][t].ease=n}))},Pl.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:Y(this,"function"==typeof n?function(r,u,i){r[e][t].delay=+n.call(r,r.__data__,u,i)}:(n=+n,function(r){r[e][t].delay=n}))},Pl.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:Y(this,"function"==typeof n?function(r,u,i){r[e][t].duration=Math.max(1,n.call(r,r.__data__,u,i))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Pl.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var u=Rl,i=Tl;try{Tl=e,Y(this,function(t,u,i){Rl=t[r][e],n.call(t,t.__data__,u,i)})}finally{Rl=u,Tl=i}}else Y(this,function(u){var i=u[r][e];(i.event||(i.event=ta.dispatch("start","end","interrupt"))).on(n,t)});return this},Pl.transition=function(){for(var n,t,e,r,u=this.id,i=++Ul,o=this.namespace,a=[],c=0,l=this.length;l>c;c++){a.push(n=[]);for(var t=this[c],s=0,f=t.length;f>s;s++)(e=t[s])&&(r=e[o][u],$o(e,s,o,i,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Yo(a,o,i)},ta.svg.axis=function(){function n(n){n.each(function(){var n,l=ta.select(this),s=this.__chart__||e,f=this.__chart__=e.copy(),h=null==c?f.ticks?f.ticks.apply(f,a):f.domain():c,g=null==t?f.tickFormat?f.tickFormat.apply(f,a):y:t,p=l.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Ca),d=ta.transition(p.exit()).style("opacity",Ca).remove(),m=ta.transition(p.order()).style("opacity",1),M=Math.max(u,0)+o,x=Ui(f),b=l.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),ta.transition(b));v.append("line"),v.append("text");var w,S,k,E,A=v.select("line"),N=m.select("line"),C=p.select("text").text(g),z=v.select("text"),q=m.select("text"),L="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=Bo,w="x",k="y",S="x2",E="y2",C.attr("dy",0>L?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+L*i+"V0H"+x[1]+"V"+L*i)):(n=Wo,w="y",k="x",S="y2",E="x2",C.attr("dy",".32em").style("text-anchor",0>L?"end":"start"),_.attr("d","M"+L*i+","+x[0]+"H0V"+x[1]+"H"+L*i)),A.attr(E,L*u),z.attr(k,L*M),N.attr(S,0).attr(E,L*u),q.attr(w,0).attr(k,L*M),f.rangeBand){var T=f,R=T.rangeBand()/2;s=f=function(n){return T(n)+R}}else s.rangeBand?s=f:d.call(n,f,s);v.call(n,s,f),m.call(n,f,f)})}var t,e=ta.scale.linear(),r=jl,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Fl?t+"":jl,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var jl="bottom",Fl={top:1,right:1,bottom:1,left:1};ta.svg.brush=function(){function n(t){t.each(function(){var t=ta.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),o=t.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=t.selectAll(".resize").data(v,y);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Hl[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var c,f=ta.transition(t),h=ta.transition(o);l&&(c=Ui(l),h.attr("x",c[0]).attr("width",c[1]-c[0]),r(f)),s&&(c=Ui(s),h.attr("y",c[0]).attr("height",c[1]-c[0]),u(f)),e(f)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+f[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",f[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1]-f[0])}function u(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function i(){function i(){32==ta.event.keyCode&&(C||(M=null,q[0]-=f[1],q[1]-=h[1],C=2),S())}function v(){32==ta.event.keyCode&&2==C&&(q[0]+=f[1],q[1]+=h[1],C=0,S())}function d(){var n=ta.mouse(b),t=!1;x&&(n[0]+=x[0],n[1]+=x[1]),C||(ta.event.altKey?(M||(M=[(f[0]+f[1])/2,(h[0]+h[1])/2]),q[0]=f[+(n[0]<M[0])],q[1]=h[+(n[1]<M[1])]):M=null),A&&m(n,l,0)&&(r(k),t=!0),N&&m(n,s,1)&&(u(k),t=!0),t&&(e(k),w({type:"brush",mode:C?"move":"resize"}))}function m(n,t,e){var r,u,i=Ui(t),c=i[0],l=i[1],s=q[e],v=e?h:f,d=v[1]-v[0];return C&&(c-=s,l-=d+s),r=(e?p:g)?Math.max(c,Math.min(l,n[e])):n[e],C?u=(r+=s)+d:(M&&(s=Math.max(c,Math.min(l,2*M[e]-r))),r>s?(u=r,r=s):u=s),v[0]!=r||v[1]!=u?(e?a=null:o=null,v[0]=r,v[1]=u,!0):void 0}function y(){d(),k.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),ta.select("body").style("cursor",null),L.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),w({type:"brushend"})}var M,x,b=this,_=ta.select(ta.event.target),w=c.of(b,arguments),k=ta.select(b),E=_.datum(),A=!/^(n|s)$/.test(E)&&l,N=!/^(e|w)$/.test(E)&&s,C=_.classed("extent"),z=W(b),q=ta.mouse(b),L=ta.select(t(b)).on("keydown.brush",i).on("keyup.brush",v);if(ta.event.changedTouches?L.on("touchmove.brush",d).on("touchend.brush",y):L.on("mousemove.brush",d).on("mouseup.brush",y),k.interrupt().selectAll("*").interrupt(),C)q[0]=f[0]-q[0],q[1]=h[0]-q[1];else if(E){var T=+/w$/.test(E),R=+/^n/.test(E);x=[f[1-T]-q[0],h[1-R]-q[1]],q[0]=f[T],q[1]=h[R]}else ta.event.altKey&&(M=q.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),ta.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),d()}var o,a,c=E(n,"brushstart","brush","brushend"),l=null,s=null,f=[0,0],h=[0,0],g=!0,p=!0,v=Ol[0];return n.event=function(n){n.each(function(){var n=c.of(this,arguments),t={x:f,y:h,i:o,j:a},e=this.__chart__||t;this.__chart__=t,Tl?ta.select(this).transition().each("start.brush",function(){o=e.i,a=e.j,f=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=yu(f,t.x),r=yu(h,t.y);return o=a=null,function(u){f=t.x=e(u),h=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(l=t,v=Ol[!l<<1|!s],n):l},n.y=function(t){return arguments.length?(s=t,v=Ol[!l<<1|!s],n):s},n.clamp=function(t){return arguments.length?(l&&s?(g=!!t[0],p=!!t[1]):l?g=!!t:s&&(p=!!t),n):l&&s?[g,p]:l?g:s?p:null},n.extent=function(t){var e,r,u,i,c;return arguments.length?(l&&(e=t[0],r=t[1],s&&(e=e[0],r=r[0]),o=[e,r],l.invert&&(e=l(e),r=l(r)),e>r&&(c=e,e=r,r=c),(e!=f[0]||r!=f[1])&&(f=[e,r])),s&&(u=t[0],i=t[1],l&&(u=u[1],i=i[1]),a=[u,i],s.invert&&(u=s(u),i=s(i)),u>i&&(c=u,u=i,i=c),(u!=h[0]||i!=h[1])&&(h=[u,i])),n):(l&&(o?(e=o[0],r=o[1]):(e=f[0],r=f[1],l.invert&&(e=l.invert(e),r=l.invert(r)),e>r&&(c=e,e=r,r=c))),s&&(a?(u=a[0],i=a[1]):(u=h[0],i=h[1],s.invert&&(u=s.invert(u),i=s.invert(i)),u>i&&(c=u,u=i,i=c))),l&&s?[[e,u],[r,i]]:l?[e,r]:s&&[u,i])},n.clear=function(){return n.empty()||(f=[0,0],h=[0,0],o=a=null),n},n.empty=function(){return!!l&&f[0]==f[1]||!!s&&h[0]==h[1]},ta.rebind(n,c,"on")};var Hl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ol=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Il=ac.format=gc.timeFormat,Yl=Il.utc,Zl=Yl("%Y-%m-%dT%H:%M:%S.%LZ");Il.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Jo:Zl,Jo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Jo.toString=Zl.toString,ac.second=Ft(function(n){return new cc(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),ac.seconds=ac.second.range,ac.seconds.utc=ac.second.utc.range,ac.minute=Ft(function(n){return new cc(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),ac.minutes=ac.minute.range,ac.minutes.utc=ac.minute.utc.range,ac.hour=Ft(function(n){var t=n.getTimezoneOffset()/60;return new cc(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),ac.hours=ac.hour.range,ac.hours.utc=ac.hour.utc.range,ac.month=Ft(function(n){return n=ac.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),ac.months=ac.month.range,ac.months.utc=ac.month.utc.range;var Vl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Xl=[[ac.second,1],[ac.second,5],[ac.second,15],[ac.second,30],[ac.minute,1],[ac.minute,5],[ac.minute,15],[ac.minute,30],[ac.hour,1],[ac.hour,3],[ac.hour,6],[ac.hour,12],[ac.day,1],[ac.day,2],[ac.week,1],[ac.month,1],[ac.month,3],[ac.year,1]],$l=Il.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",Ne]]),Bl={range:function(n,t,e){return ta.range(Math.ceil(n/e)*e,+t,e).map(Ko)},floor:y,ceil:y};Xl.year=ac.year,ac.scale=function(){return Go(ta.scale.linear(),Xl,$l)};var Wl=Xl.map(function(n){return[n[0].utc,n[1]]}),Jl=Yl.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",Ne]]);Wl.year=ac.year.utc,ac.scale.utc=function(){return Go(ta.scale.linear(),Wl,Jl)},ta.text=At(function(n){return n.responseText}),ta.json=function(n,t){return Nt(n,"application/json",Qo,t)},ta.html=function(n,t){return Nt(n,"text/html",na,t)},ta.xml=At(function(n){return n.responseXML}),"function"==typeof define&&define.amd?define(ta):"object"==typeof module&&module.exports&&(module.exports=ta),this.d3=ta}();
//-->
</script>
<script>
function s(x) {return 1/(1+Math.exp(-x));}
var m = [40, 120, 50, 120];
var height = 290 - m[0] - m[2];
var width = 600 - m[1] - m[3];
var xmin = -5;
var xmax = 5;
var sample = 400;
var x1 = d3.scale.linear().domain([0, sample]).range([xmin, xmax]);
var data = d3.range(sample).map(function(d){ return {
        x: x1(d), 
        y: s(x1(d))}; 
    });
var x = d3.scale.linear().domain([xmin, xmax]).range([0, width]);
var y = d3.scale.linear()
                .domain([0, 1])
                .range([height, 0]);
var line = d3.svg.line()
    .x(function(d) { return x(d.x); })
    .y(function(d) { return y(d.y); })
var graph = d3.select("#sigmoid_graph")
    .append("svg")
    .attr("width", width + m[1] + m[3])
    .attr("height", height + m[0] + m[2])
    .append("g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");
var xAxis = d3.svg.axis()
                  .scale(x)
                  .tickValues(d3.range(-4, 5, 1))
                  .orient("bottom")
graph.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, " + height + ")")
    .call(xAxis);
var yAxis = d3.svg.axis()
                  .scale(y)
                  .tickValues(d3.range(0, 1.01, 0.2))
                  .orient("left")
                  .ticks(5)
graph.append("g")
    .attr("class", "y axis")
    .call(yAxis);
graph.append("path").attr("d", line(data));
graph.append("text")
     .attr("class", "x label")
     .attr("text-anchor", "end")
     .attr("x", width/2)
     .attr("y", height+35)
     .text("z");
graph.append("text")
        .attr("x", (width / 2))             
        .attr("y", -10)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .text("sigmoid function");
</script>
<p></p><p>We can see from this graph that when the neuron's output is close to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame"><nobr><span class="math" id="MathJax-Span-258" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-259"><span class="mn" id="MathJax-Span-260" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">1</script>, the curve gets very flat, and so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame"><nobr><span class="math" id="MathJax-Span-261" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-262"><span class="msup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">\sigma'(z)</script> gets very small.
Equations <span id="margin_407680204546_reveal" class="equation_link">(55)</span><span id="margin_407680204546" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn55" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame"><nobr><span class="math" id="MathJax-Span-269" role="math" style="width: 13.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-270"><span class="mtable" id="MathJax-Span-271" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 13.14em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-272"><span class="mrow" id="MathJax-Span-273"><span class="mfrac" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283"></span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.806em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-285"><span class="mrow" id="MathJax-Span-286"><span class="mi" id="MathJax-Span-287"></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">\begin{eqnarray} 
  \frac{\partial C}{\partial w} & = & (a-y)\sigma'(z) x = a \sigma'(z)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_407680204546_reveal').click(function() {$('#margin_407680204546').toggle('slow', function() {});});</script> and <span id="margin_444773939420_reveal" class="equation_link">(56)</span><span id="margin_444773939420" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn56" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-35-Frame"><nobr><span class="math" id="MathJax-Span-308" role="math" style="width: 13.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-309"><span class="mtable" id="MathJax-Span-310" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.551em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-311"><span class="mrow" id="MathJax-Span-312"><span class="mfrac" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322"></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.267em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326"></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-332"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-340"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">\begin{eqnarray}  
  \frac{\partial C}{\partial b} & = & (a-y)\sigma'(z) = a \sigma'(z) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_444773939420_reveal').click(function() {$('#margin_444773939420').toggle('slow', function() {});});</script> then tell us that
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame"><nobr><span class="math" id="MathJax-Span-346" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">\partial C / \partial w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame"><nobr><span class="math" id="MathJax-Span-355" role="math" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.846em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-359"><span class="mrow" id="MathJax-Span-360"><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">\partial C / \partial b</script> get very
small.  This is the origin of the learning slowdown.  What's more, as
we shall see a little later, the learning slowdown occurs for
essentially the same reason in more general neural networks, not just
the toy example we've been playing with.</p><p></p><h4><a name="introducing_the_cross-entropy_cost_function"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#introducing_the_cross-entropy_cost_function">Introducing the cross-entropy cost function</a></h4><p></p><p>How can we address the learning slowdown?  It turns out that we can
solve the problem by replacing the quadratic cost with a different
cost function, known as the cross-entropy.  To understand the
cross-entropy, let's move a little away from our super-simple toy
model.  We'll suppose instead that we're trying to train a neuron with
several input variables, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame"><nobr><span class="math" id="MathJax-Span-364" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-365"><span class="msubsup" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-370" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">x_1, x_2, \ldots</script>, corresponding weights
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame"><nobr><span class="math" id="MathJax-Span-375" role="math" style="width: 4.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.316em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-376"><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-381" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">w_1, w_2, \ldots</script>, and a bias, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame"><nobr><span class="math" id="MathJax-Span-386" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">b</script>:
</p><center>
<img src="./Neural networks and deep learning 3_files/tikz29.png">
</center>
The output from the neuron is, of course, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame"><nobr><span class="math" id="MathJax-Span-389" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">a = \sigma(z)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame"><nobr><span class="math" id="MathJax-Span-397" role="math" style="width: 7.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="munderover" id="MathJax-Span-401" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-404" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-407"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">z =
\sum_j w_j x_j+b</script> is the weighted sum of the inputs.  We define the
cross-entropy cost function for this neuron by
<a class="displaced_anchor" name="eqtn57"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-43-Frame"><nobr><span class="math" id="MathJax-Span-412" role="math" style="width: 100%; display: inline-block; min-width: 23.434em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 23.434em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-413"><span class="mtable" id="MathJax-Span-414" style="min-width: 23.924em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.434em;"><span style="display: inline-block; position: absolute; width: 17.159em; height: 0px; clip: rect(-1.664em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -8.576em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 17.159em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-418"><span class="mrow" id="MathJax-Span-419"><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-424" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-426" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-429" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-433"></span><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-437" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-442"></span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-444" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main;">]</span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.076em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-57"><span class="mrow" id="MathJax-Span-416"><span class="mtext" id="MathJax-Span-417" style="font-family: MathJax_Main;">(57)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right],
\tag{57}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame"><nobr><span class="math" id="MathJax-Span-450" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">n</script> is the total number of items of training data, the sum is
over all training inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame"><nobr><span class="math" id="MathJax-Span-453" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">x</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame"><nobr><span class="math" id="MathJax-Span-456" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">y</script> is the corresponding desired
output.<p></p><p>It's not obvious that the expression <span id="margin_77736290904_reveal" class="equation_link">(57)</span><span id="margin_77736290904" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn57" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame"><nobr><span class="math" id="MathJax-Span-459" role="math" style="width: 17.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-460"><span class="mtable" id="MathJax-Span-461" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-468" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-470" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-473" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-477"></span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-481" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-482" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-486"></span><span class="mo" id="MathJax-Span-487" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-488" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_77736290904_reveal').click(function() {$('#margin_77736290904').toggle('slow', function() {});});</script>
fixes the learning slowdown problem.  In fact, frankly, it's not even
obvious that it makes sense to call this a cost function!  Before
addressing the learning slowdown, let's see in what sense the
cross-entropy can be interpreted as a cost function.</p><p>Two properties in particular make it reasonable to interpret the
cross-entropy as a cost function.  First, it's non-negative, that is,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-493" role="math" style="width: 2.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-497" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">C > 0</script>.  To see this, notice that all the individual terms in the sum
in <span id="margin_795219343496_reveal" class="equation_link">(57)</span><span id="margin_795219343496" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn57" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame"><nobr><span class="math" id="MathJax-Span-498" role="math" style="width: 17.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-499"><span class="mtable" id="MathJax-Span-500" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-507" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-509" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-512" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-514" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-516"></span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-518" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-520" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-525"></span><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-527" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_795219343496_reveal').click(function() {$('#margin_795219343496').toggle('slow', function() {});});</script> are positive, since: (a) both
logarithms are of numbers in the range <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame"><nobr><span class="math" id="MathJax-Span-532" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-533"><span class="mn" id="MathJax-Span-534" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame"><nobr><span class="math" id="MathJax-Span-535" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-536"><span class="mn" id="MathJax-Span-537" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">1</script>, and thus are
negative; and (b) there is a minus sign out the front.</p><p>Second, if the neuron's actual output is close to the desired output,
i.e., <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame"><nobr><span class="math" id="MathJax-Span-538" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-539"><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">y = y(x)</script> for all training inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame"><nobr><span class="math" id="MathJax-Span-546" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">x</script>, then the cross-entropy
will be close to zero*<span class="marginnote">
*To prove this I will need to assume
  that the desired output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame"><nobr><span class="math" id="MathJax-Span-549" role="math" style="width: 1.965em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.883em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.027em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">y(x)</script> is either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame"><nobr><span class="math" id="MathJax-Span-555" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-556"><span class="mn" id="MathJax-Span-557" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame"><nobr><span class="math" id="MathJax-Span-558" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-559"><span class="mn" id="MathJax-Span-560" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">1</script>.  This is
  usually the case when solving classification problems, for example,
  or when computing Boolean functions.  To understand what happens
  when we don't make this assumption, see the exercises at the end of
  this section.</span>.  To see this, suppose for example that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame"><nobr><span class="math" id="MathJax-Span-561" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-562"><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-568" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">y(x) = 0</script>
and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame"><nobr><span class="math" id="MathJax-Span-569" role="math" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.404em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">a \approx 0</script> for some input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame"><nobr><span class="math" id="MathJax-Span-574" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">x</script>.  This is a case when the neuron
is doing a good job on that input.  We see that the first term in the
expression <span id="margin_632169318283_reveal" class="equation_link">(57)</span><span id="margin_632169318283" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn57" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-60-Frame"><nobr><span class="math" id="MathJax-Span-577" role="math" style="width: 17.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-578"><span class="mtable" id="MathJax-Span-579" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-580"><span class="mrow" id="MathJax-Span-581"><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-586" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-588" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-589" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-591" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-594" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-595"></span><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-599" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-604"></span><span class="mo" id="MathJax-Span-605" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-606" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-607" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-608" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_632169318283_reveal').click(function() {$('#margin_632169318283').toggle('slow', function() {});});</script> for the cost vanishes, since
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame"><nobr><span class="math" id="MathJax-Span-611" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-618" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">y(x) = 0</script>, while the second term is just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame"><nobr><span class="math" id="MathJax-Span-619" role="math" style="width: 6.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-620"><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-623"></span><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-625" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-630" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">-\ln (1-a) \approx 0</script>.  A
similar analysis holds when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame"><nobr><span class="math" id="MathJax-Span-631" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-638" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">y(x) = 1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame"><nobr><span class="math" id="MathJax-Span-639" role="math" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.404em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-643" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">a \approx 1</script>.  And so the
contribution to the cost will be low provided the actual output is
close to the desired output.</p><p>Summing up, the cross-entropy is positive, and tends toward zero as
the neuron gets better at computing the desired output, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame"><nobr><span class="math" id="MathJax-Span-644" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">y</script>, for all
training inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame"><nobr><span class="math" id="MathJax-Span-647" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">x</script>.  These are both properties we'd intuitively
expect for a cost function.  Indeed, both properties are also
satisfied by the quadratic cost. So that's good news for the
cross-entropy.  But the cross-entropy cost function has the benefit
that, unlike the quadratic cost, it avoids the problem of learning
slowing down.  To see this, let's compute the partial derivative of
the cross-entropy cost with respect to the weights.  We substitute <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame"><nobr><span class="math" id="MathJax-Span-650" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-656" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">a
= \sigma(z)</script> into <span id="margin_456636446187_reveal" class="equation_link">(57)</span><span id="margin_456636446187" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn57" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-68-Frame"><nobr><span class="math" id="MathJax-Span-658" role="math" style="width: 17.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-659"><span class="mtable" id="MathJax-Span-660" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-661"><span class="mrow" id="MathJax-Span-662"><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-666"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-667" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-669" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-672" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-673" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-676"></span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-680" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-681" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-685"></span><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-687" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-68">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_456636446187_reveal').click(function() {$('#margin_456636446187').toggle('slow', function() {});});</script>, and apply the chain
rule twice, obtaining:
<a class="displaced_anchor" name="eqtn58"></a><a class="displaced_anchor" name="eqtn59"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-69-Frame"><nobr><span class="math" id="MathJax-Span-692" role="math" style="width: 100%; display: inline-block; min-width: 26.228em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 26.228em;"><span style="position: absolute; clip: rect(3.336em 1000.002em 9.169em -999.998em); top: -6.517em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-693"><span class="mtable" id="MathJax-Span-694" style="min-width: 26.767em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.228em;"><span style="display: inline-block; position: absolute; width: 20.002em; height: 0px; clip: rect(-3.184em 1000.002em 2.65em -999.998em); top: 0.002em; left: 50%; margin-left: -9.998em;"><span style="position: absolute; clip: rect(2.208em 1000.002em 6.816em -999.998em); top: -5.292em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.15em -999.998em); top: -5.586em; right: 0.002em;"><span class="mtd" id="MathJax-Span-698"><span class="mrow" id="MathJax-Span-699"><span class="mfrac" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-701"><span class="mi" id="MathJax-Span-702" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-706"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-707" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -2.645em; right: 0.002em;"><span class="mtd" id="MathJax-Span-760"><span class="mrow" id="MathJax-Span-761"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.297em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.787em -999.998em); top: -4.262em; left: 2.306em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.586em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711"></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.645em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-762"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764"></span><span class="mo" id="MathJax-Span-765" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.267em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 9.169em -999.998em); top: -6.517em; left: 3.63em;"><span style="display: inline-block; position: relative; width: 16.375em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.346em -999.998em); top: -5.586em; left: 0.002em;"><span class="mtd" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mi" id="MathJax-Span-715"></span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-717" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-718" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-720" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-721" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-723" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-724" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-725"><span style="display: inline-block; position: relative; width: 1.963em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -0.929em;"><span class="mrow" id="MathJax-Span-727"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.963em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-733" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -1.517em;"><span class="mrow" id="MathJax-Span-734"><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-736" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-737" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-739" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -1.811em;"><span class="mrow" id="MathJax-Span-740"><span class="mn" id="MathJax-Span-741" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.728em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-747" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mfrac" id="MathJax-Span-748" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.586em;"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-754"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-756" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 5.346em -999.998em); top: -2.645em; left: 0.002em;"><span class="mtd" id="MathJax-Span-766"><span class="mrow" id="MathJax-Span-767"><span class="mi" id="MathJax-Span-768"></span><span class="mo" id="MathJax-Span-769" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-770" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-771" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-773" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-774" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-775" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-776" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-777" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-778"><span style="display: inline-block; position: relative; width: 1.963em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -0.929em;"><span class="mrow" id="MathJax-Span-780"><span class="mi" id="MathJax-Span-781" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-782" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.963em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-786" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -1.517em;"><span class="mrow" id="MathJax-Span-787"><span class="mo" id="MathJax-Span-788" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-789" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-790" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-792" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -1.811em;"><span class="mrow" id="MathJax-Span-793"><span class="mn" id="MathJax-Span-794" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-797" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.728em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-800" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="msup" id="MathJax-Span-801" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-803" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-808" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-809" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.522em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.449em 1000.002em 1.767em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.586em; right: 0.002em;"><span class="mtd" id="mjx-eqn-58"><span class="mrow" id="MathJax-Span-696"><span class="mtext" id="MathJax-Span-697" style="font-family: MathJax_Main;">(58)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.645em; right: 0.002em;"><span class="mtd" id="mjx-eqn-59"><span class="mrow" id="MathJax-Span-758"><span class="mtext" id="MathJax-Span-759" style="font-family: MathJax_Main;">(59)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.522em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.752em; vertical-align: -2.598em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">\begin{eqnarray}
  \frac{\partial C}{\partial w_j} & = & -\frac{1}{n} \sum_x \left(
    \frac{y }{\sigma(z)} -\frac{(1-y)}{1-\sigma(z)} \right)
  \frac{\partial \sigma}{\partial w_j} \tag{58}\\
 & = & -\frac{1}{n} \sum_x \left( 
    \frac{y}{\sigma(z)} 
    -\frac{(1-y)}{1-\sigma(z)} \right)\sigma'(z) x_j.
\tag{59}\end{eqnarray}</script>
Putting everything over a common denominator and simplifying this
becomes:
<a class="displaced_anchor" name="eqtn60"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-70-Frame"><nobr><span class="math" id="MathJax-Span-811" role="math" style="width: 100%; display: inline-block; min-width: 23.826em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 23.826em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-812"><span class="mtable" id="MathJax-Span-813" style="min-width: 24.316em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.826em;"><span style="display: inline-block; position: absolute; width: 17.551em; height: 0px; clip: rect(-1.713em 1000.002em 1.228em -999.998em); top: 0.002em; left: 50%; margin-left: -8.772em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.15em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mfrac" id="MathJax-Span-819"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-820"><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-823"><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-825"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-826" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-827" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.12em -999.998em); top: -4.017em; left: 2.306em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.066em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-828"><span class="mrow" id="MathJax-Span-829"><span class="mi" id="MathJax-Span-830"></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 3.63em;"><span style="display: inline-block; position: relative; width: 13.875em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.346em -999.998em); top: -4.066em; left: 0.002em;"><span class="mtd" id="MathJax-Span-832"><span class="mrow" id="MathJax-Span-833"><span class="mfrac" id="MathJax-Span-834"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-835" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-837" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-839" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-840" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.326em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.752em; left: 50%; margin-left: -1.517em;"><span class="mrow" id="MathJax-Span-841"><span class="msup" id="MathJax-Span-842"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-844" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-845" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-847" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-848"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-850" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -3.086em;"><span class="mrow" id="MathJax-Span-851"><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-857" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-858" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-862" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-863" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 6.326em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-864" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-870" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-871" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-872" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.978em 1000.002em 0.346em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="mjx-eqn-60"><span class="mrow" id="MathJax-Span-815"><span class="mtext" id="MathJax-Span-816" style="font-family: MathJax_Main;">(60)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.853em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-70">\begin{eqnarray}
  \frac{\partial C}{\partial w_j} & = & \frac{1}{n}
  \sum_x \frac{\sigma'(z) x_j}{\sigma(z) (1-\sigma(z))}
  (\sigma(z)-y).
\tag{60}\end{eqnarray}</script>
Using the definition of the sigmoid function, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame"><nobr><span class="math" id="MathJax-Span-873" role="math" style="width: 8.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.189em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-874"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-879" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-880" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="texatom" id="MathJax-Span-881"><span class="mrow" id="MathJax-Span-882"><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-885" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-887" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mo" id="MathJax-Span-891" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">\sigma(z) =
1/(1+e^{-z})</script>, and a little algebra we can show that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame"><nobr><span class="math" id="MathJax-Span-894" role="math" style="width: 9.904em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.708em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-895"><span class="msup" id="MathJax-Span-896"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-897" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-898" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-901" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-902" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-904" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-905" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-907" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-908" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-909" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-910" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-911" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-914" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">\sigma'(z) =
\sigma(z)(1-\sigma(z))</script>.  I'll ask you to verify this in an exercise
below, but for now let's accept it as given.  We see that the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame"><nobr><span class="math" id="MathJax-Span-915" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-916"><span class="msup" id="MathJax-Span-917"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-919" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-920" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-922" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\sigma'(z)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame"><nobr><span class="math" id="MathJax-Span-923" role="math" style="width: 6.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-924"><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-928" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-929" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-930" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-931" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-936" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">\sigma(z)(1-\sigma(z))</script> terms cancel in the equation
just above, and it simplifies to become:
<a class="displaced_anchor" name="eqtn61"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-75-Frame"><nobr><span class="math" id="MathJax-Span-937" role="math" style="width: 100%; display: inline-block; min-width: 18.042em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 18.042em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-938"><span class="mtable" id="MathJax-Span-939" style="min-width: 18.434em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.042em;"><span style="display: inline-block; position: absolute; width: 11.669em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -5.831em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-943"><span class="mrow" id="MathJax-Span-944"><span class="mfrac" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-946"><span class="mi" id="MathJax-Span-947" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-949"><span class="mi" id="MathJax-Span-950" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-951"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-953" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-954" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-955" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-956" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-958" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-961" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-966" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-969" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-970" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-971" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-972" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-61"><span class="mrow" id="MathJax-Span-941"><span class="mtext" id="MathJax-Span-942" style="font-family: MathJax_Main;">(61)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">\begin{eqnarray} 
  \frac{\partial C}{\partial w_j} =  \frac{1}{n} \sum_x x_j(\sigma(z)-y).
\tag{61}\end{eqnarray}</script>
This is a beautiful expression.  It tells us that the rate at which
the weight learns is controlled by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame"><nobr><span class="math" id="MathJax-Span-973" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-976" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-977" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-978" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-980" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">\sigma(z)-y</script>, i.e., by the error
in the output.  The larger the error, the faster the neuron will
learn.  This is just what we'd intuitively expect.  In particular, it
avoids the learning slowdown caused by the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame"><nobr><span class="math" id="MathJax-Span-981" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-982"><span class="msup" id="MathJax-Span-983"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-986" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-987" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-988" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">\sigma'(z)</script> term in the
analogous equation for the quadratic cost, Equation <span id="margin_623723516985_reveal" class="equation_link">(55)</span><span id="margin_623723516985" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn55" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-78-Frame"><nobr><span class="math" id="MathJax-Span-989" role="math" style="width: 13.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-990"><span class="mtable" id="MathJax-Span-991" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 13.14em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-992"><span class="mrow" id="MathJax-Span-993"><span class="mfrac" id="MathJax-Span-994"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-995"><span class="mi" id="MathJax-Span-996" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-997" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-998"><span class="mi" id="MathJax-Span-999" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1000" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1001"><span class="mrow" id="MathJax-Span-1002"><span class="mi" id="MathJax-Span-1003"></span><span class="mo" id="MathJax-Span-1004" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.806em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1005"><span class="mrow" id="MathJax-Span-1006"><span class="mi" id="MathJax-Span-1007"></span><span class="mo" id="MathJax-Span-1008" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1009" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1010" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1011" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1012" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-1013"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1014" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1016" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1018" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-1022"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1023" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1025" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1026" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1027" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-78">\begin{eqnarray} 
  \frac{\partial C}{\partial w} & = & (a-y)\sigma'(z) x = a \sigma'(z)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_623723516985_reveal').click(function() {$('#margin_623723516985').toggle('slow', function() {});});</script>.
When we use the cross-entropy, the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame"><nobr><span class="math" id="MathJax-Span-1028" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1029"><span class="msup" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1031" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1032" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1033" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">\sigma'(z)</script> term gets cancelled
out, and we no longer need worry about it being small.  This
cancellation is the special miracle ensured by the cross-entropy cost
function.  Actually, it's not really a miracle.  As we'll see later,
the cross-entropy was specially chosen to have just this property.</p><p>In a similar way, we can compute the partial derivative for the bias.
I won't go through all the details again, but you can easily verify
that
<a class="displaced_anchor" name="eqtn62"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-80-Frame"><nobr><span class="math" id="MathJax-Span-1036" role="math" style="width: 100%; display: inline-block; min-width: 16.669em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.669em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1037"><span class="mtable" id="MathJax-Span-1038" style="min-width: 17.012em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.669em;"><span style="display: inline-block; position: absolute; width: 10.248em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -5.145em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.248em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1042"><span class="mrow" id="MathJax-Span-1043"><span class="mfrac" id="MathJax-Span-1044"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1045"><span class="mi" id="MathJax-Span-1046" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1047" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1048"><span class="mi" id="MathJax-Span-1049" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1050" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-1052" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1053" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1054" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1055" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1056" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1058" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1060" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1061" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1062" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1063" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1065" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1066" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-62"><span class="mrow" id="MathJax-Span-1040"><span class="mtext" id="MathJax-Span-1041" style="font-family: MathJax_Main;">(62)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">\begin{eqnarray} 
  \frac{\partial C}{\partial b} = \frac{1}{n} \sum_x (\sigma(z)-y).
\tag{62}\end{eqnarray}</script>
Again, this avoids the learning slowdown caused by the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame"><nobr><span class="math" id="MathJax-Span-1067" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1068"><span class="msup" id="MathJax-Span-1069"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1072" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1073" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1074" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">\sigma'(z)</script>
term in the analogous equation for the quadratic cost,
Equation <span id="margin_973334520067_reveal" class="equation_link">(56)</span><span id="margin_973334520067" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn56" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-82-Frame"><nobr><span class="math" id="MathJax-Span-1075" role="math" style="width: 13.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1076"><span class="mtable" id="MathJax-Span-1077" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.551em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1078"><span class="mrow" id="MathJax-Span-1079"><span class="mfrac" id="MathJax-Span-1080"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1081"><span class="mi" id="MathJax-Span-1082" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1083" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1084"><span class="mi" id="MathJax-Span-1085" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1087"><span class="mrow" id="MathJax-Span-1088"><span class="mi" id="MathJax-Span-1089"></span><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.267em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1091"><span class="mrow" id="MathJax-Span-1092"><span class="mi" id="MathJax-Span-1093"></span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1095" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1096" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1098" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-1099"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1102" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1103" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1104" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1106" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-1107"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1108" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1111" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1112" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-82">\begin{eqnarray}  
  \frac{\partial C}{\partial b} & = & (a-y)\sigma'(z) = a \sigma'(z) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_973334520067_reveal').click(function() {$('#margin_973334520067').toggle('slow', function() {});});</script>.</p><p></p><h4><a name="exercise_35813"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_35813">Exercise</a></h4><ul>
  <li> Verify that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame"><nobr><span class="math" id="MathJax-Span-1113" role="math" style="width: 9.904em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.708em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1114"><span class="msup" id="MathJax-Span-1115"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1116" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1117" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1121" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1122" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1123" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1124" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1125" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1127" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1128" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1129" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1130" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1131" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1132" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1133" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">\sigma'(z) = \sigma(z)(1-\sigma(z))</script>.<p></p><p></p></li></ul><p></p><p>Let's return to the toy example we played with earlier, and explore
what happens when we use the cross-entropy instead of the quadratic
cost.  To re-orient ourselves, we'll begin with the case where the
quadratic cost did just fine, with starting weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame"><nobr><span class="math" id="MathJax-Span-1134" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1135"><span class="mn" id="MathJax-Span-1136" style="font-family: MathJax_Main;">0.6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">0.6</script> and starting
bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame"><nobr><span class="math" id="MathJax-Span-1137" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1138"><span class="mn" id="MathJax-Span-1139" style="font-family: MathJax_Main;">0.9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">0.9</script>.  Press "Run" to see what happens when we replace the
quadratic cost by the cross-entropy:</p><p><script type="text/paperscript" style="display:none" canvas="saturation3">
<!--
// This is a paper.js widget to show a single neuron learning.  In
// particular, the widget is used to show the learning slowdown that
// occurs when the output is saturated.
//
// The same basic widget is used several times, in slightly different
// configurations.  paper.js makes it somewhat complex to reuse the
// code, so I have simply duplicated the code.  This can give rise to
// bugs if one is not careful to keep the code in sync, so I have
// separated the code into two pieces.
//
// The first piece is the header code.  This changes between widgets.
// It sets up things like the starting weight, bias, cost function,
// and so on -- things which may vary betweens widgets.
//
// The second piece is the body code.  This is almost exactly the same
// for the different widgets.  Note, however, that the costGraphX and
// epochX variables change name, due to a bug in the way paperjs
// handles scope.
//
// We can make these changes by searching on costGraph1 and replacing
// with costGraph2, costGraph3 etc, and by replacing epoch1 with
// epoch2, epoch3 etc.
//
// This separation makes it easy to maintain the duplicated code.

// HEADER CODE

var startingWeight = 0.6;
var startingBias = 0.9;
var eta = 0.005;
var numFrames = 300;

quadratic_cost = {
    fn: function(a) {return a*a/2;},
    derivative: function(a) {return a*a*(1-a);},
    scaling: 240 // used to scale on the graph
}

cross_entropy_cost = {
    fn: function(a) {return -Math.log(1-a);},
    derivative: function(a) {return 1/(1-a);},
    scaling: 30
}

cost3 = cross_entropy_cost;

// A path for the graph.  
costGraph3 = new Path();
costGraph3.strokeColor = "#2A6EA6";


// BODY CODE

// STATIC ELEMENTS
//
// Note that this includes some paper.js items which will later be
// modified, e.g., the variables output and weightText.  This section
// merely sets the static parts of the elements.

var input = new PointText(new Point(8, 40));
input.fontSize = 18;
input.content = "Input: 1.0";

arrow(new Point(100, 35), new Point(230, 35), 0.8); // input arrow

var neuron = new Path.Circle(new Point(260, 35), 30);
neuron.strokeColor = "black";

arrow(new Point(290, 35), new Point(380, 35), 0.8); // output arrow

// The output text's content will be set dynamically, later
var output = new PointText(new Point(390, 40)); 
output.fontSize = 18;

// The weight text and bar
var weightText = new PointText(new Point(120, 52));
weightText.fontSize=14;
var weightBar = new Path.Rectangle(new Rectangle(120, 57, 90, 9));
weightBar.strokeColor = "grey";
weightBar.strokeWidth = 1;
var weightTick = new Path(new Point(165, 57), new Point(165, 71));
weightTick.strokeColor = "black";
var weightSlider = new Path.Line(
    new Point(165, 61.5), new Point(165+weight*20, 61.5));
weightSlider.strokeColor = "#2A6EA6";
weightSlider.strokeWidth = 9;

// The bias text and bar
var biasText = new PointText(new Point(230, 82));
biasText.fontSize = 14;
var biasBar = new Path.Rectangle(new Rectangle(230, 88, 90, 9));
biasBar.strokeColor = "grey";
biasBar.strokeWidth = 1;
var biasTick = new Path(new Point(275, 88), new Point(275, 102));
biasTick.strokeColor = "black";
var biasSlider = new Path.Line(
    new Point(275, 92.5), new Point(275+bias*20, 92.5));
biasSlider.strokeColor = "#2A6EA6";
biasSlider.strokeWidth = 9;

// Axes for the graph
arrow(new Point(100, 250), new Point(100, 120));
arrow(new Point(100, 250), new Point(130+numFrames/2, 250));

// Labels on the axes
var costText = new PointText(new Point(60, 145));
costText.fontSize = 18;
costText.content = "Cost";

var epoch3LabelText = new PointText(new Point(140+numFrames/2, 255));
epoch3LabelText.fontSize = 18;
epoch3LabelText.content = "Epoch";

// Marker for the current epoch
var epoch3Tick = new Path(new Point(100, 250), new Point(100, 255));
epoch3Tick.strokeColor = "black";

var epoch3Number = new PointText(new Point(100, 267));
epoch3Number.fontSize = 14;
epoch3Number.justification = "center";

// We group the epochTick and epochNumber, to make it easy to move
epoch3 = new Group([epoch3Tick, epoch3Number]);

// Initialize the dynamic elements.  It's convenient to do this in a
// function, so that function can also be called upon a (re)start of
// the widget.

var weight, bias;
initDynamicElements();

function initDynamicElements() {
    weight = startingWeight;
    bias = startingBias;
    weightText.content = paramContent("w = ", weight);
    weightSlider.segments[1].point.x = 165+weight*20;
    biasText.content = paramContent("b = ", bias);
    biasSlider.segments[1].point.x = 275+bias*20;
    output.content = outputContent(weight, bias);
    epoch3.position.x = 100;
    epoch3Number.content = "0";
    costGraph3.removeSegments();
}

function paramContent(s, x) {
    sign = (x >= 0)? "+": "";
    return s+sign+x.toFixed(2);
}

// The run button

var runBox = new Path.Rectangle(new Rectangle(430, 230, 60, 30), 5);
runBox.fillColor = "#dddddd";

var runText = new PointText(new Point(460, 250));
runText.justification = "center";
runText.fontSize = 18;
runText.content = "Run";

var runIcon = new Group([runBox, runText]);

runIcon.onMouseEnter = function(event) {
    runBox.fillColor = "#aaaaaa";
}

runIcon.onMouseLeave = function(event) {
    runBox.fillColor = "#dddddd";
}

var playing = false;
var count = 0;

runIcon.onClick = function(event) {
    initDynamicElements();
    this.visible = false;
    weight = startingWeight;
    bias = startingBias;
    playing = true;
}

// The actual procedure

function onFrame(event) {
    if (playing) {
	a = outputValue(weight, bias);
	delta = cost3.derivative(a);
	weight += -eta*delta;
	bias += -eta*delta;
	weightText.content = paramContent("w = ", weight);
	weightSlider.segments[1].point.x = 165+weight*20;
	biasText.content = paramContent("b = ", bias);
	biasSlider.segments[1].point.x = 275+bias*20;
	output.content = outputContent(weight, bias);
	if (count % 2 === 0) {epoch3.position.x += 1;}
	costGraph3.add(new Point(epoch3.position.x, 250-cost3.scaling*cost3.fn(a)));
	epoch3Number.content = count;
	count += 1;
	if (count > numFrames) {
	    count = 0;
	    runIcon.visible = true;
	    playing = false;
	}
	}
}

function outputValue(weight, bias) {
    return sigmoid(weight+bias);
}

function outputContent(weight, bias) {
    return "Output: "+outputValue(weight, bias).toFixed(2);
}

function sigmoid(z) {
    return 1/(1+Math.exp(-z));
}

function arrow(point1, point2, width, color) {
    if (typeof width === 'undefined') {width=1};
    if (typeof color === 'undefined') {color='black'};
    delta = point1 - point2;
    n = delta/delta.length;
    nperp = new Point(-n.y, n.x);
    line = new Path(point1, point2);
    line.strokeColor = color;
    line.strokeWidth = width;
    arrow_stroke_1 = new Path(point2, point2+(n+nperp)*6);
    arrow_stroke_1.strokeWidth = width;
    arrow_stroke_1.strokeColor = color;
    arrow_stroke_2 = new Path(point2, point2+(n-nperp)*6);
    arrow_stroke_2.strokeWidth = width;
    arrow_stroke_2.strokeColor = color;
}

//-->
</script></p><center><canvas id="saturation3" width="520" height="300"></canvas></center><p></p><p>Unsurprisingly, the neuron learns perfectly well in this instance,
just as it did earlier.  And now let's look at the case where our
neuron got stuck before (<a href="http://neuralnetworksanddeeplearning.com/chap3.html#saturation2_anchor">link</a>, for
comparison), with the weight and bias both starting at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame"><nobr><span class="math" id="MathJax-Span-1140" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1141"><span class="mn" id="MathJax-Span-1142" style="font-family: MathJax_Main;">2.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">2.0</script>:</p><p><script type="text/paperscript" style="display:none" canvas="saturation4">
<!--
// This is a paper.js widget to show a single neuron learning.  In
// particular, the widget is used to show the learning slowdown that
// occurs when the output is saturated.
//
// The same basic widget is used several times, in slightly different
// configurations.  paper.js makes it somewhat complex to reuse the
// code, so I have simply duplicated the code.  This can give rise to
// bugs if one is not careful to keep the code in sync, so I have
// separated the code into two pieces.
//
// The first piece is the header code.  This changes between widgets.
// It sets up things like the starting weight, bias, cost function,
// and so on -- things which may vary betweens widgets.
//
// The second piece is the body code.  This is almost exactly the same
// for the different widgets.  Note, however, that the costGraphX and
// epochX variables change name, due to a bug in the way paperjs
// handles scope.
//
// We can make these changes by searching on costGraph1 and replacing
// with costGraph2, costGraph3 etc, and by replacing epoch1 with
// epoch2, epoch3 etc.
//
// This separation makes it easy to maintain the duplicated code.

// HEADER CODE

var startingWeight = 2.0;
var startingBias = 2.0;
var eta = 0.005;
var numFrames = 300;

quadratic_cost = {
    fn: function(a) {return a*a/2;},
    derivative: function(a) {return a*a*(1-a);},
    scaling: 240 // used to scale on the graph
}

cross_entropy_cost = {
    fn: function(a) {return -Math.log(1-a);},
    derivative: function(a) {return 1/(1-a);},
    scaling: 30
}

cost4 = cross_entropy_cost;

// A path for the graph.  
costGraph4 = new Path();
costGraph4.strokeColor = "#2A6EA6";


// BODY CODE

// STATIC ELEMENTS
//
// Note that this includes some paper.js items which will later be
// modified, e.g., the variables output and weightText.  This section
// merely sets the static parts of the elements.

var input = new PointText(new Point(8, 40));
input.fontSize = 18;
input.content = "Input: 1.0";

arrow(new Point(100, 35), new Point(230, 35), 0.8); // input arrow

var neuron = new Path.Circle(new Point(260, 35), 30);
neuron.strokeColor = "black";

arrow(new Point(290, 35), new Point(380, 35), 0.8); // output arrow

// The output text's content will be set dynamically, later
var output = new PointText(new Point(390, 40)); 
output.fontSize = 18;

// The weight text and bar
var weightText = new PointText(new Point(120, 52));
weightText.fontSize=14;
var weightBar = new Path.Rectangle(new Rectangle(120, 57, 90, 9));
weightBar.strokeColor = "grey";
weightBar.strokeWidth = 1;
var weightTick = new Path(new Point(165, 57), new Point(165, 71));
weightTick.strokeColor = "black";
var weightSlider = new Path.Line(
    new Point(165, 61.5), new Point(165+weight*20, 61.5));
weightSlider.strokeColor = "#2A6EA6";
weightSlider.strokeWidth = 9;

// The bias text and bar
var biasText = new PointText(new Point(230, 82));
biasText.fontSize = 14;
var biasBar = new Path.Rectangle(new Rectangle(230, 88, 90, 9));
biasBar.strokeColor = "grey";
biasBar.strokeWidth = 1;
var biasTick = new Path(new Point(275, 88), new Point(275, 102));
biasTick.strokeColor = "black";
var biasSlider = new Path.Line(
    new Point(275, 92.5), new Point(275+bias*20, 92.5));
biasSlider.strokeColor = "#2A6EA6";
biasSlider.strokeWidth = 9;

// Axes for the graph
arrow(new Point(100, 250), new Point(100, 120));
arrow(new Point(100, 250), new Point(130+numFrames/2, 250));

// Labels on the axes
var costText = new PointText(new Point(60, 145));
costText.fontSize = 18;
costText.content = "Cost";

var epoch4LabelText = new PointText(new Point(140+numFrames/2, 255));
epoch4LabelText.fontSize = 18;
epoch4LabelText.content = "Epoch";

// Marker for the current epoch
var epoch4Tick = new Path(new Point(100, 250), new Point(100, 255));
epoch4Tick.strokeColor = "black";

var epoch4Number = new PointText(new Point(100, 267));
epoch4Number.fontSize = 14;
epoch4Number.justification = "center";

// We group the epochTick and epochNumber, to make it easy to move
epoch4 = new Group([epoch4Tick, epoch4Number]);

// Initialize the dynamic elements.  It's convenient to do this in a
// function, so that function can also be called upon a (re)start of
// the widget.

var weight, bias;
initDynamicElements();

function initDynamicElements() {
    weight = startingWeight;
    bias = startingBias;
    weightText.content = paramContent("w = ", weight);
    weightSlider.segments[1].point.x = 165+weight*20;
    biasText.content = paramContent("b = ", bias);
    biasSlider.segments[1].point.x = 275+bias*20;
    output.content = outputContent(weight, bias);
    epoch4.position.x = 100;
    epoch4Number.content = "0";
    costGraph4.removeSegments();
}

function paramContent(s, x) {
    sign = (x >= 0)? "+": "";
    return s+sign+x.toFixed(2);
}

// The run button

var runBox = new Path.Rectangle(new Rectangle(430, 230, 60, 30), 5);
runBox.fillColor = "#dddddd";

var runText = new PointText(new Point(460, 250));
runText.justification = "center";
runText.fontSize = 18;
runText.content = "Run";

var runIcon = new Group([runBox, runText]);

runIcon.onMouseEnter = function(event) {
    runBox.fillColor = "#aaaaaa";
}

runIcon.onMouseLeave = function(event) {
    runBox.fillColor = "#dddddd";
}

var playing = false;
var count = 0;

runIcon.onClick = function(event) {
    initDynamicElements();
    this.visible = false;
    weight = startingWeight;
    bias = startingBias;
    playing = true;
}

// The actual procedure

function onFrame(event) {
    if (playing) {
	a = outputValue(weight, bias);
	delta = cost4.derivative(a);
	weight += -eta*delta;
	bias += -eta*delta;
	weightText.content = paramContent("w = ", weight);
	weightSlider.segments[1].point.x = 165+weight*20;
	biasText.content = paramContent("b = ", bias);
	biasSlider.segments[1].point.x = 275+bias*20;
	output.content = outputContent(weight, bias);
	if (count % 2 === 0) {epoch4.position.x += 1;}
	costGraph4.add(new Point(epoch4.position.x, 250-cost4.scaling*cost4.fn(a)));
	epoch4Number.content = count;
	count += 1;
	if (count > numFrames) {
	    count = 0;
	    runIcon.visible = true;
	    playing = false;
	}
	}
}

function outputValue(weight, bias) {
    return sigmoid(weight+bias);
}

function outputContent(weight, bias) {
    return "Output: "+outputValue(weight, bias).toFixed(2);
}

function sigmoid(z) {
    return 1/(1+Math.exp(-z));
}

function arrow(point1, point2, width, color) {
    if (typeof width === 'undefined') {width=1};
    if (typeof color === 'undefined') {color='black'};
    delta = point1 - point2;
    n = delta/delta.length;
    nperp = new Point(-n.y, n.x);
    line = new Path(point1, point2);
    line.strokeColor = color;
    line.strokeWidth = width;
    arrow_stroke_1 = new Path(point2, point2+(n+nperp)*6);
    arrow_stroke_1.strokeWidth = width;
    arrow_stroke_1.strokeColor = color;
    arrow_stroke_2 = new Path(point2, point2+(n-nperp)*6);
    arrow_stroke_2.strokeWidth = width;
    arrow_stroke_2.strokeColor = color;
}

//-->
</script></p><center><canvas id="saturation4" width="520" height="300"></canvas></center><p></p><p>Success!  This time the neuron learned quickly, just as we hoped.  If
you observe closely you can see that the slope of the cost curve was
much steeper initially than the initial flat region on the
corresponding curve for the quadratic cost.  It's that steepness which
the cross-entropy buys us, preventing us from getting stuck just when
we'd expect our neuron to learn fastest, i.e., when the neuron starts
out badly wrong.</p><p>I didn't say what learning rate was used in the examples just
illustrated.  Earlier, with the quadratic cost, we used <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame"><nobr><span class="math" id="MathJax-Span-1143" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1144"><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1146" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1147" style="font-family: MathJax_Main; padding-left: 0.297em;">0.15</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">\eta = 0.15</script>.
Should we have used the same learning rate in the new examples?  In
fact, with the change in cost function it's not possible to say
precisely what it means to use the "same" learning rate; it's an
apples and oranges comparison.  For both cost functions I simply
experimented to find a learning rate that made it possible to see what
is going on.  If you're still curious, despite my disavowal, here's
the lowdown: I used <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame"><nobr><span class="math" id="MathJax-Span-1148" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1149"><span class="mi" id="MathJax-Span-1150" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1151" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1152" style="font-family: MathJax_Main; padding-left: 0.297em;">0.005</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">\eta = 0.005</script> in the examples just given.</p><p>You might object that the change in learning rate makes the graphs
above meaningless.  Who cares how fast the neuron learns, when our
choice of learning rate was arbitrary to begin with?!  That objection
misses the point.  The point of the graphs isn't about the absolute
speed of learning.  It's about how the speed of learning changes.  In
particular, when we use the quadratic cost learning is <em>slower</em>
when the neuron is unambiguously wrong than it is later on, as the
neuron gets closer to the correct output; while with the cross-entropy
learning is faster when the neuron is unambiguously wrong.  Those
statements don't depend on how the learning rate is set.  </p><p>We've been studying the cross-entropy for a single neuron.  However,
it's easy to generalize the cross-entropy to many-neuron multi-layer
networks.  In particular, suppose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame"><nobr><span class="math" id="MathJax-Span-1153" role="math" style="width: 5.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1154"><span class="mi" id="MathJax-Span-1155" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1156" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1157" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1158" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1159" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1161" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1164" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1165" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">y = y_1, y_2, \ldots</script> are the
desired values at the output neurons, i.e., the neurons in the final
layer, while <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame"><nobr><span class="math" id="MathJax-Span-1166" role="math" style="width: 4.316em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.218em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1167"><span class="msubsup" id="MathJax-Span-1168"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1169" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-1171" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1172" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1173" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1174" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-1176" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">a^L_1, a^L_2, \ldots</script> are the actual output values.
Then we define the cross-entropy by
<a class="displaced_anchor" name="eqtn63"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-91-Frame"><nobr><span class="math" id="MathJax-Span-1179" role="math" style="width: 100%; display: inline-block; min-width: 27.159em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 27.159em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1180"><span class="mtable" id="MathJax-Span-1181" style="min-width: 27.699em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.159em;"><span style="display: inline-block; position: absolute; width: 20.983em; height: 0px; clip: rect(-1.713em 1000.002em 1.228em -999.998em); top: 0.002em; left: 50%; margin-left: -10.488em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 20.983em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.493em -999.998em); top: -4.262em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1185"><span class="mrow" id="MathJax-Span-1186"><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1188" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1190"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1191" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1193" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1195" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1196" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-1198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1199" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-1200" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="msubsup" id="MathJax-Span-1201"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1202" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1204" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1205"></span><span class="msubsup" id="MathJax-Span-1206" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1208" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1210" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1211" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1212" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1214" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1215" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1218" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1219"></span><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1221" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1223" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1226" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1227" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1228" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">]</span></span></span><span class="mo" id="MathJax-Span-1229" style="font-family: MathJax_Main; padding-left: 0.15em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.125em 1000.002em 0.15em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.262em; right: 0.002em;"><span class="mtd" id="mjx-eqn-63"><span class="mrow" id="MathJax-Span-1183"><span class="mtext" id="MathJax-Span-1184" style="font-family: MathJax_Main;">(63)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-91">\begin{eqnarray}  C = -\frac{1}{n} \sum_x
  \sum_j \left[y_j \ln a^L_j + (1-y_j) \ln (1-a^L_j) \right].
\tag{63}\end{eqnarray}</script>
This is the same as our earlier expression,
Equation <span id="margin_313175788317_reveal" class="equation_link">(57)</span><span id="margin_313175788317" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn57" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame"><nobr><span class="math" id="MathJax-Span-1230" role="math" style="width: 17.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1231"><span class="mtable" id="MathJax-Span-1232" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1233"><span class="mrow" id="MathJax-Span-1234"><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1236" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1237" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1238"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1239" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1241" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1244" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-1245" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1246" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1248"></span><span class="mi" id="MathJax-Span-1249" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-1250" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1251" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1252" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1256" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1257"></span><span class="mo" id="MathJax-Span-1258" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1259" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-1262" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1263" style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">\begin{eqnarray} 
  C = -\frac{1}{n} \sum_x \left[y \ln a + (1-y ) \ln (1-a) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_313175788317_reveal').click(function() {$('#margin_313175788317').toggle('slow', function() {});});</script>, except now we've got the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame"><nobr><span class="math" id="MathJax-Span-1264" role="math" style="width: 1.473em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1265"><span class="munderover" id="MathJax-Span-1266"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1267" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">\sum_j</script> summing over all the output neurons.  I won't explicitly work
through a derivation, but it should be plausible that using the
expression <span id="margin_579150261951_reveal" class="equation_link">(63)</span><span id="margin_579150261951" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn63" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-94-Frame"><nobr><span class="math" id="MathJax-Span-1269" role="math" style="width: 21.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1270"><span class="mtable" id="MathJax-Span-1271" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 20.542em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 20.542em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.493em -999.998em); top: -4.262em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1272"><span class="mrow" id="MathJax-Span-1273"><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1275" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1276" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1277"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1278" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1280" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1282" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1283" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-1285" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1286" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-1287" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="msubsup" id="MathJax-Span-1288"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1292"></span><span class="msubsup" id="MathJax-Span-1293" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1295" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1297" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1298" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1299" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1300" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1301" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1302" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1306"></span><span class="mo" id="MathJax-Span-1307" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1308" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1310" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1311" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1313" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1314" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1315" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-94">\begin{eqnarray}  C = -\frac{1}{n} \sum_x
  \sum_j \left[y_j \ln a^L_j + (1-y_j) \ln (1-a^L_j) \right] \nonumber\end{eqnarray}</script></a></span><script>$('#margin_579150261951_reveal').click(function() {$('#margin_579150261951').toggle('slow', function() {});});</script> avoids a learning slowdown in
many-neuron networks.  If you're interested, you can work through the
derivation in the problem below.  </p><p>When should we use the cross-entropy instead of the quadratic cost?
In fact, the cross-entropy is nearly always the better choice,
provided the output neurons are sigmoid neurons.  To see why, consider
that when we're setting up the network we usually initialize the
weights and biases using some sort of randomization.  It may happen
that those initial choices result in the network being decisively
wrong for some training input - that is, an output neuron will have
saturated near <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame"><nobr><span class="math" id="MathJax-Span-1316" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1317"><span class="mn" id="MathJax-Span-1318" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">1</script>, when it should be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame"><nobr><span class="math" id="MathJax-Span-1319" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1320"><span class="mn" id="MathJax-Span-1321" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">0</script>, or vice versa.  If we're
using the quadratic cost that will slow down learning.  It won't stop
learning completely, since the weights will continue learning from
other training inputs, but it's obviously undesirable.</p><p></p><h4><a name="exercises_824189"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercises_824189">Exercises</a></h4><ul>
<li> One gotcha with the cross-entropy is that it can be difficult at
  first to remember the respective roles of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame"><nobr><span class="math" id="MathJax-Span-1322" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1323"><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">y</script>s and the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame"><nobr><span class="math" id="MathJax-Span-1325" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1326"><span class="mi" id="MathJax-Span-1327" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">a</script>s.
  It's easy to get confused about whether the right form is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame"><nobr><span class="math" id="MathJax-Span-1328" role="math" style="width: 12.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1329"><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-1331" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1332" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1334"></span><span class="mi" id="MathJax-Span-1335" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-1336" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1337" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1338" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1339" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1340" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1341" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1342" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1343"></span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1345" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1349" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">-[y \ln a
  + (1-y) \ln (1-a)]</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame"><nobr><span class="math" id="MathJax-Span-1350" role="math" style="width: 12.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1351"><span class="mo" id="MathJax-Span-1352" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1355" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1356"></span><span class="mi" id="MathJax-Span-1357" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1358" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1359" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1360" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1362" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-1363" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1364" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1365"></span><span class="mo" id="MathJax-Span-1366" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1367" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1368" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1369" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1370" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">-[a \ln y + (1-a) \ln (1-y)]</script>.  What happens
  to the second of these expressions when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame"><nobr><span class="math" id="MathJax-Span-1372" role="math" style="width: 2.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1373"><span class="mi" id="MathJax-Span-1374" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1375" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">y = 0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame"><nobr><span class="math" id="MathJax-Span-1377" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1378"><span class="mn" id="MathJax-Span-1379" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">1</script>?  Does this
  problem afflict the first expression?  Why or why not? <p></p><p></p></li><li> In the single-neuron discussion at the start of this section, I
  argued that the cross-entropy is small if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame"><nobr><span class="math" id="MathJax-Span-1380" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1381"><span class="mi" id="MathJax-Span-1382" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1383" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1384" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1385" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1386" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">\sigma(z) \approx y</script> for
  all training inputs.  The argument relied on <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame"><nobr><span class="math" id="MathJax-Span-1388" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1389"><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">y</script> being equal to
  either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame"><nobr><span class="math" id="MathJax-Span-1391" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1392"><span class="mn" id="MathJax-Span-1393" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame"><nobr><span class="math" id="MathJax-Span-1394" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1395"><span class="mn" id="MathJax-Span-1396" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">1</script>.  This is usually true in classification problems,
  but for other problems (e.g., regression problems) <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame"><nobr><span class="math" id="MathJax-Span-1397" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1398"><span class="mi" id="MathJax-Span-1399" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">y</script> can sometimes
  take values intermediate between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame"><nobr><span class="math" id="MathJax-Span-1400" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1401"><span class="mn" id="MathJax-Span-1402" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame"><nobr><span class="math" id="MathJax-Span-1403" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1404"><span class="mn" id="MathJax-Span-1405" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">1</script>.  Show that the
  cross-entropy is still minimized when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame"><nobr><span class="math" id="MathJax-Span-1406" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1407"><span class="mi" id="MathJax-Span-1408" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1409" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1410" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1411" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1412" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1413" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">\sigma(z) = y</script> for all
  training inputs.  When this is the case the cross-entropy has the
  value:
  <a class="displaced_anchor" name="eqtn64"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-111-Frame"><nobr><span class="math" id="MathJax-Span-1414" role="math" style="width: 100%; display: inline-block; min-width: 23.091em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 23.091em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1415"><span class="mtable" id="MathJax-Span-1416" style="min-width: 23.532em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.091em;"><span style="display: inline-block; position: absolute; width: 16.767em; height: 0px; clip: rect(-1.664em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -8.38em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 16.767em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1420"><span class="mrow" id="MathJax-Span-1421"><span class="mi" id="MathJax-Span-1422" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1424" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1425"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1426" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1427" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1428" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1429" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1432" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1433" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1434"></span><span class="mi" id="MathJax-Span-1435" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1436" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1437" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1438" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1441" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1442" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1443"></span><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1445" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1446" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1447" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1448" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1449" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1450" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.076em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-64"><span class="mrow" id="MathJax-Span-1418"><span class="mtext" id="MathJax-Span-1419" style="font-family: MathJax_Main;">(64)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">\begin{eqnarray}
    C = -\frac{1}{n} \sum_x [y \ln y+(1-y) \ln(1-y)].
  \tag{64}\end{eqnarray}</script>
  The quantity <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame"><nobr><span class="math" id="MathJax-Span-1451" role="math" style="width: 12.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1452"><span class="mo" id="MathJax-Span-1453" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-1454" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1455" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1456" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1457"></span><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1459" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-1460" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-1461" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1462" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1463" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1464" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1465" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-1466"></span><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1468" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1469" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1470" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1472" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">-[y \ln y+(1-y)\ln(1-y)]</script> is sometimes known as the
  <a href="http://en.wikipedia.org/wiki/Binary_entropy_function">binary
    entropy</a>.<p></p><p></p></li></ul><p></p><p></p><h4><a name="problems_382219"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problems_382219">Problems</a></h4><ul>
<li><strong>Many-layer multi-neuron networks</strong> In the notation introduced in
  the <a href="http://neuralnetworksanddeeplearning.com/chap2.html">last chapter</a>, show that for the quadratic
  cost the partial derivative with respect to weights in the output
  layer is
  <a class="displaced_anchor" name="eqtn65"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-113-Frame"><nobr><span class="math" id="MathJax-Span-1473" role="math" style="width: 100%; display: inline-block; min-width: 22.012em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 22.012em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1474"><span class="mtable" id="MathJax-Span-1475" style="min-width: 22.453em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.012em;"><span style="display: inline-block; position: absolute; width: 15.738em; height: 0px; clip: rect(-1.713em 1000.002em 1.228em -999.998em); top: 0.002em; left: 50%; margin-left: -7.841em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1479"><span class="mrow" id="MathJax-Span-1480"><span class="mfrac" id="MathJax-Span-1481"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1482"><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1484" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-1485"><span class="mi" id="MathJax-Span-1486" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1487"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1490"><span class="mrow" id="MathJax-Span-1491"><span class="mi" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1494"><span class="mrow" id="MathJax-Span-1495"><span class="mi" id="MathJax-Span-1496"></span><span class="mo" id="MathJax-Span-1497" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 11.718em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1498"><span class="mrow" id="MathJax-Span-1499"><span class="mfrac" id="MathJax-Span-1500"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1501" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1503" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1504" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1506" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1507" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-1508"><span class="mrow" id="MathJax-Span-1509"><span class="mi" id="MathJax-Span-1510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1514" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1515"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1517" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1519" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1520" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1521" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1523" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-1524"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1525" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1528"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1529" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1530" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-1531" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1532" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1533" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.076em 1000.002em 0.199em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="mjx-eqn-65"><span class="mrow" id="MathJax-Span-1477"><span class="mtext" id="MathJax-Span-1478" style="font-family: MathJax_Main;">(65)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-113">\begin{eqnarray}
      \frac{\partial C}{\partial w^L_{jk}} & = & \frac{1}{n}
      \sum_x a^{L-1}_k  (a^L_j-y_j) \sigma'(z^L_j).
  \tag{65}\end{eqnarray}</script>
  The term <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame"><nobr><span class="math" id="MathJax-Span-1534" role="math" style="width: 2.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1535"><span class="msup" id="MathJax-Span-1536"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1537" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1538" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1539" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1540"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1541" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-1543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1544" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">\sigma'(z^L_j)</script> causes a learning slowdown whenever an
  output neuron saturates on the wrong value.  Show that for the
  cross-entropy cost the output error <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame"><nobr><span class="math" id="MathJax-Span-1545" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1546"><span class="msubsup" id="MathJax-Span-1547"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">\delta^L</script> for a single training
  example <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame"><nobr><span class="math" id="MathJax-Span-1550" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1551"><span class="mi" id="MathJax-Span-1552" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">x</script> is given by
  <a class="displaced_anchor" name="eqtn66"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-117-Frame"><nobr><span class="math" id="MathJax-Span-1553" role="math" style="width: 100%; display: inline-block; min-width: 12.061em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.061em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1554"><span class="mtable" id="MathJax-Span-1555" style="min-width: 12.306em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.061em;"><span style="display: inline-block; position: absolute; width: 5.591em; height: 0px; clip: rect(-0.978em 1000.002em 0.493em -999.998em); top: 0.002em; left: 50%; margin-left: -2.792em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="msubsup" id="MathJax-Span-1561"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1562" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1564" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1565" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1566" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-1567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1568" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1569" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1570" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.831em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-66"><span class="mrow" id="MathJax-Span-1557"><span class="mtext" id="MathJax-Span-1558" style="font-family: MathJax_Main;">(66)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-117">\begin{eqnarray} 
    \delta^L = a^L-y.
  \tag{66}\end{eqnarray}</script>
  Use this expression to show that the partial derivative with respect
  to the weights in the output layer is given by
  <a class="displaced_anchor" name="eqtn67"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-118-Frame"><nobr><span class="math" id="MathJax-Span-1571" role="math" style="width: 100%; display: inline-block; min-width: 19.365em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 19.365em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1572"><span class="mtable" id="MathJax-Span-1573" style="min-width: 19.708em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.365em;"><span style="display: inline-block; position: absolute; width: 12.993em; height: 0px; clip: rect(-1.713em 1000.002em 1.228em -999.998em); top: 0.002em; left: 50%; margin-left: -6.468em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1577"><span class="mrow" id="MathJax-Span-1578"><span class="mfrac" id="MathJax-Span-1579"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1580"><span class="mi" id="MathJax-Span-1581" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1582" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-1583"><span class="mi" id="MathJax-Span-1584" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1585"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1586" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1588"><span class="mrow" id="MathJax-Span-1589"><span class="mi" id="MathJax-Span-1590" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1592"><span class="mrow" id="MathJax-Span-1593"><span class="mi" id="MathJax-Span-1594"></span><span class="mo" id="MathJax-Span-1595" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 8.973em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1596"><span class="mrow" id="MathJax-Span-1597"><span class="mfrac" id="MathJax-Span-1598"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1599" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1601" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1602" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1604" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1605" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-1606"><span class="mrow" id="MathJax-Span-1607"><span class="mi" id="MathJax-Span-1608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1610" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-1611" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1612" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1613"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1614" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1617" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1618" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1619" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1620" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1621" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1622" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.076em 1000.002em 0.199em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="mjx-eqn-67"><span class="mrow" id="MathJax-Span-1575"><span class="mtext" id="MathJax-Span-1576" style="font-family: MathJax_Main;">(67)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-118">\begin{eqnarray} 
      \frac{\partial C}{\partial w^L_{jk}} & = & \frac{1}{n} \sum_x 
      a^{L-1}_k  (a^L_j-y_j).
  \tag{67}\end{eqnarray}</script>
  The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame"><nobr><span class="math" id="MathJax-Span-1623" role="math" style="width: 2.797em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1624"><span class="msup" id="MathJax-Span-1625"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1626" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1627" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1628" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1629"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1630" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-1632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">\sigma'(z^L_j)</script> term has vanished, and so the cross-entropy
  avoids the problem of learning slowdown, not just when used with a
  single neuron, as we saw earlier, but also in many-layer
  multi-neuron networks.  A simple variation on this analysis holds
  also for the biases.  If this is not obvious to you, then you should
  work through that analysis as well.<p></p><p></p></li><li><strong>Using the quadratic cost when we have linear neurons in the
  output layer</strong> Suppose that we have a many-layer multi-neuron
  network.  Suppose all the neurons in the final layer are
  <em>linear neurons</em>, meaning that the sigmoid activation function
  is not applied, and the outputs are simply <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame"><nobr><span class="math" id="MathJax-Span-1634" role="math" style="width: 3.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.532em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1635"><span class="msubsup" id="MathJax-Span-1636"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1637" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1638" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1640" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1641" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1642" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">a^L_j = z^L_j</script>.  Show
  that if we use the quadratic cost function then the output error
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame"><nobr><span class="math" id="MathJax-Span-1645" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1646"><span class="msubsup" id="MathJax-Span-1647"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1648" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">\delta^L</script> for a single training example <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame"><nobr><span class="math" id="MathJax-Span-1650" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1651"><span class="mi" id="MathJax-Span-1652" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">x</script> is given by
  <a class="displaced_anchor" name="eqtn68"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-123-Frame"><nobr><span class="math" id="MathJax-Span-1653" role="math" style="width: 100%; display: inline-block; min-width: 12.061em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.061em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1654"><span class="mtable" id="MathJax-Span-1655" style="min-width: 12.306em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.061em;"><span style="display: inline-block; position: absolute; width: 5.591em; height: 0px; clip: rect(-0.978em 1000.002em 0.493em -999.998em); top: 0.002em; left: 50%; margin-left: -2.792em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1659"><span class="mrow" id="MathJax-Span-1660"><span class="msubsup" id="MathJax-Span-1661"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1664" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1665" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1666" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-1667" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1668" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1669" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1670" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.831em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-68"><span class="mrow" id="MathJax-Span-1657"><span class="mtext" id="MathJax-Span-1658" style="font-family: MathJax_Main;">(68)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-123">\begin{eqnarray}
    \delta^L = a^L-y.
  \tag{68}\end{eqnarray}</script>
  Similarly to the previous problem, use this expression to show that
  the partial derivatives with respect to the weights and biases in
  the output layer are given by
  <a class="displaced_anchor" name="eqtn69"></a><a class="displaced_anchor" name="eqtn70"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-124-Frame"><nobr><span class="math" id="MathJax-Span-1671" role="math" style="width: 100%; display: inline-block; min-width: 19.071em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 19.071em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 9.267em -999.998em); top: -6.566em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1672"><span class="mtable" id="MathJax-Span-1673" style="min-width: 19.463em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.071em;"><span style="display: inline-block; position: absolute; width: 12.699em; height: 0px; clip: rect(-3.184em 1000.002em 2.699em -999.998em); top: 0.002em; left: 50%; margin-left: -6.321em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 9.267em -999.998em); top: -6.566em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -5.684em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1677"><span class="mrow" id="MathJax-Span-1678"><span class="mfrac" id="MathJax-Span-1679"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1680"><span class="mi" id="MathJax-Span-1681" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1682" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-1683"><span class="mi" id="MathJax-Span-1684" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1686" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-1687" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-1688"><span class="mrow" id="MathJax-Span-1689"><span class="mi" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 5.395em -999.998em); top: -2.694em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1725"><span class="mrow" id="MathJax-Span-1726"><span class="mfrac" id="MathJax-Span-1727"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1728"><span class="mi" id="MathJax-Span-1729" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1730" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -3.233em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-1731"><span class="mi" id="MathJax-Span-1732" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1733"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1734" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-1735" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="texatom" id="MathJax-Span-1736"><span class="mrow" id="MathJax-Span-1737"><span class="mi" id="MathJax-Span-1738" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.669em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.571em;"></span></span><span style="position: absolute; clip: rect(2.159em 1000.002em 5.787em -999.998em); top: -4.311em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.684em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1692"><span class="mrow" id="MathJax-Span-1693"><span class="mi" id="MathJax-Span-1694"></span><span class="mo" id="MathJax-Span-1695" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.694em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1739"><span class="mrow" id="MathJax-Span-1740"><span class="mi" id="MathJax-Span-1741"></span><span class="mo" id="MathJax-Span-1742" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.316em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 9.071em -999.998em); top: -6.468em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 8.679em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -5.684em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1696"><span class="mrow" id="MathJax-Span-1697"><span class="mfrac" id="MathJax-Span-1698"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1699" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1700" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1701" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1702" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1704" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1705" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-1706"><span class="mrow" id="MathJax-Span-1707"><span class="mi" id="MathJax-Span-1708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-1709" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1710" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-1711" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1712" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1713"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1714" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1715" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1717" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1718" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1719" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1720" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1721" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -2.694em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1743"><span class="mrow" id="MathJax-Span-1744"><span class="mfrac" id="MathJax-Span-1745"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1746" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-1747" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1748" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1749" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1751" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1752"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1753" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1756" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-1757" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1758" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-1759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1761" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.473em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.547em 1000.002em 1.718em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.684em; right: 0.002em;"><span class="mtd" id="mjx-eqn-69"><span class="mrow" id="MathJax-Span-1675"><span class="mtext" id="MathJax-Span-1676" style="font-family: MathJax_Main;">(69)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.694em; right: 0.002em;"><span class="mtd" id="mjx-eqn-70"><span class="mrow" id="MathJax-Span-1723"><span class="mtext" id="MathJax-Span-1724" style="font-family: MathJax_Main;">(70)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.571em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.803em; vertical-align: -2.647em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-124">\begin{eqnarray}
      \frac{\partial C}{\partial w^L_{jk}} & = & \frac{1}{n} \sum_x 
      a^{L-1}_k  (a^L_j-y_j) \tag{69}\\
      \frac{\partial C}{\partial b^L_{j}} & = & \frac{1}{n} \sum_x 
      (a^L_j-y_j).
  \tag{70}\end{eqnarray}</script>
  This shows that if the output neurons are linear neurons then the
  quadratic cost will not give rise to any problems with a learning
  slowdown.  In this case the quadratic cost is, in fact, an
  appropriate cost function to use.
</li></ul><p></p><p></p><h4><a name="using_the_cross-entropy_to_classify_mnist_digits"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#using_the_cross-entropy_to_classify_mnist_digits">Using the cross-entropy to classify MNIST digits</a></h4><p></p><p></p><p>The cross-entropy is easy to implement as part of a program which
learns using gradient descent and backpropagation.  We'll do that
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code">later in the
  chapter</a>, developing an improved version of our
<a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits">earlier
  program</a> for classifying the MNIST handwritten digits,
<tt>network.py</tt>.  The new program is called <tt>network2.py</tt>, and
incorporates not just the cross-entropy, but also several other
techniques developed in this chapter*<span class="marginnote">
*The code is available
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network2.py">on
    GitHub</a>.</span>.  For now, let's look at how well our new program
classifies MNIST digits.  As was the case in Chapter 1, we'll use a
network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame"><nobr><span class="math" id="MathJax-Span-1762" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1763"><span class="mn" id="MathJax-Span-1764" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">30</script> hidden neurons, and we'll use a mini-batch size of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame"><nobr><span class="math" id="MathJax-Span-1765" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1766"><span class="mn" id="MathJax-Span-1767" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">10</script>.  We set the learning rate to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame"><nobr><span class="math" id="MathJax-Span-1768" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1769"><span class="mi" id="MathJax-Span-1770" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1771" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1772" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">\eta = 0.5</script>*<span class="marginnote">
*In Chapter 1
  we used the quadratic cost and a learning rate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame"><nobr><span class="math" id="MathJax-Span-1773" role="math" style="width: 3.109em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.027em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1774"><span class="mi" id="MathJax-Span-1775" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1776" style="font-family: MathJax_Main; padding-left: 0.249em;">=</span><span class="mn" id="MathJax-Span-1777" style="font-family: MathJax_Main; padding-left: 0.249em;">3.0</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.088em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">\eta = 3.0</script>.  As
  discussed above, it's not possible to say precisely what it means to
  use the "same" learning rate when the cost function is changed.
  For both cost functions I experimented to find a learning rate that
  provides near-optimal performance, given the other hyper-parameter
  choices. <br> <br> There is, incidentally, a very rough
  general heuristic for relating the learning rate for the
  cross-entropy and the quadratic cost.  As we saw earlier, the
  gradient terms for the quadratic cost have an extra <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame"><nobr><span class="math" id="MathJax-Span-1778" role="math" style="width: 6.05em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.886em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.027em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1779"><span class="msup" id="MathJax-Span-1780"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-1781" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.658em;"><span class="mo" id="MathJax-Span-1782" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1783" style="font-family: MathJax_Main; padding-left: 0.249em;">=</span><span class="mi" id="MathJax-Span-1784" style="font-family: MathJax_Math-italic; padding-left: 0.249em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1785" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1786" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1787" style="font-family: MathJax_Main; padding-left: 0.249em;"></span><span class="mi" id="MathJax-Span-1788" style="font-family: MathJax_Math-italic; padding-left: 0.249em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.171em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">\sigma' =
  \sigma(1-\sigma)</script> term in them.  Suppose we average this over values
  for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame"><nobr><span class="math" id="MathJax-Span-1790" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1791"><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.588em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">\sigma</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame"><nobr><span class="math" id="MathJax-Span-1793" role="math" style="width: 9.073em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.909em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.782em 1000.004em 4.579em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1794"><span class="msubsup" id="MathJax-Span-1795"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(2.945em 1000.004em 4.579em -999.996em); top: -3.999em; left: 0.004em;"><span class="mo" id="MathJax-Span-1796" style="font-family: MathJax_Size1; vertical-align: 0.004em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.167em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.272em 1000.004em 4.252em -999.996em); top: -4.571em; left: 0.739em;"><span class="mn" id="MathJax-Span-1797" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.272em 1000.004em 4.252em -999.996em); top: -3.672em; left: 0.494em;"><span class="mn" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math-italic; padding-left: 0.167em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mi" id="MathJax-Span-1800" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mi" id="MathJax-Span-1801" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1802" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1803" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1804" style="font-family: MathJax_Main; padding-left: 0.249em;"></span><span class="mi" id="MathJax-Span-1805" style="font-family: MathJax_Math-italic; padding-left: 0.249em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="mo" id="MathJax-Span-1806" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1807" style="font-family: MathJax_Main; padding-left: 0.249em;">=</span><span class="mn" id="MathJax-Span-1808" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="texatom" id="MathJax-Span-1809"><span class="mrow" id="MathJax-Span-1810"><span class="mo" id="MathJax-Span-1811" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1812" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.588em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">\int_0^1 d\sigma \sigma(1-\sigma) = 1/6</script>.  We see
  that (very roughly) the quadratic cost learns an average of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame"><nobr><span class="math" id="MathJax-Span-1813" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1814"><span class="mn" id="MathJax-Span-1815" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">6</script>
  times slower, for the same learning rate.  This suggests that a
  reasonable starting point is to divide the learning rate for the
  quadratic cost by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame"><nobr><span class="math" id="MathJax-Span-1816" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-1817"><span class="mn" id="MathJax-Span-1818" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">6</script>.  Of course, this argument is far from
  rigourous, and shouldn't be taken too seriously.  Still, it can
  sometimes be a useful starting point.</span> and we train for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame"><nobr><span class="math" id="MathJax-Span-1819" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1820"><span class="mn" id="MathJax-Span-1821" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-134">30</script> epochs.
The interface to <tt>network2.py</tt> is slightly different than
<tt>network.py</tt>, but it should still be clear what is going on.  You
can, by the way, get documentation about <tt>network2.py</tt>'s
interface by using commands such as <tt>help(network2.Network.SGD)</tt>
in a Python shell.</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>Note, by the way, that the <tt>net.large_weight_initializer()</tt>
command is used to initialize the weights and biases in the same way
as described in Chapter 1.  We need to run this command because later
in this chapter we'll change the default weight initialization in our
networks.  The result from running the above sequence of commands is a
network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame"><nobr><span class="math" id="MathJax-Span-1822" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1823"><span class="mn" id="MathJax-Span-1824" style="font-family: MathJax_Main;">95.49</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-135">95.49</script> percent accuracy.  This is pretty close to the
result we obtained in Chapter 1, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame"><nobr><span class="math" id="MathJax-Span-1825" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1826"><span class="mn" id="MathJax-Span-1827" style="font-family: MathJax_Main;">95.42</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">95.42</script> percent, using the quadratic
cost.</p><p>Let's look also at the case where we use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame"><nobr><span class="math" id="MathJax-Span-1828" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1829"><span class="mn" id="MathJax-Span-1830" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-137">100</script> hidden neurons, the
cross-entropy, and otherwise keep the parameters the same.  In this
case we obtain an accuracy of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame"><nobr><span class="math" id="MathJax-Span-1831" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1832"><span class="mn" id="MathJax-Span-1833" style="font-family: MathJax_Main;">96.82</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-138">96.82</script> percent.  That's a substantial
improvement over the results from Chapter 1, where we obtained a
classification accuracy of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame"><nobr><span class="math" id="MathJax-Span-1834" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1835"><span class="mn" id="MathJax-Span-1836" style="font-family: MathJax_Main;">96.59</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">96.59</script> percent, using the quadratic cost.
That may look like a small change, but consider that the error rate
has dropped from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame"><nobr><span class="math" id="MathJax-Span-1837" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1838"><span class="mn" id="MathJax-Span-1839" style="font-family: MathJax_Main;">3.41</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-140">3.41</script> percent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame"><nobr><span class="math" id="MathJax-Span-1840" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1841"><span class="mn" id="MathJax-Span-1842" style="font-family: MathJax_Main;">3.18</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-141">3.18</script> percent.  That is, we've
eliminated about one in fourteen of the original errors.  That's quite
a handy improvement.</p><p>It's encouraging that the cross-entropy cost gives us similar or
better results than the quadratic cost.  However, these results don't
conclusively prove that the cross-entropy is a better choice.  The
reason is that I've put only a little effort into choosing
hyper-parameters such as learning rate, mini-batch size, and so on.
For the improvement to be really convincing we'd need to do a thorough
job optimizing such hyper-parameters.  Still, the results are
encouraging, and reinforce our earlier theoretical argument that the
cross-entropy is a better choice than the quadratic cost.</p><p>This, by the way, is part of a general pattern that we'll see through
this chapter and, indeed, through much of the rest of the book.  We'll
develop a new technique, we'll try it out, and we'll get "improved"
results.  It is, of course, nice that we see such improvements.  But
the interpretation of such improvements is always problematic.
They're only truly convincing if we see an improvement after putting
tremendous effort into optimizing all the other hyper-parameters.
That's a great deal of work, requiring lots of computing power, and
we're not usually going to do such an exhaustive investigation.
Instead, we'll proceed on the basis of informal tests like those done
above.  Still, you should keep in mind that such tests fall short of
definitive proof, and remain alert to signs that the arguments are
breaking down.</p><p>By now, we've discussed the cross-entropy at great length.  Why go to
so much effort when it gives only a small improvement to our MNIST
results?  Later in the chapter we'll see other techniques - notably,
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">regularization</a> - which
give much bigger improvements.  So why so much focus on cross-entropy?
Part of the reason is that the cross-entropy is a widely-used cost
function, and so is worth understanding well.  But the more important
reason is that neuron saturation is an important problem in neural
nets, a problem we'll return to repeatedly throughout the book.  And
so I've discussed the cross-entropy at length because it's a good
laboratory to begin understanding neuron saturation and how it may be
addressed.</p><p></p><h4><a name="what_does_the_cross-entropy_mean_where_does_it_come_from"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#what_does_the_cross-entropy_mean_where_does_it_come_from">What does the cross-entropy mean?  Where does it come from?</a></h4><p></p><p>Our discussion of the cross-entropy has focused on algebraic analysis
and practical implementation.  That's useful, but it leaves unanswered
broader conceptual questions, like: what does the cross-entropy mean?
Is there some intuitive way of thinking about the cross-entropy?  And
how could we have dreamed up the cross-entropy in the first place?</p><p>Let's begin with the last of these questions: what could have
motivated us to think up the cross-entropy in the first place?
Suppose we'd discovered the learning slowdown described earlier, and
understood that the origin was the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-142-Frame"><nobr><span class="math" id="MathJax-Span-1843" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1844"><span class="msup" id="MathJax-Span-1845"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1846" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1847" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1848" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1849" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1850" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-142">\sigma'(z)</script> terms in
Equations <span id="margin_489267202018_reveal" class="equation_link">(55)</span><span id="margin_489267202018" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn55" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-143-Frame"><nobr><span class="math" id="MathJax-Span-1851" role="math" style="width: 13.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1852"><span class="mtable" id="MathJax-Span-1853" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 13.14em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1854"><span class="mrow" id="MathJax-Span-1855"><span class="mfrac" id="MathJax-Span-1856"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1857"><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1859" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-1860"><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1862" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1863"><span class="mrow" id="MathJax-Span-1864"><span class="mi" id="MathJax-Span-1865"></span><span class="mo" id="MathJax-Span-1866" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.806em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1867"><span class="mrow" id="MathJax-Span-1868"><span class="mi" id="MathJax-Span-1869"></span><span class="mo" id="MathJax-Span-1870" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1871" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1872" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1873" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1874" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-1875"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1876" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1877" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1878" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1879" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1880" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-1881" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1882" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1883" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-1884"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1885" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1886" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1887" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1888" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1889" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-143">\begin{eqnarray} 
  \frac{\partial C}{\partial w} & = & (a-y)\sigma'(z) x = a \sigma'(z)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_489267202018_reveal').click(function() {$('#margin_489267202018').toggle('slow', function() {});});</script> and <span id="margin_909516500698_reveal" class="equation_link">(56)</span><span id="margin_909516500698" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn56" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-144-Frame"><nobr><span class="math" id="MathJax-Span-1890" role="math" style="width: 13.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1891"><span class="mtable" id="MathJax-Span-1892" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.551em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1893"><span class="mrow" id="MathJax-Span-1894"><span class="mfrac" id="MathJax-Span-1895"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1896"><span class="mi" id="MathJax-Span-1897" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1898" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1899"><span class="mi" id="MathJax-Span-1900" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1901" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1902"><span class="mrow" id="MathJax-Span-1903"><span class="mi" id="MathJax-Span-1904"></span><span class="mo" id="MathJax-Span-1905" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 9.267em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1906"><span class="mrow" id="MathJax-Span-1907"><span class="mi" id="MathJax-Span-1908"></span><span class="mo" id="MathJax-Span-1909" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1910" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1911" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1912" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1913" style="font-family: MathJax_Main;">)</span><span class="msup" id="MathJax-Span-1914"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1915" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1916" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1917" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1918" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1919" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1920" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1921" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="msup" id="MathJax-Span-1922"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1923" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-1924" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1925" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1926" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1927" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-144">\begin{eqnarray}  
  \frac{\partial C}{\partial b} & = & (a-y)\sigma'(z) = a \sigma'(z) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_909516500698_reveal').click(function() {$('#margin_909516500698').toggle('slow', function() {});});</script>.  After staring at
those equations for a bit, we might wonder if it's possible to choose
a cost function so that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame"><nobr><span class="math" id="MathJax-Span-1928" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1929"><span class="msup" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1931" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1934" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1935" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">\sigma'(z)</script> term disappeared.  In that
case, the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame"><nobr><span class="math" id="MathJax-Span-1936" role="math" style="width: 3.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1937"><span class="mi" id="MathJax-Span-1938" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1939" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1940" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1941" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">C = C_x</script> for a single training example <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame"><nobr><span class="math" id="MathJax-Span-1943" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1944"><span class="mi" id="MathJax-Span-1945" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-147">x</script> would
satisfy
<a class="displaced_anchor" name="eqtn71"></a><a class="displaced_anchor" name="eqtn72"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-148-Frame"><nobr><span class="math" id="MathJax-Span-1946" role="math" style="width: 100%; display: inline-block; min-width: 14.12em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.12em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1947"><span class="mtable" id="MathJax-Span-1948" style="min-width: 14.414em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.12em;"><span style="display: inline-block; position: absolute; width: 7.65em; height: 0px; clip: rect(-2.792em 1000.002em 2.306em -999.998em); top: 0.002em; left: 50%; margin-left: -3.821em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.15em -999.998em); top: -5.243em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1952"><span class="mrow" id="MathJax-Span-1953"><span class="mfrac" id="MathJax-Span-1954"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1955"><span class="mi" id="MathJax-Span-1956" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1957" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-1958"><span class="mi" id="MathJax-Span-1959" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1960"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1961" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-1962" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -2.596em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1980"><span class="mrow" id="MathJax-Span-1981"><span class="mfrac" id="MathJax-Span-1982"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1983"><span class="mi" id="MathJax-Span-1984" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1985" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1986"><span class="mi" id="MathJax-Span-1987" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1988" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span><span style="position: absolute; clip: rect(2.257em 1000.002em 5.591em -999.998em); top: -4.017em; left: 2.306em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.243em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1963"><span class="mrow" id="MathJax-Span-1964"><span class="mi" id="MathJax-Span-1965"></span><span class="mo" id="MathJax-Span-1966" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.596em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-1989"><span class="mrow" id="MathJax-Span-1990"><span class="mi" id="MathJax-Span-1991"></span><span class="mo" id="MathJax-Span-1992" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 6.473em -999.998em); top: -4.654em; left: 3.63em;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -5.243em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1967"><span class="mrow" id="MathJax-Span-1968"><span class="msubsup" id="MathJax-Span-1969"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1970" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-1971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1972" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1974" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1975" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1976" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.596em; left: 0.002em;"><span class="mtd" id="MathJax-Span-1993"><span class="mrow" id="MathJax-Span-1994"><span class="mi" id="MathJax-Span-1995"></span><span class="mo" id="MathJax-Span-1996" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1997" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1998" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1999" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2000" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2001" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.659em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.154em 1000.002em 1.816em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.243em; right: 0.002em;"><span class="mtd" id="mjx-eqn-71"><span class="mrow" id="MathJax-Span-1950"><span class="mtext" id="MathJax-Span-1951" style="font-family: MathJax_Main;">(71)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.596em; right: 0.002em;"><span class="mtd" id="mjx-eqn-72"><span class="mrow" id="MathJax-Span-1978"><span class="mtext" id="MathJax-Span-1979" style="font-family: MathJax_Main;">(72)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.952em; vertical-align: -2.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-148">\begin{eqnarray} 
  \frac{\partial C}{\partial w_j} & = & x_j(a-y) \tag{71}\\
  
  \frac{\partial C}{\partial b } & = & (a-y).
\tag{72}\end{eqnarray}</script>
If we could choose the cost function to make these equations true,
then they would capture in a simple way the intuition that the greater
the initial error, the faster the neuron learns.  They'd also
eliminate the problem of a learning slowdown.  In fact, starting from
these equations we'll now show that it's possible to derive the form
of the cross-entropy, simply by following our mathematical noses.  To
see this, note that from the chain rule we have
<a class="displaced_anchor" name="eqtn73"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-149-Frame"><nobr><span class="math" id="MathJax-Span-2002" role="math" style="width: 100%; display: inline-block; min-width: 13.63em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 13.63em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2003"><span class="mtable" id="MathJax-Span-2004" style="min-width: 13.924em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.63em;"><span style="display: inline-block; position: absolute; width: 7.159em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -3.576em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2008"><span class="mrow" id="MathJax-Span-2009"><span class="mfrac" id="MathJax-Span-2010"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2011"><span class="mi" id="MathJax-Span-2012" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2013" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-2014"><span class="mi" id="MathJax-Span-2015" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2017" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2018" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2019"><span class="mi" id="MathJax-Span-2020" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2021" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2022"><span class="mi" id="MathJax-Span-2023" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2024" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="msup" id="MathJax-Span-2025"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2026" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2028" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2029" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2030" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2031" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-73"><span class="mrow" id="MathJax-Span-2006"><span class="mtext" id="MathJax-Span-2007" style="font-family: MathJax_Main;">(73)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-149">\begin{eqnarray}
  \frac{\partial C}{\partial b} = \frac{\partial C}{\partial a} 
  \sigma'(z).
\tag{73}\end{eqnarray}</script>
Using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame"><nobr><span class="math" id="MathJax-Span-2032" role="math" style="width: 14.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.659em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2033"><span class="msup" id="MathJax-Span-2034"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2035" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-2036" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2038" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2039" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2040" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2041" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2042" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2043" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2044" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2045" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2046" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2047" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2048" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2049" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2050" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2051" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2052" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2053" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2054" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="mo" id="MathJax-Span-2055" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2056" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2057" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2058" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-2059" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">\sigma'(z) = \sigma(z)(1-\sigma(z)) = a(1-a)</script> the last equation
becomes
<a class="displaced_anchor" name="eqtn74"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-151-Frame"><nobr><span class="math" id="MathJax-Span-2060" role="math" style="width: 100%; display: inline-block; min-width: 15.1em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.1em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2061"><span class="mtable" id="MathJax-Span-2062" style="min-width: 15.395em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.1em;"><span style="display: inline-block; position: absolute; width: 8.63em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -4.311em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.63em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2066"><span class="mrow" id="MathJax-Span-2067"><span class="mfrac" id="MathJax-Span-2068"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2069"><span class="mi" id="MathJax-Span-2070" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2071" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-2072"><span class="mi" id="MathJax-Span-2073" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2074" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2075" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2076" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2077"><span class="mi" id="MathJax-Span-2078" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2079" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2080"><span class="mi" id="MathJax-Span-2081" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2082" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-2083" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2084" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2085" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2086" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2087" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-2088" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2089" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-74"><span class="mrow" id="MathJax-Span-2064"><span class="mtext" id="MathJax-Span-2065" style="font-family: MathJax_Main;">(74)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-151">\begin{eqnarray}
  \frac{\partial C}{\partial b} = \frac{\partial C}{\partial a} 
  a(1-a).
\tag{74}\end{eqnarray}</script>
Comparing to Equation <span id="margin_354156252375_reveal" class="equation_link">(72)</span><span id="margin_354156252375" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn72" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-152-Frame"><nobr><span class="math" id="MathJax-Span-2090" role="math" style="width: 6.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2091"><span class="mtable" id="MathJax-Span-2092" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.375em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2093"><span class="mrow" id="MathJax-Span-2094"><span class="mfrac" id="MathJax-Span-2095"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2096"><span class="mi" id="MathJax-Span-2097" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2098" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-2099"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2101" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-2102"><span class="mrow" id="MathJax-Span-2103"><span class="mi" id="MathJax-Span-2104"></span><span class="mo" id="MathJax-Span-2105" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2106"><span class="mrow" id="MathJax-Span-2107"><span class="mi" id="MathJax-Span-2108"></span><span class="mo" id="MathJax-Span-2109" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2110" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2111" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2112" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2113" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-152">\begin{eqnarray}  
  \frac{\partial C}{\partial b } & = & (a-y) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_354156252375_reveal').click(function() {$('#margin_354156252375').toggle('slow', function() {});});</script> we obtain
<a class="displaced_anchor" name="eqtn75"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-153-Frame"><nobr><span class="math" id="MathJax-Span-2114" role="math" style="width: 100%; display: inline-block; min-width: 13.777em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 13.777em;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2115"><span class="mtable" id="MathJax-Span-2116" style="min-width: 14.071em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.777em;"><span style="display: inline-block; position: absolute; width: 7.306em; height: 0px; clip: rect(-1.566em 1000.002em 1.081em -999.998em); top: 0.002em; left: 50%; margin-left: -3.674em;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.306em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.15em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2120"><span class="mrow" id="MathJax-Span-2121"><span class="mfrac" id="MathJax-Span-2122"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2123"><span class="mi" id="MathJax-Span-2124" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2125" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2126"><span class="mi" id="MathJax-Span-2127" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2128" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2129" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2130" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -1.125em;"><span class="mrow" id="MathJax-Span-2131"><span class="mi" id="MathJax-Span-2132" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2134" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.282em; left: 50%; margin-left: -1.811em;"><span class="mrow" id="MathJax-Span-2135"><span class="mi" id="MathJax-Span-2136" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2137" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2138" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2139" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2140" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-2141" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.728em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2142" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.929em 1000.002em 0.346em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="mjx-eqn-75"><span class="mrow" id="MathJax-Span-2118"><span class="mtext" id="MathJax-Span-2119" style="font-family: MathJax_Main;">(75)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.502em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-153">\begin{eqnarray}
  \frac{\partial C}{\partial a} = \frac{a-y}{a(1-a)}.
\tag{75}\end{eqnarray}</script>
Integrating this expression with respect to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame"><nobr><span class="math" id="MathJax-Span-2143" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2144"><span class="mi" id="MathJax-Span-2145" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-154">a</script> gives
<a class="displaced_anchor" name="eqtn76"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-155-Frame"><nobr><span class="math" id="MathJax-Span-2146" role="math" style="width: 100%; display: inline-block; min-width: 25.542em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 25.542em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2147"><span class="mtable" id="MathJax-Span-2148" style="min-width: 26.032em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 25.542em;"><span style="display: inline-block; position: absolute; width: 19.316em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -9.654em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 19.316em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2152"><span class="mrow" id="MathJax-Span-2153"><span class="mi" id="MathJax-Span-2154" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-2156" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-2157" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2159" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2160"></span><span class="mi" id="MathJax-Span-2161" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-2162" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-2163" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-2164" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2165" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2166" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2167" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2168" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2169"></span><span class="mo" id="MathJax-Span-2170" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2171" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2172" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2173" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-2174" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2175" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2176" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="texatom" id="MathJax-Span-2177" style="padding-left: 0.248em;"><span class="mrow" id="MathJax-Span-2178"><span class="mi" id="MathJax-Span-2179" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-2180" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-2181" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-2182" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-2183" style="font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-2184" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-2185" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-2186" style="font-family: MathJax_Main;">t</span></span></span><span class="mo" id="MathJax-Span-2187" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-76"><span class="mrow" id="MathJax-Span-2150"><span class="mtext" id="MathJax-Span-2151" style="font-family: MathJax_Main;">(76)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-155">\begin{eqnarray}
  C = -[y \ln a + (1-y) \ln (1-a)]+ {\rm constant},
\tag{76}\end{eqnarray}</script>
for some constant of integration.  This is the contribution to the
cost from a single training example, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame"><nobr><span class="math" id="MathJax-Span-2188" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2189"><span class="mi" id="MathJax-Span-2190" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-156">x</script>.  To get the full cost
function we must average over training examples, obtaining
<a class="displaced_anchor" name="eqtn77"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-157-Frame"><nobr><span class="math" id="MathJax-Span-2191" role="math" style="width: 100%; display: inline-block; min-width: 28.042em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 28.042em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2192"><span class="mtable" id="MathJax-Span-2193" style="min-width: 28.581em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.042em;"><span style="display: inline-block; position: absolute; width: 21.865em; height: 0px; clip: rect(-1.664em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -10.929em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 21.865em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2197"><span class="mrow" id="MathJax-Span-2198"><span class="mi" id="MathJax-Span-2199" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2200" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-2201" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2202"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2203" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-2204" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2205" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2206" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-2207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2208" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2209" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2210" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2211"></span><span class="mi" id="MathJax-Span-2212" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">a</span><span class="mo" id="MathJax-Span-2213" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-2214" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-2215" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2216" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2217" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2218" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-2219" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2220"></span><span class="mo" id="MathJax-Span-2221" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2222" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2223" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2224" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="mo" id="MathJax-Span-2225" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2226" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2227" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="texatom" id="MathJax-Span-2228" style="padding-left: 0.248em;"><span class="mrow" id="MathJax-Span-2229"><span class="mi" id="MathJax-Span-2230" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-2231" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-2232" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-2233" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-2234" style="font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-2235" style="font-family: MathJax_Main;">a</span><span class="mi" id="MathJax-Span-2236" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-2237" style="font-family: MathJax_Main;">t</span></span></span><span class="mo" id="MathJax-Span-2238" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.076em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-77"><span class="mrow" id="MathJax-Span-2195"><span class="mtext" id="MathJax-Span-2196" style="font-family: MathJax_Main;">(77)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-157">\begin{eqnarray}
  C = -\frac{1}{n} \sum_x [y \ln a +(1-y) \ln(1-a)] + {\rm constant},
\tag{77}\end{eqnarray}</script>
where the constant here is the average of the individual constants for
each training example.  And so we see that
Equations <span id="margin_159347648373_reveal" class="equation_link">(71)</span><span id="margin_159347648373" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn71" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-158-Frame"><nobr><span class="math" id="MathJax-Span-2239" role="math" style="width: 8.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2240"><span class="mtable" id="MathJax-Span-2241" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 7.65em; height: 0px;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.15em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2242"><span class="mrow" id="MathJax-Span-2243"><span class="mfrac" id="MathJax-Span-2244"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2245"><span class="mi" id="MathJax-Span-2246" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2247" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-2248"><span class="mi" id="MathJax-Span-2249" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2250"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2251" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.017em; left: 2.306em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.066em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-2253"><span class="mrow" id="MathJax-Span-2254"><span class="mi" id="MathJax-Span-2255"></span><span class="mo" id="MathJax-Span-2256" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 3.63em;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.066em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2257"><span class="mrow" id="MathJax-Span-2258"><span class="msubsup" id="MathJax-Span-2259"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2260" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-2261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2262" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2263" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2264" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2265" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2266" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.502em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-158">\begin{eqnarray} 
  \frac{\partial C}{\partial w_j} & = & x_j(a-y)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_159347648373_reveal').click(function() {$('#margin_159347648373').toggle('slow', function() {});});</script>
and <span id="margin_829496292668_reveal" class="equation_link">(72)</span><span id="margin_829496292668" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn72" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-159-Frame"><nobr><span class="math" id="MathJax-Span-2267" role="math" style="width: 6.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2268"><span class="mtable" id="MathJax-Span-2269" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.375em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2270"><span class="mrow" id="MathJax-Span-2271"><span class="mfrac" id="MathJax-Span-2272"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2273"><span class="mi" id="MathJax-Span-2274" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2275" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-2276"><span class="mi" id="MathJax-Span-2277" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2278" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-2279"><span class="mrow" id="MathJax-Span-2280"><span class="mi" id="MathJax-Span-2281"></span><span class="mo" id="MathJax-Span-2282" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.512em -999.998em); top: -4.017em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2283"><span class="mrow" id="MathJax-Span-2284"><span class="mi" id="MathJax-Span-2285"></span><span class="mo" id="MathJax-Span-2286" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2287" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2288" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2289" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2290" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-159">\begin{eqnarray}  
  \frac{\partial C}{\partial b } & = & (a-y) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_829496292668_reveal').click(function() {$('#margin_829496292668').toggle('slow', function() {});});</script> uniquely determine the form
of the cross-entropy, up to an overall constant term.  The
cross-entropy isn't something that was miraculously pulled out of thin
air.  Rather, it's something that we could have discovered in a simple
and natural way.</p><p>What about the intuitive meaning of the cross-entropy?  How should we
think about it?  Explaining this in depth would take us further afield
than I want to go.  However, it is worth mentioning that there is a
standard way of interpreting the cross-entropy that comes from the
field of information theory.  Roughly speaking, the idea is that the
cross-entropy is a measure of surprise.  In particular, our neuron is
trying to compute the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame"><nobr><span class="math" id="MathJax-Span-2291" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2292"><span class="mi" id="MathJax-Span-2293" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2294" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2295" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2296" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2297" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2298" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2299" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2300" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">x \rightarrow y = y(x)</script>.  But instead
it computes the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame"><nobr><span class="math" id="MathJax-Span-2301" role="math" style="width: 6.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2302"><span class="mi" id="MathJax-Span-2303" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2304" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2305" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="mo" id="MathJax-Span-2306" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2307" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">a</span><span class="mo" id="MathJax-Span-2308" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2309" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2310" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">x \rightarrow a = a(x)</script>.  Suppose we think
of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame"><nobr><span class="math" id="MathJax-Span-2311" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2312"><span class="mi" id="MathJax-Span-2313" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">a</script> as our neuron's estimated probability that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-163-Frame"><nobr><span class="math" id="MathJax-Span-2314" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2315"><span class="mi" id="MathJax-Span-2316" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">y</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame"><nobr><span class="math" id="MathJax-Span-2317" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2318"><span class="mn" id="MathJax-Span-2319" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">1</script>, and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-165-Frame"><nobr><span class="math" id="MathJax-Span-2320" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2321"><span class="mn" id="MathJax-Span-2322" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2323" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2324" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">1-a</script> is the estimated probability that the right value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame"><nobr><span class="math" id="MathJax-Span-2325" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2326"><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">y</script> is
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame"><nobr><span class="math" id="MathJax-Span-2328" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2329"><span class="mn" id="MathJax-Span-2330" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-167">0</script>.  Then the cross-entropy measures how "surprised" we are, on
average, when we learn the true value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-168-Frame"><nobr><span class="math" id="MathJax-Span-2331" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2332"><span class="mi" id="MathJax-Span-2333" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-168">y</script>.  We get low surprise if
the output is what we expect, and high surprise if the output is
unexpected.  Of course, I haven't said exactly what "surprise"
means, and so this perhaps seems like empty verbiage.  But in fact
there is a precise information-theoretic way of saying what is meant
by surprise.  Unfortunately, I don't know of a good, short,
self-contained discussion of this subject that's available online.
But if you want to dig deeper, then Wikipedia contains a
<a href="http://en.wikipedia.org/wiki/Cross_entropy#Motivation">brief
  summary</a> that will get you started down the right track.  And the
details can be filled in by working through the materials about the
Kraft inequality in chapter 5 of the book about information theory by
<a href="http://books.google.ca/books?id=VWq5GG6ycxMC">Cover and Thomas</a>.</p><p></p><h4><a name="problem_793129"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_793129">Problem</a></h4><ul>
<li> We've discussed at length the learning slowdown that can occur
  when output neurons saturate, in networks using the quadratic cost
  to train.  Another factor that may inhibit learning is the presence
  of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame"><nobr><span class="math" id="MathJax-Span-2334" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2335"><span class="msubsup" id="MathJax-Span-2336"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2337" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-2338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-169">x_j</script> term in Equation <span id="margin_703048509096_reveal" class="equation_link">(61)</span><span id="margin_703048509096" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn61" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-170-Frame"><nobr><span class="math" id="MathJax-Span-2339" role="math" style="width: 11.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2340"><span class="mtable" id="MathJax-Span-2341" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 11.375em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.375em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2342"><span class="mrow" id="MathJax-Span-2343"><span class="mfrac" id="MathJax-Span-2344"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2345"><span class="mi" id="MathJax-Span-2346" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2347" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-2348"><span class="mi" id="MathJax-Span-2349" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2350"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2351" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2353" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2354" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2355" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-2356" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2357" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2358" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-2359" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2360" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2361" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-2362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2363" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2364" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2365" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2366" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2367" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2368" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2369" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2370" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-170">\begin{eqnarray} 
  \frac{\partial C}{\partial w_j} =  \frac{1}{n} \sum_x x_j(\sigma(z)-y) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_703048509096_reveal').click(function() {$('#margin_703048509096').toggle('slow', function() {});});</script>.  Because of
  this term, when an input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-171-Frame"><nobr><span class="math" id="MathJax-Span-2371" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2372"><span class="msubsup" id="MathJax-Span-2373"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2374" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-2375" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-171">x_j</script> is near to zero, the corresponding
  weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-172-Frame"><nobr><span class="math" id="MathJax-Span-2376" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2377"><span class="msubsup" id="MathJax-Span-2378"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2379" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-172">w_j</script> will learn slowly.  Explain why it is not possible to
  eliminate the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame"><nobr><span class="math" id="MathJax-Span-2381" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2382"><span class="msubsup" id="MathJax-Span-2383"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2384" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-2385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-173">x_j</script> term through a clever choice of cost function.
</li></ul><p></p><p></p><h4><a name="softmax"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#softmax">Softmax</a></h4><p></p><p>In this chapter we'll mostly use the cross-entropy cost to address the
problem of learning slowdown.  However, I want to briefly describe
another approach to the problem, based on what are called
<em>softmax</em> layers of neurons. We're not actually going to use
softmax layers in the remainder of the chapter, so if you're in a
great hurry, you can skip to the next section.  However, softmax is
still worth understanding, in part because it's intrinsically
interesting, and in part because we'll use softmax layers in
<a href="http://neuralnetworksanddeeplearning.com/chap6.html">Chapter 6</a>, in our discussion of deep neural
networks.</p><p>The idea of softmax is to define a new type of output layer for our
neural networks.  It begins in the same way as with a sigmoid layer,
by forming the weighted inputs*<span class="marginnote">
*In describing the softmax
  we'll make frequent use of notation introduced in the
  <a href="http://neuralnetworksanddeeplearning.com/chap2.html">last chapter</a>.  You may wish to revisit that
  chapter if you need to refresh your memory about the meaning of the
  notation.</span> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-174-Frame"><nobr><span class="math" id="MathJax-Span-2386" role="math" style="width: 10.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.806em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2387"><span class="msubsup" id="MathJax-Span-2388"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2389" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2392" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="munderover" id="MathJax-Span-2393" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2394" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="texatom" id="MathJax-Span-2395"><span class="mrow" id="MathJax-Span-2396"><span class="mi" id="MathJax-Span-2397" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2398" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2399" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-2400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2401"><span class="mrow" id="MathJax-Span-2402"><span class="mi" id="MathJax-Span-2403" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-2404" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2405"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2406" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-2407"><span class="mrow" id="MathJax-Span-2408"><span class="mi" id="MathJax-Span-2409" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-2410" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-2411" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2413" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-2414" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2415" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-2416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.547em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-174">z^L_j = \sum_{k} w^L_{jk} a^{L-1}_k + b^L_j</script>.  However,
we don't apply the sigmoid function to get the output.  Instead, in a
softmax layer we apply the so-called <em>softmax function</em> to the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame"><nobr><span class="math" id="MathJax-Span-2418" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2419"><span class="msubsup" id="MathJax-Span-2420"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2421" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2422" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2423" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">z^L_j</script>.  According to this function, the activation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame"><nobr><span class="math" id="MathJax-Span-2424" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2425"><span class="msubsup" id="MathJax-Span-2426"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2427" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-176">a^L_j</script> of the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame"><nobr><span class="math" id="MathJax-Span-2430" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2431"><span class="mi" id="MathJax-Span-2432" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-177">j</script>th output neuron is
<a class="displaced_anchor" name="eqtn78"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-178-Frame"><nobr><span class="math" id="MathJax-Span-2433" role="math" style="width: 100%; display: inline-block; min-width: 12.551em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.551em;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2434"><span class="mtable" id="MathJax-Span-2435" style="min-width: 12.797em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.551em;"><span style="display: inline-block; position: absolute; width: 6.081em; height: 0px; clip: rect(-1.811em 1000.002em 1.326em -999.998em); top: 0.002em; left: 50%; margin-left: -3.037em;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2439"><span class="mrow" id="MathJax-Span-2440"><span class="msubsup" id="MathJax-Span-2441"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2442" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2443" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2444" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2445" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2446" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2447"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2448" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2449"><span class="mrow" id="MathJax-Span-2450"><span class="msubsup" id="MathJax-Span-2451"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2453" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2454" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2455"><span class="munderover" id="MathJax-Span-2456"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2457" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2458" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2459" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2460" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2461"><span class="mrow" id="MathJax-Span-2462"><span class="msubsup" id="MathJax-Span-2463"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2465" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2466" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2467" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.395em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="mjx-eqn-78"><span class="mrow" id="MathJax-Span-2437"><span class="mtext" id="MathJax-Span-2438" style="font-family: MathJax_Main;">(78)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-178">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}},
\tag{78}\end{eqnarray}</script>
where in the denominator we sum over all the output neurons.</p><p>If you're not familiar with the softmax function,
Equation <span id="margin_349675573833_reveal" class="equation_link">(78)</span><span id="margin_349675573833" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-179-Frame"><nobr><span class="math" id="MathJax-Span-2468" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2469"><span class="mtable" id="MathJax-Span-2470" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2471"><span class="mrow" id="MathJax-Span-2472"><span class="msubsup" id="MathJax-Span-2473"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2474" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2475" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2476" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2477" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2478" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2479"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2480" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2481"><span class="mrow" id="MathJax-Span-2482"><span class="msubsup" id="MathJax-Span-2483"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2484" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2485" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2486" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2487"><span class="munderover" id="MathJax-Span-2488"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2489" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2490" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2491" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2492" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2493"><span class="mrow" id="MathJax-Span-2494"><span class="msubsup" id="MathJax-Span-2495"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2497" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2498" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-179">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_349675573833_reveal').click(function() {$('#margin_349675573833').toggle('slow', function() {});});</script> may look pretty opaque.  It's certainly
not obvious why we'd want to use this function.  And it's also not
obvious that this will help us address the learning slowdown problem.
To better understand Equation <span id="margin_277672038361_reveal" class="equation_link">(78)</span><span id="margin_277672038361" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-180-Frame"><nobr><span class="math" id="MathJax-Span-2499" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2500"><span class="mtable" id="MathJax-Span-2501" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="msubsup" id="MathJax-Span-2504"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2505" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2507" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2508" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2509" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2510"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2511" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2512"><span class="mrow" id="MathJax-Span-2513"><span class="msubsup" id="MathJax-Span-2514"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2516" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2517" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2518"><span class="munderover" id="MathJax-Span-2519"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2520" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2522" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2523" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2524"><span class="mrow" id="MathJax-Span-2525"><span class="msubsup" id="MathJax-Span-2526"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2527" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2528" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2529" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-180">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_277672038361_reveal').click(function() {$('#margin_277672038361').toggle('slow', function() {});});</script>, suppose we have a
network with four output neurons, and four corresponding weighted
inputs, which we'll denote <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame"><nobr><span class="math" id="MathJax-Span-2530" role="math" style="width: 4.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.071em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2531"><span class="msubsup" id="MathJax-Span-2532"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2533" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2534" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2535" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2536" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2537" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2538" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2540" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2541" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2542" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2543" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2545" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-181">z^L_1, z^L_2, z^L_3</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame"><nobr><span class="math" id="MathJax-Span-2546" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2547"><span class="msubsup" id="MathJax-Span-2548"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2549" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2551" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-182">z^L_4</script>.  Shown
below are adjustable sliders showing possible values for the weighted
inputs, and a graph of the corresponding output activations.  A good
place to start exploration is by using the bottom slider to increase
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame"><nobr><span class="math" id="MathJax-Span-2552" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2553"><span class="msubsup" id="MathJax-Span-2554"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2555" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2557" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-183">z^L_4</script>:</p><p>
    <script type="text/javascript" style="display:none">
<!--
/*! jQuery UI - v1.11.2 - 2014-10-16
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return n=!a&&o.length?e.widget.extend.apply(null,[n].concat(o)):n,a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))}),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>u&&(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,e.top+p+f+m>d&&(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.accordion",{version:"1.11.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.length&&(!t.length||e.index()<t.index()),l=this.options.animate||{},u=h&&l.down||l,d=function(){o._toggleComplete(i)};return"number"==typeof u&&(a=u),"string"==typeof u&&(n=u),n=n||u.easing||l.easing,a=a||u.duration||l.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:d,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?r+=i.now:"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,d):e.animate(this.showProps,a,n,d)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)
}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.2"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0
},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,z,H,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),z=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=z,H=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;z>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(H)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[H]):[!0,""],j=H.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>H||$&&H>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(H.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===H.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(H.getTime()===G.getTime()?" "+this._currentClass:"")+(H.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+H.getMonth()+"' data-year='"+H.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+H.getDate()+"</span>":"<a class='ui-state-default"+(H.getTime()===R.getTime()?" ui-state-highlight":"")+(H.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.2",e.datepicker,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)
},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=this.element.children(this.handles[i]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=u-t.height,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.dialog",{version:"1.11.2",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;
if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.droppable",{version:"1.11.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable;var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.2",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};
f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})},e.widget("ui.progressbar",{version:"1.11.2",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectable",e.ui.mouse,{version:"1.11.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.selectmenu",{version:"1.11.2",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this,i=this.element.attr("tabindex");this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:i||this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.attr("value"),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=(this.options.max-this._valueMin())%this.options.step;this.max=this.options.max-e},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));
return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.spinner",{version:"1.11.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]
}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){o.html(e),s._trigger("load",i,r)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.2",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){e.data("ui-tooltip-open")&&n._delay(function(){t&&(t.type=a),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){u.of=e,o.is(":hidden")||o.position(u)}var a,o,r,h,l,u=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(l=s.clone(),l.removeAttr("id").find("[id]").removeAttr("id")):l=s,e("<div>").html(l).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(u.of),clearInterval(h))},e.fx.interval)),this._trigger("open",t,{tooltip:o}),r={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}},i[0]!==this.element[0]&&(r.remove=function(){this._removeTooltip(o)}),t&&"mouseover"!==t.type||(r.mouseleave="close"),t&&"focusin"!==t.type||(r.focusout="close"),this._on(!0,i,r)}},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);a&&(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)))},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}})});
//-->
</script>
    <link rel="stylesheet" href="http://neuralnetworksanddeeplearning.com/js/jquery-ui.css">
    <script style="display:none">
<!--
var defaultFont = "16px Arial";
var littleFont = "11px Arial";
var defaultLine = "#333"; 
var defaultText = "#333";
var defaultMathText = "#000";
var sliderColor = "#2A6EA6";

function isAlpha(s) {
    // Checks whether the string s contains alphabetical characters only
    return /^[a-zA-Z]+$/.test(s);
}

function selfOrDefault(x, deflt) {
    // Return x if x is not undefined, otherwise return the default
    return (typeof x !== "undefined") ? x : deflt;
}
function parseArgs(args, deflt) {
    // For each key in the associative array deflt, set args to that key,
    // if the key isn't in args.  Then return args.
    args = selfOrDefault(args, {});
    for (var index in deflt) {
	args[index] = selfOrDefault(args[index], deflt[index]);
    }
    return args;
}

$(function() {

    var zs = [2.5, -1, 3.2, 0.5]; // initial values for the z sliders
    function smG() {
	var Z = 0;
	for (var j=0; j <=3; j++) {
	    Z += Math.exp(zs[j]);
	} 
	var as = [0, 0, 0, 0];
	for (var j=0; j <=3; j++) {
	    var smGCanvas = $("#smG"+(j+1))[0];
	    var smGContext = smGCanvas.getContext("2d");
	    smGContext.clear();
            as[j] = Math.exp(zs[j])/Z;
	    smGContext.filledRectangle(5.5, 12.5, 205.5, 32.5, "#aaa", "white", 1);
	    smGContext.filledRectangle(
		6.5, 13.5, 6.5+as[j]*200, 31.5, sliderColor, sliderColor, 0);
            smGContext.line(5.5, 9.5, 5.5, 12.5, "#aaa");
	    smGContext.text("0", 2, 7, {"font": "10px Arial"});
            smGContext.line(205.5, 9.5, 205.5, 12.5, "#aaa");
	    smGContext.text("1", 202, 7, {"font": "10px Arial"});
	    $("#activation"+(j+1)).val(as[j].toFixed(3));
	};
    }

function createSlider(j) {
  $("#slider"+j).slider({
      range: "min", 
      min: -5, 
      max: 5, 
      value: zs[j-1], 
      step: 0.1,
      slide: function(event, ui) {
	  $("#amount"+j).val(ui.value);
	  zs[j-1] = ui.value;
	  smG();
      }
  });
}

    for (var j=1; j < 5; j++) {
	createSlider(j);
	$("#amount"+j).val($("#slider"+j).slider("value"));
	smG();
    }
});


//-->
</script>
    <script style="display:none">
<!--
CanvasRenderingContext2D.prototype.clear = function() {
    // Clear the canvas corresponding to this context
    this.canvas.width = this.canvas.width;
}
    
CanvasRenderingContext2D.prototype.text = function(content, x, y, args) {
    // Note that the optional arguments are based on CSS property
    // names, not the canvas property names.  The exception is
    // "textBaseline", because the values for canvas are not modelled
    // on those for CSS.
    var args = parseArgs(args, {"font": defaultFont,
				"color": defaultText,
				"text-align": "left",
				"textBaseline": "alphabetic"});
    this.font = args.font;
    this.fillStyle = args.color;
    this.textAlign = args["text-align"];
    this.textBaseline = args.textBaseline;
    this.fillText(content, x, y);
}

CanvasRenderingContext2D.prototype.mathText = function(content, x, y, args) {
    // Renders content at x, y on the canvas.  Note that we can use ^
    // and _ to denote superscripts and subscripts, respectively.  So,
    // for example, f^1(x_2) renders as f with a 1 superscript, with
    // an argument of x with a 2 subscript.  args is as for the .text
    // method.  Note that only text-align: left and text-align: center
    // are currently supported.
    var args = parseArgs(args, {"size": 20,
				"littleSize": 14,
				"color": defaultMathText,
				"text-align": "left", 
			        "up": -8,
			        "down": 4});
    var dx = 0;
    var dy = 0;
    var fontMath = String(args.size)+"px MJX_Math"; // for alphabet
    var fontMain = String(args.size)+"px MJX_Main"; // for numbers
    var littleFontMath = String(args.littleSize)+"px MJX_Math";
    var littleFontMain = String(args.littleSize)+"px MJX_Main";
    this.fillStyle = args.color;
    this.textAlign = "left";
    var little = false;
    if (args["text-align"] === "center") {
	// adjust the starting x value
	var width = 0;
	content.split('').forEach(function(s) {
	    if (s === "_" || s === "^") {
		if (s === "^") {width += 2};
		little = true;
	    } else {
		if (!little && !isAlpha(s)) {this.font = fontMain};
		if (!little && isAlpha(s)) {this.font = fontMath};
		if (little && !isAlpha(s)) {this.font = littleFontMain};
		if (little && isAlpha(s)) {this.font = littleFontMath};
		width += this.measureText(s).width;
		little = false;
	    }
	}, this);
	x -= Math.round(width/2);
    }
    little = false;
    content.split('').forEach(function(s) {
	if (s === '^') {
	    dx += 2;
	    dy = args.up;
	    little = true;
	} else if (s === "_") {
	    dy = args.down;
	    little = true;
	} else {
	    if (!little && !isAlpha(s)) {this.font = fontMain};
	    if (!little && isAlpha(s)) {this.font = fontMath};
	    if (little && !isAlpha(s)) {this.font = littleFontMain};
	    if (little && isAlpha(s)) {this.font = littleFontMath};
	    this.fillText(s, x+dx, y+dy);
	    dx += this.measureText(s).width;
	    dy = 0;
	    little = false;
	}
    }, this);
}

CanvasRenderingContext2D.prototype.line = function(
    x1, y1, x2, y2, color, lineWidth) {
    this.beginPath();
    this.moveTo(x1, y1);
    this.lineTo(x2, y2);
    this.strokeStyle = selfOrDefault(color, "black");
    this.lineWidth = selfOrDefault(lineWidth, 1);
    this.stroke();
}

CanvasRenderingContext2D.prototype.arrow = function(
    x1, y1, x2, y2, color, lineWidth) {
    this.line(x1, y1, x2, y2, color, lineWidth);
    var delta = { // difference vector between the two points
	"x": x1-x2,
	"y": y1-y2
    }
    var norm = Math.sqrt(delta.x * delta.x + delta.y * delta.y);
    var n = { // normalized difference vector, pointing from pt 2 to pt 1
	"x": delta.x / norm,
	"y": delta.y / norm
    }
    var m = { // vector orthogonal to n
	"x": -n.y,
	"y": n.x
    }
    var arrow1 = { // part of the arrowhead
	"x": 8*n.x+4*m.x,
	"y": 8*n.y+4*m.y
    }
    var arrow2 = { // other part of the arrowhead
	"x": 8*n.x-4*m.x,
	"y": 8*n.y-4*m.y
    }
    this.line(x2, y2, x2+arrow1.x, y2+arrow1.y, color, lineWidth);
    this.line(x2, y2, x2+arrow2.x, y2+arrow2.y, color, lineWidth);
}

CanvasRenderingContext2D.prototype.filledRectangle = function(
    x1, y1, x2, y2, color, fillColor, lineWidth) {
    this.strokeStyle = selfOrDefault(color, "black");
    this.fillStyle = selfOrDefault(fillColor, "white");
    this.lineWidth = selfOrDefault(lineWidth, 1);
    this.fillRect(x1, y1, x2-x1, y2-y1);
    this.strokeRect(x1, y1, x2-x1, y2-y1);
}

CanvasRenderingContext2D.prototype.filledRoundedRectangle = function(
    x1, y1, x2, y2, r, color, fillColor, lineWidth) {
    this.strokeStyle = selfOrDefault(color, "black");
    this.fillStyle = selfOrDefault(fillColor, "white");
    this.lineWidth = selfOrDefault(lineWidth, 1);
    this.beginPath();
    this.moveTo(x1+r, y1);
    this.lineTo(x2-r, y1);
    this.quadraticCurveTo(x2, y1, x2, y1+r);
    this.lineTo(x2, y2-r);
    this.quadraticCurveTo(x2, y2, x2-r, y2);
    this.lineTo(x1+r, y2);
    this.quadraticCurveTo(x1, y2, x1, y2-r);
    this.lineTo(x1, y1+r);
    this.quadraticCurveTo(x1, y1, x1+r, y1);
    this.closePath();
    this.stroke();
    this.fill();
}

CanvasRenderingContext2D.prototype.circle = function(
    x, y, r, color, lineWidth, fillColor) { 
    // This is slower but produces smoother circles than the arc based method
    color = selfOrDefault(color, "black");
    lineWidth = selfOrDefault(lineWidth, 1);
    this.beginPath();
    var increment = 3/r;
    var x1 = x+r, y1 = y, x2, y2;
    this.moveTo(x1, y1);
    for (var theta = increment; theta < 2*Math.PI+increment; theta += increment) {
	x2 = x+r*Math.cos(theta);
	y2 = y+r*Math.sin(theta);
	this.lineTo(x2, y2);
	x1 = x2, y1 = y2;
    }
    this.strokeStyle = color;
    this.lineWidth = lineWidth;
    if (typeof fillColor !== "undefined") {
	this.fillStyle = fillColor;
    }
    this.stroke();
    this.fill();
}

CanvasRenderingContext2D.prototype.quickCircle = function(
    x, y, r, color, lineWidth) {
    this.beginPath();
    this.arc(x, y, r, 0, 2*Math.PI);
    this.strokeStyle = selfOrDefault(color, "black");
    this.lineWidth = selfOrDefault(lineWidth, 1);
    this.stroke();
}


function scale(in1, in2, out1, out2) {
    return function(x) {return (x-in1)*(out2-out1)/(in2-in1)+out1;}
}

CanvasRenderingContext2D.prototype.plot = function(
    data, xScale, yScale, color, lineWidth) {
    for (var j = 0; j < data.length-1; j++) {
	this.line(
	    xScale(data[j].x), yScale(data[j].y), 
	    xScale(data[j+1].x), yScale(data[j+1].y), 
	    color, lineWidth)
    }
}

//-->
</script>
<style>
.softmaxTable {
  height: 64px;
  width: 260px;
}
.canvasSoftmax {
  position: absolute; 
  margin-top: -22px; 
  padding-bottom: 5px;
}
.softmaxInput {
  border: 0;
  font: 18px Arial;
}
.softmaxA {
  padding-top: 7px;
  padding-left: 5px;
}
</style>
</p><p>
</p><table>
<tbody><tr>
<td class="softmaxTable">
<div id="slider1" style="width: 200px;" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 75.7575757575758%;"></div><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 75.7575757575758%;"></span></div>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-184-Frame"><nobr><span class="math" id="MathJax-Span-2558" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2559"><span class="msubsup" id="MathJax-Span-2560"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2561" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2563" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2564" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-184">z^L_1 = </script> <input type="text" id="amount1" readonly="" class="softmaxInput">
</td>
<td class="softmaxTable">
<canvas id="smG1" width="300" height="40" class="canvasSoftmax"></canvas>
<div class="softmaxA"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-185-Frame"><nobr><span class="math" id="MathJax-Span-2565" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2566"><span class="msubsup" id="MathJax-Span-2567"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2568" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2569" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2570" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2571" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-185">a^L_1 = </script> <input type="text" id="activation1" readonly="" class="softmaxInput"></div>
</td>
</tr>
<tr>
<td class="softmaxTable">
<div id="slider2" style="width: 200px;" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 40.4040404040404%;"></div><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 40.4040404040404%;"></span></div>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-186-Frame"><nobr><span class="math" id="MathJax-Span-2572" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2573"><span class="msubsup" id="MathJax-Span-2574"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2575" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2576" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2577" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-186">z^L_2</script> = <input type="text" id="amount2" readonly="" class="softmaxInput">
</td>
<td class="softmaxTable">
<canvas id="smG2" width="300" height="40" class="canvasSoftmax"></canvas>
<div class="softmaxA"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-187-Frame"><nobr><span class="math" id="MathJax-Span-2578" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2579"><span class="msubsup" id="MathJax-Span-2580"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2581" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2583" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2584" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-187">a^L_2 = </script> <input type="text" id="activation2" readonly="" class="softmaxInput"></div>
</td>
</tr>
<tr>
<td class="softmaxTable">
<div id="slider3" style="width: 200px;" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 82.8282828282828%;"></div><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 82.8282828282828%;"></span></div>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-188-Frame"><nobr><span class="math" id="MathJax-Span-2585" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2586"><span class="msubsup" id="MathJax-Span-2587"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2588" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2589" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2590" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-188">z^L_3</script> = <input type="text" id="amount3" readonly="" class="softmaxInput">
</td>
<td class="softmaxTable">
<canvas id="smG3" width="300" height="40" class="canvasSoftmax"></canvas>
<div class="softmaxA"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-189-Frame"><nobr><span class="math" id="MathJax-Span-2591" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2592"><span class="msubsup" id="MathJax-Span-2593"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2594" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2596" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2597" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-189">a^L_3 = </script> <input type="text" id="activation3" readonly="" class="softmaxInput"></div>
</td>
</tr>
<tr>
<td class="softmaxTable">
<div id="slider4" style="width: 200px;" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all"><div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min" style="width: 55.5555555555556%;"></div><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 55.5555555555556%;"></span></div>
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame"><nobr><span class="math" id="MathJax-Span-2598" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2599"><span class="msubsup" id="MathJax-Span-2600"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2601" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2602" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2603" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-190">z^L_4</script> = <input type="text" id="amount4" readonly="" class="softmaxInput">
</td>
<td class="softmaxTable">
<canvas id="smG4" width="300" height="40" class="canvasSoftmax"></canvas>
<div class="softmaxA"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-191-Frame"><nobr><span class="math" id="MathJax-Span-2604" role="math" style="width: 2.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2605"><span class="msubsup" id="MathJax-Span-2606"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2607" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2608" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2609" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2610" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-191">a^L_4 = </script> <input type="text" id="activation4" readonly="" class="softmaxInput"></div>
</td>
</tr>
</tbody></table>
<p></p><p>As you increase <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-192-Frame"><nobr><span class="math" id="MathJax-Span-2611" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2612"><span class="msubsup" id="MathJax-Span-2613"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2614" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2615" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2616" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-192">z^L_4</script>, you'll see an increase in the corresponding
output activation, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-193-Frame"><nobr><span class="math" id="MathJax-Span-2617" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2618"><span class="msubsup" id="MathJax-Span-2619"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2620" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-193">a^L_4</script>, and a decrease in the other output
activations.  Similarly, if you decrease <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-194-Frame"><nobr><span class="math" id="MathJax-Span-2623" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2624"><span class="msubsup" id="MathJax-Span-2625"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2626" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.444em;"><span class="mn" id="MathJax-Span-2628" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-194">z^L_4</script> then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-195-Frame"><nobr><span class="math" id="MathJax-Span-2629" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2630"><span class="msubsup" id="MathJax-Span-2631"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2632" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2633" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2634" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">a^L_4</script> will
decrease, and all the other output activations will increase.  In
fact, if you look closely, you'll see that in both cases the total
change in the other activations exactly compensates for the change in
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame"><nobr><span class="math" id="MathJax-Span-2635" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2636"><span class="msubsup" id="MathJax-Span-2637"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2638" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-196">a^L_4</script>.  The reason is that the output activations are guaranteed to
always sum up to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-197-Frame"><nobr><span class="math" id="MathJax-Span-2641" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2642"><span class="mn" id="MathJax-Span-2643" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-197">1</script>, as we can prove using
Equation <span id="margin_339874824261_reveal" class="equation_link">(78)</span><span id="margin_339874824261" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-198-Frame"><nobr><span class="math" id="MathJax-Span-2644" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2645"><span class="mtable" id="MathJax-Span-2646" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2647"><span class="mrow" id="MathJax-Span-2648"><span class="msubsup" id="MathJax-Span-2649"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2650" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2652" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2653" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2654" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2655"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2656" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2657"><span class="mrow" id="MathJax-Span-2658"><span class="msubsup" id="MathJax-Span-2659"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2660" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2661" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2662" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2663"><span class="munderover" id="MathJax-Span-2664"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2665" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2666" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2667" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2668" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2669"><span class="mrow" id="MathJax-Span-2670"><span class="msubsup" id="MathJax-Span-2671"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2672" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2673" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2674" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-198">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_339874824261_reveal').click(function() {$('#margin_339874824261').toggle('slow', function() {});});</script> and a little algebra:
<a class="displaced_anchor" name="eqtn79"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-199-Frame"><nobr><span class="math" id="MathJax-Span-2675" role="math" style="width: 100%; display: inline-block; min-width: 16.228em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.228em;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.738em -999.998em); top: -4.213em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2676"><span class="mtable" id="MathJax-Span-2677" style="min-width: 16.522em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.228em;"><span style="display: inline-block; position: absolute; width: 9.806em; height: 0px; clip: rect(-2.007em 1000.002em 1.522em -999.998em); top: 0.002em; left: 50%; margin-left: -4.9em;"><span style="position: absolute; clip: rect(2.944em 1000.002em 5.542em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.699em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 5.493em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2681"><span class="mrow" id="MathJax-Span-2682"><span class="munderover" id="MathJax-Span-2683"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2684" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-2685" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2686" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2687" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2688" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.218em -999.998em); top: -4.017em; left: 2.944em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-2690"><span class="mrow" id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692"></span><span class="mo" id="MathJax-Span-2693" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.061em 1000.002em 5.444em -999.998em); top: -4.066em; left: 4.316em;"><span style="display: inline-block; position: relative; width: 5.493em; height: 0px;"><span style="position: absolute; clip: rect(2.012em 1000.002em 5.395em -999.998em); top: -4.017em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2694"><span class="mrow" id="MathJax-Span-2695"><span class="mfrac" id="MathJax-Span-2696"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.61em -999.998em); top: -4.9em; left: 50%; margin-left: -1.419em;"><span class="mrow" id="MathJax-Span-2697"><span class="munderover" id="MathJax-Span-2698"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2699" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2700" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2701" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2702" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2703"><span class="mrow" id="MathJax-Span-2704"><span class="msubsup" id="MathJax-Span-2705"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2706" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2707" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2708" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2709"><span class="munderover" id="MathJax-Span-2710"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2711" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2713" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2714" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2715"><span class="mrow" id="MathJax-Span-2716"><span class="msubsup" id="MathJax-Span-2717"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2718" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2719" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2720" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2721" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-2722" style="font-family: MathJax_Main; padding-left: 0.297em;">1.</span></span></span><span style="display: inline-block; width: 0px; height: 4.071em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.071em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-79"><span class="mrow" id="MathJax-Span-2679"><span class="mtext" id="MathJax-Span-2680" style="font-family: MathJax_Main;">(79)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.218em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.402em; vertical-align: -1.448em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-199">\begin{eqnarray}
  \sum_j a^L_j & = & \frac{\sum_j e^{z^L_j}}{\sum_k e^{z^L_k}} = 1.
\tag{79}\end{eqnarray}</script>
As a result, if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame"><nobr><span class="math" id="MathJax-Span-2723" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2724"><span class="msubsup" id="MathJax-Span-2725"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2726" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2728" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">a^L_4</script> increases, then the other output activations
must decrease by the same total amount, to ensure the sum over all
activations remains <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-201-Frame"><nobr><span class="math" id="MathJax-Span-2729" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2730"><span class="mn" id="MathJax-Span-2731" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-201">1</script>.  And, of course, similar statements hold for
all the other activations.</p><p>Equation <span id="margin_462555050801_reveal" class="equation_link">(78)</span><span id="margin_462555050801" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-202-Frame"><nobr><span class="math" id="MathJax-Span-2732" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2733"><span class="mtable" id="MathJax-Span-2734" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2735"><span class="mrow" id="MathJax-Span-2736"><span class="msubsup" id="MathJax-Span-2737"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2738" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2740" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2741" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2742" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2743"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2744" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2745"><span class="mrow" id="MathJax-Span-2746"><span class="msubsup" id="MathJax-Span-2747"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2748" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2749" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2750" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2751"><span class="munderover" id="MathJax-Span-2752"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2753" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2754" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2755" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2756" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2757"><span class="mrow" id="MathJax-Span-2758"><span class="msubsup" id="MathJax-Span-2759"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2760" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2761" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2762" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-202">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_462555050801_reveal').click(function() {$('#margin_462555050801').toggle('slow', function() {});});</script> also implies that the output activations
are all positive, since the exponential function is positive.
Combining this with the observation in the last paragraph, we see that
the output from the softmax layer is a set of positive numbers which
sum up to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame"><nobr><span class="math" id="MathJax-Span-2763" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2764"><span class="mn" id="MathJax-Span-2765" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-203">1</script>.  In other words, the output from the softmax layer can
be thought of as a probability distribution.</p><p>The fact that a softmax layer outputs a probability distribution is
rather pleasing.  In many problems it's convenient to be able to
interpret the output activation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-204-Frame"><nobr><span class="math" id="MathJax-Span-2766" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2767"><span class="msubsup" id="MathJax-Span-2768"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2769" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2771" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-204">a^L_j</script> as the network's estimate of
the probability that the correct output is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame"><nobr><span class="math" id="MathJax-Span-2772" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2773"><span class="mi" id="MathJax-Span-2774" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-205">j</script>.  So, for instance, in
the MNIST classification problem, we can interpret <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame"><nobr><span class="math" id="MathJax-Span-2775" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2776"><span class="msubsup" id="MathJax-Span-2777"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2778" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2780" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-206">a^L_j</script> as the
network's estimated probability that the correct digit classification
is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame"><nobr><span class="math" id="MathJax-Span-2781" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2782"><span class="mi" id="MathJax-Span-2783" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-207">j</script>.</p><p>By contrast, if the output layer was a sigmoid layer, then we
certainly couldn't assume that the activations formed a probability
distribution.  I won't explicitly prove it, but it should be plausible
that the activations from a sigmoid layer won't in general form a
probability distribution.  And so with a sigmoid output layer we don't
have such a simple interpretation of the output activations.</p><p></p><h4><a name="exercise_332838"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_332838">Exercise</a></h4><ul>
<li> Construct an example showing explicitly that in a network with a
  sigmoid output layer, the output activations <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-208-Frame"><nobr><span class="math" id="MathJax-Span-2784" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2785"><span class="msubsup" id="MathJax-Span-2786"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2787" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2788" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2789" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-208">a^L_j</script> won't always
  sum to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-209-Frame"><nobr><span class="math" id="MathJax-Span-2790" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2791"><span class="mn" id="MathJax-Span-2792" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-209">1</script>.
</li></ul><p></p><p>We're starting to build up some feel for the softmax function and the
way softmax layers behave.  Just to review where we're at: the
exponentials in Equation <span id="margin_677711360314_reveal" class="equation_link">(78)</span><span id="margin_677711360314" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-210-Frame"><nobr><span class="math" id="MathJax-Span-2793" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2794"><span class="mtable" id="MathJax-Span-2795" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2796"><span class="mrow" id="MathJax-Span-2797"><span class="msubsup" id="MathJax-Span-2798"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2799" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2800" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2801" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2802" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2803" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2804"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2805" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2806"><span class="mrow" id="MathJax-Span-2807"><span class="msubsup" id="MathJax-Span-2808"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2809" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2810" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2811" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2812"><span class="munderover" id="MathJax-Span-2813"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2814" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2816" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2817" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2818"><span class="mrow" id="MathJax-Span-2819"><span class="msubsup" id="MathJax-Span-2820"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2821" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2822" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2823" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-210">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_677711360314_reveal').click(function() {$('#margin_677711360314').toggle('slow', function() {});});</script> ensure that all the output
activations are positive.  And the sum in the denominator of
Equation <span id="margin_949222228535_reveal" class="equation_link">(78)</span><span id="margin_949222228535" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn78" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-211-Frame"><nobr><span class="math" id="MathJax-Span-2824" role="math" style="width: 6.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2825"><span class="mtable" id="MathJax-Span-2826" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.787em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2827"><span class="mrow" id="MathJax-Span-2828"><span class="msubsup" id="MathJax-Span-2829"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2830" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2831" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2832" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2833" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2834" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.635em;"><span class="msubsup" id="MathJax-Span-2835"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2836" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2837"><span class="mrow" id="MathJax-Span-2838"><span class="msubsup" id="MathJax-Span-2839"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2840" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2841" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-2842" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.944em 1000.002em 4.463em -999.998em); top: -3.135em; left: 50%; margin-left: -1.468em;"><span class="mrow" id="MathJax-Span-2843"><span class="munderover" id="MathJax-Span-2844"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2845" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2846" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2847" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2848" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2849"><span class="mrow" id="MathJax-Span-2850"><span class="msubsup" id="MathJax-Span-2851"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2852" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-2853" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -3.772em; left: 0.346em;"><span class="mi" id="MathJax-Span-2854" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.091em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-211">\begin{eqnarray} 
  a^L_j = \frac{e^{z^L_j}}{\sum_k e^{z^L_k}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_949222228535_reveal').click(function() {$('#margin_949222228535').toggle('slow', function() {});});</script> ensures that the softmax outputs sum to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-212-Frame"><nobr><span class="math" id="MathJax-Span-2855" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2856"><span class="mn" id="MathJax-Span-2857" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-212">1</script>.  So that particular form no longer appears so mysterious: rather,
it is a natural way to ensure that the output activations form a
probability distribution.  You can think of softmax as a way of
rescaling the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame"><nobr><span class="math" id="MathJax-Span-2858" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2859"><span class="msubsup" id="MathJax-Span-2860"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2861" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2862" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-213">z^L_j</script>, and then squishing them together to form a
probability distribution.</p><p></p><h4><a name="exercises_193619"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercises_193619">Exercises</a></h4><ul>
<li><strong>Monotonicity of softmax</strong> Show that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-214-Frame"><nobr><span class="math" id="MathJax-Span-2864" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2865"><span class="mi" id="MathJax-Span-2866" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2867"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2868" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2869" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2871"><span class="mrow" id="MathJax-Span-2872"><span class="mo" id="MathJax-Span-2873" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2874" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2875"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2876" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2877" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-2878" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-214">\partial a^L_j / \partial
  z^L_k</script> is positive if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame"><nobr><span class="math" id="MathJax-Span-2879" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2880"><span class="mi" id="MathJax-Span-2881" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2882" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2883" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">k</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-215">j = k</script> and negative if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame"><nobr><span class="math" id="MathJax-Span-2884" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2885"><span class="mi" id="MathJax-Span-2886" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2887" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2888" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">k</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-216">j \neq k</script>.  As a
  consequence, increasing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame"><nobr><span class="math" id="MathJax-Span-2889" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2890"><span class="msubsup" id="MathJax-Span-2891"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2892" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2894" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-217">z^L_j</script> is guaranteed to increase the
  corresponding output activation, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-218-Frame"><nobr><span class="math" id="MathJax-Span-2895" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2896"><span class="msubsup" id="MathJax-Span-2897"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2898" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-218">a^L_j</script>, and will decrease all the
  other output activations.  We already saw this empirically with the
  sliders, but this is a rigorous proof.<p></p><p></p></li><li><strong>Non-locality of softmax</strong> A nice thing about sigmoid layers is
  that the output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame"><nobr><span class="math" id="MathJax-Span-2901" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2902"><span class="msubsup" id="MathJax-Span-2903"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2904" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-219">a^L_j</script> is a function of the corresponding weighted
  input, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame"><nobr><span class="math" id="MathJax-Span-2907" role="math" style="width: 5.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.904em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2908"><span class="msubsup" id="MathJax-Span-2909"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2910" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2912" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2913" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2914" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2915" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2916"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2917" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2918" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2920" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-220">a^L_j = \sigma(z^L_j)</script>.  Explain why this is not the case
  for a softmax layer: any particular output activation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame"><nobr><span class="math" id="MathJax-Span-2921" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2922"><span class="msubsup" id="MathJax-Span-2923"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2924" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-221">a^L_j</script>
  depends on <em>all</em> the weighted inputs.
</li></ul><p></p><p></p><h4><a name="problem_905066"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_905066">Problem</a></h4><ul>
<li><strong>Inverting the softmax layer</strong> Suppose we have a neural network
  with a softmax output layer, and the activations <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame"><nobr><span class="math" id="MathJax-Span-2927" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2928"><span class="msubsup" id="MathJax-Span-2929"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2930" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2931" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-222">a^L_j</script> are known.
  Show that the corresponding weighted inputs have the form <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame"><nobr><span class="math" id="MathJax-Span-2933" role="math" style="width: 6.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2934"><span class="msubsup" id="MathJax-Span-2935"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2936" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2937" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-2938" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2939" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2940" style="font-family: MathJax_Main; padding-left: 0.297em;">ln</span><span class="mo" id="MathJax-Span-2941"></span><span class="msubsup" id="MathJax-Span-2942" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2943" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-2945" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2946" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-2947" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-223">z^L_j =
  \ln a^L_j + C</script>, for some constant <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame"><nobr><span class="math" id="MathJax-Span-2948" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2949"><span class="mi" id="MathJax-Span-2950" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-224">C</script> that is independent of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame"><nobr><span class="math" id="MathJax-Span-2951" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2952"><span class="mi" id="MathJax-Span-2953" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-225">j</script>.
</li></ul><p></p><p><strong>The learning slowdown problem:</strong> We've now built up
considerable familiarity with softmax layers of neurons.  But we
haven't yet seen how a softmax layer lets us address the learning
slowdown problem.  To understand that, let's define the
<em>log-likelihood</em> cost function.  We'll use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame"><nobr><span class="math" id="MathJax-Span-2954" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2955"><span class="mi" id="MathJax-Span-2956" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-226">x</script> to denote a
training input to the network, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame"><nobr><span class="math" id="MathJax-Span-2957" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2958"><span class="mi" id="MathJax-Span-2959" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-227">y</script> to denote the corresponding
desired output.  Then the log-likelihood cost associated to this
training input is
<a class="displaced_anchor" name="eqtn80"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-228-Frame"><nobr><span class="math" id="MathJax-Span-2960" role="math" style="width: 100%; display: inline-block; min-width: 11.914em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 11.914em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2961"><span class="mtable" id="MathJax-Span-2962" style="min-width: 12.159em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 11.914em;"><span style="display: inline-block; position: absolute; width: 5.395em; height: 0px; clip: rect(-0.978em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -2.694em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.395em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2966"><span class="mrow" id="MathJax-Span-2967"><span class="mi" id="MathJax-Span-2968" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2969" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-2970" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2971" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2972"></span><span class="msubsup" id="MathJax-Span-2973" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2974" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2975" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.316em -999.998em); top: -3.87em; left: 0.542em;"><span class="mi" id="MathJax-Span-2976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2977" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.395em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="mjx-eqn-80"><span class="mrow" id="MathJax-Span-2964"><span class="mtext" id="MathJax-Span-2965" style="font-family: MathJax_Main;">(80)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-228">\begin{eqnarray}
  C \equiv -\ln a^L_y.
\tag{80}\end{eqnarray}</script>
So, for instance, if we're training with MNIST images, and input an
image of a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame"><nobr><span class="math" id="MathJax-Span-2978" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2979"><span class="mn" id="MathJax-Span-2980" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-229">7</script>, then the log-likelihood cost is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame"><nobr><span class="math" id="MathJax-Span-2981" role="math" style="width: 3.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.993em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2982"><span class="mo" id="MathJax-Span-2983" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2984" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-2985"></span><span class="msubsup" id="MathJax-Span-2986" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2987" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2988" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2989" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-230">-\ln a^L_7</script>.  To see
that this makes intuitive sense, consider the case when the network is
doing a good job, that is, it is confident the input is a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame"><nobr><span class="math" id="MathJax-Span-2990" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2991"><span class="mn" id="MathJax-Span-2992" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-231">7</script>.  In
that case it will estimate a value for the corresponding probability
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame"><nobr><span class="math" id="MathJax-Span-2993" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2994"><span class="msubsup" id="MathJax-Span-2995"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2996" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-2997" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-2998" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-232">a^L_7</script> which is close to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame"><nobr><span class="math" id="MathJax-Span-2999" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3000"><span class="mn" id="MathJax-Span-3001" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-233">1</script>, and so the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-234-Frame"><nobr><span class="math" id="MathJax-Span-3002" role="math" style="width: 3.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.993em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3003"><span class="mo" id="MathJax-Span-3004" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-3005" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-3006"></span><span class="msubsup" id="MathJax-Span-3007" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3008" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3009" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-3010" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-234">-\ln a^L_7</script> will be
small.  By contrast, when the network isn't doing such a good job, the
probability <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-235-Frame"><nobr><span class="math" id="MathJax-Span-3011" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3012"><span class="msubsup" id="MathJax-Span-3013"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3014" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3015" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-3016" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-235">a^L_7</script> will be smaller, and the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame"><nobr><span class="math" id="MathJax-Span-3017" role="math" style="width: 3.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.993em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3018"><span class="mo" id="MathJax-Span-3019" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-3020" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-3021"></span><span class="msubsup" id="MathJax-Span-3022" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3023" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.723em; left: 0.542em;"><span class="mn" id="MathJax-Span-3025" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-236">-\ln a^L_7</script> will be
larger.  So the log-likelihood cost behaves as we'd expect a cost
function to behave.</p><p>What about the learning slowdown problem?  To analyse that, recall
that the key to the learning slowdown is the behaviour of the
quantities <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-237-Frame"><nobr><span class="math" id="MathJax-Span-3026" role="math" style="width: 3.924em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.826em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3027"><span class="mi" id="MathJax-Span-3028" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3029" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-3030"><span class="mrow" id="MathJax-Span-3031"><span class="mo" id="MathJax-Span-3032" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3033" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3034"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3035" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3037"><span class="mrow" id="MathJax-Span-3038"><span class="mi" id="MathJax-Span-3039" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.547em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-237">\partial C / \partial w^L_{jk}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame"><nobr><span class="math" id="MathJax-Span-3041" role="math" style="width: 3.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.385em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3042"><span class="mi" id="MathJax-Span-3043" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3044" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-3045"><span class="mrow" id="MathJax-Span-3046"><span class="mo" id="MathJax-Span-3047" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3048" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3049"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3050" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-3051" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3052" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-238">\partial C / \partial
b^L_j</script>.  I won't go through the derivation explicitly - I'l ask you
to do in the problems, below - but with a little algebra you can
show that*<span class="marginnote">
*Note that I'm abusing notation here, using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-239-Frame"><nobr><span class="math" id="MathJax-Span-3053" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3054"><span class="mi" id="MathJax-Span-3055" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-239">y</script> in a
  slightly different way to last paragraph.  In the last paragraph we
  used <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-240-Frame"><nobr><span class="math" id="MathJax-Span-3056" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3057"><span class="mi" id="MathJax-Span-3058" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-240">y</script> to denote the desired output from the network - e.g.,
  output a "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-241-Frame"><nobr><span class="math" id="MathJax-Span-3059" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3060"><span class="mn" id="MathJax-Span-3061" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-241">7</script>" if an image of a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-242-Frame"><nobr><span class="math" id="MathJax-Span-3062" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3063"><span class="mn" id="MathJax-Span-3064" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-242">7</script> was input.  But in the
  equations which follow I'm using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-243-Frame"><nobr><span class="math" id="MathJax-Span-3065" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3066"><span class="mi" id="MathJax-Span-3067" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-243">y</script> to denote the vector of output
  activations which corresponds to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-244-Frame"><nobr><span class="math" id="MathJax-Span-3068" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3069"><span class="mn" id="MathJax-Span-3070" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-244">7</script>, that is, a vector which is all
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-245-Frame"><nobr><span class="math" id="MathJax-Span-3071" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3072"><span class="mn" id="MathJax-Span-3073" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">0</script>s, except for a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-246-Frame"><nobr><span class="math" id="MathJax-Span-3074" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3075"><span class="mn" id="MathJax-Span-3076" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">1</script> in the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame"><nobr><span class="math" id="MathJax-Span-3077" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-3078"><span class="mn" id="MathJax-Span-3079" style="font-family: MathJax_Main;">7</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">7</script>th location.</span>
<a class="displaced_anchor" name="eqtn81"></a><a class="displaced_anchor" name="eqtn82"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-248-Frame"><nobr><span class="math" id="MathJax-Span-3080" role="math" style="width: 100%; display: inline-block; min-width: 16.424em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.424em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 9.267em -999.998em); top: -6.566em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3081"><span class="mtable" id="MathJax-Span-3082" style="min-width: 16.767em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.424em;"><span style="display: inline-block; position: absolute; width: 10.002em; height: 0px; clip: rect(-3.184em 1000.002em 2.699em -999.998em); top: 0.002em; left: 50%; margin-left: -4.998em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 9.267em -999.998em); top: -6.566em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.395em -999.998em); top: -5.684em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3086"><span class="mrow" id="MathJax-Span-3087"><span class="mfrac" id="MathJax-Span-3088"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3089"><span class="mi" id="MathJax-Span-3090" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3091" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -3.233em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-3092"><span class="mi" id="MathJax-Span-3093" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3094"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3095" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-3096" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3097" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.669em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3115"><span class="mrow" id="MathJax-Span-3116"><span class="mfrac" id="MathJax-Span-3117"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3118"><span class="mi" id="MathJax-Span-3119" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3120" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-3121"><span class="mi" id="MathJax-Span-3122" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3123"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3124" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-3125" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3126"><span class="mrow" id="MathJax-Span-3127"><span class="mi" id="MathJax-Span-3128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.571em;"></span></span><span style="position: absolute; clip: rect(2.159em 1000.002em 5.738em -999.998em); top: -4.311em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.684em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3098"><span class="mrow" id="MathJax-Span-3099"><span class="mi" id="MathJax-Span-3100"></span><span class="mo" id="MathJax-Span-3101" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.743em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3130"><span class="mrow" id="MathJax-Span-3131"><span class="mi" id="MathJax-Span-3132"></span><span class="mo" id="MathJax-Span-3133" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.316em;"></span></span><span style="position: absolute; clip: rect(2.551em 1000.002em 7.061em -999.998em); top: -5.194em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 5.983em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -5.684em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3102"><span class="mrow" id="MathJax-Span-3103"><span class="msubsup" id="MathJax-Span-3104"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3105" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3108" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3109" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3110" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -2.743em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3134"><span class="mrow" id="MathJax-Span-3135"><span class="msubsup" id="MathJax-Span-3136"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3137" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-3138"><span class="mrow" id="MathJax-Span-3139"><span class="mi" id="MathJax-Span-3140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-3141" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-3142" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-3143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3144" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3145"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3146" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3149" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3150" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3151" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3153" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.199em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.547em 1000.002em 1.669em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.684em; right: 0.002em;"><span class="mtd" id="mjx-eqn-81"><span class="mrow" id="MathJax-Span-3084"><span class="mtext" id="MathJax-Span-3085" style="font-family: MathJax_Main;">(81)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="mjx-eqn-82"><span class="mrow" id="MathJax-Span-3113"><span class="mtext" id="MathJax-Span-3114" style="font-family: MathJax_Main;">(82)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.571em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.803em; vertical-align: -2.647em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-248">\begin{eqnarray}
  \frac{\partial C}{\partial b^L_j} & = & a^L_j-y_j  \tag{81}\\
  \frac{\partial C}{\partial w^L_{jk}} & = & a^{L-1}_k (a^L_j-y_j) 
\tag{82}\end{eqnarray}</script>
These equations are the same as the analogous expressions obtained in
our earlier analysis of the cross-entropy.  Compare, for example,
Equation <span id="margin_450072242236_reveal" class="equation_link">(82)</span><span id="margin_450072242236" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn82" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-249-Frame"><nobr><span class="math" id="MathJax-Span-3154" role="math" style="width: 10.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3155"><span class="mtable" id="MathJax-Span-3156" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.002em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3157"><span class="mrow" id="MathJax-Span-3158"><span class="mfrac" id="MathJax-Span-3159"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3160"><span class="mi" id="MathJax-Span-3161" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3162" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-3163"><span class="mi" id="MathJax-Span-3164" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3165"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3166" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-3167" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3168"><span class="mrow" id="MathJax-Span-3169"><span class="mi" id="MathJax-Span-3170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3172"><span class="mrow" id="MathJax-Span-3173"><span class="mi" id="MathJax-Span-3174"></span><span class="mo" id="MathJax-Span-3175" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.846em 1000.002em 4.414em -999.998em); top: -4.017em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 5.983em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3176"><span class="mrow" id="MathJax-Span-3177"><span class="msubsup" id="MathJax-Span-3178"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3179" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-3180"><span class="mrow" id="MathJax-Span-3181"><span class="mi" id="MathJax-Span-3182" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-3183" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-3184" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-3185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3186" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3187"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3188" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3191" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3192" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3193" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3194" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3195" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-249">\begin{eqnarray}  \frac{\partial C}{\partial w^L_{jk}} & = & a^{L-1}_k (a^L_j-y_j)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_450072242236_reveal').click(function() {$('#margin_450072242236').toggle('slow', function() {});});</script> to Equation <span id="margin_35027394255_reveal" class="equation_link">(67)</span><span id="margin_35027394255" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn67" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-250-Frame"><nobr><span class="math" id="MathJax-Span-3196" role="math" style="width: 13.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3197"><span class="mtable" id="MathJax-Span-3198" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.993em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3199"><span class="mrow" id="MathJax-Span-3200"><span class="mfrac" id="MathJax-Span-3201"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3204" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-3205"><span class="mi" id="MathJax-Span-3206" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3207"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3208" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-3209" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3210"><span class="mrow" id="MathJax-Span-3211"><span class="mi" id="MathJax-Span-3212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3214"><span class="mrow" id="MathJax-Span-3215"><span class="mi" id="MathJax-Span-3216"></span><span class="mo" id="MathJax-Span-3217" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 8.973em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3218"><span class="mrow" id="MathJax-Span-3219"><span class="mfrac" id="MathJax-Span-3220"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-3221" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3222" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3223" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3224" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-3225" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3226" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3227" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-3228"><span class="mrow" id="MathJax-Span-3229"><span class="mi" id="MathJax-Span-3230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-3231" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-3232" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3234" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3235"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3236" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3237" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3238" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3239" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3240" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3241" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3242" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3243" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3244" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-250">\begin{eqnarray} 
      \frac{\partial C}{\partial w^L_{jk}} & = & \frac{1}{n} \sum_x 
      a^{L-1}_k  (a^L_j-y_j).
   \nonumber\end{eqnarray}</script></a></span><script>$('#margin_35027394255_reveal').click(function() {$('#margin_35027394255').toggle('slow', function() {});});</script>.  It's the
same equation, albeit in the latter I've averaged over training
instances.  And, just as in the earlier analysis, these expressions
ensure that we will not encounter a learning slowdown.  In fact, it's
useful to think of a softmax output layer with log-likelihood cost as
being quite similar to a sigmoid output layer with cross-entropy cost.</p><p></p><p></p><p></p><p>Given this similarity, should you use a sigmoid output layer and
cross-entropy, or a softmax output layer and log-likelihood?  In fact,
in many situations both approaches work well.  Through the remainder
of this chapter we'll use a sigmoid output layer, with the
cross-entropy cost.  Later, in <a href="http://neuralnetworksanddeeplearning.com/chap6.html">Chapter 6</a>, we'll
sometimes use a softmax output layer, with log-likelihood cost.  The
reason for the switch is to make some of our later networks more
similar to networks found in certain influential academic papers.  As
a more general point of principle, softmax plus log-likelihood is
worth using whenever you want to interpret the output activations as
probabilities.  That's not always a concern, but can be useful with
classification problems (like MNIST) involving disjoint classes.</p><p></p><h4><a name="problems_594724"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problems_594724">Problems</a></h4><ul>
<li> Derive Equations <span id="margin_759898333160_reveal" class="equation_link">(81)</span><span id="margin_759898333160" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn81" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-251-Frame"><nobr><span class="math" id="MathJax-Span-3245" role="math" style="width: 7.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.061em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3246"><span class="mtable" id="MathJax-Span-3247" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.395em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3248"><span class="mrow" id="MathJax-Span-3249"><span class="mfrac" id="MathJax-Span-3250"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3251"><span class="mi" id="MathJax-Span-3252" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3253" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -3.233em; left: 50%; margin-left: -0.782em;"><span class="mrow" id="MathJax-Span-3254"><span class="mi" id="MathJax-Span-3255" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3256"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3257" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.444em;"><span class="mi" id="MathJax-Span-3258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3259" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.669em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.208em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3260"><span class="mrow" id="MathJax-Span-3261"><span class="mi" id="MathJax-Span-3262"></span><span class="mo" id="MathJax-Span-3263" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.895em 1000.002em 4.463em -999.998em); top: -4.017em; left: 3.532em;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3264"><span class="mrow" id="MathJax-Span-3265"><span class="msubsup" id="MathJax-Span-3266"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3267" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3270" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3271" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3272" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-251">\begin{eqnarray}  \frac{\partial C}{\partial b^L_j} & = & a^L_j-y_j   \nonumber\end{eqnarray}</script></a></span><script>$('#margin_759898333160_reveal').click(function() {$('#margin_759898333160').toggle('slow', function() {});});</script> and <span id="margin_5165456496_reveal" class="equation_link">(82)</span><span id="margin_5165456496" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn82" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-252-Frame"><nobr><span class="math" id="MathJax-Span-3274" role="math" style="width: 10.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.297em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3275"><span class="mtable" id="MathJax-Span-3276" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.002em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.444em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3277"><span class="mrow" id="MathJax-Span-3278"><span class="mfrac" id="MathJax-Span-3279"><span style="display: inline-block; position: relative; width: 2.159em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3280"><span class="mi" id="MathJax-Span-3281" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3282" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.659em -999.998em); top: -3.233em; left: 50%; margin-left: -1.027em;"><span class="mrow" id="MathJax-Span-3283"><span class="mi" id="MathJax-Span-3284" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3285"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3286" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.738em;"><span class="mi" id="MathJax-Span-3287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3288"><span class="mrow" id="MathJax-Span-3289"><span class="mi" id="MathJax-Span-3290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.159em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.336em 1000.002em 3.973em -999.998em); top: -4.017em; left: 2.65em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.213em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3292"><span class="mrow" id="MathJax-Span-3293"><span class="mi" id="MathJax-Span-3294"></span><span class="mo" id="MathJax-Span-3295" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.846em 1000.002em 4.414em -999.998em); top: -4.017em; left: 4.022em;"><span style="display: inline-block; position: relative; width: 5.983em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.213em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3296"><span class="mrow" id="MathJax-Span-3297"><span class="msubsup" id="MathJax-Span-3298"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3299" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-3300"><span class="mrow" id="MathJax-Span-3301"><span class="mi" id="MathJax-Span-3302" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-3303" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-3304" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-3305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3306" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-3307"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3308" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3310" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3311" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3312" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3313" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3315" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.802em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-252">\begin{eqnarray}  \frac{\partial C}{\partial w^L_{jk}} & = & a^{L-1}_k (a^L_j-y_j)  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_5165456496_reveal').click(function() {$('#margin_5165456496').toggle('slow', function() {});});</script>.<p></p><p></p></li><li><strong>Where does the "softmax" name come from?</strong>  Suppose we change
  the softmax function so the output activations are given by
<a class="displaced_anchor" name="eqtn83"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-253-Frame"><nobr><span class="math" id="MathJax-Span-3316" role="math" style="width: 100%; display: inline-block; min-width: 12.846em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.846em;"><span style="position: absolute; clip: rect(2.159em 1000.002em 5.395em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3317"><span class="mtable" id="MathJax-Span-3318" style="min-width: 13.14em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.846em;"><span style="display: inline-block; position: absolute; width: 6.375em; height: 0px; clip: rect(-1.86em 1000.002em 1.375em -999.998em); top: 0.002em; left: 50%; margin-left: -3.184em;"><span style="position: absolute; clip: rect(2.159em 1000.002em 5.395em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.375em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.444em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3322"><span class="mrow" id="MathJax-Span-3323"><span class="msubsup" id="MathJax-Span-3324"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3325" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3326" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3328" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-3329" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.385em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="msubsup" id="MathJax-Span-3330"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3331" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3332"><span class="mrow" id="MathJax-Span-3333"><span class="mi" id="MathJax-Span-3334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="msubsup" id="MathJax-Span-3335"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-3337" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-3338" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.846em 1000.002em 4.463em -999.998em); top: -3.037em; left: 50%; margin-left: -1.615em;"><span class="mrow" id="MathJax-Span-3339"><span class="munderover" id="MathJax-Span-3340"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3341" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-3342" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3343" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3344" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.458em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3345"><span class="mrow" id="MathJax-Span-3346"><span class="mi" id="MathJax-Span-3347" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="msubsup" id="MathJax-Span-3348"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.262em; left: 0.395em;"><span class="mi" id="MathJax-Span-3350" style="font-size: 50%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.267em -999.998em); top: -3.821em; left: 0.346em;"><span class="mi" id="MathJax-Span-3351" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.385em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3352" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.929em 1000.002em 0.346em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="mjx-eqn-83"><span class="mrow" id="MathJax-Span-3320"><span class="mtext" id="MathJax-Span-3321" style="font-family: MathJax_Main;">(83)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.103em; vertical-align: -1.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-253">\begin{eqnarray}
  a^L_j = \frac{e^{c z^L_j}}{\sum_k e^{c z^L_j}},
\tag{83}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-254-Frame"><nobr><span class="math" id="MathJax-Span-3353" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3354"><span class="mi" id="MathJax-Span-3355" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">c</script> is a positive constant.  Note that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-255-Frame"><nobr><span class="math" id="MathJax-Span-3356" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3357"><span class="mi" id="MathJax-Span-3358" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-3359" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3360" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-255">c = 1</script> corresponds to
the standard softmax function.  But if we use a different value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-256-Frame"><nobr><span class="math" id="MathJax-Span-3361" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3362"><span class="mi" id="MathJax-Span-3363" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-256">c</script>
we get a different function, which is nonetheless qualitatively rather
similar to the softmax.  In particular, show that the output
activations form a probability distribution, just as for the usual
softmax.  Suppose we allow <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-257-Frame"><nobr><span class="math" id="MathJax-Span-3364" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3365"><span class="mi" id="MathJax-Span-3366" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-257">c</script> to become large, i.e., <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-258-Frame"><nobr><span class="math" id="MathJax-Span-3367" role="math" style="width: 3.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.042em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3368"><span class="mi" id="MathJax-Span-3369" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-3370" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-3371" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.653em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-258">c \rightarrow
\infty</script>.  What is the limiting value for the output activations
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-259-Frame"><nobr><span class="math" id="MathJax-Span-3372" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3373"><span class="msubsup" id="MathJax-Span-3374"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3375" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3376" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-259">a^L_j</script>?  After solving this problem it should be clear to you why we
think of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-260-Frame"><nobr><span class="math" id="MathJax-Span-3378" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3379"><span class="mi" id="MathJax-Span-3380" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-3381" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3382" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">c = 1</script> function as a "softened" version of the maximum
function.  This is the origin of the term "softmax".<p></p><p></p></li><li><strong>Backpropagation with softmax and the log-likelihood cost</strong> In the
  last chapter we derived the backpropagation algorithm for a network
  containing sigmoid layers.  To apply the algorithm to a network with
  a softmax layer we need to figure out an expression for the error
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-261-Frame"><nobr><span class="math" id="MathJax-Span-3383" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3384"><span class="msubsup" id="MathJax-Span-3385"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3386" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-3387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3389" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-3390" style="font-family: MathJax_Main; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3391" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-3392"><span class="mrow" id="MathJax-Span-3393"><span class="mo" id="MathJax-Span-3394" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3395" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3396"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3397" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">\delta^L_j \equiv \partial C / \partial z^L_j</script> in the final layer.
  Show that a suitable expression is:
  <a class="displaced_anchor" name="eqtn84"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-262-Frame"><nobr><span class="math" id="MathJax-Span-3400" role="math" style="width: 100%; display: inline-block; min-width: 12.453em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.453em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.561em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3401"><span class="mtable" id="MathJax-Span-3402" style="min-width: 12.699em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.453em;"><span style="display: inline-block; position: absolute; width: 5.934em; height: 0px; clip: rect(-1.027em 1000.002em 0.542em -999.998em); top: 0.002em; left: 50%; margin-left: -2.939em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.561em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.934em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.61em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3406"><span class="mrow" id="MathJax-Span-3407"><span class="msubsup" id="MathJax-Span-3408"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3409" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-3410" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-3411" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3412" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3413" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3414" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3416" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3417" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3418" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3419" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3420" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3421" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.978em 1000.002em 0.346em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.066em; right: 0.002em;"><span class="mtd" id="mjx-eqn-84"><span class="mrow" id="MathJax-Span-3404"><span class="mtext" id="MathJax-Span-3405" style="font-family: MathJax_Main;">(84)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.447em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-262">\begin{eqnarray}
    \delta^L_j = a^L_j -y_j.
  \tag{84}\end{eqnarray}</script>
  Using this expression we can apply the backpropagation algorithm to
  a network using a softmax output layer and the log-likelihood cost.<p></p><p></p></li></ul><p></p><p></p><h3><a name="overfitting_and_regularization"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">Overfitting and regularization</a></h3><p></p><p>The Nobel prizewinning physicist Enrico Fermi was once asked his
opinion of a mathematical model some colleagues had proposed as the
solution to an important unsolved physics problem.  The model gave
excellent agreement with experiment, but Fermi was skeptical.  He
asked how many free parameters could be set in the model.  "Four"
was the answer.  Fermi replied*<span class="marginnote">
*The quote comes from a
  charming article by
  <a href="http://www.nature.com/nature/journal/v427/n6972/full/427297a.html">Freeman
    Dyson</a>, who is one of the people who proposed the flawed model. A
  four-parameter elephant may be found
  <a href="http://www.johndcook.com/blog/2011/06/21/how-to-fit-an-elephant/">here</a>. </span>:
"I remember my friend Johnny von Neumann used to say, with four
parameters I can fit an elephant, and with five I can make him wiggle
his trunk.".</p><p>The point, of course, is that models with a large number of free
parameters can describe an amazingly wide range of phenomena.  Even if
such a model agrees well with the available data, that doesn't make it
a good model.  It may just mean there's enough freedom in the model
that it can describe almost any data set of the given size, without
capturing any genuine insights into the underlying phenomenon.  When
that happens the model will work well for the existing data, but will
fail to generalize to new situations.  The true test of a model is its
ability to make predictions in situations it hasn't been exposed to
before.</p><p>Fermi and von Neumann were suspicious of models with four parameters.
Our 30 hidden neuron network for classifying MNIST digits has nearly
24,000 parameters!  That's a lot of parameters.  Our 100 hidden neuron
network has nearly 80,000 parameters, and state-of-the-art deep neural
nets sometimes contain millions or even billions of parameters.
Should we trust the results?</p><p>Let's sharpen this problem up by constructing a situation where our
network does a bad job generalizing to new situations.  We'll use our
30 hidden neuron network, with its 23,860 parameters.  But we won't
train the network using all 50,000 MNIST training images.  Instead,
we'll use just the first 1,000 training images.  Using that restricted
set will make the problem with generalization much more evident.
We'll train in a similar way to before, using the cross-entropy cost
function, with a learning rate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-263-Frame"><nobr><span class="math" id="MathJax-Span-3422" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3423"><span class="mi" id="MathJax-Span-3424" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3425" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3426" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">\eta = 0.5</script> and a mini-batch size
of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-264-Frame"><nobr><span class="math" id="MathJax-Span-3427" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3428"><span class="mn" id="MathJax-Span-3429" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">10</script>.  However, we'll train for 400 epochs, a somewhat larger
number than before, because we're not using as many training examples.
Let's use <tt>network2</tt> to look at the way the cost function
changes:</p><p></p><div class="highlight"><pre> 
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">monitor_training_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
 <p></p><p>Using the results we can plot the way the cost changes as the network
learns*<span class="marginnote">
*This and the next four graphs were generated by the
  program
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/overfitting.py">overfitting.py</a>.</span>
:</p><p></p><center><img src="./Neural networks and deep learning 3_files/overfitting1.png" width="520px"></center><p></p><p>This looks encouraging, showing a smooth decrease in the cost, just as
we expect.  Note that I've only shown training epochs 200 through 399.
This gives us a nice up-close view of the later stages of learning,
which, as we'll see, turns out to be where the interesting action is.</p><p>Let's now look at how the classification accuracy on the test data
changes over time:</p><p></p><center><img src="./Neural networks and deep learning 3_files/overfitting2.png" width="520px"></center><p></p><p>Again, I've zoomed in quite a bit.  In the first 200 epochs (not
shown) the accuracy rises to just under 82 percent.  The learning then
gradually slows down.  Finally, at around epoch 280 the classification
accuracy pretty much stops improving.  Later epochs merely see small
stochastic fluctuations near the value of the accuracy at epoch 280.
Contrast this with the earlier graph, where the cost associated to the
training data continues to smoothly drop.  If we just look at that
cost, it appears that our model is still getting "better".  But the
test accuracy results show the improvement is an illusion.  Just like
the model that Fermi disliked, what our network learns after epoch 280
no longer generalizes to the test data.  And so it's not useful
learning.  We say the network is <em>overfitting</em> or
<em>overtraining</em> beyond epoch 280.</p><p>You might wonder if the problem here is that I'm looking at the
<em>cost</em> on the training data, as opposed to the
<em>classification accuracy</em> on the test data.  In other words,
maybe the problem is that we're making an apples and oranges
comparison.  What would happen if we compared the cost on the training
data with the cost on the test data, so we're comparing similar
measures?  Or perhaps we could compare the classification accuracy on
both the training data and the test data?  In fact, essentially the
same phenomenon shows up no matter how we do the comparison.  The
details do change, however. For instance, let's look at the cost on
the test data:</p><p></p><center><img src="./Neural networks and deep learning 3_files/overfitting3.png" width="520px"></center><p></p><p>We can see that the cost on the test data improves until around epoch
15, but after that it actually starts to get worse, even though the
cost on the training data is continuing to get better.  This is
another sign that our model is overfitting.  It poses a puzzle,
though, which is whether we should regard epoch 15 or epoch 280 as the
point at which overfitting is coming to dominate learning?  From a
practical point of view, what we really care about is improving
classification accuracy on the test data, while the cost on the test
data is no more than a proxy for classification accuracy.  And so it
makes most sense to regard epoch 280 as the point beyond which
overfitting is dominating learning in our neural network.</p><p>Another sign of overfitting may be seen in the classification accuracy
on the training data:</p><p></p><center><img src="./Neural networks and deep learning 3_files/overfitting4.png" width="520px"></center><p></p><p>The accuracy rises all the way up to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-265-Frame"><nobr><span class="math" id="MathJax-Span-3430" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3431"><span class="mn" id="MathJax-Span-3432" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-265">100</script> percent.  That is, our
network correctly classifies all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-266-Frame"><nobr><span class="math" id="MathJax-Span-3433" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3434"><span class="mn" id="MathJax-Span-3435" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3436" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3437" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">1,000</script> training images!  Meanwhile,
our test accuracy tops out at just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-267-Frame"><nobr><span class="math" id="MathJax-Span-3438" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3439"><span class="mn" id="MathJax-Span-3440" style="font-family: MathJax_Main;">82.27</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-267">82.27</script> percent.  So our network
really is learning about peculiarities of the training set, not just
recognizing digits in general.  It's almost as though our network is
merely memorizing the training set, without understanding digits well
enough to generalize to the test set.</p><p>Overfitting is a major problem in neural networks.  This is especially
true in modern networks, which often have very large numbers of
weights and biases.  To train effectively, we need a way of detecting
when overfitting is going on, so we don't overtrain.  And we'd like to
have techniques for reducing the effects of overfitting.</p><p>The obvious way to detect overfitting is to use the approach above,
keeping track of accuracy on the test data as our network trains.  If
we see that the accuracy on the test data is no longer improving, then
we should stop training.  Of course, strictly speaking, this is not
necessarily a sign of overfitting.  It might be that accuracy on the
test data and the training data both stop improving at the same time.
Still, adopting this strategy will prevent overfitting.</p><p>In fact, we'll use a variation on this strategy.  Recall that when we
load in the MNIST data we load in three data sets:
</p><div class="highlight"><pre> 
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
</pre></div>
 
Up to now we've been using the <tt>training_data</tt> and
<tt>test_data</tt>, and ignoring the <tt>validation_data</tt>.  The
<tt>validation_data</tt> contains <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-268-Frame"><nobr><span class="math" id="MathJax-Span-3441" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3442"><span class="mn" id="MathJax-Span-3443" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-3444" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3445" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-268">10,000</script> images of digits, images
which are different from the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-269-Frame"><nobr><span class="math" id="MathJax-Span-3446" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3447"><span class="mn" id="MathJax-Span-3448" style="font-family: MathJax_Main;">50</span><span class="mo" id="MathJax-Span-3449" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3450" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-269">50,000</script> images in the MNIST training
set, and the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-270-Frame"><nobr><span class="math" id="MathJax-Span-3451" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3452"><span class="mn" id="MathJax-Span-3453" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-3454" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3455" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-270">10,000</script> images in the MNIST test set.  Instead of using
the <tt>test_data</tt> to prevent overfitting, we will use the
<tt>validation_data</tt>.  To do this, we'll use much the same strategy
as was described above for the <tt>test_data</tt>.  That is, we'll
compute the classification accuracy on the <tt>validation_data</tt> at
the end of each epoch.  Once the classification accuracy on the
<tt>validation_data</tt> has saturated, we stop training.  This strategy
is called <em>early stopping</em>.  Of course, in practice we won't
immediately know when the accuracy has saturated.  Instead, we
continue training until we're confident that the accuracy has
saturated*<span class="marginnote">
*It requires some judgement to determine when to
  stop.  In my earlier graphs I identified epoch 280 as the place at
  which accuracy saturated.  It's possible that was too pessimistic.
  Neural networks sometimes plateau for a while in training, before
  continuing to improve.  I wouldn't be surprised if more learning
  could have occurred even after epoch 400, although the magnitude of
  any further improvement would likely be small.  So it's possible to
  adopt more or less aggressive strategies for early stopping.</span>.<p></p><p><a name="validation_explanation"></a></p><p>Why use the <tt>validation_data</tt> to prevent overfitting, rather than
the <tt>test_data</tt>?  In fact, this is part of a more general
strategy, which is to use the <tt>validation_data</tt> to evaluate
different trial choices of hyper-parameters such as the number of
epochs to train for, the learning rate, the best network architecture,
and so on.  We use such evaluations to find and set good values for
the hyper-parameters.  Indeed, although I haven't mentioned it until
now, that is, in part, how I arrived at the hyper-parameter choices
made earlier in this book. (More on this
<a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">later</a>.)</p><p>Of course, that doesn't in any way answer the question of why we're
using the <tt>validation_data</tt> to prevent overfitting, rather than
the <tt>test_data</tt>.  Instead, it replaces it with a more general
question, which is why we're using the <tt>validation_data</tt> rather
than the <tt>test_data</tt> to set good hyper-parameters?  To understand
why, consider that when setting hyper-parameters we're likely to try
many different choices for the hyper-parameters.  If we set the
hyper-parameters based on evaluations of the <tt>test_data</tt> it's
possible we'll end up overfitting our hyper-parameters to the
<tt>test_data</tt>.  That is, we may end up finding hyper-parameters
which fit particular peculiarities of the <tt>test_data</tt>, but where
the performance of the network won't generalize to other data sets.
We guard against that by figuring out the hyper-parameters using the
<tt>validation_data</tt>.  Then, once we've got the hyper-parameters we
want, we do a final evaluation of accuracy using the <tt>test_data</tt>.
That gives us confidence that our results on the <tt>test_data</tt> are
a true measure of how well our neural network generalizes.  To put it
another way, you can think of the validation data as a type of
training data that helps us learn good hyper-parameters.  This
approach to finding good hyper-parameters is sometimes known as the
<em>hold out</em> method, since the <tt>validation_data</tt> is kept apart
or "held out" from the <tt>training_data</tt>.</p><p>Now, in practice, even after evaluating performance on the
<tt>test_data</tt> we may change our minds and want to try another
approach - perhaps a different network architecture - which will
involve finding a new set of hyper-parameters.  If we do this, isn't
there a danger we'll end up overfitting to the <tt>test_data</tt> as
well?  Do we need a potentially infinite regress of data sets, so we
can be confident our results will generalize?  Addressing this concern
fully is a deep and difficult problem.  But for our practical
purposes, we're not going to worry too much about this question.
Instead, we'll plunge ahead, using the basic hold out method, based on
the <tt>training_data</tt>, <tt>validation_data</tt>, and
<tt>test_data</tt>, as described above.</p><p>We've been looking so far at overfitting when we're just using 1,000
training images.  What happens when we use the full training set of
50,000 images?  We'll keep all the other parameters the same (30
hidden neurons, learning rate 0.5, mini-batch size of 10), but train
using all 50,000 images for 30 epochs.  Here's a graph showing the
results for the classification accuracy on both the training data and
the test data.  Note that I've used the test data here, rather than
the validation data, in order to make the results more directly
comparable with the earlier graphs.</p><p></p><center><img src="./Neural networks and deep learning 3_files/overfitting_full.png" width="520px"></center><p></p><p>As you can see, the accuracy on the test and training data remain much
closer together than when we were using 1,000 training examples.  In
particular, the best classification accuracy of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-271-Frame"><nobr><span class="math" id="MathJax-Span-3456" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3457"><span class="mn" id="MathJax-Span-3458" style="font-family: MathJax_Main;">97.86</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-271">97.86</script> percent on the
training data is only <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-272-Frame"><nobr><span class="math" id="MathJax-Span-3459" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3460"><span class="mn" id="MathJax-Span-3461" style="font-family: MathJax_Main;">1.53</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-272">1.53</script> percent higher than the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-273-Frame"><nobr><span class="math" id="MathJax-Span-3462" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3463"><span class="mn" id="MathJax-Span-3464" style="font-family: MathJax_Main;">95.33</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">95.33</script> percent
on the test data.  That's compared to the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-274-Frame"><nobr><span class="math" id="MathJax-Span-3465" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3466"><span class="mn" id="MathJax-Span-3467" style="font-family: MathJax_Main;">17.73</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">17.73</script> percent gap we had
earlier!  Overfitting is still going on, but it's been greatly
reduced.  Our network is generalizing much better from the training
data to the test data.  In general, one of the best ways of reducing
overfitting is to increase the size of the training data.  With enough
training data it is difficult for even a very large network to
overfit.  Unfortunately, training data can be expensive or difficult
to acquire, so this is not always a practical option.</p><p></p><h4><a name="regularization"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#regularization">Regularization</a></h4><p></p><p>Increasing the amount of training data is one way of reducing
overfitting.  Are there other ways we can reduce the extent to which
overfitting occurs?  One possible approach is to reduce the size of
our network. However, large networks have the potential to be more
powerful than small networks, and so this is an option we'd only adopt
reluctantly.</p><p>Fortunately, there are other techniques which can reduce overfitting,
even when we have a fixed network and fixed training data.  These are
known as <em>regularization</em> techniques.  In this section I describe
one of the most commonly used regularization techniques, a technique
sometimes known as <em>weight decay</em> or <em>L2 regularization</em>.
The idea of L2 regularization is to add an extra term to the cost
function, a term called the <em>regularization term</em>.  Here's the
regularized cross-entropy:</p><p><a class="displaced_anchor" name="eqtn85"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-275-Frame"><nobr><span class="math" id="MathJax-Span-3468" role="math" style="width: 100%; display: inline-block; min-width: 30.983em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 30.983em;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3469"><span class="mtable" id="MathJax-Span-3470" style="min-width: 31.62em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 30.983em;"><span style="display: inline-block; position: absolute; width: 24.855em; height: 0px; clip: rect(-1.762em 1000.002em 1.228em -999.998em); top: 0.002em; left: 50%; margin-left: -12.4em;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.248em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 24.855em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.493em -999.998em); top: -4.262em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3474"><span class="mrow" id="MathJax-Span-3475"><span class="mi" id="MathJax-Span-3476" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-3477" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-3478" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-3479"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-3480" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3481" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3482" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3483" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.395em;"><span class="texatom" id="MathJax-Span-3484"><span class="mrow" id="MathJax-Span-3485"><span class="mi" id="MathJax-Span-3486" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-3487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mrow" id="MathJax-Span-3488" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-3489" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">[</span></span><span class="msubsup" id="MathJax-Span-3490"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3491" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-3493" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-3494"></span><span class="msubsup" id="MathJax-Span-3495" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3496" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3498" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3499" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-3500" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mn" id="MathJax-Span-3501" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3502" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3503" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3504" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-3505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3506" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-3507" style="font-family: MathJax_Main; padding-left: 0.15em;">ln</span><span class="mo" id="MathJax-Span-3508"></span><span class="mo" id="MathJax-Span-3509" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-3510" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3511" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3512" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3513" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-3514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.542em;"><span class="mi" id="MathJax-Span-3515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3516" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3517" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">]</span></span></span><span class="mo" id="MathJax-Span-3518" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-3519" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3520" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3521"><span class="mn" id="MathJax-Span-3522" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3523" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3524" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3525" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-3526" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3527" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3528" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mn" id="MathJax-Span-3529" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3530" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.125em 1000.002em 0.15em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.262em; right: 0.002em;"><span class="mtd" id="mjx-eqn-85"><span class="mrow" id="MathJax-Span-3472"><span class="mtext" id="MathJax-Span-3473" style="font-family: MathJax_Main;">(85)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.853em; vertical-align: -1.147em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-275">\begin{eqnarray} C = -\frac{1}{n} \sum_{xj} \left[ y_j \ln a^L_j+(1-y_j) \ln
(1-a^L_j)\right] + \frac{\lambda}{2n} \sum_w w^2.
\tag{85}\end{eqnarray}</script></p><p>The first term is just the usual expression for the cross-entropy.
But we've added a second term, namely the sum of the squares of all
the weights in the network.  This is scaled by a factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-276-Frame"><nobr><span class="math" id="MathJax-Span-3531" role="math" style="width: 2.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.208em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3532"><span class="mi" id="MathJax-Span-3533" style="font-family: MathJax_Math-italic;"></span><span class="texatom" id="MathJax-Span-3534"><span class="mrow" id="MathJax-Span-3535"><span class="mo" id="MathJax-Span-3536" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-3537" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3538" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-276">\lambda /
2n</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-277-Frame"><nobr><span class="math" id="MathJax-Span-3539" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3540"><span class="mi" id="MathJax-Span-3541" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-3542" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-3543" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">\lambda > 0</script> is known as the <em>regularization
  parameter</em>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-278-Frame"><nobr><span class="math" id="MathJax-Span-3544" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3545"><span class="mi" id="MathJax-Span-3546" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-278">n</script> is, as usual, the size of our training set.
I'll discuss later how <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-279-Frame"><nobr><span class="math" id="MathJax-Span-3547" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3548"><span class="mi" id="MathJax-Span-3549" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-279">\lambda</script> is chosen.  It's also worth noting
that the regularization term <em>doesn't</em> include the biases.  I'll
also come back to that below.</p><p>Of course, it's possible to regularize other cost functions, such as
the quadratic cost.  This can be done in a similar way:</p><p><a class="displaced_anchor" name="eqtn86"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-280-Frame"><nobr><span class="math" id="MathJax-Span-3550" role="math" style="width: 100%; display: inline-block; min-width: 21.865em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 21.865em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3551"><span class="mtable" id="MathJax-Span-3552" style="min-width: 22.257em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.865em;"><span style="display: inline-block; position: absolute; width: 15.542em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -7.743em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 15.542em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3556"><span class="mrow" id="MathJax-Span-3557"><span class="mi" id="MathJax-Span-3558" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-3559" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-3560" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-3561" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3562"><span class="mn" id="MathJax-Span-3563" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3564" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3565" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3566" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-3567" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3568" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-3569" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3570" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-3571" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3572" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-3573" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3574"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3575" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-3576" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3577" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-3578" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3579" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3580"><span class="mn" id="MathJax-Span-3581" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3582" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3583" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3584" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-3585" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3586" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3587" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mn" id="MathJax-Span-3588" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3589" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-86"><span class="mrow" id="MathJax-Span-3554"><span class="mtext" id="MathJax-Span-3555" style="font-family: MathJax_Main;">(86)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-280">\begin{eqnarray} C = \frac{1}{2n} \sum_x \|y-a^L\|^2 +
  \frac{\lambda}{2n} \sum_w w^2.
\tag{86}\end{eqnarray}</script></p><p>In both cases we can write the regularized cost function as
<a class="displaced_anchor" name="eqtn87"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-281-Frame"><nobr><span class="math" id="MathJax-Span-3590" role="math" style="width: 100%; display: inline-block; min-width: 15.64em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.64em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3591"><span class="mtable" id="MathJax-Span-3592" style="min-width: 15.934em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.64em;"><span style="display: inline-block; position: absolute; width: 9.169em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -4.605em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.169em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3596"><span class="mrow" id="MathJax-Span-3597"><span class="mi" id="MathJax-Span-3598" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-3599" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3600" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3601" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3602" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3603" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-3604" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3605" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3606"><span class="mn" id="MathJax-Span-3607" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3608" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3609" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3610" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-3611" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3612" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3613" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mn" id="MathJax-Span-3614" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3615" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-87"><span class="mrow" id="MathJax-Span-3594"><span class="mtext" id="MathJax-Span-3595" style="font-family: MathJax_Main;">(87)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-281">\begin{eqnarray}  C = C_0 + \frac{\lambda}{2n}
\sum_w w^2,
\tag{87}\end{eqnarray}</script> where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-282-Frame"><nobr><span class="math" id="MathJax-Span-3616" role="math" style="width: 1.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3617"><span class="msubsup" id="MathJax-Span-3618"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3619" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3620" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-282">C_0</script> is the original, unregularized cost
function.</p><p>Intuitively, the effect of regularization is to make it so the network
prefers to learn small weights, all other things being equal.  Large
weights will only be allowed if they considerably improve the first
part of the cost function.  Put another way, regularization can be
viewed as a way of compromising between finding small weights and
minimizing the original cost function.  The relative importance of the
two elements of the compromise depends on the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-283-Frame"><nobr><span class="math" id="MathJax-Span-3621" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3622"><span class="mi" id="MathJax-Span-3623" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-283">\lambda</script>: when
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-284-Frame"><nobr><span class="math" id="MathJax-Span-3624" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3625"><span class="mi" id="MathJax-Span-3626" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-284">\lambda</script> is small we prefer to minimize the original cost function,
but when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-285-Frame"><nobr><span class="math" id="MathJax-Span-3627" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3628"><span class="mi" id="MathJax-Span-3629" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-285">\lambda</script> is large we prefer small weights.</p><p>Now, it's really not at all obvious why making this kind of compromise
should help reduce overfitting!  But it turns out that it does. We'll
address the question of why it helps in the next section.  But first,
let's work through an example showing that regularization really does
reduce overfitting.</p><p>To construct such an example, we first need to figure out how to apply
our stochastic gradient descent learning algorithm in a regularized
neural network.  In particular, we need to know how to compute the
partial derivatives <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-286-Frame"><nobr><span class="math" id="MathJax-Span-3630" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3631"><span class="mi" id="MathJax-Span-3632" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3633" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-3634"><span class="mrow" id="MathJax-Span-3635"><span class="mo" id="MathJax-Span-3636" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3637" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3638" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-286">\partial C / \partial w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-287-Frame"><nobr><span class="math" id="MathJax-Span-3639" role="math" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.846em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3640"><span class="mi" id="MathJax-Span-3641" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3642" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-3643"><span class="mrow" id="MathJax-Span-3644"><span class="mo" id="MathJax-Span-3645" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3646" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3647" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-287">\partial C
/ \partial b</script> for all the weights and biases in the network.  Taking
the partial derivatives of Equation <span id="margin_656242918157_reveal" class="equation_link">(87)</span><span id="margin_656242918157" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn87" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-288-Frame"><nobr><span class="math" id="MathJax-Span-3648" role="math" style="width: 9.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.218em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3649"><span class="mtable" id="MathJax-Span-3650" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 8.924em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.924em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3651"><span class="mrow" id="MathJax-Span-3652"><span class="mi" id="MathJax-Span-3653" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-3654" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3655" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3656" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3657" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3658" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-3659" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3660" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3661"><span class="mn" id="MathJax-Span-3662" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-3663" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3664" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3665" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-3666" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3667" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3668" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mn" id="MathJax-Span-3669" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-288">\begin{eqnarray}  C = C_0 + \frac{\lambda}{2n}
\sum_w w^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_656242918157_reveal').click(function() {$('#margin_656242918157').toggle('slow', function() {});});</script> gives</p><p><a class="displaced_anchor" name="eqtn88"></a><a class="displaced_anchor" name="eqtn89"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-289-Frame"><nobr><span class="math" id="MathJax-Span-3670" role="math" style="width: 100%; display: inline-block; min-width: 14.806em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.806em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 7.65em -999.998em); top: -5.488em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3671"><span class="mtable" id="MathJax-Span-3672" style="min-width: 15.1em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.806em;"><span style="display: inline-block; position: absolute; width: 8.336em; height: 0px; clip: rect(-2.645em 1000.002em 2.159em -999.998em); top: 0.002em; left: 50%; margin-left: -4.164em;"><span style="position: absolute; clip: rect(2.846em 1000.002em 7.65em -999.998em); top: -5.488em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -5.145em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3676"><span class="mrow" id="MathJax-Span-3677"><span class="mfrac" id="MathJax-Span-3678"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3679"><span class="mi" id="MathJax-Span-3680" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3681" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-3682"><span class="mi" id="MathJax-Span-3683" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3684" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3708"><span class="mrow" id="MathJax-Span-3709"><span class="mfrac" id="MathJax-Span-3710"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-3711"><span class="mi" id="MathJax-Span-3712" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3713" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-3714"><span class="mi" id="MathJax-Span-3715" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3716" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.493em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 5.444em -999.998em); top: -4.017em; left: 1.963em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.145em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3685"><span class="mrow" id="MathJax-Span-3686"><span class="mi" id="MathJax-Span-3687"></span><span class="mo" id="MathJax-Span-3688" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.743em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3717"><span class="mrow" id="MathJax-Span-3718"><span class="mi" id="MathJax-Span-3719"></span><span class="mo" id="MathJax-Span-3720" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.846em 1000.002em 7.65em -999.998em); top: -5.488em; left: 3.336em;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -5.145em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3689"><span class="mrow" id="MathJax-Span-3690"><span class="mfrac" id="MathJax-Span-3691"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-3692"><span class="mi" id="MathJax-Span-3693" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3694"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3695" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3696" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-3697"><span class="mi" id="MathJax-Span-3698" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3699" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3700" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-3701" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3702" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3703" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-3704" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -2.743em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3721"><span class="mrow" id="MathJax-Span-3722"><span class="mfrac" id="MathJax-Span-3723"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-3724"><span class="mi" id="MathJax-Span-3725" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3726"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3727" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3728" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-3729"><span class="mi" id="MathJax-Span-3730" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3731" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3732" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.493em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.007em 1000.002em 1.669em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.145em; right: 0.002em;"><span class="mtd" id="mjx-eqn-88"><span class="mrow" id="MathJax-Span-3674"><span class="mtext" id="MathJax-Span-3675" style="font-family: MathJax_Main;">(88)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="mjx-eqn-89"><span class="mrow" id="MathJax-Span-3706"><span class="mtext" id="MathJax-Span-3707" style="font-family: MathJax_Main;">(89)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.493em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.702em; vertical-align: -2.098em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-289">\begin{eqnarray} 
  \frac{\partial C}{\partial w} & = & \frac{\partial C_0}{\partial w} + 
  \frac{\lambda}{n} w \tag{88}\\ 
  \frac{\partial C}{\partial b} & = & \frac{\partial C_0}{\partial b}.
\tag{89}\end{eqnarray}</script> </p><p>The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-290-Frame"><nobr><span class="math" id="MathJax-Span-3733" role="math" style="width: 3.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3734"><span class="mi" id="MathJax-Span-3735" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3736"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3737" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3738" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3739"><span class="mrow" id="MathJax-Span-3740"><span class="mo" id="MathJax-Span-3741" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3742" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3743" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-290">\partial C_0 / \partial w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-291-Frame"><nobr><span class="math" id="MathJax-Span-3744" role="math" style="width: 3.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.189em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3745"><span class="mi" id="MathJax-Span-3746" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3747"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3748" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3749" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3750"><span class="mrow" id="MathJax-Span-3751"><span class="mo" id="MathJax-Span-3752" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3753" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3754" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-291">\partial C_0 / \partial b</script> terms
can be computed using backpropagation, as described in
<a href="http://neuralnetworksanddeeplearning.com/chap2.html">the last chapter</a>.  And so we see that it's easy to
compute the gradient of the regularized cost function: just use
backpropagation, as usual, and then add <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-292-Frame"><nobr><span class="math" id="MathJax-Span-3755" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3756"><span class="mfrac" id="MathJax-Span-3757"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-3758" style="font-size: 70.7%; font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-3759" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.542em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-3760" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.403em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-292">\frac{\lambda}{n} w</script> to the
partial derivative of all the weight terms.  The partial derivatives
with respect to the biases are unchanged, and so the gradient descent
learning rule for the biases doesn't change from the usual rule:</p><p><a class="displaced_anchor" name="eqtn90"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-293-Frame"><nobr><span class="math" id="MathJax-Span-3761" role="math" style="width: 100%; display: inline-block; min-width: 13.336em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 13.336em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3762"><span class="mtable" id="MathJax-Span-3763" style="min-width: 13.581em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.336em;"><span style="display: inline-block; position: absolute; width: 6.816em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -3.429em;"><span style="position: absolute; clip: rect(3.287em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3767"><span class="mrow" id="MathJax-Span-3768"><span class="mi" id="MathJax-Span-3769" style="font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.689em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.919em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-3770"><span class="mrow" id="MathJax-Span-3771"><span class="mi" id="MathJax-Span-3772"></span><span class="mo" id="MathJax-Span-3773" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 2.306em;"><span style="display: inline-block; position: relative; width: 4.561em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3774"><span class="mrow" id="MathJax-Span-3775"><span class="mi" id="MathJax-Span-3776" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3777" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3778" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-3779"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-3780"><span class="mi" id="MathJax-Span-3781" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3782"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3783" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3784" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-3785"><span class="mi" id="MathJax-Span-3786" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3787" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3788" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-90"><span class="mrow" id="MathJax-Span-3765"><span class="mtext" id="MathJax-Span-3766" style="font-family: MathJax_Main;">(90)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-293">\begin{eqnarray}
b & \rightarrow & b -\eta \frac{\partial C_0}{\partial b}.
\tag{90}\end{eqnarray}</script></p><p>The learning rule for the weights becomes:</p><p><a class="displaced_anchor" name="eqtn91"></a><a class="displaced_anchor" name="eqtn92"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-294-Frame"><nobr><span class="math" id="MathJax-Span-3789" role="math" style="width: 100%; display: inline-block; min-width: 18.63em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 18.63em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3790"><span class="mtable" id="MathJax-Span-3791" style="min-width: 19.022em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.63em;"><span style="display: inline-block; position: absolute; width: 12.257em; height: 0px; clip: rect(-2.792em 1000.002em 2.306em -999.998em); top: 0.002em; left: 50%; margin-left: -6.125em;"><span style="position: absolute; clip: rect(2.159em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -5.292em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3795"><span class="mrow" id="MathJax-Span-3796"><span class="mi" id="MathJax-Span-3797" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -2.841em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3826"><span class="mrow" id="MathJax-Span-3827"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.11em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -5.292em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-3798"><span class="mrow" id="MathJax-Span-3799"><span class="mi" id="MathJax-Span-3800"></span><span class="mo" id="MathJax-Span-3801" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -2.841em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-3828"><span class="mrow" id="MathJax-Span-3829"><span class="mi" id="MathJax-Span-3830"></span><span class="mo" id="MathJax-Span-3831" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 2.551em;"><span style="display: inline-block; position: relative; width: 9.708em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -5.292em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3802"><span class="mrow" id="MathJax-Span-3803"><span class="mi" id="MathJax-Span-3804" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-3805" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3806" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-3807"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-3808"><span class="mi" id="MathJax-Span-3809" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3810"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3811" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3812" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-3813"><span class="mi" id="MathJax-Span-3814" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3815" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3816" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3817" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3818"><span class="mi" id="MathJax-Span-3819" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3820" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3821" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-3822" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -2.841em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3832"><span class="mrow" id="MathJax-Span-3833"><span class="mrow" id="MathJax-Span-3834"><span class="mo" id="MathJax-Span-3835" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mn" id="MathJax-Span-3836" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3837" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3838" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3839"><span class="mi" id="MathJax-Span-3840" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3841" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3842" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3843" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-3844" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">w</span><span class="mo" id="MathJax-Span-3845" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3846" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-3847"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-3848"><span class="mi" id="MathJax-Span-3849" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3850"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3851" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3852" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-3853"><span class="mi" id="MathJax-Span-3854" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3855" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3856" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.154em 1000.002em 1.62em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.292em; right: 0.002em;"><span class="mtd" id="mjx-eqn-91"><span class="mrow" id="MathJax-Span-3793"><span class="mtext" id="MathJax-Span-3794" style="font-family: MathJax_Main;">(91)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.841em; right: 0.002em;"><span class="mtd" id="mjx-eqn-92"><span class="mrow" id="MathJax-Span-3824"><span class="mtext" id="MathJax-Span-3825" style="font-family: MathJax_Main;">(92)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.002em; vertical-align: -2.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-294">\begin{eqnarray} 
  w & \rightarrow & w-\eta \frac{\partial C_0}{\partial
    w}-\frac{\eta \lambda}{n} w \tag{91}\\ 
  & = & \left(1-\frac{\eta \lambda}{n}\right) w -\eta \frac{\partial
    C_0}{\partial w}. 
\tag{92}\end{eqnarray}</script></p><p>This is exactly the same as the usual gradient descent learning rule,
except we first rescale the weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-295-Frame"><nobr><span class="math" id="MathJax-Span-3857" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3858"><span class="mi" id="MathJax-Span-3859" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-295">w</script> by a factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-296-Frame"><nobr><span class="math" id="MathJax-Span-3860" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3861"><span class="mn" id="MathJax-Span-3862" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3863" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3864" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -4.556em; left: 50%; margin-left: -0.39em;"><span class="mrow" id="MathJax-Span-3865"><span class="mi" id="MathJax-Span-3866" style="font-size: 70.7%; font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3867" style="font-size: 70.7%; font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-3868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.885em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.552em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-296">1-\frac{\eta
  \lambda}{n}</script>.  This rescaling is sometimes referred to as
<em>weight decay</em>, since it makes the weights smaller.  At first
glance it looks as though this means the weights are being driven
unstoppably toward zero.  But that's not right, since the other term
may lead the weights to increase, if so doing causes a decrease in the
unregularized cost function.</p><p>Okay, that's how gradient descent works.  What about stochastic
gradient descent?  Well, just as in unregularized stochastic gradient
descent, we can estimate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-297-Frame"><nobr><span class="math" id="MathJax-Span-3869" role="math" style="width: 3.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3870"><span class="mi" id="MathJax-Span-3871" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3872"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3873" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-3874" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3875"><span class="mrow" id="MathJax-Span-3876"><span class="mo" id="MathJax-Span-3877" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3878" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3879" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-297">\partial C_0 / \partial w</script> by averaging over
a mini-batch of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-298-Frame"><nobr><span class="math" id="MathJax-Span-3880" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3881"><span class="mi" id="MathJax-Span-3882" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-298">m</script> training examples.  Thus the regularized learning
rule for stochastic gradient descent becomes
(c.f. Equation <span id="margin_482261063883_reveal" class="equation_link">(20)</span><span id="margin_482261063883" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn20" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-299-Frame"><nobr><span class="math" id="MathJax-Span-3883" role="math" style="width: 14.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.826em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3884"><span class="mtable" id="MathJax-Span-3885" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 13.532em; height: 0px;"><span style="position: absolute; clip: rect(3.287em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3886"><span class="mrow" id="MathJax-Span-3887"><span class="msubsup" id="MathJax-Span-3888"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3889" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.022em -999.998em); top: -4.017em; left: 1.424em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.164em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-3891"><span class="mrow" id="MathJax-Span-3892"><span class="mi" id="MathJax-Span-3893"></span><span class="mo" id="MathJax-Span-3894" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 2.993em;"><span style="display: inline-block; position: relative; width: 10.493em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -4.164em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3895"><span class="mrow" id="MathJax-Span-3896"><span class="msubsup" id="MathJax-Span-3897"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3898" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.738em;"><span class="mo" id="MathJax-Span-3899" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.738em;"><span class="mi" id="MathJax-Span-3900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3901" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3902" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3903" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3904" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3905" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3906" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-3907" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-3908" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3909" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3910" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-3911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3912" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-3913"><span class="mi" id="MathJax-Span-3914" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3915"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3916" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3917"><span class="mrow" id="MathJax-Span-3918"><span class="msubsup" id="MathJax-Span-3919"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3920" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-3921" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-3922"><span class="mi" id="MathJax-Span-3923" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3924"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3925" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.002em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-299">\begin{eqnarray} 
  w_k & \rightarrow & w_k' = w_k-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial w_k}  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_482261063883_reveal').click(function() {$('#margin_482261063883').toggle('slow', function() {});});</script>)</p><p><a class="displaced_anchor" name="eqtn93"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-300-Frame"><nobr><span class="math" id="MathJax-Span-3927" role="math" style="width: 100%; display: inline-block; min-width: 20.885em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 20.885em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3928"><span class="mtable" id="MathJax-Span-3929" style="min-width: 21.277em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.885em;"><span style="display: inline-block; position: absolute; width: 14.512em; height: 0px; clip: rect(-1.713em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -7.252em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 14.512em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.346em -999.998em); top: -4.115em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3933"><span class="mrow" id="MathJax-Span-3934"><span class="mi" id="MathJax-Span-3935" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-3936" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mrow" id="MathJax-Span-3937" style="padding-left: 0.297em;"><span class="mo" id="MathJax-Span-3938" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mn" id="MathJax-Span-3939" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3940" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3941" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-3942"><span class="mi" id="MathJax-Span-3943" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3944" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-3945" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3946" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-3947" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">w</span><span class="mo" id="MathJax-Span-3948" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3949" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-3950" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-3951" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3952" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3953" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-3954" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-3955" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-3956"><span class="mi" id="MathJax-Span-3957" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3958"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3959" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-3961"><span class="mi" id="MathJax-Span-3962" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-3963" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-3964" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.978em 1000.002em 0.297em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.115em; right: 0.002em;"><span class="mtd" id="mjx-eqn-93"><span class="mrow" id="MathJax-Span-3931"><span class="mtext" id="MathJax-Span-3932" style="font-family: MathJax_Main;">(93)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.752em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-300">\begin{eqnarray} 
  w \rightarrow \left(1-\frac{\eta \lambda}{n}\right) w -\frac{\eta}{m}
  \sum_x \frac{\partial C_x}{\partial w}, 
\tag{93}\end{eqnarray}</script></p><p>where the sum is over training examples <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-301-Frame"><nobr><span class="math" id="MathJax-Span-3965" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3966"><span class="mi" id="MathJax-Span-3967" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-301">x</script> in the mini-batch, and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-302-Frame"><nobr><span class="math" id="MathJax-Span-3968" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3969"><span class="msubsup" id="MathJax-Span-3970"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3971" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3972" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-302">C_x</script> is the (unregularized) cost for each training example.  This is
exactly the same as the usual rule for stochastic gradient descent,
except for the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-303-Frame"><nobr><span class="math" id="MathJax-Span-3973" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3974"><span class="mn" id="MathJax-Span-3975" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3976" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-3977" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -4.556em; left: 50%; margin-left: -0.39em;"><span class="mrow" id="MathJax-Span-3978"><span class="mi" id="MathJax-Span-3979" style="font-size: 70.7%; font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3980" style="font-size: 70.7%; font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-3981" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.885em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.552em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-303">1-\frac{\eta \lambda}{n}</script> weight decay factor.
Finally, and for completeness, let me state the regularized learning
rule for the biases.  This is, of course, exactly the same as in the
unregularized case (c.f. Equation <span id="margin_667546403840_reveal" class="equation_link">(21)</span><span id="margin_667546403840" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn21" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-304-Frame"><nobr><span class="math" id="MathJax-Span-3982" role="math" style="width: 12.748em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3983"><span class="mtable" id="MathJax-Span-3984" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.208em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3985"><span class="mrow" id="MathJax-Span-3986"><span class="msubsup" id="MathJax-Span-3987"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3988" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-3989" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.022em -999.998em); top: -4.017em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.164em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-3990"><span class="mrow" id="MathJax-Span-3991"><span class="mi" id="MathJax-Span-3992"></span><span class="mo" id="MathJax-Span-3993" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 2.551em;"><span style="display: inline-block; position: relative; width: 9.61em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -4.164em; left: 0.002em;"><span class="mtd" id="MathJax-Span-3994"><span class="mrow" id="MathJax-Span-3995"><span class="msubsup" id="MathJax-Span-3996"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3997" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.444em;"><span class="mo" id="MathJax-Span-3998" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-3999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4000" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-4001" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4002" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-4003" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4004" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4005" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-4006" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-4007" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-4008" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4009" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-4010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4011" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-4012"><span class="mi" id="MathJax-Span-4013" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4014"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4015" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-4016"><span class="mrow" id="MathJax-Span-4017"><span class="msubsup" id="MathJax-Span-4018"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4019" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-4020" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4021"><span class="mi" id="MathJax-Span-4022" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4023"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4024" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-4025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.002em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-304">\begin{eqnarray}  
  b_l & \rightarrow & b_l' = b_l-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial b_l} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_667546403840_reveal').click(function() {$('#margin_667546403840').toggle('slow', function() {});});</script>),</p><p><a class="displaced_anchor" name="eqtn94"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-305-Frame"><nobr><span class="math" id="MathJax-Span-4026" role="math" style="width: 100%; display: inline-block; min-width: 15.542em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.542em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-4027"><span class="mtable" id="MathJax-Span-4028" style="min-width: 15.885em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.542em;"><span style="display: inline-block; position: absolute; width: 9.12em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -4.556em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.12em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4032"><span class="mrow" id="MathJax-Span-4033"><span class="mi" id="MathJax-Span-4034" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-4035" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-4036" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">b</span><span class="mo" id="MathJax-Span-4037" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4038" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-4039" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-4040" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-4041" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4042" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-4043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4044" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-4045"><span class="mi" id="MathJax-Span-4046" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4047"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4048" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-4049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-4050"><span class="mi" id="MathJax-Span-4051" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4052" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4053" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-94"><span class="mrow" id="MathJax-Span-4030"><span class="mtext" id="MathJax-Span-4031" style="font-family: MathJax_Main;">(94)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-305">\begin{eqnarray}
  b \rightarrow b - \frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial b},
\tag{94}\end{eqnarray}</script>
where the sum is over training examples <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-306-Frame"><nobr><span class="math" id="MathJax-Span-4054" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4055"><span class="mi" id="MathJax-Span-4056" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-306">x</script> in the mini-batch.</p><p>Let's see how regularization changes the performance of our neural
network. We'll use a network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-307-Frame"><nobr><span class="math" id="MathJax-Span-4057" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4058"><span class="mn" id="MathJax-Span-4059" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-307">30</script> hidden neurons, a mini-batch
size of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-308-Frame"><nobr><span class="math" id="MathJax-Span-4060" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4061"><span class="mn" id="MathJax-Span-4062" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-308">10</script>, a learning rate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-309-Frame"><nobr><span class="math" id="MathJax-Span-4063" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4064"><span class="mn" id="MathJax-Span-4065" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-309">0.5</script>, and the cross-entropy cost
function.  However, this time we'll use a regularization parameter of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-310-Frame"><nobr><span class="math" id="MathJax-Span-4066" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4067"><span class="mi" id="MathJax-Span-4068" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4069" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4070" style="font-family: MathJax_Main; padding-left: 0.297em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-310">\lambda = 0.1</script>.  Note that in the code, we use the variable name
<tt>lmbda</tt>, because <tt>lambda</tt> is a reserved word in Python, with
an unrelated meaning.  I've also used the <tt>test_data</tt> again, not
the <tt>validation_data</tt>.  Strictly speaking, we should use the
<tt>validation_data</tt>, for all the reasons we discussed earlier.  But
I decided to use the <tt>test_data</tt> because it makes the results
more directly comparable with our earlier, unregularized results.  You
can easily change the code to use the <tt>validation_data</tt> instead,
and you'll find that it gives similar results.
</p><div class="highlight"><pre> 
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_training_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">monitor_training_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

The cost on the training data decreases over the whole time, much as
it did in the earlier, unregularized case*<span class="marginnote">
*This and the next
  two graphs were produced with the program
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/overfitting.py">overfitting.py</a>.</span>:<p></p><p></p><center><img src="./Neural networks and deep learning 3_files/regularized1.png" width="520px"></center><p></p><p>But this time the accuracy on the <tt>test_data</tt> continues to
increase for the entire 400 epochs:</p><p></p><center><img src="./Neural networks and deep learning 3_files/regularized2.png" width="520px"></center><p></p><p>Clearly, the use of regularization has suppressed overfitting.  What's
more, the accuracy is considerably higher, with a peak classification
accuracy of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-311-Frame"><nobr><span class="math" id="MathJax-Span-4071" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4072"><span class="mn" id="MathJax-Span-4073" style="font-family: MathJax_Main;">87.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-311">87.1</script> percent, compared to the peak of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-312-Frame"><nobr><span class="math" id="MathJax-Span-4074" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4075"><span class="mn" id="MathJax-Span-4076" style="font-family: MathJax_Main;">82.27</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-312">82.27</script> percent
obtained in the unregularized case.  Indeed, we could almost certainly
get considerably better results by continuing to train past 400
epochs. It seems that, empirically, regularization is causing our
network to generalize better, and considerably reducing the effects of
overfitting.</p><p>What happens if we move out of the artificial environment of just
having 1,000 training images, and return to the full 50,000 image
training set?  Of course, we've seen already that overfitting is much
less of a problem with the full 50,000 images.  Does regularization
help any further?  Let's keep the hyper-parameters the same as before
- <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-313-Frame"><nobr><span class="math" id="MathJax-Span-4077" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4078"><span class="mn" id="MathJax-Span-4079" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">30</script> epochs, learning rate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-314-Frame"><nobr><span class="math" id="MathJax-Span-4080" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4081"><span class="mn" id="MathJax-Span-4082" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">0.5</script>, mini-batch size of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-315-Frame"><nobr><span class="math" id="MathJax-Span-4083" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4084"><span class="mn" id="MathJax-Span-4085" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">10</script>.
However, we need to modify the regularization parameter.  The reason
is because the size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-316-Frame"><nobr><span class="math" id="MathJax-Span-4086" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4087"><span class="mi" id="MathJax-Span-4088" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-316">n</script> of the training set has changed from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-317-Frame"><nobr><span class="math" id="MathJax-Span-4089" role="math" style="width: 4.512em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.414em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4090"><span class="mi" id="MathJax-Span-4091" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4092" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4093" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span><span class="mo" id="MathJax-Span-4094" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4095" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-317">n =
1,000</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-318-Frame"><nobr><span class="math" id="MathJax-Span-4096" role="math" style="width: 5.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.904em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4097"><span class="mi" id="MathJax-Span-4098" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4099" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4100" style="font-family: MathJax_Main; padding-left: 0.297em;">50</span><span class="mo" id="MathJax-Span-4101" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4102" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-318">n = 50,000</script>, and this changes the weight decay factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-319-Frame"><nobr><span class="math" id="MathJax-Span-4103" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.846em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4104"><span class="mn" id="MathJax-Span-4105" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4106" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4107" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -4.556em; left: 50%; margin-left: -0.39em;"><span class="mrow" id="MathJax-Span-4108"><span class="mi" id="MathJax-Span-4109" style="font-size: 70.7%; font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4110" style="font-size: 70.7%; font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-4111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.885em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.552em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-319">1 -
\frac{\eta \lambda}{n}</script>.  If we continued to use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-320-Frame"><nobr><span class="math" id="MathJax-Span-4112" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4113"><span class="mi" id="MathJax-Span-4114" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4115" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4116" style="font-family: MathJax_Main; padding-left: 0.297em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-320">\lambda = 0.1</script> that
would mean much less weight decay, and thus much less of a
regularization effect.  We compensate by changing to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-321-Frame"><nobr><span class="math" id="MathJax-Span-4117" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4118"><span class="mi" id="MathJax-Span-4119" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4120" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4121" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-321">\lambda = 5.0</script>.</p><p>Okay, let's train our network, stopping first to re-initialize the
weights:
</p><div class="highlight"><pre> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">monitor_training_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

We obtain the results:<p></p><p></p><center><img src="./Neural networks and deep learning 3_files/regularized_full.png" width="520px"></center><p></p><p>There's lots of good news here.  First, our classification accuracy on
the test data is up, from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-322-Frame"><nobr><span class="math" id="MathJax-Span-4122" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4123"><span class="mn" id="MathJax-Span-4124" style="font-family: MathJax_Main;">95.49</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-322">95.49</script> percent when running unregularized,
to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-323-Frame"><nobr><span class="math" id="MathJax-Span-4125" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4126"><span class="mn" id="MathJax-Span-4127" style="font-family: MathJax_Main;">96.49</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-323">96.49</script> percent.  That's a big improvement.  Second, we can see
that the gap between results on the training and test data is much
narrower than before, running at under a percent.  That's still a
significant gap, but we've obviously made substantial progress
reducing overfitting.</p><p>Finally, let's see what test classification accuracy we get when we
use 100 hidden neurons and a regularization parameter of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-324-Frame"><nobr><span class="math" id="MathJax-Span-4128" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4129"><span class="mi" id="MathJax-Span-4130" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4131" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4132" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-324">\lambda =
5.0</script>. I won't go through a detailed analysis of overfitting here, this
is purely for fun, just to see how high an accuracy we can get when we
use our new tricks: the cross-entropy cost function and L2
regularization.</p><p></p><div class="highlight"><pre> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">lmbda</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>The final result is a classification accuracy of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-325-Frame"><nobr><span class="math" id="MathJax-Span-4133" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4134"><span class="mn" id="MathJax-Span-4135" style="font-family: MathJax_Main;">97.92</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-325">97.92</script> percent on
the validation data.  That's a big jump from the 30 hidden neuron
case.  <a name="chap3_98_04_percent"></a> In fact, tuning just
a little more, to run for 60 epochs at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-326-Frame"><nobr><span class="math" id="MathJax-Span-4136" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4137"><span class="mi" id="MathJax-Span-4138" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4139" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4140" style="font-family: MathJax_Main; padding-left: 0.297em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-326">\eta = 0.1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-327-Frame"><nobr><span class="math" id="MathJax-Span-4141" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4142"><span class="mi" id="MathJax-Span-4143" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4144" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4145" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-327">\lambda =
5.0</script> we break the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-328-Frame"><nobr><span class="math" id="MathJax-Span-4146" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4147"><span class="mn" id="MathJax-Span-4148" style="font-family: MathJax_Main;">98</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-328">98</script> percent barrier, achieving <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-329-Frame"><nobr><span class="math" id="MathJax-Span-4149" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4150"><span class="mn" id="MathJax-Span-4151" style="font-family: MathJax_Main;">98.04</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-329">98.04</script> percent
classification accuracy on the validation data.  Not bad for what
turns out to be 152 lines of code!</p><p>I've described regularization as a way to reduce overfitting and to
increase classification accuracies.  In fact, that's not the only
benefit.  Empirically, when doing multiple runs of our MNIST networks,
but with different (random) weight initializations, I've found that
the unregularized runs will occasionally get "stuck", apparently
caught in local minima of the cost function.  The result is that
different runs sometimes provide quite different results.  By
contrast, the regularized runs have provided much more easily
replicable results.</p><p>Why is this going on?  Heuristically, if the cost function is
unregularized, then the length of the weight vector is likely to grow,
all other things being equal.  Over time this can lead to the weight
vector being very large indeed.  This can cause the weight vector to
get stuck pointing in more or less the same direction, since changes
due to gradient descent only make tiny changes to the direction, when
the length is long.  I believe this phenomenon is making it hard for
our learning algorithm to properly explore the weight space, and
consequently harder to find good minima of the cost function.</p><p>
</p><h4><a name="why_does_regularization_help_reduce_overfitting"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#why_does_regularization_help_reduce_overfitting">Why does regularization help reduce overfitting?</a></h4><p></p><p>We've seen empirically that regularization helps reduce overfitting.
That's encouraging but, unfortunately, it's not obvious why
regularization helps!  A standard story people tell to explain what's
going on is along the following lines: smaller weights are, in some
sense, lower complexity, and so provide a simpler and more powerful
explanation for the data, and should thus be preferred.  That's a
pretty terse story, though, and contains several elements that perhaps
seem dubious or mystifying.  Let's unpack the story and examine it
critically.  To do that, let's suppose we have a simple data set for
which we wish to build a model:</p><p></p><div id="simple_model"><svg width="520" height="360"><circle cx="101.6" cy="269.6" r="5"></circle><circle cx="154.4" cy="258.40000000000003" r="5"></circle><circle cx="207.20000000000002" cy="208" r="5"></circle><circle cx="268.8" cy="180" r="5"></circle><circle cx="295.2" cy="149.20000000000002" r="5"></circle><circle cx="356.79999999999995" cy="124.00000000000001" r="5"></circle><circle cx="374.40000000000003" cy="112.80000000000001" r="5"></circle><circle cx="387.6" cy="95.99999999999999" r="5"></circle><circle cx="427.20000000000005" cy="65.20000000000002" r="5"></circle><circle cx="471.20000000000005" cy="40" r="5"></circle><g class="axis" transform="translate(0,320)"><g class="tick" transform="translate(40,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(128,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(304,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(392,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><g class="tick" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">5</text></g><path class="domain" d="M40,6V0H480V6"></path></g><text class="axisLabel" x="260" y="357">x</text><g class="axis" transform="translate(40, 0)"><g class="tick" transform="translate(0,320)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0</text></g><g class="tick" transform="translate(0,292)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1</text></g><g class="tick" transform="translate(0,264)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">2</text></g><g class="tick" transform="translate(0,236)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">3</text></g><g class="tick" transform="translate(0,208)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">4</text></g><g class="tick" transform="translate(0,180)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">5</text></g><g class="tick" transform="translate(0,152)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">6</text></g><g class="tick" transform="translate(0,124.00000000000001)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">7</text></g><g class="tick" transform="translate(0,95.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">8</text></g><g class="tick" transform="translate(0,68)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">9</text></g><g class="tick" transform="translate(0,40)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,40H0V320H-6"></path></g><text class="axisLabel" x="2" y="180">y</text></svg></div> <script type="text/javascript" style="display:none">
<!--
var data = [[ 0.7, 1.8], 
	    [ 1.3, 2.2], 
	    [ 1.9, 4.0], 
	    [ 2.6, 5.0], 
	    [ 2.9, 6.1], 
	    [ 3.6, 7.0], 
	    [ 3.8, 7.4], 
	    [ 3.95, 8.0], 
	    [ 4.4, 9.1], 
	    [ 4.9, 10.0] ]; 

var width = 520; 
var height = 360; 
var padding = 40; 

var xScale = d3.scale.linear() 
    .domain([0, 5]) 
    .range([padding, width-padding]);

var yScale = d3.scale.linear() 
    .domain([0, 10])
    .range([height-padding, padding]); 

var xAxis = d3.svg.axis()
    .scale(xScale) 
    .orient("bottom") 
    .ticks(5); 

var yAxis = d3.svg.axis()
    .scale(yScale) 
    .orient("left"); 

var svg = d3.select("#simple_model").append("svg") 
    .attr("width", width)
    .attr("height", height);

svg.selectAll("circle").data(data).enter()
    .append("circle") 
    .attr("cx", function(d) {return xScale(d[0]);})
    .attr("cy", function(d) {return yScale(d[1]);}) 
    .attr("r", 5); 

// x axis 
svg.append("g") 
    .attr("class", "axis") 
    .attr("transform", "translate(0,"+(height-padding)+")") 
    .call(xAxis); 
svg.append("text")
    .attr("class", "axisLabel") 
    .attr("x", width/2) 
    .attr("y", height - 3)
    .text("x"); 

// y axis 
svg.append("g") 
    .attr("class", "axis")
    .attr("transform", "translate("+padding+", 0)") 
    .call(yAxis);
svg.append("text") 
    .attr("class", "axisLabel") 
    .attr("x", 2)
    .attr("y", height/2) 
    .text("y");

//-->
</script> <p></p><p>Implicitly, we're studying some real-world phenomenon here, with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-330-Frame"><nobr><span class="math" id="MathJax-Span-4152" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4153"><span class="mi" id="MathJax-Span-4154" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-330">x</script>
and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-331-Frame"><nobr><span class="math" id="MathJax-Span-4155" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4156"><span class="mi" id="MathJax-Span-4157" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-331">y</script> representing real-world data.  Our goal is to build a model
which lets us predict <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-332-Frame"><nobr><span class="math" id="MathJax-Span-4158" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4159"><span class="mi" id="MathJax-Span-4160" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-332">y</script> as a function of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-333-Frame"><nobr><span class="math" id="MathJax-Span-4161" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4162"><span class="mi" id="MathJax-Span-4163" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-333">x</script>.  We could try using
neural networks to build such a model, but I'm going to do something
even simpler: I'll try to model <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-334-Frame"><nobr><span class="math" id="MathJax-Span-4164" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4165"><span class="mi" id="MathJax-Span-4166" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-334">y</script> as a polynomial in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-335-Frame"><nobr><span class="math" id="MathJax-Span-4167" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4168"><span class="mi" id="MathJax-Span-4169" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-335">x</script>.  I'm doing
this instead of using neural nets because using polynomials will make
things particularly transparent.  Once we've understood the polynomial
case, we'll translate to neural networks.  Now, there are ten points
in the graph above, which means we can find a unique <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-336-Frame"><nobr><span class="math" id="MathJax-Span-4170" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4171"><span class="mn" id="MathJax-Span-4172" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-336">9</script>th-order
polynomial <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-337-Frame"><nobr><span class="math" id="MathJax-Span-4173" role="math" style="width: 11.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4174"><span class="mi" id="MathJax-Span-4175" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4176" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-4177" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4178" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-4179" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4180"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4181" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.591em;"><span class="mn" id="MathJax-Span-4182" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4183" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-4184" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4185" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-4186" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4187"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4188" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.591em;"><span class="mn" id="MathJax-Span-4189" style="font-size: 70.7%; font-family: MathJax_Main;">8</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4190" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-4191" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mo" id="MathJax-Span-4192" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-4193" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4194" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-4195" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-337">y = a_0 x^9 + a_1 x^8 + \ldots + a_9</script> which fits the data
exactly.  Here's the graph of that polynomial*<span class="marginnote">
*I won't show
  the coefficients explicitly, although they are easy to find using a
  routine such as Numpy's <tt>polyfit</tt>.  You can view the exact form
  of the polynomial in the <a href="http://neuralnetworksanddeeplearning.com/js/polynomial_model.js">source code
    for the graph</a> if you're curious.  It's the function <tt>p(x)</tt>
  defined starting on line 14 of the program which produces the
  graph.</span>:</p><p></p><div id="polynomial_fit"><svg width="520" height="360"><path class="path" d="M40,12947.550627999999L40.88,12354.008600295576L41.760000000000005,11783.748930240756L42.64,11236.014446066483L43.519999999999996,10710.068060934105L44.4,10205.19234849147L45.279999999999994,9720.689125317602L46.16,9255.879040175092L47.04,8810.101169990052L47.92,8382.712622480038L48.800000000000004,7973.088145350963L49.67999999999999,7580.619741984643L50.56,7204.716293539193L51.44,6844.803187385111L52.31999999999999,6500.321951800487L53.199999999999996,6170.72989684934L54.08,5855.499761367722L54.96,5554.119365982789L55.84,5266.091272090624L56.72,4990.932446719216L57.599999999999994,4728.173933203559L58.48,4477.360527600381L59.35999999999999,4238.050460770703L60.239999999999995,4009.815086058874L61.12,3792.2385724973756L62,3584.9176034672773L62.88,3387.4610807447407L63.76,3199.489833864566L64.64,3020.6363347323495L65.52,2850.5444174173936L66.39999999999999,2688.8690030589887L67.28,2535.2758298194076L68.16,2389.441187817331L69.03999999999999,2251.051658976093L69.92,2119.8038617216744L70.8,1995.404200465865L71.68,1877.5686198106343L72.56,1766.0223634102456L73.44,1660.49973742822L74.32,1560.7438785268043L75.2,1466.50652632707L76.07999999999998,1377.5478002784296L76.96,1293.635980876774L77.84,1214.5472951710185L78.72,1140.0657064983814L79.6,1069.9827083892471L80.47999999999999,1004.0971225829401L81.36,942.2149010963642L82.24000000000001,884.1489322878504L83.12,829.7188508591937L84,778.7508517393046L84.88,731.0775077934638L85.76,686.5375913026285L86.64,644.9758991577185L87.52000000000001,606.2430817146003L88.4,570.1954752553982L89.28,536.6949380030617L90.16,505.6086896357981L91.03999999999999,476.8091542491509L91.92,450.1738067135964L92.8,425.585022376227L93.68,402.9299300553346L94.56,382.10026827765273L95.44,362.99224470797003L96.32,345.5063987216779L97.2,329.54746707115214L98.08,315.0242525975002L98.96000000000001,301.84949593925717L99.84,289.93975019081677L100.72,279.2152584631292L101.6,269.5998343000854L102.47999999999999,261.0207449043289L103.35999999999999,253.4085971269567L104.24,246.6972261753997L105.11999999999999,240.82358699519295L106,235.7276482807381L106.88,231.35228907173473L107.75999999999999,227.64319789123124L108.63999999999999,224.54877438283052L109.52000000000001,222.02003340411534L110.4,220.0105115345675L111.28,218.476175955994L112.16,217.37533566452362L113.03999999999999,216.6685549732763L113.91999999999999,216.31856926539854L114.8,216.290202957847L115.67999999999999,216.55028963594464L116.56,217.06759432036483L117.44,217.8127378273955L118.32,218.75812318475596L119.19999999999999,219.87786406494592L120.08,221.14771519915644L120.96,222.54500473454368L121.84,224.0485684986404L122.72,225.6386861347562L123.60000000000001,227.29701907299454L124.47999999999999,229.00655030120902L125.36000000000001,230.7515259018062L126.24000000000001,232.51739831914415L127.12,234.29077132443376L128,236.05934664399933L128.88,237.81187221807954L129.76,239.53809205691027L130.64000000000001,241.22869766243525L131.52,242.8752809831119L132.4,244.47028887038755L133.28,246.00697900595583L134.16000000000003,247.47937726843224L135.04000000000002,248.88223650951363L135.92000000000002,250.21099670945728L136.8,251.4617464822502L137.68,252.63118590124645L138.56,253.71659061585956L139.44,254.71577723213773L140.32,255.62706992741437L141.2,256.44926827249833L142.07999999999998,257.1816162335824L142.95999999999998,257.8237723267746L143.84,258.3757808988055L144.72,258.8380445072114L145.6,259.211297374565L146.48,259.49657989116054L147.36,259.6952141400386L148.24,259.8087804209724L149.12,259.8390947472624L150,259.78818729277623L150.88,259.65828176376885L151.76,259.4517756737848L152.64,259.1712214964962L153.52,258.81930867593724L154.4,258.3988464691163L155.28,257.91274760193005L156.16,257.3640127129154L157.04000000000002,256.7557155669863L157.92000000000002,256.0909890159062L158.8,255.373011684537L159.68,254.60499536432576L160.56,253.79017309100777L161.44,252.93178788978253L162.32,252.03308216552682L163.2,251.0972877214033L164.07999999999998,250.127616384804L164.95999999999998,249.12725122370716L165.84,248.0993383341945L166.71999999999997,247.0469791813673L167.6,245.97322347639488L168.48,244.8810625712074L169.36,243.77342335621574L170.23999999999998,242.65316264063472L171.12,241.5230620020145L172,240.38582308827495L172.88,239.24406335462004L173.76,238.1003122213649L174.64,236.95700763784112L175.52,235.81649303443987L176.4,234.68101465249197L177.27999999999997,233.552719232325L178.16,232.43365205083933L179.04000000000002,231.32575529026758L179.92000000000002,230.23086672528257L180.79999999999998,229.1507187188788L181.68,228.08693750670568L182.56,227.0410427658287L183.44,226.01444744694777L184.31999999999996,225.00845786332388L185.2,224.02427402275202L186.07999999999998,223.06299019020366L186.95999999999998,222.1255956691573L187.83999999999997,221.21297579328962L188.71999999999997,220.3259131130569L189.6,219.4650887701889L190.48,218.63108404761692L191.35999999999999,217.8243820843952L192.23999999999998,217.04536974807775L193.12,216.2943396492708L194,215.5714922960185L194.88,214.87693837274196L195.76,214.21070113669043L196.64,213.57271892435415L197.52,212.96284775718118L198.39999999999998,212.38086403914963L199.28,211.82646733707838L200.16,211.29928323644413L201.04000000000002,210.79886626786606L201.92,210.32470288678883L202.79999999999998,209.87621451425798L203.68,209.45276061647996L204.56,209.0536418270883L205.44,208.67810310005802L206.32,208.325336886978L207.20000000000002,207.99448633612224L208.08,207.68464850191117L208.95999999999998,207.39487756271296L209.84,207.1241880416626L210.72,206.8715580187843L211.60000000000002,206.63593233938332L212.48,206.41622580397484L213.36,206.21132633990305L214.24,206.0200981494297L215.12,205.8413848274165L216,205.6740124481173L216.88,205.51679261142885L217.76000000000002,205.36852545140096L218.64,205.22800259462997L219.52,205.0940100758187L220.39999999999998,204.9653311944337L221.28000000000003,204.8407493197435L222.16,204.71905063550253L223.04000000000002,204.59902682086863L223.92,204.47947766976972L224.8,204.3592136395007L225.68,204.23705833035888L226.56,204.11185088954403L227.44,203.98244834861794L228.32000000000002,203.84772787389625L229.20000000000002,203.70658894253097L230.08,203.55795543791714L230.95999999999998,203.40077766287027L231.84000000000003,203.23403426665277L232.72000000000003,203.05673408959296L233.60000000000002,202.86791791699466L234.48,202.66666015183614L235.36000000000004,202.45207038899275L236.24,202.22329491107553L237.12,201.97951808383255L238,201.71996367074712L238.88,201.44389604327694L239.76000000000002,201.15062131332047L240.64,200.83948836295417L241.52,200.50988978771306L242.39999999999998,200.16126274574958L243.28000000000003,199.79308971516252L244.15999999999997,199.40489916138063L245.04000000000002,198.99626610578957L245.92,198.56681261426888L246.8,198.1162081885766L247.68,197.6441700635612L248.56,197.15046342644814L249.44,196.63490153841371L250.32000000000002,196.09734576970254L251.2,195.53770555243932L252.08,194.95593824609273L252.95999999999998,194.35204891510762L253.84000000000003,193.72609002670174L254.72,193.0781610689544L255.60000000000002,192.40840808557073L256.48,191.71702312750017L257.36,191.00424364111927L258.24,190.27035176422828L259.12,189.51567355955444L260,188.74057817101743L260.88,187.94547691301955L261.76,187.13082228720918L262.64,186.29710693629272L263.52,185.444862535506L264.40000000000003,184.57465861181367L265.28,183.6871013179068L266.15999999999997,182.78283213576174L267.04,181.86252653242514L267.92,180.92689255241453L268.8,179.97666937764984L269.68,179.01262581944206L270.56,178.03555876968562L271.44,177.04629161983644L272.32,176.04567262297383L273.2,175.0345732281046L274.08000000000004,174.01388636832303L274.96,172.98452473111934L275.84000000000003,171.9474189814489L276.72,170.9035159606599L277.6,169.85377687732284L278.48,168.79917544486193L279.36,167.7406960211472L280.24,166.67933173031156L281.12,165.6160825594077L282,164.55195344961498L282.88,163.48795237736226L283.76,162.42508843359133L284.64,161.36436988595847L285.52000000000004,160.30680226482104L286.4,159.25338642360543L287.28000000000003,158.20511662731474L288.15999999999997,157.16297863309114L289.04,156.1279477900814L289.91999999999996,155.10098714925948L290.8,154.08304559099884L291.68,153.07505597775412L292.56000000000006,152.07793330776144L293.43999999999994,151.09257291557037L294.32000000000005,150.11984869643743L295.2,149.1606113537407L296.08000000000004,148.2156866640678L296.96,147.28587381928696L297.84000000000003,146.37194377557057L298.72,145.47463762936127L299.6,144.5946650864414L300.47999999999996,143.73270291712356L301.36000000000007,142.88939351210752L302.24,142.06534344831994L303.12,141.2611221327304L304,140.47726049340667L304.88,139.71424971788542L305.76,138.97254007883998L306.64,138.25253978175056L307.52,137.55461391678068L308.40000000000003,136.87908345990468L309.28,136.22622432214007L310.15999999999997,135.59626651149188L311.04,134.9893933230112L311.91999999999996,134.40574065676878L312.8,133.84539633890995L313.68,133.308399585522L314.56,132.794740530421L315.44,132.30435979039862L316.32,131.8371481851234L317.2,131.39294647705788L318.08000000000004,130.97154523870518L318.96,130.57268477646608L319.84000000000003,130.19605517044215L320.72,129.841296385747L321.59999999999997,129.50799846749828L322.48,129.19570184661166L323.36,128.90389772833328L324.24,128.63202855640588L325.12,128.37948861515792L326,128.14562465784797L326.88,127.92973670639437L327.76,127.73107886806497L328.63999999999993,127.54886032895115L329.52000000000004,127.38224635490293L330.4,127.2303594595203L331.28,127.09228062536819L332.15999999999997,126.96705064477896L333.04,126.85367152498178L333.92,126.75110802685116L334.8,126.65828925440906L335.67999999999995,126.57411037476298L336.56000000000006,126.49743439916233L337.43999999999994,126.42709406833706L338.32,126.3618938507268L339.2,126.3006119618974L340.08000000000004,126.24200256685323L340.96,126.1847979682668L341.84000000000003,126.12771096117899L342.71999999999997,126.06943722177196L343.6,126.00865779617266L344.47999999999996,125.94404164301409L345.36,125.87424829051702L346.24,125.7979305608012L347.12,125.71373730229493L348,125.62031629936132L348.88,125.51631714958307L349.75999999999993,125.40039425829195L350.64,125.27120987384365L351.52,125.12743720020694L352.4,124.96776350746472L353.28,124.79089336966967L354.15999999999997,124.59555190234344L355.04,124.38048799895728L355.91999999999996,124.14447774809264L356.79999999999995,123.88632768397908L357.68,123.60487823994366L358.56,123.29900714558131L359.44,122.96763281493509L360.32,122.60971782719456L361.2,122.22427238218256L362.08000000000004,121.8103577126519L362.96,121.36708953424635L363.84,120.89364157269915L364.72,120.3892488422814L365.59999999999997,119.85321120269394L366.47999999999996,119.28489660708397L367.36,118.68374458152061L368.24,118.04926937794765L369.12,117.38106337649765L370,116.67880018257233L370.88,115.94223782313816L371.76,115.17122177767192L372.64,114.36568803115985L373.52000000000004,113.52566588601145L374.40000000000003,112.65128085739957L375.28,111.74275734885555L376.16,110.80042124998978L377.04,109.82470237487246L377.91999999999996,108.81613689274924L378.8,107.77536944659619L379.68,106.7031552604701L380.56,105.60036199484853L381.44,104.46797151110762L382.32,103.30708140701131L383.20000000000005,102.11890634989938L384.08000000000004,100.90477927113784L384.96,99.66615224708472L385.84000000000003,98.40459728134988L386.72,97.12180673399668L387.6,95.81959356199036L388.48,94.49989133264421L389.36,93.16475383821921L390.24000000000007,91.81635460509528L391.12,90.4569859201099L392,89.08905770033267L392.88,87.71509590236633L393.75999999999993,86.33774073978816L394.64,84.95974439463566L395.52000000000004,83.58396846358914L396.4,82.21338097454532L397.28,80.85105305410504L398.16,79.50015514782966L399.04,78.16395275012724L399.92,76.84580182141758L400.79999999999995,75.54914369210995L401.68000000000006,74.27749938453303L402.56000000000006,73.03446364664228L403.43999999999994,71.82369828073092L404.32,70.64892504242994L405.20000000000005,69.51391803573894L406.08,68.42249542465538L406.96,67.37851061710057L407.84,66.38584296076691L408.72,65.44838762415996L409.6,64.57004490715438L410.47999999999996,63.75470909993851L411.36,63.006256277791856L412.24,62.32853173541912L413.12,61.72533656624251L414,61.200413508074L414.88,60.75743202053376L415.76,60.39997266068054L416.64000000000004,60.13151044688381L417.52,59.95539785013055L418.40000000000003,59.874846256515184L419.2799999999999,59.89290730061725L420.16,60.012452688550866L421.04,60.23615352264711L421.91999999999996,60.566458482261396L422.79999999999995,61.00557106876181L423.68000000000006,61.555425966903144L424.56,62.21766420971359L425.44,62.99360747244894L426.31999999999994,63.884231254402714L427.20000000000005,64.890136952238L428.08000000000004,66.01152281918871L428.96,67.24815371605904L429.84,68.59932991586061L430.7200000000001,70.06385450971241L431.59999999999997,71.63999957846204L432.48,73.32547124538792L433.35999999999996,75.11737343039816L434.24,77.01217008778872L435.12,79.00564651088165L436,81.09286882945412L436.88,83.26814240143972L437.76,85.52496859416965L438.64,87.85600042708641L439.52000000000004,90.25299624986904L440.4,92.70677224505448L441.28,95.20715334709053L442.16,97.74292241020407L443.04,100.30176792155795L443.92,102.87022999205033L444.79999999999995,105.43364476583771L445.68,107.97608678698704L446.56000000000006,110.48031017427523L447.43999999999994,112.92768747498006L448.31999999999994,115.29814692440664L449.20000000000005,117.57010787732246L450.08,119.72041443294688L450.96,121.72426668509684L451.84,123.55515074447136L452.72,125.18476590529713L453.6,126.58295064120718L454.47999999999996,127.71760566612897L455.36,128.55461560794606L456.24000000000007,129.05776812747604L457.12,129.1886709780763L458,128.90666664125706L458.88,128.1687449299668L459.75999999999993,126.92945328828752L460.64000000000004,125.14080447940319L461.52,122.7521820282443L462.4,119.71024337974337L463.28,115.95882023608534L464.16,111.43881653256062L465.04,106.08810415760193L465.91999999999996,99.84141540331142L466.79999999999995,92.63023334423882L467.68000000000006,84.3826791550116L468.56,75.02339701451523L469.44,64.47343578421237L470.32,52.65012836198979L471.20000000000005,39.466967559713126L472.08000000000004,24.83347964235398L472.96,8.655094443131716L473.84,-9.166987182322586L474.7200000000001,-28.73592934870723L475.59999999999997,-50.159400104739035L476.47999999999996,-73.54971335964115L477.36,-99.02397434042109L478.24,-126.70422819081912L479.12,-156.71761190582515"></path><circle cx="101.6" cy="269.6" r="5"></circle><circle cx="154.4" cy="258.40000000000003" r="5"></circle><circle cx="207.20000000000002" cy="208" r="5"></circle><circle cx="268.8" cy="180" r="5"></circle><circle cx="295.2" cy="149.20000000000002" r="5"></circle><circle cx="356.79999999999995" cy="124.00000000000001" r="5"></circle><circle cx="374.40000000000003" cy="112.80000000000001" r="5"></circle><circle cx="387.6" cy="95.99999999999999" r="5"></circle><circle cx="427.20000000000005" cy="65.20000000000002" r="5"></circle><circle cx="471.20000000000005" cy="40" r="5"></circle><g class="axis" transform="translate(0,320)"><g class="tick" transform="translate(40,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(128,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(304,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(392,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><g class="tick" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">5</text></g><path class="domain" d="M40,6V0H480V6"></path></g><text class="axisLabel" x="260" y="357">x</text><g class="axis" transform="translate(40, 0)"><g class="tick" transform="translate(0,320)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0</text></g><g class="tick" transform="translate(0,292)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1</text></g><g class="tick" transform="translate(0,264)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">2</text></g><g class="tick" transform="translate(0,236)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">3</text></g><g class="tick" transform="translate(0,208)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">4</text></g><g class="tick" transform="translate(0,180)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">5</text></g><g class="tick" transform="translate(0,152)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">6</text></g><g class="tick" transform="translate(0,124.00000000000001)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">7</text></g><g class="tick" transform="translate(0,95.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">8</text></g><g class="tick" transform="translate(0,68)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">9</text></g><g class="tick" transform="translate(0,40)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,40H0V320H-6"></path></g><text class="axisLabel" x="2" y="180">y</text></svg></div> <script type="text/javascript" style="display:none">
<!--
// Note that this script relies on globals defined in simple_data.js,
// such as data, width, height, and so on.  

var svg = d3.select("#polynomial_fit").append("svg") 
    .attr("width", width)
    .attr("height", height) 

// Polynomial model 

var line = d3.svg.line()
    .x(function(d) { return xScale(d[0]); }) 
    .y(function(d) { return yScale(d[1]); }); 

function p(x) {return 2.20539187e-01*Math.pow(x, 9)
	       -5.49142821*(Math.pow(x, 8)) 
	       +5.87844045e+01*(Math.pow(x, 7))
	       -3.53892824e+02*(Math.pow(x, 6)) 
	       +1.31549254e+03*(Math.pow(x, 5))
	       -3.11809836e+03*(Math.pow(x, 4)) 
	       +4.69080366e+03*(Math.pow(x, 3))
	       -4.29612493e+03*(Math.pow(x, 2)) 
	       +2.16228823e+03*x 
	       -4.50983951e+02;};

var polynomialFit = d3.range(0, 5, .01).map(function(d){ 
    return [d, p(d)]; }); 

svg.append("path") 
    .datum(polynomialFit) 
    .attr("class", "path") 
    .attr("d", line); 

svg.selectAll("circle") 
    .data(data) 
    .enter()
    .append("circle") 
    .attr("cx", function(d) {return xScale(d[0]);})
    .attr("cy", function(d) {return yScale(d[1]);}) 
    .attr("r", 5); 

// x axis 
svg.append("g") 
    .attr("class", "axis") 
    .attr("transform", "translate(0,"+(height-padding)+")") 
    .call(xAxis); 
svg.append("text")
    .attr("class", "axisLabel") 
    .attr("x", width/2) .attr("y", height - 3)
    .text("x"); 

// y axis 
svg.append("g") 
    .attr("class", "axis")
    .attr("transform", "translate("+padding+", 0)") 
    .call(yAxis);
svg.append("text") 
    .attr("class", "axisLabel") 
    .attr("x", 2)
    .attr("y", height/2) 
    .text("y");

//-->
</script><p></p><p>That provides an exact fit.  But we can also get a good fit using the
linear model <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-338-Frame"><nobr><span class="math" id="MathJax-Span-4196" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4197"><span class="mi" id="MathJax-Span-4198" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4199" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4200" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span><span class="mi" id="MathJax-Span-4201" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-338">y = 2x</script>:</p><p></p><div id="linear_fit"><svg width="520" height="360"><path class="path" d="M40,320L480,40"></path><circle cx="101.6" cy="269.6" r="5"></circle><circle cx="154.4" cy="258.40000000000003" r="5"></circle><circle cx="207.20000000000002" cy="208" r="5"></circle><circle cx="268.8" cy="180" r="5"></circle><circle cx="295.2" cy="149.20000000000002" r="5"></circle><circle cx="356.79999999999995" cy="124.00000000000001" r="5"></circle><circle cx="374.40000000000003" cy="112.80000000000001" r="5"></circle><circle cx="387.6" cy="95.99999999999999" r="5"></circle><circle cx="427.20000000000005" cy="65.20000000000002" r="5"></circle><circle cx="471.20000000000005" cy="40" r="5"></circle><g class="axis" transform="translate(0,320)"><g class="tick" transform="translate(40,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(128,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(304,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(392,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><g class="tick" transform="translate(480,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">5</text></g><path class="domain" d="M40,6V0H480V6"></path></g><text class="axisLabel" x="260" y="357">x</text><g class="axis" transform="translate(40, 0)"><g class="tick" transform="translate(0,320)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0</text></g><g class="tick" transform="translate(0,292)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1</text></g><g class="tick" transform="translate(0,264)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">2</text></g><g class="tick" transform="translate(0,236)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">3</text></g><g class="tick" transform="translate(0,208)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">4</text></g><g class="tick" transform="translate(0,180)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">5</text></g><g class="tick" transform="translate(0,152)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">6</text></g><g class="tick" transform="translate(0,124.00000000000001)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">7</text></g><g class="tick" transform="translate(0,95.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">8</text></g><g class="tick" transform="translate(0,68)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">9</text></g><g class="tick" transform="translate(0,40)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">10</text></g><path class="domain" d="M-6,40H0V320H-6"></path></g><text class="axisLabel" x="2" y="180">y</text></svg></div> <script type="text/javascript" style="display:none">
<!--
// Note that this script relies on globals defined in simple_data.js,
// such as data, width, height, and so on.  

var svg = d3.select("#linear_fit").append("svg") 
    .attr("width", width)
    .attr("height", height) 

// Straight line model 

var linearModel = [[0,0], [5, 10]]; 

svg.append("path").datum(linearModel)
    .attr("class", "path") .attr("d", line);


svg.selectAll("circle") 
    .data(data) 
    .enter()
    .append("circle") 
    .attr("cx", function(d) {return xScale(d[0]);})
    .attr("cy", function(d) {return yScale(d[1]);}) 
    .attr("r", 5); 

// x axis 
svg.append("g") 
    .attr("class", "axis") 
    .attr("transform", "translate(0,"+(height-padding)+")") 
    .call(xAxis); 
svg.append("text")
    .attr("class", "axisLabel") 
    .attr("x", width/2) .attr("y", height - 3)
    .text("x"); 

// y axis 
svg.append("g") 
    .attr("class", "axis")
    .attr("transform", "translate("+padding+", 0)") 
    .call(yAxis);
svg.append("text") 
    .attr("class", "axisLabel") 
    .attr("x", 2)
    .attr("y", height/2) 
    .text("y");

//-->
</script> <p></p><p>Which of these is the better model?  Which is more likely to be true?
And which model is more likely to generalize well to other examples of
the same underlying real-world phenomenon?</p><p>These are difficult questions.  In fact, we can't determine with
certainty the answer to any of the above questions, without much more
information about the underlying real-world phenomenon.  But let's
consider two possibilities: (1) the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-339-Frame"><nobr><span class="math" id="MathJax-Span-4202" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4203"><span class="mn" id="MathJax-Span-4204" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-339">9</script>th order polynomial is, in
fact, the model which truly describes the real-world phenomenon, and
the model will therefore generalize perfectly; (2) the correct model
is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-340-Frame"><nobr><span class="math" id="MathJax-Span-4205" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4206"><span class="mi" id="MathJax-Span-4207" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4208" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4209" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span><span class="mi" id="MathJax-Span-4210" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-340">y = 2x</script>, but there's a little additional noise due to, say,
measurement error, and that's why the model isn't an exact fit.</p><p>It's not <em>a priori</em> possible to say which of these two
possibilities is correct.  (Or, indeed, if some third possibility
holds).  Logically, either could be true.  And it's not a trivial
difference.  It's true that on the data provided there's only a small
difference between the two models.  But suppose we want to predict the
value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-341-Frame"><nobr><span class="math" id="MathJax-Span-4211" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4212"><span class="mi" id="MathJax-Span-4213" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-341">y</script> corresponding to some large value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-342-Frame"><nobr><span class="math" id="MathJax-Span-4214" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4215"><span class="mi" id="MathJax-Span-4216" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-342">x</script>, much larger
than any shown on the graph above.  If we try to do that there will be
a dramatic difference between the predictions of the two models, as
the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-343-Frame"><nobr><span class="math" id="MathJax-Span-4217" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4218"><span class="mn" id="MathJax-Span-4219" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-343">9</script>th order polynomial model comes to be dominated by the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-344-Frame"><nobr><span class="math" id="MathJax-Span-4220" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4221"><span class="msubsup" id="MathJax-Span-4222"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4223" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.591em;"><span class="mn" id="MathJax-Span-4224" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-344">x^9</script>
term, while the linear model remains, well, linear.</p><p>One point of view is to say that in science we should go with the
simpler explanation, unless compelled not to.  When we find a simple
model that seems to explain many data points we are tempted to shout
"Eureka!"  After all, it seems unlikely that a simple explanation
should occur merely by coincidence.  Rather, we suspect that the model
must be expressing some underlying truth about the phenomenon.  In the
case at hand, the model <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-345-Frame"><nobr><span class="math" id="MathJax-Span-4225" role="math" style="width: 6.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.375em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4226"><span class="mi" id="MathJax-Span-4227" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4228" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4229" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span><span class="mi" id="MathJax-Span-4230" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4231" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="texatom" id="MathJax-Span-4232" style="padding-left: 0.248em;"><span class="mrow" id="MathJax-Span-4233"><span class="mi" id="MathJax-Span-4234" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-4235" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-4236" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4237" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-4238" style="font-family: MathJax_Main;">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-345">y = 2x+{\rm noise}</script> seems much simpler than
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-346-Frame"><nobr><span class="math" id="MathJax-Span-4239" role="math" style="width: 9.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.512em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4240"><span class="mi" id="MathJax-Span-4241" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4242" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-4243" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4244" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-4245" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4246"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4247" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.591em;"><span class="mn" id="MathJax-Span-4248" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4249" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-4250" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4251" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.542em;"><span class="mn" id="MathJax-Span-4252" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4253"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4254" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.591em;"><span class="mn" id="MathJax-Span-4255" style="font-size: 70.7%; font-family: MathJax_Main;">8</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4256" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-4257" style="font-family: MathJax_Main; padding-left: 0.248em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-346">y = a_0 x^9 + a_1 x^8 + \ldots</script>.  It would be surprising if that
simplicity had occurred by chance, and so we suspect that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-347-Frame"><nobr><span class="math" id="MathJax-Span-4258" role="math" style="width: 6.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.375em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4259"><span class="mi" id="MathJax-Span-4260" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4261" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4262" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span><span class="mi" id="MathJax-Span-4263" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4264" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="texatom" id="MathJax-Span-4265" style="padding-left: 0.248em;"><span class="mrow" id="MathJax-Span-4266"><span class="mi" id="MathJax-Span-4267" style="font-family: MathJax_Main;">n</span><span class="mi" id="MathJax-Span-4268" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-4269" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4270" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-4271" style="font-family: MathJax_Main;">e</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-347">y = 2x+{\rm
  noise}</script> expresses some underlying truth.  In this point of view, the
9th order model is really just learning the effects of local
noise. And so while the 9th order model works perfectly for these
particular data points, the model will fail to generalize to other
data points, and the noisy linear model will have greater predictive
power.</p><p>Let's see what this point of view means for neural networks.  Suppose
our network mostly has small weights, as will tend to happen in a
regularized network.  The smallness of the weights means that the
behaviour of the network won't change too much if we change a few
random inputs here and there.  That makes it difficult for a
regularized network to learn the effects of local noise in the data.
Think of it as a way of making it so single pieces of evidence don't
matter too much to the output of the network.  Instead, a regularized
network learns to respond to types of evidence which are seen often
across the training set.  By contrast, a network with large weights
may change its behaviour quite a bit in response to small changes in
the input.  And so an unregularized network can use large weights to
learn a complex model that carries a lot of information about the
noise in the training data.  In a nutshell, regularized networks are
constrained to build relatively simple models based on patterns seen
often in the training data, and are resistant to learning
peculiarities of the noise in the training data.  The hope is that
this will force our networks to do real learning about the phenemonon
at hand, and to generalize better from what they learn.</p><p>With that said, this idea of preferring simpler explanation should
make you nervous.  People sometimes refer to this idea as "Occam's
Razor", and will zealously apply it as though it has the status of
some general scientific principle.  But, of course, it's not a general
scientific principle.  There is no <em>a priori</em> logical reason to
prefer simple explanations over more complex explanations.  Indeed,
sometimes the more complex explanation turns out to be correct.</p><p>Let me describe two examples where more complex explanations have
turned out to be correct.  In the 1940s the physicist Marcel Schein
announced the discovery of a new particle of nature.  The company he
worked for, General Electric, was ecstatic, and publicised the
discovery widely.  But the physicist Hans Bethe was skeptical.  Bethe
visited Schein, and looked at the plates showing the tracks of
Schein's new particle.  Schein showed Bethe plate after plate, but on
each plate Bethe identified some problem that suggested the data
should be discarded.  Finally, Schein showed Bethe a plate that looked
good.  Bethe said it might just be a statistical fluke.  Schein:
"Yes, but the chance that this would be statistics, even according to
your own formula, is one in five."  Bethe: "But we have already
looked at five plates."  Finally, Schein said: "But on my plates,
each one of the good plates, each one of the good pictures, you
explain by a different theory, whereas I have one hypothesis that
explains all the plates, that they are [the new particle]."  Bethe
replied: "The sole difference between your and my explanations is
that yours is wrong and all of mine are right.  Your single
explanation is wrong, and all of my multiple explanations are right."
Subsequent work confirmed that Nature agreed with Bethe, and Schein's
particle is no more*<span class="marginnote">
*The story is related by the physicist
  Richard Feynman in an
  <a href="http://www.aip.org/history/ohilist/5020_4.html">interview</a>
  with the historian Charles Weiner.</span>.</p><p>As a second example, in 1859 the astronomer Urbain Le Verrier observed
that the orbit of the planet Mercury doesn't have quite the shape that
Newton's theory of gravitation says it should have.  It was a tiny,
tiny deviation from Newton's theory, and several of the explanations
proferred at the time boiled down to saying that Newton's theory was
more or less right, but needed a tiny alteration.  In 1916, Einstein
showed that the deviation could be explained very well using his
general theory of relativity, a theory radically different to
Newtonian gravitation, and based on much more complex mathematics.
Despite that additional complexity, today it's accepted that
Einstein's explanation is correct, and Newtonian gravity, even in its
modified forms, is wrong.  This is in part because we now know that
Einstein's theory explains many other phenomena which Newton's theory
has difficulty with.  Furthermore, and even more impressively,
Einstein's theory accurately predicts several phenomena which aren't
predicted by Newtonian gravity at all. But these impressive qualities
weren't entirely obvious in the early days.  If one had judged merely
on the grounds of simplicity, then some modified form of Newton's
theory would arguably have been more attractive.</p><p>There are three morals to draw from these stories.  First, it can be
quite a subtle business deciding which of two explanations is truly
"simpler".  Second, even if we can make such a judgement, simplicity
is a guide that must be used with great caution!  Third, the true test
of a model is not simplicity, but rather how well it does in
predicting new phenomena, in new regimes of behaviour.</p><p>With that said, and keeping the need for caution in mind, it's an
empirical fact that regularized neural networks usually generalize
better than unregularized networks.  And so through the remainder of
the book we will make frequent use of regularization.  I've included
the stories above merely to help convey why no-one has yet developed
an entirely convincing theoretical explanation for why regularization
helps networks generalize.  Indeed, researchers continue to write
papers where they try different approaches to regularization, compare
them to see which works better, and attempt to understand why different
approaches work better or worse.  And so you can view regularization
as something of a kludge.  While it often helps, we don't have an
entirely satisfactory systematic understanding of what's going on,
merely incomplete heuristics and rules of thumb.</p><p>There's a deeper set of issues here, issues which go to the heart of
science.  It's the question of how we generalize.  Regularization may
give us a computional magic wand that helps our networks generalize
better, but it doesn't give us a principled understanding of how
generalization works, nor of what the best approach is*<span class="marginnote">
*These
  issues go back to the
  <a href="http://en.wikipedia.org/wiki/Problem_of_induction">problem
    of induction</a>, famously discussed by the Scottish philosopher
  David Hume in <a href="http://www.gutenberg.org/ebooks/9662">"An
    Enquiry Concerning Human Understanding"</a> (1748).  The problem of
  induction has been given a modern machine learning form in the
  no-free lunch theorem
  (<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?tp=&arnumber=585893">link</a>)
  of David Wolpert and William Macready (1997).</span>.</p><p>This is particularly galling because in everyday life, we humans
generalize phenomenally well.  Shown just a few images of an elephant
a child will quickly learn to recognize other elephants.  Of course,
they may occasionally make mistakes, perhaps confusing a rhinoceros
for an elephant, but in general this process works remarkably
accurately.  So we have a system - the human brain - with a huge
number of free parameters.  And after being shown just one or a few
training images that system learns to generalize to other images.  Our
brains are, in some sense, regularizing amazingly well!  How do we do
it?  At this point we don't know.  I expect that in years to come we
will develop more powerful techniques for regularization in artificial
neural networks, techniques that will ultimately enable neural nets to
generalize well even from small data sets.</p><p>In fact, our networks already generalize better than one might <em>a
  priori</em> expect.  A network with 100 hidden neurons has nearly 80,000
parameters.  We have only 50,000 images in our training data.  It's
like trying to fit an 80,000th degree polynomial to 50,000 data
points.  By all rights, our network should overfit terribly.  And yet,
as we saw earlier, such a network actually does a pretty good job
generalizing.  Why is that the case?  It's not well understood.  It
has been conjectured*<span class="marginnote">
*In
  <a href="http://yann.lecun.com/exdb/publis/pdf/lecun-01a.pdf">Gradient-Based
    Learning Applied to Document Recognition</a>, by Yann LeCun,
  Lon Bottou, Yoshua Bengio, and Patrick Haffner
  (1998).</span>  that "the dynamics of gradient descent learning in
multilayer nets has a `self-regularization' effect".  This is
exceptionally fortunate, but it's also somewhat disquieting that we
don't understand why it's the case.  In the meantime, we will adopt
the pragmatic approach and use regularization whenever we can.  Our
neural networks will be the better for it.</p><p>Let me conclude this section by returning to a detail which I left
unexplained earlier: the fact that L2 regularization <em>doesn't</em>
constrain the biases.  Of course, it would be easy to modify the
regularization procedure to regularize the biases.  Empirically, doing
this often doesn't change the results very much, so to some extent
it's merely a convention whether to regularize the biases or not.
However, it's worth noting that having a large bias doesn't make a
neuron sensitive to its inputs in the same way as having large
weights.  And so we don't need to worry about large biases enabling
our network to learn the noise in our training data.  At the same
time, allowing large biases gives our networks more flexibility in
behaviour - in particular, large biases make it easier for neurons
to saturate, which is sometimes desirable.  For these reasons we don't
usually include bias terms when regularizing.</p><p></p><h4><a name="other_techniques_for_regularization"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques_for_regularization">Other techniques for regularization</a></h4><p></p><p>There are many regularization techniques other that L2 regularization.
In fact, so many techniques have been developed that I can't possibly
summarize them all.  In this section I briefly describe three other
approaches to reducing overfitting: L1 regularization, dropout, and
artificially increasing the training set size.  We won't go into
nearly as much depth studying these techniques as we did earlier.
Instead, the purpose is to get familiar with the main ideas, and to
appreciate something of the diversity of regularization techniques
available.</p><p><strong>L1 regularization:</strong> In this approach we modify the
unregularized cost function by adding the sum of the absolute values
of the weights:</p><p><a class="displaced_anchor" name="eqtn95"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-348-Frame"><nobr><span class="math" id="MathJax-Span-4272" role="math" style="width: 100%; display: inline-block; min-width: 15.248em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.248em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-4273"><span class="mtable" id="MathJax-Span-4274" style="min-width: 15.542em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.248em;"><span style="display: inline-block; position: absolute; width: 8.826em; height: 0px; clip: rect(-1.664em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -4.409em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.826em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4278"><span class="mrow" id="MathJax-Span-4279"><span class="mi" id="MathJax-Span-4280" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-4281" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-4282" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4283" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4284" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4285" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-4286" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4287" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4288" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-4289" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4290" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-4291" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4292" style="padding-left: 0.15em;"><span class="mrow" id="MathJax-Span-4293"><span class="mo" id="MathJax-Span-4294" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4295" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-4296"><span class="mrow" id="MathJax-Span-4297"><span class="mo" id="MathJax-Span-4298" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-4299" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-95"><span class="mrow" id="MathJax-Span-4276"><span class="mtext" id="MathJax-Span-4277" style="font-family: MathJax_Main;">(95)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-348">\begin{eqnarray}  C = C_0 + \frac{\lambda}{n} \sum_w |w|.
\tag{95}\end{eqnarray}</script> </p><p>Intuitively, this is similar to L2 regularization, penalizing large
weights, and tending to make the network prefer small weights.  Of
course, the L1 regularization term isn't the same as the L2
regularization term, and so we shouldn't expect to get exactly the
same behaviour.  Let's try to understand how the behaviour of a
network trained using L1 regularization differs from a network trained
using L2 regularization.</p><p>To do that, we'll look at the partial derivatives of the cost
function.  Differentiating <span id="margin_320389750442_reveal" class="equation_link">(95)</span><span id="margin_320389750442" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn95" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-349-Frame"><nobr><span class="math" id="MathJax-Span-4300" role="math" style="width: 9.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.826em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4301"><span class="mtable" id="MathJax-Span-4302" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 8.532em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.532em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4303"><span class="mrow" id="MathJax-Span-4304"><span class="mi" id="MathJax-Span-4305" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-4306" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-4307" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4308" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4309" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4310" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-4311" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4312" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4313" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-4314" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4315" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.493em;"><span class="mi" id="MathJax-Span-4316" style="font-size: 70.7%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4317" style="padding-left: 0.15em;"><span class="mrow" id="MathJax-Span-4318"><span class="mo" id="MathJax-Span-4319" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4320" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-4321"><span class="mrow" id="MathJax-Span-4322"><span class="mo" id="MathJax-Span-4323" style="font-family: MathJax_Main;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.702em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-349">\begin{eqnarray}  C = C_0 + \frac{\lambda}{n} \sum_w |w| \nonumber\end{eqnarray}</script></a></span><script>$('#margin_320389750442_reveal').click(function() {$('#margin_320389750442').toggle('slow', function() {});});</script> we obtain:
<a class="displaced_anchor" name="eqtn96"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-350-Frame"><nobr><span class="math" id="MathJax-Span-4324" role="math" style="width: 100%; display: inline-block; min-width: 17.159em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 17.159em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-4325"><span class="mtable" id="MathJax-Span-4326" style="min-width: 17.502em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.159em;"><span style="display: inline-block; position: absolute; width: 10.738em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -5.39em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.738em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4330"><span class="mrow" id="MathJax-Span-4331"><span class="mfrac" id="MathJax-Span-4332"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-4333"><span class="mi" id="MathJax-Span-4334" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4335" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4336"><span class="mi" id="MathJax-Span-4337" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4338" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4339" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-4340" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-4341"><span class="mi" id="MathJax-Span-4342" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4343"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4344" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4345" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4346"><span class="mi" id="MathJax-Span-4347" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4348" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4349" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-4350" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4351" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4352" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mspace" id="MathJax-Span-4353" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-4354"><span class="mrow" id="MathJax-Span-4355"><span class="mi" id="MathJax-Span-4356" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-4357" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-4358" style="font-family: MathJax_Main;">n</span></span></span><span class="mo" id="MathJax-Span-4359" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4360" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4361" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4362" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-96"><span class="mrow" id="MathJax-Span-4328"><span class="mtext" id="MathJax-Span-4329" style="font-family: MathJax_Main;">(96)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-350">\begin{eqnarray}  \frac{\partial C}{\partial
    w} = \frac{\partial C_0}{\partial w} + \frac{\lambda}{n} \, {\rm
    sgn}(w),
\tag{96}\end{eqnarray}</script></p><p>where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-351-Frame"><nobr><span class="math" id="MathJax-Span-4363" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4364"><span class="texatom" id="MathJax-Span-4365"><span class="mrow" id="MathJax-Span-4366"><span class="mi" id="MathJax-Span-4367" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-4368" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-4369" style="font-family: MathJax_Main;">n</span></span></span><span class="mo" id="MathJax-Span-4370" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4371" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4372" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-351">{\rm sgn}(w)</script> is the sign of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-352-Frame"><nobr><span class="math" id="MathJax-Span-4373" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4374"><span class="mi" id="MathJax-Span-4375" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-352">w</script>, that is, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-353-Frame"><nobr><span class="math" id="MathJax-Span-4376" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4377"><span class="mo" id="MathJax-Span-4378" style="font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-4379" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-353">+1</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-354-Frame"><nobr><span class="math" id="MathJax-Span-4380" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4381"><span class="mi" id="MathJax-Span-4382" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-354">w</script> is
positive, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-355-Frame"><nobr><span class="math" id="MathJax-Span-4383" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4384"><span class="mo" id="MathJax-Span-4385" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-4386" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-355">-1</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-356-Frame"><nobr><span class="math" id="MathJax-Span-4387" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4388"><span class="mi" id="MathJax-Span-4389" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-356">w</script> is negative.  Using this expression, we can
easily modify backpropagation to do stochastic gradient descent using
L1 regularization.  The resulting update rule for an L1 regularized
network is 
<a class="displaced_anchor" name="eqtn97"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-357-Frame"><nobr><span class="math" id="MathJax-Span-4390" role="math" style="width: 100%; display: inline-block; min-width: 21.522em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 21.522em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-4391"><span class="mtable" id="MathJax-Span-4392" style="min-width: 21.914em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.522em;"><span style="display: inline-block; position: absolute; width: 15.199em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -7.596em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 15.199em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4396"><span class="mrow" id="MathJax-Span-4397"><span class="mi" id="MathJax-Span-4398" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4399" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-4400" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4401" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-4402" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4403" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-4404" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-4405" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4406" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-4407"><span class="mi" id="MathJax-Span-4408" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4409" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4410" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mtext" id="MathJax-Span-4411" style="font-family: MathJax_Main;">sgn</span><span class="mo" id="MathJax-Span-4412" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4413" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4414" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4415" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-4416" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-4417"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-4418"><span class="mi" id="MathJax-Span-4419" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4420"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4421" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4422" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4423"><span class="mi" id="MathJax-Span-4424" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4425" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4426" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-97"><span class="mrow" id="MathJax-Span-4394"><span class="mtext" id="MathJax-Span-4395" style="font-family: MathJax_Main;">(97)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-357">\begin{eqnarray}  w \rightarrow w' =
  w-\frac{\eta \lambda}{n} \mbox{sgn}(w) - \eta \frac{\partial
    C_0}{\partial w},
\tag{97}\end{eqnarray}</script> </p><p>where, as per usual, we can estimate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-358-Frame"><nobr><span class="math" id="MathJax-Span-4427" role="math" style="width: 3.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4428"><span class="mi" id="MathJax-Span-4429" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4430"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4431" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4432" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-4433"><span class="mrow" id="MathJax-Span-4434"><span class="mo" id="MathJax-Span-4435" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-4436" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4437" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-358">\partial C_0 / \partial w</script> using
a mini-batch average, if we wish.  Compare that to the update rule for
L2 regularization (c.f. Equation <span id="margin_315255355987_reveal" class="equation_link">(93)</span><span id="margin_315255355987" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn93" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-359-Frame"><nobr><span class="math" id="MathJax-Span-4438" role="math" style="width: 15.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.806em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4439"><span class="mtable" id="MathJax-Span-4440" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 14.512em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 14.512em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.346em -999.998em); top: -4.115em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4441"><span class="mrow" id="MathJax-Span-4442"><span class="mi" id="MathJax-Span-4443" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4444" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mrow" id="MathJax-Span-4445" style="padding-left: 0.297em;"><span class="mo" id="MathJax-Span-4446" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mn" id="MathJax-Span-4447" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4448" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4449" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-4450"><span class="mi" id="MathJax-Span-4451" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4452" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4453" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4454" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mi" id="MathJax-Span-4455" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">w</span><span class="mo" id="MathJax-Span-4456" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4457" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-4458" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-4459" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-4460" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4461" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-4462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-4463" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-4464"><span class="mi" id="MathJax-Span-4465" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4466"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4467" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-4468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4469"><span class="mi" id="MathJax-Span-4470" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4471" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4472" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.752em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-359">\begin{eqnarray} 
  w \rightarrow \left(1-\frac{\eta \lambda}{n}\right) w -\frac{\eta}{m}
  \sum_x \frac{\partial C_x}{\partial w},  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_315255355987_reveal').click(function() {$('#margin_315255355987').toggle('slow', function() {});});</script>),
<a class="displaced_anchor" name="eqtn98"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-360-Frame"><nobr><span class="math" id="MathJax-Span-4473" role="math" style="width: 100%; display: inline-block; min-width: 20.689em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 20.689em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-4474"><span class="mtable" id="MathJax-Span-4475" style="min-width: 21.13em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.689em;"><span style="display: inline-block; position: absolute; width: 14.365em; height: 0px; clip: rect(-1.615em 1000.002em 1.081em -999.998em); top: 0.002em; left: 50%; margin-left: -7.154em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 14.365em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4479"><span class="mrow" id="MathJax-Span-4480"><span class="mi" id="MathJax-Span-4481" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4482" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-4483" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4484" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-4485" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4486" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-4487" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mrow" id="MathJax-Span-4488" style="padding-left: 0.15em;"><span class="mo" id="MathJax-Span-4489" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mn" id="MathJax-Span-4490" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4491" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4492" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-4493"><span class="mi" id="MathJax-Span-4494" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4495" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4496" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4497" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-4498" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-4499" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-4500"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-4501"><span class="mi" id="MathJax-Span-4502" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4503"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4504" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4505" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4506"><span class="mi" id="MathJax-Span-4507" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4508" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4509" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.395em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="mjx-eqn-98"><span class="mrow" id="MathJax-Span-4477"><span class="mtext" id="MathJax-Span-4478" style="font-family: MathJax_Main;">(98)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.552em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-360">\begin{eqnarray}
  w \rightarrow w' = w\left(1 - \frac{\eta \lambda}{n} \right)
  - \eta \frac{\partial C_0}{\partial w}.
\tag{98}\end{eqnarray}</script>
In both expressions the effect of regularization is to shrink the
weights.  This accords with our intuition that both kinds of
regularization penalize large weights.  But the way the weights shrink
is different.  In L1 regularization, the weights shrink by a constant
amount toward <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-361-Frame"><nobr><span class="math" id="MathJax-Span-4510" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4511"><span class="mn" id="MathJax-Span-4512" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-361">0</script>.  In L2 regularization, the weights shrink by an
amount which is proportional to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-362-Frame"><nobr><span class="math" id="MathJax-Span-4513" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4514"><span class="mi" id="MathJax-Span-4515" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-362">w</script>.  And so when a particular weight
has a large magnitude, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-363-Frame"><nobr><span class="math" id="MathJax-Span-4516" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4517"><span class="texatom" id="MathJax-Span-4518"><span class="mrow" id="MathJax-Span-4519"><span class="mo" id="MathJax-Span-4520" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4521" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-4522"><span class="mrow" id="MathJax-Span-4523"><span class="mo" id="MathJax-Span-4524" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-363">|w|</script>, L1 regularization shrinks the weight
much less than L2 regularization does.  By contrast, when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-364-Frame"><nobr><span class="math" id="MathJax-Span-4525" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4526"><span class="texatom" id="MathJax-Span-4527"><span class="mrow" id="MathJax-Span-4528"><span class="mo" id="MathJax-Span-4529" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4530" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-4531"><span class="mrow" id="MathJax-Span-4532"><span class="mo" id="MathJax-Span-4533" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-364">|w|</script> is
small, L1 regularization shrinks the weight much more than L2
regularization.  The net result is that L1 regularization tends to
concentrate the weight of the network in a relatively small number of
high-importance connections, while the other weights are driven toward
zero.</p><p>I've glossed over an issue in the above discussion, which is that the
partial derivative <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-365-Frame"><nobr><span class="math" id="MathJax-Span-4534" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4535"><span class="mi" id="MathJax-Span-4536" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4537" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-4538"><span class="mrow" id="MathJax-Span-4539"><span class="mo" id="MathJax-Span-4540" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-4541" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4542" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-365">\partial C / \partial w</script> isn't defined when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-366-Frame"><nobr><span class="math" id="MathJax-Span-4543" role="math" style="width: 2.65em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4544"><span class="mi" id="MathJax-Span-4545" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4546" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4547" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-366">w =
0</script>.  The reason is that the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-367-Frame"><nobr><span class="math" id="MathJax-Span-4548" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4549"><span class="texatom" id="MathJax-Span-4550"><span class="mrow" id="MathJax-Span-4551"><span class="mo" id="MathJax-Span-4552" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4553" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-4554"><span class="mrow" id="MathJax-Span-4555"><span class="mo" id="MathJax-Span-4556" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-367">|w|</script> has a sharp "corner" at
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-368-Frame"><nobr><span class="math" id="MathJax-Span-4557" role="math" style="width: 2.65em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4558"><span class="mi" id="MathJax-Span-4559" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4560" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4561" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-368">w = 0</script>, and so isn't differentiable at that point.  That's okay,
though.  What we'll do is just apply the usual (unregularized) rule
for stochastic gradient descent when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-369-Frame"><nobr><span class="math" id="MathJax-Span-4562" role="math" style="width: 2.65em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4563"><span class="mi" id="MathJax-Span-4564" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4565" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4566" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-369">w = 0</script>.  That should be okay -
intuitively, the effect of regularization is to shrink weights, and
obviously it can't shrink a weight which is already <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-370-Frame"><nobr><span class="math" id="MathJax-Span-4567" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4568"><span class="mn" id="MathJax-Span-4569" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-370">0</script>.  To put it
more precisely, we'll use Equations <span id="margin_461212690107_reveal" class="equation_link">(96)</span><span id="margin_461212690107" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn96" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-371-Frame"><nobr><span class="math" id="MathJax-Span-4570" role="math" style="width: 11.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4571"><span class="mtable" id="MathJax-Span-4572" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.493em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.493em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4573"><span class="mrow" id="MathJax-Span-4574"><span class="mfrac" id="MathJax-Span-4575"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-4576"><span class="mi" id="MathJax-Span-4577" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4578" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4579"><span class="mi" id="MathJax-Span-4580" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4581" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4582" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-4583" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-4584"><span class="mi" id="MathJax-Span-4585" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4586"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4587" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4588" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4589"><span class="mi" id="MathJax-Span-4590" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4591" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-4592" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-4593" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4594" style="font-family: MathJax_Math-italic;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4595" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mspace" id="MathJax-Span-4596" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-4597"><span class="mrow" id="MathJax-Span-4598"><span class="mi" id="MathJax-Span-4599" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-4600" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-4601" style="font-family: MathJax_Main;">n</span></span></span><span class="mo" id="MathJax-Span-4602" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4603" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4604" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-371">\begin{eqnarray}  \frac{\partial C}{\partial
    w} = \frac{\partial C_0}{\partial w} + \frac{\lambda}{n} \, {\rm
    sgn}(w) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_461212690107_reveal').click(function() {$('#margin_461212690107').toggle('slow', function() {});});</script>
and <span id="margin_344122888714_reveal" class="equation_link">(97)</span><span id="margin_344122888714" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn97" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-372-Frame"><nobr><span class="math" id="MathJax-Span-4605" role="math" style="width: 15.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.199em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4606"><span class="mtable" id="MathJax-Span-4607" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 14.904em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 14.904em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-4608"><span class="mrow" id="MathJax-Span-4609"><span class="mi" id="MathJax-Span-4610" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4611" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-4612" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4613" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-4614" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4615" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-4616" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-4617" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-4618" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-4619"><span class="mi" id="MathJax-Span-4620" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4621" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-4622" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mtext" id="MathJax-Span-4623" style="font-family: MathJax_Main;">sgn</span><span class="mo" id="MathJax-Span-4624" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4625" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-4626" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4627" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-4628" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-4629"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.703em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-4630"><span class="mi" id="MathJax-Span-4631" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-4632"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4633" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-4634" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-4635"><span class="mi" id="MathJax-Span-4636" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-4637" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.816em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-372">\begin{eqnarray}  w \rightarrow w' =
  w-\frac{\eta \lambda}{n} \mbox{sgn}(w) - \eta \frac{\partial
    C_0}{\partial w} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_344122888714_reveal').click(function() {$('#margin_344122888714').toggle('slow', function() {});});</script> with the convention that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-373-Frame"><nobr><span class="math" id="MathJax-Span-4638" role="math" style="width: 4.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.61em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4639"><span class="mtext" id="MathJax-Span-4640" style="font-family: MathJax_Main;">sgn</span><span class="mo" id="MathJax-Span-4641" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-4642" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-4643" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4644" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4645" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-373">\mbox{sgn}(0) = 0</script>.
That gives a nice, compact rule for doing stochastic gradient descent
with L1 regularization.</p><p><strong>Dropout:</strong> Dropout is a radically different technique for
regularization.  Unlike L1 and L2 regularization, dropout doesn't rely
on modifying the cost function.  Instead, in dropout we modify the
network itself.  Let me describe the basic mechanics of how dropout
works, before getting into why it works, and what the results are.</p><p>Suppose we're trying to train a network:</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz30.png">
</center><p></p><p>In particular, suppose we have a training input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-374-Frame"><nobr><span class="math" id="MathJax-Span-4646" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4647"><span class="mi" id="MathJax-Span-4648" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-374">x</script> and corresponding
desired output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-375-Frame"><nobr><span class="math" id="MathJax-Span-4649" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4650"><span class="mi" id="MathJax-Span-4651" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-375">y</script>.  Ordinarily, we'd train by forward-propagating <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-376-Frame"><nobr><span class="math" id="MathJax-Span-4652" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4653"><span class="mi" id="MathJax-Span-4654" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-376">x</script>
through the network, and then backpropagating to determine the
contribution to the gradient.  With dropout, this process is modified.
We start by randomly (and temporarily) deleting half the hidden
neurons in the network, while leaving the input and output neurons
untouched.  After doing this, we'll end up with a network along the
following lines.  Note that the dropout neurons, i.e., the neurons
which have been temporarily deleted, are still ghosted in:</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz31.png">
</center><p></p><p>We forward-propagate the input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-377-Frame"><nobr><span class="math" id="MathJax-Span-4655" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4656"><span class="mi" id="MathJax-Span-4657" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-377">x</script> through the modified network, and
then backpropagate the result, also through the modified network.
After doing this over a mini-batch of examples, we update the
appropriate weights and biases.  We then repeat the process, first
restoring the dropout neurons, then choosing a new random subset of
hidden neurons to delete, estimating the gradient for a different
mini-batch, and updating the weights and biases in the network.</p><p></p><p></p><p></p><p></p><p>By repeating this process over and over, our network will learn a set
of weights and biases.  Of course, those weights and biases will have
been learnt under conditions in which half the hidden neurons were
dropped out.  When we actually run the full network that means that
twice as many hidden neurons will be active.  To compensate for that,
we halve the weights outgoing from the hidden neurons.</p><p>This dropout procedure may seem strange and <em>ad hoc</em>.  Why would
we expect it to help with regularization?  To explain what's going on,
I'd like you to briefly stop thinking about dropout, and instead
imagine training neural networks in the standard way (no dropout).  In
particular, imagine we train several different neural networks, all
using the same training data.  Of course, the networks may not start
out identical, and as a result after training they may sometimes give
different results.  When that happens we could use some kind of
averaging or voting scheme to decide which output to accept.  For
instance, if we have trained five networks, and three of them are
classifying a digit as a "3", then it probably really is a "3".
The other two networks are probably just making a mistake.  This kind
of averaging scheme is often found to be a powerful (though expensive)
way of reducing overfitting.  The reason is that the different
networks may overfit in different ways, and averaging may help
eliminate that kind of overfitting.</p><p>What's this got to do with dropout?  Heuristically, when we dropout
different sets of neurons, it's rather like we're training different
neural networks.  And so the dropout procedure is like averaging the
effects of a very large number of different networks.  The different
networks will overfit in different ways, and so, hopefully, the net
effect of dropout will be to reduce overfitting.</p><p><a name="dropout_explanation"></a></p><p>A related heuristic explanation for dropout is given in one of the
earliest papers to use the
technique*<span class="marginnote">
*<a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">ImageNet
    Classification with Deep Convolutional Neural Networks</a>, by Alex
  Krizhevsky, Ilya Sutskever, and Geoffrey Hinton (2012).</span>: "This
technique reduces complex co-adaptations of neurons, since a neuron
cannot rely on the presence of particular other neurons. It is,
therefore, forced to learn more robust features that are useful in
conjunction with many different random subsets of the other neurons."
In other words, if we think of our network as a model which is making
predictions, then we can think of dropout as a way of making sure that
the model is robust to the loss of any individual piece of evidence.
In this, it's somewhat similar to L1 and L2 regularization, which tend
to reduce weights, and thus make the network more robust to losing any
individual connection in the network.</p><p>Of course, the true measure of dropout is that it has been very
successful in improving the performance of neural networks.  The
original
paper*<span class="marginnote">
*<a href="http://arxiv.org/pdf/1207.0580.pdf">Improving
    neural networks by preventing co-adaptation of feature detectors</a>
  by Geoffrey Hinton, Nitish Srivastava, Alex Krizhevsky, Ilya
  Sutskever, and Ruslan Salakhutdinov (2012).  Note that the paper
  discusses a number of subtleties that I have glossed over in this
  brief introduction.</span> introducing the technique applied it to many
different tasks. For us, it's of particular interest that they applied
dropout to MNIST digit classification, using a vanilla feedforward
neural network along lines similar to those we've been considering.
The paper noted that the best result anyone had achieved up to that
point using such an architecture was <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-378-Frame"><nobr><span class="math" id="MathJax-Span-4658" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4659"><span class="mn" id="MathJax-Span-4660" style="font-family: MathJax_Main;">98.4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-378">98.4</script> percent classification
accuracy on the test set.  They improved that to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-379-Frame"><nobr><span class="math" id="MathJax-Span-4661" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4662"><span class="mn" id="MathJax-Span-4663" style="font-family: MathJax_Main;">98.7</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-379">98.7</script> percent
accuracy using a combination of dropout and a modified form of L2
regularization.  Similarly impressive results have been obtained for
many other tasks, including problems in image and speech recognition,
and natural language processing.  Dropout has been especially useful
in training large, deep networks, where the problem of overfitting is
often acute.</p><p><strong>Artificially expanding the training data:</strong> We saw earlier that
our MNIST classification accuracy dropped down to percentages in the
mid-80s when we used only 1,000 training images.  It's not surprising
that this is the case, since less training data means our network will
be exposed to fewer variations in the way human beings write digits.
Let's try training our 30 hidden neuron network with a variety of
different training data set sizes, to see how performance varies.  We
train using a mini-batch size of 10, a learning rate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-380-Frame"><nobr><span class="math" id="MathJax-Span-4664" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4665"><span class="mi" id="MathJax-Span-4666" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4667" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4668" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-380">\eta = 0.5</script>, a
regularization parameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-381-Frame"><nobr><span class="math" id="MathJax-Span-4669" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4670"><span class="mi" id="MathJax-Span-4671" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4672" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4673" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-381">\lambda = 5.0</script>, and the cross-entropy cost
function.  We will train for 30 epochs when the full training data set
is used, and scale up the number of epochs proportionally when smaller
training sets are used.  To ensure the weight decay factor remains the
same across training sets, we will use a regularization parameter of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-382-Frame"><nobr><span class="math" id="MathJax-Span-4674" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4675"><span class="mi" id="MathJax-Span-4676" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4677" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4678" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-382">\lambda = 5.0</script> when the full training data set is used, and scale
down <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-383-Frame"><nobr><span class="math" id="MathJax-Span-4679" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4680"><span class="mi" id="MathJax-Span-4681" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-383">\lambda</script> proportionally when smaller training sets are
used*<span class="marginnote">
*This and the next two graph are produced with the
  program
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/more_data.py">more_data.py</a>.</span>.</p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data.png" width="520px"></center><p></p><p>As you can see, the classification accuracies improve considerably as
we use more training data.  Presumably this improvement would continue
still further if more data was available.  Of course, looking at the
graph above it does appear that we're getting near saturation.
Suppose, however, that we redo the graph with the training set size
plotted logarithmically:</p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data_log.png" width="520px"></center><p></p><p>It seems clear that the graph is still going up toward the end.  This
suggests that if we used vastly more training data - say, millions
or even billions of handwriting samples, instead of just 50,000 -
then we'd likely get considerably better performance, even from this
very small network.</p><p>Obtaining more training data is a great idea. Unfortunately, it can be
expensive, and so is not always possible in practice.  However,
there's another idea which can work nearly as well, and that's to
artificially expand the training data.  Suppose, for example, that we
take an MNIST training image of a five,</p><p></p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data_5.png" width="120px"></center><p></p><p>and rotate it by a small amount, let's say 15 degrees:</p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data_rotated_5.png" width="120px"></center><p></p><p>It's still recognizably the same digit.  And yet at the pixel level
it's quite different to any image currently in the MNIST training
data.  It's conceivable that adding this image to the training data
might help our network learn more about how to classify digits.
What's more, obviously we're not limited to adding just this one
image.  We can expand our training data by making <em>many</em> small
rotations of <em>all</em> the MNIST training images, and then using the
expanded training data to improve our network's performance.</p><p>This idea is very powerful and has been widely used.  Let's look at
some of the results from a
paper*<span class="marginnote">
*<a href="http://dx.doi.org/10.1109/ICDAR.2003.1227801">Best
    Practices for Convolutional Neural Networks Applied to Visual
    Document Analysis</a>, by Patrice Simard, Dave Steinkraus, and John
  Platt (2003).</span> which applied several variations of the idea to
MNIST.  One of the neural network architectures they considered was
along similar lines to what we've been using, a feedforward network
with 800 hidden neurons and using the cross-entropy cost function.
Running the network with the standard MNIST training data they
achieved a classification accuracy of 98.4 percent on their test set.
But then they expanded the training data, using not just rotations, as
I described above, but also translating and skewing the images.  By
training on the expanded data set they increased their network's
accuracy to 98.9 percent.  They also experimented with what they
called "elastic distortions", a special type of image distortion
intended to emulate the random oscillations found in hand muscles.  By
using the elastic distortions to expand the data they achieved an even
higher accuracy, 99.3 percent.  Effectively, they were broadening the
experience of their network by exposing it to the sort of variations
that are found in real handwriting.</p><p>Variations on this idea can be used to improve peformance on many
learning tasks, not just handwriting recognition.  The general
principle is to expand the training data by applying operations that
reflect real-world variation.  It's not difficult to think of ways of
doing this.  Suppose, for example, that you're building a neural
network to do speech recognition.  We humans can recognize speech even
in the presence of distortions such as background noise.  And so you
can expand your data by adding background noise.  We can also
recognize speech if it's sped up or slowed down. So that's another way
we can expand the training data.  These techniques are not always used
- for instance, instead of expanding the training data by adding
noise, it may well be more efficient to clean up the input to the
network by first applying a noise reduction filter.  Still, it's worth
keeping the idea of expanding the training data in mind, and looking
for opportunities to apply it.</p><p></p><h4><a name="exercise_195778"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_195778">Exercise</a></h4><ul>
<li> As discussed above, one way of expanding the MNIST training data
  is to use small rotations of training images.  What's a problem that
  might occur if we allow arbitrarily large rotations of training
  images?
</li></ul><p></p><p><strong>An aside on big data and what it means to compare
  classification accuracies:</strong> Let's look again at how our neural
network's accuracy varies with training set size:</p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data_log.png" width="520px"></center><p></p><p>Suppose that instead of using a neural network we use some other
machine learning technique to classify digits.  For instance, let's
try using the support vector machines (SVM) which we met briefly back
in <a href="http://neuralnetworksanddeeplearning.com/chap1.html#SVM">Chapter 1</a>.  As was the case in Chapter 1,
don't worry if you're not familiar with SVMs, we don't need to
understand their details.  Instead, we'll use the SVM supplied by the
<a href="http://scikit-learn.org/stable/">scikit-learn library</a>.  Here's
how SVM performance varies as a function of training set size.  I've
plotted the neural net results as well, to make comparison
easy*<span class="marginnote">
*This graph was produced with the program
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/more_data.py">more_data.py</a>
  (as were the last few graphs).</span>:</p><p></p><center><img src="./Neural networks and deep learning 3_files/more_data_comparison.png" width="520px"></center><p></p><p>Probably the first thing that strikes you about this graph is that our
neural network outperforms the SVM for every training set size.
That's nice, although you shouldn't read too much into it, since I
just used the out-of-the-box settings from scikit-learn's SVM, while
we've done a fair bit of work improving our neural network.  A more
subtle but more interesting fact about the graph is that if we train
our SVM using 50,000 images then it actually has better performance
(94.48 percent accuracy) than our neural network does when trained
using 5,000 images (93.24 percent accuracy).  In other words, more
training data can sometimes compensate for differences in the machine
learning algorithm used.</p><p>Something even more interesting can occur.  Suppose we're trying to
solve a problem using two machine learning algorithms, algorithm A and
algorithm B.  It sometimes happens that algorithm A will outperform
algorithm B with one set of training data, while algorithm B will
outperform algorithm A with a different set of training data.  We
don't see that above - it would require the two graphs to cross -
but it does happen*<span class="marginnote">
*Striking examples may be found in
  <a href="http://dx.doi.org/10.3115/1073012.1073017">Scaling to very
    very large corpora for natural language disambiguation</a>, by
  Michele Banko and Eric Brill (2001).</span>.  The correct response to the
question "Is algorithm A better than algorithm B?" is really: "What
training data set are you using?"</p><p>All this is a caution to keep in mind, both when doing development,
and when reading research papers.  Many papers focus on finding new
tricks to wring out improved performance on standard benchmark data
sets.  "Our whiz-bang technique gave us an improvement of X percent
on standard benchmark Y" is a canonical form of research claim.  Such
claims are often genuinely interesting, but they must be understood as
applying only in the context of the specific training data set used.
Imagine an alternate history in which the people who originally
created the benchmark data set had a larger research grant.  They
might have used the extra money to collect more training data.  It's
entirely possible that the "improvement" due to the whiz-bang
technique would disappear on a larger data set.  In other words, the
purported improvement might be just an accident of history.  The
message to take away, especially in practical applications, is that
what we want is both better algorithms <em>and</em> better training
data.  It's fine to look for better algorithms, but make sure you're
not focusing on better algorithms to the exclusion of easy wins
getting more or better training data.</p><p></p><h4><a name="problem_953063"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_953063">Problem</a></h4><ul>
<li><strong>(Research problem)</strong> How do our machine learning algorithms
  perform in the limit of very large data sets?  For any given
  algorithm it's natural to attempt to define a notion of asymptotic
  performance in the limit of truly big data. A quick-and-dirty
  approach to this problem is to simply try fitting curves to graphs
  like those shown above, and then to extrapolate the fitted curves
  out to infinity.  An objection to this approach is that different
  approaches to curvefitting will give different notions of asymptotic
  performance.  Can you find a principled justification for fitting to
  some particular class of curves?  If so, compare the asymptotic
  performance of several different machine learning algorithms.
</li></ul><p></p><p><strong>Summing up:</strong> We've now completed our dive into overfitting and
regularization.  Of course, we'll return again to the issue.  As I've
mentioned several times, overfitting is a major problem in neural
networks, especially as computers get more powerful, and we have the
ability to train larger networks.  As a result there's a pressing need
to develop powerful regularization techniques to reduce overfitting,
and this is an extremely active area of current work.</p><p></p><h3><a name="weight_initialization"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">Weight initialization</a></h3><p></p><p>When we create our neural networks, we have to make choices for the
initial weights and biases.  Up to now, we've beeen choosing them
according to a prescription which I discussed only briefly
<a href="http://neuralnetworksanddeeplearning.com/chap1.html#weight_initialization">back in Chapter 1</a>.  Just to
remind you, that prescription was to choose both the weights and
biases using independent Gaussian random variables, normalized to have
mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-384-Frame"><nobr><span class="math" id="MathJax-Span-4682" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4683"><span class="mn" id="MathJax-Span-4684" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-384">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-385-Frame"><nobr><span class="math" id="MathJax-Span-4685" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4686"><span class="mn" id="MathJax-Span-4687" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-385">1</script>.  While this approach has worked
well, it was quite <em>ad hoc</em>, and it's worth revisiting to see if
we can find a better way of setting our initial weights and biases,
and perhaps help our neural networks learn faster.</p><p>It turns out that we can do quite a bit better than initializing with
normalized Gaussians.  To see why, suppose we're working with a
network with a large number - say <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-386-Frame"><nobr><span class="math" id="MathJax-Span-4688" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4689"><span class="mn" id="MathJax-Span-4690" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4691" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-4692" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-386">1,000</script> - of input neurons.  And
let's suppose we've used normalized Gaussians to initialize the
weights connecting to the first hidden layer.  For now I'm going to
concentrate specifically on the weights connecting the input neurons
to the first neuron in the hidden layer, and ignore the rest of the
network:</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz32.png">
</center><p></p><p>We'll suppose for simplicity that we're trying to train using a
training input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-387-Frame"><nobr><span class="math" id="MathJax-Span-4693" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4694"><span class="mi" id="MathJax-Span-4695" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-387">x</script> in which half the input neurons are on, i.e., set
to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-388-Frame"><nobr><span class="math" id="MathJax-Span-4696" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4697"><span class="mn" id="MathJax-Span-4698" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-388">1</script>, and half the input neurons are off, i.e., set to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-389-Frame"><nobr><span class="math" id="MathJax-Span-4699" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4700"><span class="mn" id="MathJax-Span-4701" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-389">0</script>.  The
argument which follows applies more generally, but you'll get the gist
from this special case.  Let's consider the weighted sum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-390-Frame"><nobr><span class="math" id="MathJax-Span-4702" role="math" style="width: 7.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4703"><span class="mi" id="MathJax-Span-4704" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4705" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="munderover" id="MathJax-Span-4706" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4707" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-4708" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4709" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4710" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-4711" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4712"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4713" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-4714" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4715" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-4716" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-390">z = \sum_j
w_j x_j+b</script> of inputs to our hidden neuron.  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-391-Frame"><nobr><span class="math" id="MathJax-Span-4717" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4718"><span class="mn" id="MathJax-Span-4719" style="font-family: MathJax_Main;">500</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-391">500</script> terms in this sum
vanish, because the corresponding input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-392-Frame"><nobr><span class="math" id="MathJax-Span-4720" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4721"><span class="msubsup" id="MathJax-Span-4722"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4723" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-4724" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-392">x_j</script> is zero.  And so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-393-Frame"><nobr><span class="math" id="MathJax-Span-4725" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4726"><span class="mi" id="MathJax-Span-4727" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-393">z</script> is
a sum over a total of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-394-Frame"><nobr><span class="math" id="MathJax-Span-4728" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4729"><span class="mn" id="MathJax-Span-4730" style="font-family: MathJax_Main;">501</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-394">501</script> normalized Gaussian random variables,
accounting for the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-395-Frame"><nobr><span class="math" id="MathJax-Span-4731" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4732"><span class="mn" id="MathJax-Span-4733" style="font-family: MathJax_Main;">500</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-395">500</script> weight terms and the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-396-Frame"><nobr><span class="math" id="MathJax-Span-4734" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4735"><span class="mn" id="MathJax-Span-4736" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-396">1</script> extra bias term.
Thus <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-397-Frame"><nobr><span class="math" id="MathJax-Span-4737" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4738"><span class="mi" id="MathJax-Span-4739" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-397">z</script> is itself distributed as a Gaussian with mean zero and
standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-398-Frame"><nobr><span class="math" id="MathJax-Span-4740" role="math" style="width: 5.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4741"><span class="msqrt" id="MathJax-Span-4742"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4743"><span class="mn" id="MathJax-Span-4744" style="font-family: MathJax_Main;">501</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.556em; left: 0.836em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.836em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.346em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -4.066em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4745" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-4746" style="font-family: MathJax_Main; padding-left: 0.297em;">22.4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-398">\sqrt{501} \approx 22.4</script>.  That is, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-399-Frame"><nobr><span class="math" id="MathJax-Span-4747" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4748"><span class="mi" id="MathJax-Span-4749" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-399">z</script> has a very
broad Gaussian distribution, not sharply peaked at all:</p><p></p><div id="wide_gaussian"><svg width="600" height="120"><path class="path" d="M20,70.96202478453063L20.933333333333344,70.78791459290079L21.86666666666666,70.61334701139624L22.800000000000004,70.4383262962334L23.73333333333332,70.26285675623473L24.666666666666668,70.08694275279697L25.600000000000016,69.910588699854L26.533333333333328,69.73379906383417L27.466666666666676,69.55657836361209L28.399999999999984,69.37893117045499L29.33333333333333,69.20086210796343L30.26666666666668,69.0223758520065L31.199999999999996,68.84347713065131L32.13333333333334,68.66417072408697L33.066666666666656,68.48446146454279L34,68.30435423620094L34.933333333333344,68.12385397510319L35.86666666666666,67.94296566905226L36.800000000000004,67.76169435750705L37.73333333333332,67.58004513147245L38.666666666666664,67.39802313338296L39.600000000000016,67.21563355698108L40.533333333333324,67.03288164718926L41.466666666666676,66.84977269997644L42.39999999999999,66.66631206221862L43.33333333333333,66.48250513155341L44.26666666666668,66.29835735622896L45.19999999999999,66.11387423494676L46.13333333333334,65.92906131669866L47.06666666666665,65.74392420059792L48,65.55846853570424L48.93333333333335,65.37270002084306L49.86666666666666,65.18662440441867L50.80000000000001,65.00024748422143L51.73333333333332,64.81357510722907L52.66666666666667,64.6266131694019L53.60000000000001,64.43936761547218L54.533333333333324,64.25184443872722L55.46666666666667,64.06404968078674L56.39999999999999,63.875989431374165L57.33333333333333,63.68766982808168L58.26666666666668,63.49909705612963L59.199999999999996,63.310277348119556L60.13333333333334,63.121216983781444L61.06666666666665,62.93192228971476L62,62.74239963912365L62.93333333333335,62.552655451545974L63.86666666666666,62.362696192576394L64.80000000000001,62.17252837358329L65.73333333333332,61.98215855142002L66.66666666666666,61.79159332812961L67.60000000000001,61.600839350643994L68.53333333333333,61.409903310476906L69.46666666666667,61.21879194341087L70.39999999999999,61.02751202917827L71.33333333333333,60.83607039113623L72.26666666666668,60.64447389593587L73.19999999999999,60.45272945318523L74.13333333333334,60.260844015106514L75.06666666666666,60.06882457618726L76,59.87667817282564L76.93333333333335,59.684411882969826L77.86666666666666,59.49203282575147L78.80000000000001,59.29954816111331L79.73333333333332,59.10696508943089L80.66666666666667,58.91429085112847L81.60000000000002,58.72153272628907L82.53333333333332,58.52869803425874L83.46666666666667,58.33579413324502L84.39999999999999,58.14282841990962L85.33333333333334,57.94980832895542L86.26666666666668,57.75674133270764L87.19999999999999,57.56363494068942L88.13333333333334,57.370496699191655L89.06666666666665,57.17733419083722L90,56.98415503413953L90.93333333333334,56.79096688305557L91.86666666666666,56.59777742653331L92.80000000000001,56.404594388053575L93.73333333333332,56.21142552516643L94.66666666666666,56.018278629022134L95.60000000000002,55.82516152389658L96.53333333333333,55.632082066711284L97.46666666666667,55.43904814654814L98.39999999999999,55.246067684158774L99.33333333333334,55.05314863146845L100.26666666666668,54.86029897107495L101.19999999999999,54.66752671574202L102.13333333333333,54.47483990788773L103.06666666666665,54.282246619067635L104,54.089754949452846L104.93333333333335,53.89737302730292L105.86666666666666,53.70510900843398L106.80000000000001,53.512971075681484L107.73333333333332,53.32096743835837L108.66666666666666,53.129106331708094L109.60000000000001,52.93739601635287L110.53333333333333,52.74584477773715L111.46666666666668,52.55446092556626L112.39999999999999,52.36325279324038L113.33333333333333,52.172228737283824L114.26666666666668,51.98139713676971L115.19999999999999,51.790766392740025L116.13333333333334,51.6003449276213L117.06666666666665,51.41014118463564L118,51.22016362720749L118.93333333333335,51.03042073836592L119.86666666666666,50.84092102014283L120.80000000000001,50.65167299296651L121.73333333333332,50.46268519505146L122.66666666666666,50.273966181783834L123.60000000000001,50.085524525102684L124.53333333333332,49.89736881287756L125.46666666666668,49.70950764828176L126.39999999999999,49.52194964916193L127.33333333333334,49.334703447403804L128.26666666666668,49.14777768829397L129.2,48.961181029878205L130.13333333333335,48.77492214231596L131.06666666666666,48.58900970723134L132,48.403452417060514L132.93333333333334,48.218258974395766L133.86666666666665,48.033438091326005L134.8,47.84899848877413L135.73333333333332,47.66494889583097L136.66666666666669,47.481298049086114L137.60000000000002,47.298054691955755L138.5333333333333,47.11522757400715L139.46666666666667,46.93282545028045L140.39999999999998,46.75085708060745L141.33333333333334,46.56933122892751L142.26666666666668,46.38825666260072L143.2,46.20764215171846L144.13333333333333,46.027496468411236L145.06666666666663,45.84782838615395L146,45.66864667906891L146.93333333333334,45.48996012122609L147.86666666666667,45.31177748594153L148.8,45.13410754507306L149.73333333333332,44.95695906831412L150.66666666666669,44.78034082248544L151.6,44.604261570824704L152.5333333333333,44.428730072274234L153.4666666666667,44.25375508076692L154.4,44.07934534451033L155.33333333333331,43.90550960526908L156.26666666666665,43.732256597645744L157.2,43.559595048360045L158.13333333333333,43.38753367552681L159.06666666666666,43.216081187932296L160,43.04524628430958L160.93333333333334,42.875037652612384L161.86666666666665,42.70546396928812L162.8,42.5365338985496L163.73333333333332,42.368256091646074L164.66666666666669,42.20063918613324L165.60000000000002,42.033691805142425L166.5333333333333,41.86742255664935L167.46666666666667,41.701840032742L168.4,41.53695280888805L169.33333333333331,41.37276944320199L170.26666666666668,41.20929847571172L171.19999999999996,41.04654842762501L172.13333333333333,40.88452780059582L173.06666666666666,40.72324507599028L174,40.562708714153075L174.93333333333334,40.402927153673545L175.86666666666667,40.243908810652215L176.8,40.085662077967456L177.73333333333332,39.92819532454257L178.66666666666669,39.77151689461331L179.60000000000002,39.61563510699592L180.53333333333336,39.460558254355746L181.46666666666664,39.306294602476726L182.39999999999998,39.152852389531475L183.33333333333334,39.00023982535245L184.26666666666665,38.84846509070392L185.2,38.697536336555146L186.13333333333335,38.547461683354676L187.06666666666663,38.398249220305885L188,38.24990700464384L188.93333333333334,38.10244306091359L189.86666666666667,37.95586538025009L190.8,37.810181919659584L191.73333333333332,37.66540060130274L192.66666666666669,37.521529311779666L193.60000000000002,37.378575901416646L194.53333333333333,37.23654818355495L195.46666666666667,37.09545393384176L196.39999999999998,36.95530088952311L197.33333333333331,36.816096748739106L198.26666666666668,36.67784916982157L199.2,36.540565770594L200.13333333333333,36.40425412767406L201.06666666666666,36.268921775778665L202,36.13457620703186L202.93333333333337,36.001224870275266L203.86666666666665,35.86887517038157L204.8,35.73753446757088L205.73333333333335,35.60721007673018L206.66666666666666,35.477909266735814L207.60000000000002,35.349639259779295L208.53333333333336,35.22240723069633L209.46666666666664,35.09622030629935L210.39999999999998,34.9710855647134L211.33333333333331,34.84701003471556L212.26666666666668,34.724000695078196L213.2,34.60206447391584L214.13333333333333,34.48120824803581L215.06666666666666,34.36143884229287L216,34.242763028947834L216.93333333333334,34.12518752703025L217.86666666666667,34.00871900170515L218.80000000000004,33.89336406364425L219.73333333333332,33.779129268401185L220.66666666666669,33.666021115791494L221.60000000000002,33.55404604927682L222.53333333333333,33.44321045535373L223.4666666666667,33.333520662947336L224.39999999999998,33.224982942809476L225.33333333333331,33.11760350692186L226.26666666666668,33.01138850790386L227.2,32.90634403842563L228.13333333333335,32.80247613062596L229.06666666666663,32.69979075553542L230,32.59829382250467L230.93333333333337,32.49799117863803L231.86666666666665,32.39888860823248L232.8,32.300991832221904L233.73333333333332,32.20430650762719L234.66666666666669,32.108838227011475L235.60000000000002,32.014592517941416L236.5333333333333,31.921574842453957L237.46666666666667,31.829790596529044L238.39999999999998,31.739245109568024L239.33333333333331,31.649943643878274L240.26666666666668,31.561891394163524L241.19999999999996,31.475093487020445L242.13333333333333,31.38955498044135L243.06666666666666,31.305280863323162L244,31.222276054982466L244.93333333333334,31.140545404677233L245.86666666666667,31.060093691134576L246.8,30.980925622085344L247.73333333333332,30.903045833805002L248.66666666666669,30.826458890661232L249.60000000000002,30.751169284668187L250.53333333333336,30.67718143504745L251.46666666666664,30.60449968779575L252.39999999999998,30.533128315259628L253.33333333333334,30.463071515716873L254.26666666666665,30.394333412965054L255.2,30.326918055916945L256.1333333333334,30.260829418203066L257.06666666666666,30.19607139778146L258,30.132647816554456L258.93333333333334,30.070562419992804L259.8666666666667,30.00981887676712L260.8,29.950420778386437L261.7333333333333,29.89237163884453L262.6666666666667,29.835674894273268L263.6,29.780333902603857L264.5333333333333,29.726351943235052L265.4666666666667,29.67373221670971L266.4,29.62247784439822L267.33333333333337,29.572591868190052L268.26666666666665,29.524077250192853L269.20000000000005,29.476936872439374L270.1333333333333,29.431173536602024L271.06666666666666,29.386789963715447L272,29.34378879390688L272.93333333333334,29.302172586134347L273.8666666666667,29.261943817932927L274.8,29.223104885168922L275.73333333333335,29.185658101802012L276.66666666666663,29.149605699655563L277.6,29.11494982819481L278.5333333333333,29.08169255431347L279.4666666666667,29.04983586212804L280.4,29.01938165278075L281.33333333333337,28.990331744250348L282.2666666666667,28.96268787117119L283.2,28.936451684660742L284.1333333333333,28.911624752155134L285.0666666666666,28.888208557253073L286,28.866204499568113L286.93333333333334,28.845613894589253L287.8666666666667,28.826437973549773L288.8,28.808677883304696L289.73333333333335,28.79233468621626L290.66666666666663,28.777409360048196L291.6,28.76390279786812L292.5333333333333,28.751815807958494L293.4666666666667,28.74114911373601L294.4,28.731903353679506L295.3333333333333,28.72407908126611L296.26666666666665,28.71767676491622L297.20000000000005,28.712696787946534L298.1333333333333,28.709139448532007L299.06666666666666,28.707004959676006L300,28.706293449189033L300.93333333333334,28.707004959676006L301.8666666666667,28.709139448532007L302.79999999999995,28.712696787946534L303.7333333333333,28.71767676491622L304.66666666666663,28.72407908126611L305.6,28.731903353679506L306.5333333333333,28.74114911373601L307.46666666666664,28.751815807958494L308.4,28.76390279786812L309.33333333333337,28.777409360048196L310.26666666666665,28.79233468621626L311.20000000000005,28.808677883304696L312.1333333333334,28.826437973549773L313.06666666666666,28.845613894589253L314,28.866204499568113L314.93333333333334,28.888208557253073L315.8666666666667,28.911624752155134L316.8,28.936451684660742L317.7333333333333,28.96268787117119L318.66666666666663,28.990331744250348L319.6,29.01938165278075L320.53333333333336,29.04983586212804L321.4666666666667,29.08169255431347L322.3999999999999,29.11494982819481L323.3333333333333,29.149605699655563L324.26666666666665,29.185658101802012L325.20000000000005,29.223104885168922L326.1333333333333,29.261943817932927L327.0666666666667,29.302172586134347L328,29.34378879390688L328.9333333333333,29.386789963715447L329.8666666666667,29.431173536602024L330.79999999999995,29.476936872439374L331.73333333333335,29.524077250192853L332.66666666666663,29.572591868190052L333.6,29.62247784439822L334.53333333333336,29.67373221670971L335.46666666666664,29.726351943235052L336.4,29.780333902603857L337.33333333333337,29.835674894273268L338.26666666666665,29.89237163884453L339.20000000000005,29.950420778386437L340.1333333333333,30.00981887676712L341.0666666666667,30.070562419992804L342,30.132647816554456L342.9333333333333,30.19607139778146L343.8666666666667,30.260829418203066L344.79999999999995,30.326918055916945L345.73333333333335,30.394333412965054L346.6666666666667,30.463071515716873L347.6000000000001,30.533128315259628L348.5333333333333,30.60449968779575L349.46666666666664,30.67718143504745L350.4,30.751169284668187L351.33333333333337,30.826458890661232L352.2666666666667,30.903045833805002L353.20000000000005,30.980925622085344L354.13333333333327,31.060093691134576L355.06666666666666,31.140545404677233L356,31.222276054982466L356.93333333333334,31.305280863323162L357.8666666666667,31.38955498044135L358.79999999999995,31.475093487020445L359.73333333333335,31.561891394163524L360.66666666666663,31.649943643878274L361.6,31.739245109568024L362.53333333333336,31.829790596529044L363.46666666666664,31.921574842453957L364.4,32.014592517941416L365.33333333333337,32.108838227011475L366.2666666666667,32.20430650762719L367.20000000000005,32.300991832221904L368.13333333333327,32.39888860823248L369.06666666666666,32.49799117863803L370,32.59829382250467L370.93333333333334,32.69979075553542L371.86666666666673,32.80247613062596L372.79999999999995,32.90634403842563L373.7333333333333,33.01138850790386L374.66666666666663,33.11760350692186L375.6,33.224982942809476L376.53333333333336,33.333520662947336L377.46666666666664,33.44321045535373L378.4,33.55404604927682L379.33333333333337,33.666021115791494L380.26666666666665,33.779129268401185L381.20000000000005,33.89336406364425L382.1333333333333,34.00871900170515L383.06666666666666,34.12518752703025L384,34.242763028947834L384.93333333333334,34.36143884229287L385.86666666666673,34.48120824803581L386.79999999999995,34.60206447391584L387.7333333333333,34.724000695078196L388.66666666666663,34.84701003471556L389.6,34.9710855647134L390.53333333333336,35.09622030629935L391.4666666666667,35.22240723069633L392.3999999999999,35.349639259779295L393.3333333333333,35.477909266735814L394.26666666666665,35.60721007673018L395.20000000000005,35.73753446757088L396.1333333333333,35.86887517038157L397.0666666666667,36.001224870275266L398,36.13457620703186L398.9333333333333,36.268921775778665L399.8666666666667,36.40425412767406L400.79999999999995,36.540565770594L401.73333333333335,36.67784916982157L402.66666666666663,36.816096748739106L403.6,36.95530088952311L404.53333333333336,37.09545393384176L405.46666666666664,37.23654818355495L406.4,37.378575901416646L407.33333333333337,37.521529311779666L408.26666666666665,37.66540060130274L409.20000000000005,37.810181919659584L410.1333333333333,37.95586538025009L411.0666666666667,38.10244306091359L412,38.24990700464384L412.9333333333333,38.398249220305885L413.8666666666667,38.547461683354676L414.79999999999995,38.697536336555146L415.73333333333335,38.84846509070392L416.6666666666667,39.00023982535245L417.6000000000001,39.152852389531475L418.5333333333333,39.306294602476726L419.46666666666664,39.460558254355746L420.4,39.61563510699592L421.33333333333337,39.77151689461331L422.2666666666667,39.92819532454257L423.20000000000005,40.085662077967456L424.13333333333327,40.243908810652215L425.06666666666666,40.402927153673545L426,40.562708714153075L426.93333333333334,40.72324507599028L427.8666666666667,40.88452780059582L428.79999999999995,41.04654842762501L429.73333333333335,41.20929847571172L430.66666666666663,41.37276944320199L431.6,41.53695280888805L432.53333333333336,41.701840032742L433.46666666666664,41.86742255664935L434.4,42.033691805142425L435.33333333333337,42.20063918613324L436.2666666666667,42.368256091646074L437.20000000000005,42.5365338985496L438.13333333333327,42.70546396928812L439.06666666666666,42.875037652612384L440,43.04524628430958L440.93333333333334,43.216081187932296L441.86666666666673,43.38753367552681L442.79999999999995,43.559595048360045L443.7333333333333,43.732256597645744L444.66666666666663,43.90550960526908L445.6,44.07934534451033L446.53333333333336,44.25375508076692L447.46666666666664,44.428730072274234L448.4,44.604261570824704L449.33333333333337,44.78034082248544L450.26666666666665,44.95695906831412L451.20000000000005,45.13410754507306L452.1333333333333,45.31177748594153L453.06666666666666,45.48996012122609L454,45.66864667906891L454.93333333333334,45.84782838615395L455.86666666666673,46.027496468411236L456.79999999999995,46.20764215171846L457.7333333333333,46.38825666260072L458.66666666666663,46.56933122892751L459.6,46.75085708060745L460.53333333333336,46.93282545028045L461.4666666666667,47.11522757400715L462.3999999999999,47.298054691955755L463.3333333333333,47.481298049086114L464.26666666666665,47.66494889583097L465.20000000000005,47.84899848877413L466.1333333333333,48.033438091326005L467.0666666666667,48.218258974395766L468,48.403452417060514L468.9333333333333,48.58900970723134L469.8666666666667,48.77492214231596L470.79999999999995,48.961181029878205L471.73333333333335,49.14777768829397L472.66666666666663,49.334703447403804L473.6,49.52194964916193L474.53333333333336,49.70950764828176L475.46666666666664,49.89736881287756L476.4,50.085524525102684L477.33333333333337,50.273966181783834L478.26666666666665,50.46268519505146L479.20000000000005,50.65167299296651L480.1333333333333,50.84092102014283L481.0666666666667,51.03042073836592L482,51.22016362720749L482.9333333333333,51.41014118463564L483.8666666666667,51.6003449276213L484.79999999999995,51.790766392740025L485.73333333333335,51.98139713676971L486.6666666666667,52.172228737283824L487.6000000000001,52.36325279324038L488.5333333333333,52.55446092556626L489.46666666666664,52.74584477773715L490.4,52.93739601635287L491.33333333333337,53.129106331708094L492.2666666666667,53.32096743835837L493.20000000000005,53.512971075681484L494.13333333333327,53.70510900843398L495.06666666666666,53.89737302730292L496,54.089754949452846L496.93333333333334,54.282246619067635L497.8666666666667,54.47483990788773L498.79999999999995,54.66752671574202L499.73333333333335,54.86029897107495L500.66666666666663,55.05314863146845L501.6,55.246067684158774L502.53333333333336,55.43904814654814L503.46666666666664,55.632082066711284L504.4,55.82516152389658L505.33333333333337,56.018278629022134L506.2666666666667,56.21142552516643L507.20000000000005,56.404594388053575L508.13333333333327,56.59777742653331L509.06666666666666,56.79096688305557L510,56.98415503413953L510.93333333333334,57.17733419083722L511.86666666666673,57.370496699191655L512.8,57.56363494068942L513.7333333333332,57.75674133270764L514.6666666666667,57.94980832895542L515.5999999999999,58.14282841990962L516.5333333333333,58.33579413324502L517.4666666666667,58.52869803425874L518.4000000000001,58.72153272628907L519.3333333333334,58.91429085112847L520.2666666666667,59.10696508943089L521.2,59.29954816111331L522.1333333333333,59.49203282575147L523.0666666666666,59.684411882969826L524,59.87667817282564L524.9333333333334,60.06882457618726L525.8666666666667,60.260844015106514L526.8,60.45272945318523L527.7333333333333,60.64447389593587L528.6666666666667,60.83607039113623L529.6,61.02751202917827L530.5333333333333,61.21879194341087L531.4666666666667,61.409903310476906L532.4,61.600839350643994L533.3333333333333,61.79159332812961L534.2666666666667,61.98215855142002L535.2,62.17252837358329L536.1333333333333,62.362696192576394L537.0666666666666,62.552655451545974L538,62.74239963912365L538.9333333333334,62.93192228971476L539.8666666666667,63.121216983781444L540.8,63.310277348119556L541.7333333333333,63.49909705612963L542.6666666666667,63.68766982808168L543.6,63.875989431374165L544.5333333333334,64.06404968078674L545.4666666666666,64.25184443872722L546.4,64.43936761547218L547.3333333333333,64.6266131694019L548.2666666666667,64.81357510722907L549.2,65.00024748422143L550.1333333333333,65.18662440441867L551.0666666666666,65.37270002084306L552,65.55846853570424L552.9333333333334,65.74392420059792L553.8666666666667,65.92906131669866L554.8,66.11387423494676L555.7333333333333,66.29835735622896L556.6666666666667,66.48250513155341L557.6,66.66631206221862L558.5333333333333,66.84977269997644L559.4666666666667,67.03288164718926L560.4,67.21563355698108L561.3333333333333,67.39802313338296L562.2666666666667,67.58004513147245L563.2,67.76169435750705L564.1333333333333,67.94296566905226L565.0666666666666,68.12385397510319L566,68.30435423620094L566.9333333333334,68.48446146454279L567.8666666666667,68.66417072408697L568.8,68.84347713065131L569.7333333333333,69.0223758520065L570.6666666666666,69.20086210796343L571.5999999999999,69.37893117045499L572.5333333333333,69.55657836361209L573.4666666666667,69.73379906383417L574.4000000000001,69.910588699854L575.3333333333333,70.08694275279697L576.2666666666667,70.26285675623473L577.2,70.4383262962334L578.1333333333333,70.61334701139624L579.0666666666666,70.78791459290079"></path><g class="axis" transform="translate(0,100)"><g class="tick" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-30</text></g><g class="tick" transform="translate(113.33333333333333,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-20</text></g><g class="tick" transform="translate(206.66666666666666,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-10</text></g><g class="tick" transform="translate(300,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(393.3333333333333,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">10</text></g><g class="tick" transform="translate(486.6666666666667,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">20</text></g><g class="tick" transform="translate(580,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">30</text></g><path class="domain" d="M20,6V0H580V6"></path></g><g class="axis" transform="translate(300, 0)"><g class="tick" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.02</text></g><path class="domain" d="M-6,20H0V100H-6"></path></g></svg></div>
<script type="text/javascript" style="display:none">
<!--
var width = 600; 
var height = 120; 
var padding = 20; 

var sigma = Math.sqrt(501);
function gaussian(x) {
    return (1/(sigma*Math.sqrt(2*Math.PI)))*Math.exp(-x*x/(2*sigma*sigma));}

var xScale = d3.scale.linear() 
    .domain([-30, 30]) 
    .range([padding, width-padding]);

var yScale = d3.scale.linear() 
    .domain([0, 0.02])
    .range([height-padding, padding]); 

var line = d3.svg.line()
    .x(function(d) { return xScale(d[0]); }) 
    .y(function(d) { return yScale(d[1]); }); 

var xAxis = d3.svg.axis()
    .scale(xScale) 
    .orient("bottom") 
    .ticks(5);

var yAxis = d3.svg.axis()
    .scale(yScale) 
    .orient("left")
    .tickValues([0.02])
    .tickFormat(d3.format(".2"));

var svg = d3.select("#wide_gaussian").append("svg") 
    .attr("width", width)
    .attr("height", height);

var lineFit = d3.range(-30, 30, .1).map(function(d){ 
    return [d, gaussian(d)]; }); 

svg.append("path") 
    .datum(lineFit) 
    .attr("class", "path") 
    .attr("d", line); 

// x axis 
svg.append("g") 
    .attr("class", "axis") 
    .attr("transform", "translate(0,"+(height-padding)+")") 
    .call(xAxis); 

// y axis 
svg.append("g") 
    .attr("class", "axis")
    .attr("transform", "translate("+width/2+", 0)") 
    .call(yAxis);

//-->
</script><p></p><p>In particular, we can see from this graph that it's quite likely that
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-400-Frame"><nobr><span class="math" id="MathJax-Span-4750" role="math" style="width: 1.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4751"><span class="texatom" id="MathJax-Span-4752"><span class="mrow" id="MathJax-Span-4753"><span class="mo" id="MathJax-Span-4754" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4755" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-4756"><span class="mrow" id="MathJax-Span-4757"><span class="mo" id="MathJax-Span-4758" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-400">|z|</script> will be pretty large, i.e., either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-401-Frame"><nobr><span class="math" id="MathJax-Span-4759" role="math" style="width: 2.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4760"><span class="mi" id="MathJax-Span-4761" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4762" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-4763" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-401">z \gg 1</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-402-Frame"><nobr><span class="math" id="MathJax-Span-4764" role="math" style="width: 3.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4765"><span class="mi" id="MathJax-Span-4766" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4767" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-4768" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-4769" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-402">z \ll -1</script>.  If
that's the case then the output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-403-Frame"><nobr><span class="math" id="MathJax-Span-4770" role="math" style="width: 1.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.816em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4771"><span class="mi" id="MathJax-Span-4772" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4773" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4774" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4775" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-403">\sigma(z)</script> from the hidden neuron
will be very close to either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-404-Frame"><nobr><span class="math" id="MathJax-Span-4776" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4777"><span class="mn" id="MathJax-Span-4778" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-404">1</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-405-Frame"><nobr><span class="math" id="MathJax-Span-4779" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4780"><span class="mn" id="MathJax-Span-4781" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-405">0</script>.  That means our hidden neuron
will have saturated.  And when that happens, as we know, making small
changes in the weights will make only absolutely miniscule changes in
the activation of our hidden neuron.  That miniscule change in the
activation of the hidden neuron will, in turn, barely affect the rest
of the neurons in the network at all, and we'll see a correspondingly
miniscule change in the cost function.  As a result, those weights
will only learn very slowly when we use the gradient descent
algorithm*<span class="marginnote">
*We discussed this in more detail in Chapter 2,
  where we used the
  <a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">equations
    of backpropagation</a> to show that weights input to saturated
  neurons learned slowly.</span>.  It's similar to the problem we discussed
earlier in this chapter, in which output neurons which saturated on
the wrong value caused learning to slow down.  We addressed that
earlier problem with a clever choice of cost function.  Unfortunately,
while that helped with saturated output neurons, it does nothing at
all for the problem with saturated hidden neurons.</p><p>I've been talking about the weights input to the first hidden layer.
Of course, similar arguments apply also to later hidden layers: if the
weights in later hidden layers are initialized using normalized
Gaussians, then activations will often be very close to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-406-Frame"><nobr><span class="math" id="MathJax-Span-4782" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4783"><span class="mn" id="MathJax-Span-4784" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-406">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-407-Frame"><nobr><span class="math" id="MathJax-Span-4785" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4786"><span class="mn" id="MathJax-Span-4787" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-407">1</script>,
and learning will proceed very slowly.</p><p>Is there some way we can choose better initializations for the weights
and biases, so that we don't get this kind of saturation, and so avoid
a learning slowdown?  Suppose we have a neuron with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-408-Frame"><nobr><span class="math" id="MathJax-Span-4788" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4789"><span class="msubsup" id="MathJax-Span-4790"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4791" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="texatom" id="MathJax-Span-4792"><span class="mrow" id="MathJax-Span-4793"><span class="mi" id="MathJax-Span-4794" style="font-size: 70.7%; font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4795" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-408">n_{\rm in}</script> input
weights.  Then we shall initialize those weights as Gaussian random
variables with mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-409-Frame"><nobr><span class="math" id="MathJax-Span-4796" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4797"><span class="mn" id="MathJax-Span-4798" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-409">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-410-Frame"><nobr><span class="math" id="MathJax-Span-4799" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4800"><span class="mn" id="MathJax-Span-4801" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-4802"><span class="mrow" id="MathJax-Span-4803"><span class="mo" id="MathJax-Span-4804" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-4805"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4806"><span class="msubsup" id="MathJax-Span-4807"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4808" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="texatom" id="MathJax-Span-4809"><span class="mrow" id="MathJax-Span-4810"><span class="mi" id="MathJax-Span-4811" style="font-size: 70.7%; font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4812" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.409em; left: 0.836em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.591em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.248em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -3.87em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-410">1/\sqrt{n_{\rm in}}</script>.
That is, we'll squash the Gaussians down, making it less likely that
our neuron will saturate.  We'll continue to choose the bias as a
Gaussian with mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-411-Frame"><nobr><span class="math" id="MathJax-Span-4813" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4814"><span class="mn" id="MathJax-Span-4815" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-411">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-412-Frame"><nobr><span class="math" id="MathJax-Span-4816" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4817"><span class="mn" id="MathJax-Span-4818" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-412">1</script>, for reasons I'll
return to in a moment.  With these choices, the weighted sum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-413-Frame"><nobr><span class="math" id="MathJax-Span-4819" role="math" style="width: 7.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4820"><span class="mi" id="MathJax-Span-4821" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4822" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="munderover" id="MathJax-Span-4823" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4824" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-4825" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4826" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4827" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-4828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4829"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4830" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-4831" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4832" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-4833" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-413">z =
\sum_j w_j x_j + b</script> will again be a Gaussian random variable with mean
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-414-Frame"><nobr><span class="math" id="MathJax-Span-4834" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4835"><span class="mn" id="MathJax-Span-4836" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-414">0</script>, but it'll be much more sharply peaked than it was before.
Suppose, as we did earlier, that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-415-Frame"><nobr><span class="math" id="MathJax-Span-4837" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4838"><span class="mn" id="MathJax-Span-4839" style="font-family: MathJax_Main;">500</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-415">500</script> of the inputs are zero and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-416-Frame"><nobr><span class="math" id="MathJax-Span-4840" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4841"><span class="mn" id="MathJax-Span-4842" style="font-family: MathJax_Main;">500</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-416">500</script> are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-417-Frame"><nobr><span class="math" id="MathJax-Span-4843" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4844"><span class="mn" id="MathJax-Span-4845" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-417">1</script>.  Then it's easy to show (see the exercise below) that
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-418-Frame"><nobr><span class="math" id="MathJax-Span-4846" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4847"><span class="mi" id="MathJax-Span-4848" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-418">z</script> has a Gaussian distribution with mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-419-Frame"><nobr><span class="math" id="MathJax-Span-4849" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4850"><span class="mn" id="MathJax-Span-4851" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-419">0</script> and standard deviation
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-420-Frame"><nobr><span class="math" id="MathJax-Span-4852" role="math" style="width: 7.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4853"><span class="msqrt" id="MathJax-Span-4854"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.983em;"><span class="mrow" id="MathJax-Span-4855"><span class="mn" id="MathJax-Span-4856" style="font-family: MathJax_Main;">3</span><span class="texatom" id="MathJax-Span-4857"><span class="mrow" id="MathJax-Span-4858"><span class="mo" id="MathJax-Span-4859" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-4860" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.605em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.836em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.346em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span style="font-family: MathJax_Size1;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4861" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4862" style="font-family: MathJax_Main; padding-left: 0.297em;">1.22</span><span class="mo" id="MathJax-Span-4863" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-420">\sqrt{3/2} = 1.22\ldots</script>.  This is much more sharply peaked than
before, so much so that even the graph below understates the
situation, since I've had to rescale the vertical axis, when compared
to the earlier graph:</p><p></p><div id="narrow_gaussian"><svg width="600" height="360"><path class="path" d="M20,340L20.933333333333344,340L21.86666666666666,340L22.800000000000004,340L23.73333333333332,340L24.666666666666668,340L25.600000000000016,340L26.533333333333328,340L27.466666666666676,340L28.399999999999984,340L29.33333333333333,340L30.26666666666668,340L31.199999999999996,340L32.13333333333334,340L33.066666666666656,340L34,340L34.933333333333344,340L35.86666666666666,340L36.800000000000004,340L37.73333333333332,340L38.666666666666664,340L39.600000000000016,340L40.533333333333324,340L41.466666666666676,340L42.39999999999999,340L43.33333333333333,340L44.26666666666668,340L45.19999999999999,340L46.13333333333334,340L47.06666666666665,340L48,340L48.93333333333335,340L49.86666666666666,340L50.80000000000001,340L51.73333333333332,340L52.66666666666667,340L53.60000000000001,340L54.533333333333324,340L55.46666666666667,340L56.39999999999999,340L57.33333333333333,340L58.26666666666668,340L59.199999999999996,340L60.13333333333334,340L61.06666666666665,340L62,340L62.93333333333335,340L63.86666666666666,340L64.80000000000001,340L65.73333333333332,340L66.66666666666666,340L67.60000000000001,340L68.53333333333333,340L69.46666666666667,340L70.39999999999999,340L71.33333333333333,340L72.26666666666668,340L73.19999999999999,340L74.13333333333334,340L75.06666666666666,340L76,340L76.93333333333335,340L77.86666666666666,340L78.80000000000001,340L79.73333333333332,340L80.66666666666667,340L81.60000000000002,340L82.53333333333332,340L83.46666666666667,340L84.39999999999999,340L85.33333333333334,340L86.26666666666668,340L87.19999999999999,340L88.13333333333334,340L89.06666666666665,340L90,340L90.93333333333334,340L91.86666666666666,340L92.80000000000001,340L93.73333333333332,340L94.66666666666666,340L95.60000000000002,340L96.53333333333333,340L97.46666666666667,340L98.39999999999999,340L99.33333333333334,340L100.26666666666668,340L101.19999999999999,340L102.13333333333333,340L103.06666666666665,340L104,340L104.93333333333335,340L105.86666666666666,340L106.80000000000001,340L107.73333333333332,340L108.66666666666666,340L109.60000000000001,340L110.53333333333333,340L111.46666666666668,340L112.39999999999999,340L113.33333333333333,340L114.26666666666668,340L115.19999999999999,340L116.13333333333334,340L117.06666666666665,340L118,340L118.93333333333335,340L119.86666666666666,340L120.80000000000001,340L121.73333333333332,340L122.66666666666666,340L123.60000000000001,340L124.53333333333332,340L125.46666666666668,340L126.39999999999999,340L127.33333333333334,340L128.26666666666668,340L129.2,340L130.13333333333335,340L131.06666666666666,340L132,340L132.93333333333334,340L133.86666666666665,340L134.8,340L135.73333333333332,340L136.66666666666669,340L137.60000000000002,340L138.5333333333333,340L139.46666666666667,340L140.39999999999998,340L141.33333333333334,340L142.26666666666668,340L143.2,340L144.13333333333333,340L145.06666666666663,340L146,340L146.93333333333334,340L147.86666666666667,340L148.8,340L149.73333333333332,340L150.66666666666669,340L151.6,340L152.5333333333333,340L153.4666666666667,340L154.4,340L155.33333333333331,340L156.26666666666665,340L157.2,340L158.13333333333333,340L159.06666666666666,340L160,340L160.93333333333334,340L161.86666666666665,340L162.8,340L163.73333333333332,340L164.66666666666669,340L165.60000000000002,340L166.5333333333333,340L167.46666666666667,340L168.4,340L169.33333333333331,340L170.26666666666668,340L171.19999999999996,340L172.13333333333333,340L173.06666666666666,340L174,340L174.93333333333334,340L175.86666666666667,340L176.8,340L177.73333333333332,340L178.66666666666669,340L179.60000000000002,340L180.53333333333336,340L181.46666666666664,340L182.39999999999998,340L183.33333333333334,340L184.26666666666665,340L185.2,340L186.13333333333335,340L187.06666666666663,340L188,340L188.93333333333334,340L189.86666666666667,340L190.8,340L191.73333333333332,340L192.66666666666669,340L193.60000000000002,340L194.53333333333333,340L195.46666666666667,340L196.39999999999998,340L197.33333333333331,340L198.26666666666668,340L199.2,340L200.13333333333333,340L201.06666666666666,340L202,339.99999999999994L202.93333333333337,339.99999999999994L203.86666666666665,339.9999999999999L204.8,339.9999999999998L205.73333333333335,339.9999999999995L206.66666666666666,339.99999999999915L207.60000000000002,339.9999999999983L208.53333333333336,339.99999999999676L209.46666666666664,339.99999999999375L210.39999999999998,339.9999999999881L211.33333333333331,339.9999999999776L212.26666666666668,339.9999999999578L213.2,339.99999999992144L214.13333333333333,339.9999999998544L215.06666666666666,339.9999999997321L216,339.99999999951024L216.93333333333334,339.99999999911057L217.86666666666667,339.9999999983954L218.80000000000004,339.9999999971246L219.73333333333332,339.9999999948814L220.66666666666669,339.99999999094905L221.60000000000002,339.99999998410175L222.53333333333333,339.99999997226L223.4666666666667,339.9999999519197L224.39999999999998,339.99999991721836L225.33333333333331,339.99999985841885L226.26666666666668,339.9999997594632L227.2,339.99999959405955L228.13333333333335,339.99999931946917L229.06666666666663,339.999998866718L230,339.99999812529524L230.93333333333337,339.9999969194201L231.86666666666665,339.99999497151947L232.8,339.99999184646805L233.73333333333332,339.9999868671351L234.66666666666669,339.99997898749234L235.60000000000002,339.9999666034969L236.5333333333333,339.9999472735164L237.46666666666667,339.9999173084132L238.39999999999998,339.99987117547613L239.33333333333331,339.99980063887773L240.26666666666668,339.9996935306149L241.19999999999996,339.99953200800155L242.13333333333333,339.99929010443685L243.06666666666666,339.9989303167399L244,339.99839889195226L244.93333333333334,339.99761937612413L245.86666666666667,339.99648386425787L246.8,339.99484124165673L247.73333333333332,339.9924815305545L248.66666666666669,339.98911525153454L249.60000000000002,339.9843464783162L250.53333333333336,339.977638011263L251.46666666666664,339.9682668274614L252.39999999999998,339.9552676962586L253.33333333333334,339.93736259735283L254.26666666666665,339.91287336926814L255.2,339.8796148821435L256.1333333333334,339.8347660107387L257.06666666666666,339.7747158293328L258,339.6948828139443L258.93333333333334,339.589505477197L259.8666666666667,339.4514038360422L260.8,339.27171247700676L261.7333333333333,339.03958778199114L262.6666666666667,338.74189413635855L263.6,338.3628766604667L264.5333333333333,337.88383115110673L265.4666666666667,337.28278541201826L266.4,336.53420986301103L267.33333333333337,335.6087790590976L268.26666666666665,334.4732092801777L269.20000000000005,333.0902003689244L270.1333333333333,331.4185121541305L271.06666666666666,329.41320672276527L272,327.02608711209564L272.93333333333334,324.2063603201987L273.8666666666667,320.90154757165664L274.8,317.0586573121472L275.73333333333335,312.6256263618742L276.66666666666663,307.55302212487317L277.6,301.7959840216825L278.5333333333333,295.3163658993683L279.4666666666667,288.08502381234484L280.4,280.08417620654353L281.33333333333337,271.30974729932535L282.2666666666667,261.77359056673095L283.2,251.50547900740818L284.1333333333333,240.55474347526234L285.0666666666666,228.99144093027843L286,216.90694175563578L286.93333333333334,204.4138397728559L287.8666666666667,191.64511025312473L288.8,178.75246956784588L289.73333333333335,165.90392411725045L290.66666666666663,153.2805342914962L291.6,141.0724594836441L292.5333333333333,129.47439028507875L293.4666666666667,118.6805114597638L294.4,108.8791716063798L295.3333333333333,100.24746023992591L296.26666666666665,92.94590837736084L297.20000000000005,87.11353314305572L298.1333333333333,82.86343963084374L299.06666666666666,80.27917423568547L300,79.41199365177603L300.93333333333334,80.27917423568547L301.8666666666667,82.86343963084374L302.79999999999995,87.11353314305572L303.7333333333333,92.94590837736084L304.66666666666663,100.24746023992591L305.6,108.8791716063798L306.5333333333333,118.6805114597638L307.46666666666664,129.47439028507875L308.4,141.0724594836441L309.33333333333337,153.2805342914962L310.26666666666665,165.90392411725045L311.20000000000005,178.75246956784588L312.1333333333334,191.64511025312473L313.06666666666666,204.4138397728559L314,216.90694175563578L314.93333333333334,228.99144093027843L315.8666666666667,240.55474347526234L316.8,251.50547900740818L317.7333333333333,261.77359056673095L318.66666666666663,271.30974729932535L319.6,280.08417620654353L320.53333333333336,288.08502381234484L321.4666666666667,295.3163658993683L322.3999999999999,301.7959840216825L323.3333333333333,307.55302212487317L324.26666666666665,312.6256263618742L325.20000000000005,317.0586573121472L326.1333333333333,320.90154757165664L327.0666666666667,324.2063603201987L328,327.02608711209564L328.9333333333333,329.41320672276527L329.8666666666667,331.4185121541305L330.79999999999995,333.0902003689244L331.73333333333335,334.4732092801777L332.66666666666663,335.6087790590976L333.6,336.53420986301103L334.53333333333336,337.28278541201826L335.46666666666664,337.88383115110673L336.4,338.3628766604667L337.33333333333337,338.74189413635855L338.26666666666665,339.03958778199114L339.20000000000005,339.27171247700676L340.1333333333333,339.4514038360422L341.0666666666667,339.589505477197L342,339.6948828139443L342.9333333333333,339.7747158293328L343.8666666666667,339.8347660107387L344.79999999999995,339.8796148821435L345.73333333333335,339.91287336926814L346.6666666666667,339.93736259735283L347.6000000000001,339.9552676962586L348.5333333333333,339.9682668274614L349.46666666666664,339.977638011263L350.4,339.9843464783162L351.33333333333337,339.98911525153454L352.2666666666667,339.9924815305545L353.20000000000005,339.99484124165673L354.13333333333327,339.99648386425787L355.06666666666666,339.99761937612413L356,339.99839889195226L356.93333333333334,339.9989303167399L357.8666666666667,339.99929010443685L358.79999999999995,339.99953200800155L359.73333333333335,339.9996935306149L360.66666666666663,339.99980063887773L361.6,339.99987117547613L362.53333333333336,339.9999173084132L363.46666666666664,339.9999472735164L364.4,339.9999666034969L365.33333333333337,339.99997898749234L366.2666666666667,339.9999868671351L367.20000000000005,339.99999184646805L368.13333333333327,339.99999497151947L369.06666666666666,339.9999969194201L370,339.99999812529524L370.93333333333334,339.999998866718L371.86666666666673,339.99999931946917L372.79999999999995,339.99999959405955L373.7333333333333,339.9999997594632L374.66666666666663,339.99999985841885L375.6,339.99999991721836L376.53333333333336,339.9999999519197L377.46666666666664,339.99999997226L378.4,339.99999998410175L379.33333333333337,339.99999999094905L380.26666666666665,339.9999999948814L381.20000000000005,339.9999999971246L382.1333333333333,339.9999999983954L383.06666666666666,339.99999999911057L384,339.99999999951024L384.93333333333334,339.9999999997321L385.86666666666673,339.9999999998544L386.79999999999995,339.99999999992144L387.7333333333333,339.9999999999578L388.66666666666663,339.9999999999776L389.6,339.9999999999881L390.53333333333336,339.99999999999375L391.4666666666667,339.99999999999676L392.3999999999999,339.9999999999983L393.3333333333333,339.99999999999915L394.26666666666665,339.9999999999995L395.20000000000005,339.9999999999998L396.1333333333333,339.9999999999999L397.0666666666667,339.99999999999994L398,339.99999999999994L398.9333333333333,340L399.8666666666667,340L400.79999999999995,340L401.73333333333335,340L402.66666666666663,340L403.6,340L404.53333333333336,340L405.46666666666664,340L406.4,340L407.33333333333337,340L408.26666666666665,340L409.20000000000005,340L410.1333333333333,340L411.0666666666667,340L412,340L412.9333333333333,340L413.8666666666667,340L414.79999999999995,340L415.73333333333335,340L416.6666666666667,340L417.6000000000001,340L418.5333333333333,340L419.46666666666664,340L420.4,340L421.33333333333337,340L422.2666666666667,340L423.20000000000005,340L424.13333333333327,340L425.06666666666666,340L426,340L426.93333333333334,340L427.8666666666667,340L428.79999999999995,340L429.73333333333335,340L430.66666666666663,340L431.6,340L432.53333333333336,340L433.46666666666664,340L434.4,340L435.33333333333337,340L436.2666666666667,340L437.20000000000005,340L438.13333333333327,340L439.06666666666666,340L440,340L440.93333333333334,340L441.86666666666673,340L442.79999999999995,340L443.7333333333333,340L444.66666666666663,340L445.6,340L446.53333333333336,340L447.46666666666664,340L448.4,340L449.33333333333337,340L450.26666666666665,340L451.20000000000005,340L452.1333333333333,340L453.06666666666666,340L454,340L454.93333333333334,340L455.86666666666673,340L456.79999999999995,340L457.7333333333333,340L458.66666666666663,340L459.6,340L460.53333333333336,340L461.4666666666667,340L462.3999999999999,340L463.3333333333333,340L464.26666666666665,340L465.20000000000005,340L466.1333333333333,340L467.0666666666667,340L468,340L468.9333333333333,340L469.8666666666667,340L470.79999999999995,340L471.73333333333335,340L472.66666666666663,340L473.6,340L474.53333333333336,340L475.46666666666664,340L476.4,340L477.33333333333337,340L478.26666666666665,340L479.20000000000005,340L480.1333333333333,340L481.0666666666667,340L482,340L482.9333333333333,340L483.8666666666667,340L484.79999999999995,340L485.73333333333335,340L486.6666666666667,340L487.6000000000001,340L488.5333333333333,340L489.46666666666664,340L490.4,340L491.33333333333337,340L492.2666666666667,340L493.20000000000005,340L494.13333333333327,340L495.06666666666666,340L496,340L496.93333333333334,340L497.8666666666667,340L498.79999999999995,340L499.73333333333335,340L500.66666666666663,340L501.6,340L502.53333333333336,340L503.46666666666664,340L504.4,340L505.33333333333337,340L506.2666666666667,340L507.20000000000005,340L508.13333333333327,340L509.06666666666666,340L510,340L510.93333333333334,340L511.86666666666673,340L512.8,340L513.7333333333332,340L514.6666666666667,340L515.5999999999999,340L516.5333333333333,340L517.4666666666667,340L518.4000000000001,340L519.3333333333334,340L520.2666666666667,340L521.2,340L522.1333333333333,340L523.0666666666666,340L524,340L524.9333333333334,340L525.8666666666667,340L526.8,340L527.7333333333333,340L528.6666666666667,340L529.6,340L530.5333333333333,340L531.4666666666667,340L532.4,340L533.3333333333333,340L534.2666666666667,340L535.2,340L536.1333333333333,340L537.0666666666666,340L538,340L538.9333333333334,340L539.8666666666667,340L540.8,340L541.7333333333333,340L542.6666666666667,340L543.6,340L544.5333333333334,340L545.4666666666666,340L546.4,340L547.3333333333333,340L548.2666666666667,340L549.2,340L550.1333333333333,340L551.0666666666666,340L552,340L552.9333333333334,340L553.8666666666667,340L554.8,340L555.7333333333333,340L556.6666666666667,340L557.6,340L558.5333333333333,340L559.4666666666667,340L560.4,340L561.3333333333333,340L562.2666666666667,340L563.2,340L564.1333333333333,340L565.0666666666666,340L566,340L566.9333333333334,340L567.8666666666667,340L568.8,340L569.7333333333333,340L570.6666666666666,340L571.5999999999999,340L572.5333333333333,340L573.4666666666667,340L574.4000000000001,340L575.3333333333333,340L576.2666666666667,340L577.2,340L578.1333333333333,340L579.0666666666666,340"></path><g class="axis" transform="translate(0,340)"><g class="tick" transform="translate(20,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-30</text></g><g class="tick" transform="translate(113.33333333333333,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-20</text></g><g class="tick" transform="translate(206.66666666666666,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-10</text></g><g class="tick" transform="translate(300,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(393.3333333333333,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">10</text></g><g class="tick" transform="translate(486.6666666666667,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">20</text></g><g class="tick" transform="translate(580,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">30</text></g><path class="domain" d="M20,6V0H580V6"></path></g><g class="axis" transform="translate(300, 0)"><g class="tick" transform="translate(0,20)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.4</text></g><path class="domain" d="M-6,20H0V340H-6"></path></g></svg></div> <script type="text/javascript" style="display:none">
<!--
var width = 600; 
var height = 360; 
var padding = 20; 

var sigma = Math.sqrt(1.5);
function gaussian(x) {
    return (1/(sigma*Math.sqrt(2*Math.PI)))*Math.exp(-x*x/(2*sigma*sigma));}

var xScale = d3.scale.linear() 
    .domain([-30, 30]) 
    .range([padding, width-padding]);

var yScale = d3.scale.linear() 
    .domain([0, 0.4])
    .range([height-padding, padding]); 

var line = d3.svg.line()
    .x(function(d) { return xScale(d[0]); }) 
    .y(function(d) { return yScale(d[1]); }); 

var xAxis = d3.svg.axis()
    .scale(xScale) 
    .orient("bottom") 
    .ticks(5);

var yAxis = d3.svg.axis()
    .scale(yScale) 
    .orient("left")
    .tickValues([0.4])
    .tickFormat(d3.format(".1"));

var svg = d3.select("#narrow_gaussian").append("svg") 
    .attr("width", width)
    .attr("height", height);

var lineFit = d3.range(-30, 30, .1).map(function(d){ 
    return [d, gaussian(d)]; }); 

svg.append("path") 
    .datum(lineFit) 
    .attr("class", "path") 
    .attr("d", line); 

// x axis 
svg.append("g") 
    .attr("class", "axis") 
    .attr("transform", "translate(0,"+(height-padding)+")") 
    .call(xAxis); 

// y axis 
svg.append("g") 
    .attr("class", "axis")
    .attr("transform", "translate("+width/2+", 0)") 
    .call(yAxis);

//-->
</script>  <p></p><p>Such a neuron is much less likely to saturate, and correspondingly
much less likely to have problems with a learning slowdown.</p><p></p><h4><a name="exercise_319349"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_319349">Exercise</a></h4><ul>
<li> Verify that the standard deviation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-421-Frame"><nobr><span class="math" id="MathJax-Span-4864" role="math" style="width: 7.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.159em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4865"><span class="mi" id="MathJax-Span-4866" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4867" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="munderover" id="MathJax-Span-4868" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-4869" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-4870" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4871" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4872" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-4873" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4874"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4875" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-4876" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-4877" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-4878" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-421">z = \sum_j w_j x_j + b</script>
  in the paragraph above is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-422-Frame"><nobr><span class="math" id="MathJax-Span-4879" role="math" style="width: 2.6em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4880"><span class="msqrt" id="MathJax-Span-4881"><span style="display: inline-block; position: relative; width: 2.551em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.983em;"><span class="mrow" id="MathJax-Span-4882"><span class="mn" id="MathJax-Span-4883" style="font-family: MathJax_Main;">3</span><span class="texatom" id="MathJax-Span-4884"><span class="mrow" id="MathJax-Span-4885"><span class="mo" id="MathJax-Span-4886" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-4887" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.605em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.836em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.346em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span style="font-family: MathJax_Size1;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-422">\sqrt{3/2}</script>.  It may help to know that:
  (a) the variance of a sum of independent random variables is the sum
  of the variances of the individual random variables; and (b) the
  variance is the square of the standard deviation.
</li></ul><p></p><p>I stated above that we'll continue to initialize the biases as before,
as Gaussian random variables with a mean of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-423-Frame"><nobr><span class="math" id="MathJax-Span-4888" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4889"><span class="mn" id="MathJax-Span-4890" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-423">0</script> and a standard
deviation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-424-Frame"><nobr><span class="math" id="MathJax-Span-4891" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4892"><span class="mn" id="MathJax-Span-4893" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-424">1</script>.  This is okay, because it doesn't make it too much
more likely that our neurons will saturate.  In fact, it doesn't much
matter how we initialize the biases, provided we avoid the problem
with saturation.  Some people go so far as to initialize all the
biases to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-425-Frame"><nobr><span class="math" id="MathJax-Span-4894" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4895"><span class="mn" id="MathJax-Span-4896" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-425">0</script>, and rely on gradient descent to learn appropriate
biases.  But since it's unlikely to make much difference, we'll
continue with the same initialization procedure as before.</p><p>Let's compare the results for both our old and new approaches to
weight initialization, using the MNIST digit classification task.  As
before, we'll use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-426-Frame"><nobr><span class="math" id="MathJax-Span-4897" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4898"><span class="mn" id="MathJax-Span-4899" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-426">30</script> hidden neurons, a mini-batch size of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-427-Frame"><nobr><span class="math" id="MathJax-Span-4900" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4901"><span class="mn" id="MathJax-Span-4902" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-427">10</script>, a
regularization parameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-428-Frame"><nobr><span class="math" id="MathJax-Span-4903" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4904"><span class="mi" id="MathJax-Span-4905" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4906" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4907" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-428">\lambda = 5.0</script>, and the cross-entropy cost
function.  We will decrease the learning rate slightly from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-429-Frame"><nobr><span class="math" id="MathJax-Span-4908" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4909"><span class="mi" id="MathJax-Span-4910" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4911" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-4912" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-429">\eta =
0.5</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-430-Frame"><nobr><span class="math" id="MathJax-Span-4913" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4914"><span class="mn" id="MathJax-Span-4915" style="font-family: MathJax_Main;">0.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-430">0.1</script>, since that makes the results a little more easily
visible in the graphs.  We can train using the old method of weight
initialization:
</p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">large_weight_initializer</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

We can also train using the new approach to weight initialization.
This is actually even easier, since <tt>network2</tt>'s default way of
initializing the weights is using this new approach.  That means we
can omit the <tt>net.large_weight_initializer()</tt> call above:
<div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

Plotting the results*<span class="marginnote">
*The program used to generate this and
  the next graph is
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/weight_initialization.py">weight_initialization.py</a>.</span>,
we obtain:<p></p><p></p><center><img src="./Neural networks and deep learning 3_files/weight_initialization_30.png" width="520px"></center><p></p><p>In both cases, we end up with a classification accuracy somewhat over
96 percent.  The final classification accuracy is almost exactly the
same in the two cases.  But the new initialization technique brings us
there much, much faster.  At the end of the first epoch of training
the old approach to weight initialization has a classification
accuracy under 87 percent, while the new approach is already almost 93
percent.  What appears to be going on is that our new approach to
weight initialization starts us off in a much better regime, which
lets us get good results much more quickly.  The same phenomenon is
also seen if we plot results with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-431-Frame"><nobr><span class="math" id="MathJax-Span-4916" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4917"><span class="mn" id="MathJax-Span-4918" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-431">100</script> hidden neurons:</p><p></p><center><img src="./Neural networks and deep learning 3_files/weight_initialization_100.png" width="520px"></center><p></p><p>In this case, the two curves don't quite meet.  However, my
experiments suggest that with just a few more epochs of training (not
shown) the accuracies become almost exactly the same.  So on the basis
of these experiments it looks as though the improved weight
initialization only speeds up learning, it doesn't change the final
performance of our networks.  However, in Chapter 4 we'll see examples
of neural networks where the long-run behaviour is significantly
better with the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-432-Frame"><nobr><span class="math" id="MathJax-Span-4919" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4920"><span class="mn" id="MathJax-Span-4921" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-4922"><span class="mrow" id="MathJax-Span-4923"><span class="mo" id="MathJax-Span-4924" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-4925"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4926"><span class="msubsup" id="MathJax-Span-4927"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4928" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="texatom" id="MathJax-Span-4929"><span class="mrow" id="MathJax-Span-4930"><span class="mi" id="MathJax-Span-4931" style="font-size: 70.7%; font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4932" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.409em; left: 0.836em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.591em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.248em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -3.87em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-432">1/\sqrt{n_{\rm in}}</script> weight initialization.  Thus
it's not only the speed of learning which is improved, it's sometimes
also the final performance.</p><p>The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-433-Frame"><nobr><span class="math" id="MathJax-Span-4933" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4934"><span class="mn" id="MathJax-Span-4935" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-4936"><span class="mrow" id="MathJax-Span-4937"><span class="mo" id="MathJax-Span-4938" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-4939"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4940"><span class="msubsup" id="MathJax-Span-4941"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4942" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="texatom" id="MathJax-Span-4943"><span class="mrow" id="MathJax-Span-4944"><span class="mi" id="MathJax-Span-4945" style="font-size: 70.7%; font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4946" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.409em; left: 0.836em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.591em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.248em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -3.87em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-433">1/\sqrt{n_{\rm in}}</script> approach to weight initialization helps
improve the way our neural nets learn.  Other techniques for weight
initialization have also been proposed, many building on this basic
idea.  I won't review the other approaches here, since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-434-Frame"><nobr><span class="math" id="MathJax-Span-4947" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4948"><span class="mn" id="MathJax-Span-4949" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-4950"><span class="mrow" id="MathJax-Span-4951"><span class="mo" id="MathJax-Span-4952" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-4953"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4954"><span class="msubsup" id="MathJax-Span-4955"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-4956" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="texatom" id="MathJax-Span-4957"><span class="mrow" id="MathJax-Span-4958"><span class="mi" id="MathJax-Span-4959" style="font-size: 70.7%; font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-4960" style="font-size: 70.7%; font-family: MathJax_Main;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 3.924em -999.998em); top: -4.409em; left: 0.836em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: -0.096em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -4.017em; left: 0.591em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -4.017em; left: 0.248em;"><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -3.87em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-434">1/\sqrt{n_{\rm
    in}}</script> works well enough for our purposes.  If you're interested in
looking further, I recommend looking at the discussion on pages 14 and
15 of a 2012 paper by Yoshua
Bengio*<span class="marginnote">
*<a href="http://arxiv.org/pdf/1206.5533v2.pdf">Practical
    Recommendations for Gradient-Based Training of Deep
    Architectures</a>, by Yoshua Bengio (2012).</span>, as well as the
references therein.</p><p></p><h4><a name="problem_735589"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_735589">Problem</a></h4><ul>
<li><strong>Connecting regularization and the improved method of weight
  initialization</strong> L2 regularization sometimes automatically gives us
  something similar to the new approach to weight initialization.
  Suppose we are using the old approach to weight initialization.
  Sketch a heuristic argument that: (1) supposing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-435-Frame"><nobr><span class="math" id="MathJax-Span-4961" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4962"><span class="mi" id="MathJax-Span-4963" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-435">\lambda</script> is not too
  small, the first epochs of training will be dominated almost
  entirely by weight decay; (2) provided <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-436-Frame"><nobr><span class="math" id="MathJax-Span-4964" role="math" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4965"><span class="mi" id="MathJax-Span-4966" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4967" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-4968" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-4969" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-436">\eta \lambda \ll n</script> the
  weights will decay by a factor of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-437-Frame"><nobr><span class="math" id="MathJax-Span-4970" role="math" style="width: 5.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4971"><span class="mi" id="MathJax-Span-4972" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-4973"></span><span class="mo" id="MathJax-Span-4974" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-4975" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-4976" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-4977" style="font-family: MathJax_Math-italic;"></span><span class="texatom" id="MathJax-Span-4978"><span class="mrow" id="MathJax-Span-4979"><span class="mo" id="MathJax-Span-4980" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-4981" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4982" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-437">\exp(-\eta \lambda / m)</script> per
  epoch; and (3) supposing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-438-Frame"><nobr><span class="math" id="MathJax-Span-4983" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4984"><span class="mi" id="MathJax-Span-4985" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-438">\lambda</script> is not too large, the weight
  decay will tail off when the weights are down to a size around
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-439-Frame"><nobr><span class="math" id="MathJax-Span-4986" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4987"><span class="mn" id="MathJax-Span-4988" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-4989"><span class="mrow" id="MathJax-Span-4990"><span class="mo" id="MathJax-Span-4991" style="font-family: MathJax_Main;">/</span></span></span><span class="msqrt" id="MathJax-Span-4992"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.836em;"><span class="mrow" id="MathJax-Span-4993"><span class="mi" id="MathJax-Span-4994" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.934em 1000.002em 1.277em -999.998em); top: -1.811em; left: 0.836em;"><span style="border-left-width: 0.591em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: -0.047em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.365em -999.998em); top: -3.968em; left: 0.002em;"><span style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-439">1/\sqrt{n}</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-440-Frame"><nobr><span class="math" id="MathJax-Span-4995" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4996"><span class="mi" id="MathJax-Span-4997" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-440">n</script> is the total number of weights in the
  network.  Argue that these conditions are all satisfied in the
  examples graphed in this section.
</li></ul><p></p><p></p><p></p><p></p><p></p><p></p><p></p><h3><a name="handwriting_recognition_revisited_the_code"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code">Handwriting recognition revisited: the code</a></h3><p></p><p>Let's implement the ideas we've discussed in this chapter.  We'll
develop a new program,
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network2.py"><tt>network2.py</tt></a>,
which is an improved version of the program
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network.py"><tt>network.py</tt></a>
we developed in
<a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits">Chapter
  1</a>.  If you haven't looked at <tt>network.py</tt> in a while then you
may find it helpful to spend a few minutes quickly reading over the
earlier discussion.  It's only 74 lines of code, and is easily
understood. </p><p>As was the case in <tt>network.py</tt>, the star of <tt>network2.py</tt>
is the <tt>Network</tt> class, which we use to represent our neural
networks.  We initialize an instance of <tt>Network</tt> with a list of
<tt>sizes</tt> for the respective layers in the network, and a choice
for the <tt>cost</tt> to use, defaulting to the cross-entropy:</p><p></p><div class="highlight"><pre><span class="k">class</span> <span class="nc">Network</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="n">CrossEntropyCost</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_weight_initializer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">=</span><span class="n">cost</span>
</pre></div>
<p></p><p>The first couple of lines of the <tt>__init__</tt> method are the same
as in <tt>network.py</tt>, and are pretty self-explanatory.  But the
next two lines are new, and we need to understand what they're doing
in detail.</p><p>Let's start by examining the <tt>default_weight_initializer</tt>
method. This makes use of our <a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">new and
  improved approach</a> to weight initialization.  As we've seen, in that
approach the weights input to a neuron are initialized as Gaussian
random variables with mean 0 and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-441-Frame"><nobr><span class="math" id="MathJax-Span-4998" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-4999"><span class="mn" id="MathJax-Span-5000" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-441">1</script> divided by the
square root of the number of connections input to the neuron.  Also in
this method we'll initialize the biases, using Gaussian random
variables with mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-442-Frame"><nobr><span class="math" id="MathJax-Span-5001" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5002"><span class="mn" id="MathJax-Span-5003" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-442">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-443-Frame"><nobr><span class="math" id="MathJax-Span-5004" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5005"><span class="mn" id="MathJax-Span-5006" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-443">1</script>.  Here's the code:</p><p></p><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">default_weight_initializer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</pre></div>
<p></p><p>To understand the code, it may help to recall that <tt>np</tt> is the
Numpy library for doing linear algebra.  We'll <tt>import</tt> Numpy at
the beginning of our program.  Also, notice that we don't initialize
any biases for the first layer of neurons.  We avoid doing this
because the first layer is an input layer, and so any biases would not
be used.  We did exactly the same thing in <tt>network.py</tt>.</p><p>Complementing the <tt>default_weight_initializer</tt> we'll also include
a <tt>large_weight_initializer</tt> method.  This method initializes the
weights and biases using the old approach from Chapter 1, with both
weights and biases initialized as Gaussian random variables with mean
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-444-Frame"><nobr><span class="math" id="MathJax-Span-5007" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5008"><span class="mn" id="MathJax-Span-5009" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-444">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-445-Frame"><nobr><span class="math" id="MathJax-Span-5010" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5011"><span class="mn" id="MathJax-Span-5012" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-445">1</script>.  The code is, of course, only a tiny
bit different from the <tt>default_weight_initializer</tt>:</p><p></p><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">large_weight_initializer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</pre></div>
<p></p><p>I've included the <tt>large_weight_initializer</tt> method mostly as a
convenience to make it easier to compare the results in this chapter
to those in Chapter 1. I can't think of many practical situations
where I would recommend using it!</p><p>The second new thing in <tt>Network</tt>'s <tt>__init__</tt> method is
that we now initialize a <tt>cost</tt> attribute.  To understand how
that works, let's look at the class we use to represent the
cross-entropy cost*<span class="marginnote">
*If you're not familiar with Python's
  static methods you can ignore the <tt>@staticmethod</tt> decorators,
  and just treat <tt>fn</tt> and <tt>delta</tt> as ordinary methods.  If
  you're curious about details, all <tt>@staticmethod</tt> does is tell
  the Python interpreter that the method which follows doesn't depend
  on the object in any way.  That's why <tt>self</tt> isn't passed as a
  parameter to the <tt>fn</tt> and <tt>delta</tt> methods.</span>:</p><p></p><div class="highlight"><pre><span class="k">class</span> <span class="nc">CrossEntropyCost</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
</pre></div>
<p></p><p>Let's break this down.  The first thing to observe is that even though
the cross-entropy is, mathematically speaking, a function, we've
implemented it as a Python class, not a Python function.  Why have I
made that choice?  The reason is that the cost plays two different
roles in our network.  The obvious role is that it's a measure of how
well an output activation, <tt>a</tt>, matches the desired output,
<tt>y</tt>.  This role is captured by the <tt>CrossEntropyCost.fn</tt>
method.  (Note, by the way, that the <tt>np.nan_to_num</tt> call inside
<tt>CrossEntropyCost.fn</tt> ensures that Numpy deals correctly with the
log of numbers very close to zero.)  But there's also a second way the
cost function enters our network.  Recall from
<a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">Chapter
  2</a> that when running the backpropagation algorithm we need to
compute the network's output error, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-446-Frame"><nobr><span class="math" id="MathJax-Span-5013" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5014"><span class="msubsup" id="MathJax-Span-5015"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5016" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-5017" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-446">\delta^L</script>. The form of the output
error depends on the choice of cost function: different cost function,
different form for the output error.  For the cross-entropy the output
error is, as we saw in Equation <span id="margin_95474680082_reveal" class="equation_link">(66)</span><span id="margin_95474680082" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn66" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-447-Frame"><nobr><span class="math" id="MathJax-Span-5018" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5019"><span class="mtable" id="MathJax-Span-5020" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.365em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5021"><span class="mrow" id="MathJax-Span-5022"><span class="msubsup" id="MathJax-Span-5023"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5024" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-5025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5026" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-5027" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5028" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-5029" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5030" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5031" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5032" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-447">\begin{eqnarray} 
    \delta^L = a^L-y.
   \nonumber\end{eqnarray}</script></a></span><script>$('#margin_95474680082_reveal').click(function() {$('#margin_95474680082').toggle('slow', function() {});});</script>,</p><p><a class="displaced_anchor" name="eqtn99"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-448-Frame"><nobr><span class="math" id="MathJax-Span-5033" role="math" style="width: 100%; display: inline-block; min-width: 12.061em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.061em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5034"><span class="mtable" id="MathJax-Span-5035" style="min-width: 12.306em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.061em;"><span style="display: inline-block; position: absolute; width: 5.591em; height: 0px; clip: rect(-0.978em 1000.002em 0.493em -999.998em); top: 0.002em; left: 50%; margin-left: -2.792em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5039"><span class="mrow" id="MathJax-Span-5040"><span class="msubsup" id="MathJax-Span-5041"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5042" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-5043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5044" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-5045" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5046" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-5047" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5048" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5049" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5050" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.831em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-99"><span class="mrow" id="MathJax-Span-5037"><span class="mtext" id="MathJax-Span-5038" style="font-family: MathJax_Main;">(99)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-448">\begin{eqnarray}
  \delta^L = a^L-y.
\tag{99}\end{eqnarray}</script>
For this reason we define a second method,
<tt>CrossEntropyCost.delta</tt>, whose purpose is to tell our network
how to compute the output error.  And then we bundle these two methods
up into a single class containing everything our networks need to know
about the cost function.</p><p>In a similar way, <tt>network2.py</tt> also contains a class to
represent the quadratic cost function.  This is included for
comparison with the results of Chapter 1, since going forward we'll
mostly use the cross entropy.  The code is just below.  The
<tt>QuadraticCost.fn</tt> method is a straightfoward computation of the
quadratic cost associated to the actual output, <tt>a</tt>, and the
desired output, <tt>y</tt>.  The value returned by
<tt>QuadraticCost.delta</tt> is based on the
expression <span id="margin_191893049698_reveal" class="equation_link">(30)</span><span id="margin_191893049698" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap2.html#eqtn30" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-449-Frame"><nobr><span class="math" id="MathJax-Span-5051" role="math" style="width: 10.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5052"><span class="mtable" id="MathJax-Span-5053" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.1em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.1em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5054"><span class="mrow" id="MathJax-Span-5055"><span class="msubsup" id="MathJax-Span-5056"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5057" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mi" id="MathJax-Span-5058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5059" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-5060" style="font-family: MathJax_Main; padding-left: 0.297em;">(</span><span class="msubsup" id="MathJax-Span-5061"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5062" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-5063" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5064" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5065" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5066" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5067" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msup" id="MathJax-Span-5068" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5069" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.64em;"><span class="mo" id="MathJax-Span-5070" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5071" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-5072"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5073" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mi" id="MathJax-Span-5074" style="font-size: 70.7%; font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5075" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.398em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-449">\begin{eqnarray} 
  \delta^L = (a^L-y) \odot \sigma'(z^L) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_191893049698_reveal').click(function() {$('#margin_191893049698').toggle('slow', function() {});});</script> for the output error for the
quadratic cost, which we derived back in Chapter 2.</p><p></p><div class="highlight"><pre><span class="k">class</span> <span class="nc">QuadraticCost</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigmoid_prime_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
<p></p><p>We've now understood the main differences between <tt>network2.py</tt>
and <tt>network.py</tt>.  It's all pretty simple stuff.  There are a
number of smaller changes, which I'll discuss below, including the
implementation of L2 regularization.  Before getting to that, let's
look at the complete code for <tt>network2.py</tt>.  You don't need to
read all the code in detail, but it is worth understanding the broad
structure, and in particular reading the documentation strings, so you
understand what each piece of the program is doing.  Of course, you're
also welcome to delve as deeply as you wish!  If you get lost, you may
wish to continue reading the prose below, and return to the code
later.  Anyway, here's the code:</p><p></p><div class="highlight"><pre><span class="sd">"""network2.py</span>
<span class="sd">~~~~~~~~~~~~~~</span>

<span class="sd">An improved version of network.py, implementing the stochastic</span>
<span class="sd">gradient descent learning algorithm for a feedforward neural network.</span>
<span class="sd">Improvements include the addition of the cross-entropy cost function,</span>
<span class="sd">regularization, and better initialization of network weights.  Note</span>
<span class="sd">that I have focused on making the code simple, easily readable, and</span>
<span class="sd">easily modifiable.  It is not optimized, and omits many desirable</span>
<span class="sd">features.</span>

<span class="sd">"""</span>

<span class="c">#### Libraries</span>
<span class="c"># Standard library</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c"># Third-party libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="c">#### Define the quadratic and cross-entropy cost functions</span>

<span class="k">class</span> <span class="nc">QuadraticCost</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return the cost associated with an output ``a`` and desired output</span>
<span class="sd">        ``y``.</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return the error delta from the output layer."""</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigmoid_prime_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CrossEntropyCost</span><span class="p">:</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return the cost associated with an output ``a`` and desired output</span>
<span class="sd">        ``y``.  Note that np.nan_to_num is used to ensure numerical</span>
<span class="sd">        stability.  In particular, if both ``a`` and ``y`` have a 1.0</span>
<span class="sd">        in the same slot, then the expression (1-y)*np.log(1-a)</span>
<span class="sd">        returns nan.  The np.nan_to_num ensures that that is converted</span>
<span class="sd">        to the correct value (0.0).</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">delta</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return the error delta from the output layer.  Note that the</span>
<span class="sd">        parameter ``z`` is not used by the method.  It is included in</span>
<span class="sd">        the method's parameters in order to make the interface</span>
<span class="sd">        consistent with the delta method for other cost classes.</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>


<span class="c">#### Main Network class</span>
<span class="k">class</span> <span class="nc">Network</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">cost</span><span class="o">=</span><span class="n">CrossEntropyCost</span><span class="p">):</span>
        <span class="sd">"""The list ``sizes`` contains the number of neurons in the respective</span>
<span class="sd">        layers of the network.  For example, if the list was [2, 3, 1]</span>
<span class="sd">        then it would be a three-layer network, with the first layer</span>
<span class="sd">        containing 2 neurons, the second layer 3 neurons, and the</span>
<span class="sd">        third layer 1 neuron.  The biases and weights for the network</span>
<span class="sd">        are initialized randomly, using</span>
<span class="sd">        ``self.default_weight_initializer`` (see docstring for that</span>
<span class="sd">        method).</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_weight_initializer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">=</span><span class="n">cost</span>

    <span class="k">def</span> <span class="nf">default_weight_initializer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Initialize each weight using a Gaussian distribution with mean 0</span>
<span class="sd">        and standard deviation 1 over the square root of the number of</span>
<span class="sd">        weights connecting to the same neuron.  Initialize the biases</span>
<span class="sd">        using a Gaussian distribution with mean 0 and standard</span>
<span class="sd">        deviation 1.</span>

<span class="sd">        Note that the first layer is assumed to be an input layer, and</span>
<span class="sd">        by convention we won't set any biases for those neurons, since</span>
<span class="sd">        biases are only ever used in computing the outputs from later</span>
<span class="sd">        layers.</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

    <span class="k">def</span> <span class="nf">large_weight_initializer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">"""Initialize the weights using a Gaussian distribution with mean 0</span>
<span class="sd">        and standard deviation 1.  Initialize the biases using a</span>
<span class="sd">        Gaussian distribution with mean 0 and standard deviation 1.</span>

<span class="sd">        Note that the first layer is assumed to be an input layer, and</span>
<span class="sd">        by convention we won't set any biases for those neurons, since</span>
<span class="sd">        biases are only ever used in computing the outputs from later</span>
<span class="sd">        layers.</span>

<span class="sd">        This weight and bias initializer uses the same approach as in</span>
<span class="sd">        Chapter 1, and is included for purposes of comparison.  It</span>
<span class="sd">        will usually be better to use the default weight initializer</span>
<span class="sd">        instead.</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

    <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">"""Return the output of the network if ``a`` is input."""</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sigmoid_vec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">SGD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> 
            <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> 
            <span class="n">evaluation_data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
            <span class="n">monitor_evaluation_cost</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">monitor_training_cost</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> 
            <span class="n">monitor_training_accuracy</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">"""Train the neural network using mini-batch stochastic gradient</span>
<span class="sd">        descent.  The ``training_data`` is a list of tuples ``(x, y)``</span>
<span class="sd">        representing the training inputs and the desired outputs.  The</span>
<span class="sd">        other non-optional parameters are self-explanatory, as is the</span>
<span class="sd">        regularization parameter ``lmbda``.  The method also accepts</span>
<span class="sd">        ``evaluation_data``, usually either the validation or test</span>
<span class="sd">        data.  We can monitor the cost and accuracy on either the</span>
<span class="sd">        evaluation data or the training data, by setting the</span>
<span class="sd">        appropriate flags.  The method returns a tuple containing four</span>
<span class="sd">        lists: the (per-epoch) costs on the evaluation data, the</span>
<span class="sd">        accuracies on the evaluation data, the costs on the training</span>
<span class="sd">        data, and the accuracies on the training data.  All values are</span>
<span class="sd">        evaluated at the end of each training epoch.  So, for example,</span>
<span class="sd">        if we train for 30 epochs, then the first element of the tuple</span>
<span class="sd">        will be a 30-element list containing the cost on the</span>
<span class="sd">        evaluation data at the end of each epoch. Note that the lists</span>
<span class="sd">        are empty if the corresponding flag is not set.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">evaluation_data</span><span class="p">:</span> <span class="n">n_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">evaluation_data</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
        <span class="n">evaluation_cost</span><span class="p">,</span> <span class="n">evaluation_accuracy</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">training_cost</span><span class="p">,</span> <span class="n">training_accuracy</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
            <span class="n">mini_batches</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">training_data</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="n">mini_batch_size</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">mini_batch</span> <span class="ow">in</span> <span class="n">mini_batches</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_mini_batch</span><span class="p">(</span>
                    <span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">lmbda</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="p">))</span>
            <span class="k">print</span> <span class="s">"Epoch </span><span class="si">%s</span><span class="s"> training complete"</span> <span class="o">%</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">monitor_training_cost</span><span class="p">:</span>
                <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_cost</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">lmbda</span><span class="p">)</span>
                <span class="n">training_cost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">"Cost on training data: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">monitor_training_accuracy</span><span class="p">:</span>
                <span class="n">accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">training_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">"Accuracy on training data: {} / {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">accuracy</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">monitor_evaluation_cost</span><span class="p">:</span>
                <span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_cost</span><span class="p">(</span><span class="n">evaluation_data</span><span class="p">,</span> <span class="n">lmbda</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">evaluation_cost</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">"Cost on evaluation data: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">monitor_evaluation_accuracy</span><span class="p">:</span>
                <span class="n">accuracy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">evaluation_data</span><span class="p">)</span>
                <span class="n">evaluation_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">"Accuracy on evaluation data: {} / {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">evaluation_data</span><span class="p">),</span> <span class="n">n_data</span><span class="p">)</span>
            <span class="k">print</span>
        <span class="k">return</span> <span class="n">evaluation_cost</span><span class="p">,</span> <span class="n">evaluation_accuracy</span><span class="p">,</span> \
            <span class="n">training_cost</span><span class="p">,</span> <span class="n">training_accuracy</span>

    <span class="k">def</span> <span class="nf">update_mini_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">lmbda</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">"""Update the network's weights and biases by applying gradient</span>
<span class="sd">        descent using backpropagation to a single mini batch.  The</span>
<span class="sd">        ``mini_batch`` is a list of tuples ``(x, y)``, ``eta`` is the</span>
<span class="sd">        learning rate, ``lmbda`` is the regularization parameter, and</span>
<span class="sd">        ``n`` is the total size of the training data set.</span>

<span class="sd">        """</span>
        <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">]</span>
        <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">mini_batch</span><span class="p">:</span>
            <span class="n">delta_nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb</span><span class="o">+</span><span class="n">dnb</span> <span class="k">for</span> <span class="n">nb</span><span class="p">,</span> <span class="n">dnb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_b</span><span class="p">)]</span>
            <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">nw</span><span class="o">+</span><span class="n">dnw</span> <span class="k">for</span> <span class="n">nw</span><span class="p">,</span> <span class="n">dnw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_w</span><span class="p">,</span> <span class="n">delta_nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="p">(</span><span class="n">lmbda</span><span class="o">/</span><span class="n">n</span><span class="p">))</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nw</span> 
                        <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">nw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nb</span> 
                       <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="n">nabla_b</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return a tuple ``(nabla_b, nabla_w)`` representing the</span>
<span class="sd">        gradient for the cost function C_x.  ``nabla_b`` and</span>
<span class="sd">        ``nabla_w`` are layer-by-layer lists of numpy arrays, similar</span>
<span class="sd">        to ``self.biases`` and ``self.weights``."""</span>
        <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">]</span>
        <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span>
        <span class="c"># feedforward</span>
        <span class="n">activation</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">activations</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="c"># list to store all the activations, layer by layer</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># list to store all the z vectors, layer by layer</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">activation</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
            <span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">activation</span> <span class="o">=</span> <span class="n">sigmoid_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="c"># backward pass</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">nabla_b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>
        <span class="n">nabla_w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
        <span class="c"># Note that the variable l in the loop below is used a little</span>
        <span class="c"># differently to the notation in Chapter 2 of the book.  Here,</span>
        <span class="c"># l = 1 means the last layer of neurons, l = 2 is the</span>
        <span class="c"># second-last layer, and so on.  It's a renumbering of the</span>
        <span class="c"># scheme in the book, used here to take advantage of the fact</span>
        <span class="c"># that Python can use negative indices in lists.</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span>
            <span class="n">spv</span> <span class="o">=</span> <span class="n">sigmoid_prime_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">spv</span>
            <span class="n">nabla_b</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>
            <span class="n">nabla_w</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nabla_b</span><span class="p">,</span> <span class="n">nabla_w</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">accuracy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">"""Return the number of inputs in ``data`` for which the neural</span>
<span class="sd">        network outputs the correct result. The neural network's</span>
<span class="sd">        output is assumed to be the index of whichever neuron in the</span>
<span class="sd">        final layer has the highest activation.  </span>

<span class="sd">        The flag ``convert`` should be set to False if the data set is</span>
<span class="sd">        validation or test data (the usual case), and to True if the</span>
<span class="sd">        data set is the training data. The need for this flag arises</span>
<span class="sd">        due to differences in the way the results ``y`` are</span>
<span class="sd">        represented in the different data sets.  In particular, it</span>
<span class="sd">        flags whether we need to convert between the different</span>
<span class="sd">        representations.  It may seem strange to use different</span>
<span class="sd">        representations for the different data sets.  Why not use the</span>
<span class="sd">        same representation for all three data sets?  It's done for</span>
<span class="sd">        efficiency reasons -- the program usually evaluates the cost</span>
<span class="sd">        on the training data and the accuracy on other data sets.</span>
<span class="sd">        These are different types of computations, and using different</span>
<span class="sd">        representations speeds things up.  More details on the</span>
<span class="sd">        representations can be found in</span>
<span class="sd">        mnist_loader.load_data_wrapper.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> 
                       <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">y</span><span class="p">)</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">results</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">total_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lmbda</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">"""Return the total cost for the data set ``data``.  The flag</span>
<span class="sd">        ``convert`` should be set to False if the data set is the</span>
<span class="sd">        training data (the usual case), and to True if the data set is</span>
<span class="sd">        the validation or test data.  See comments on the similar (but</span>
<span class="sd">        reversed) convention for the ``accuracy`` method, above.</span>
<span class="sd">        """</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">convert</span><span class="p">:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vectorized_result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">cost</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">fn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cost</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">lmbda</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cost</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">"""Save the neural network to the file ``filename``."""</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"sizes"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span><span class="p">,</span>
                <span class="s">"weights"</span><span class="p">:</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">],</span>
                <span class="s">"biases"</span><span class="p">:</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">],</span>
                <span class="s">"cost"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="o">.</span><span class="n">__name__</span><span class="p">)}</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c">#### Loading a Network</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""Load a neural network from the file ``filename``.  Returns an</span>
<span class="sd">    instance of Network.</span>

<span class="sd">    """</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">__name__</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s">"cost"</span><span class="p">])</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"sizes"</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">cost</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">"weights"</span><span class="p">]]</span>
    <span class="n">net</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">"biases"</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">net</span>

<span class="c">#### Miscellaneous functions</span>
<span class="k">def</span> <span class="nf">vectorized_result</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
    <span class="sd">"""Return a 10-dimensional unit vector with a 1.0 in the j'th position</span>
<span class="sd">    and zeroes elsewhere.  This is used to convert a digit (0...9)</span>
<span class="sd">    into a corresponding desired output from the neural network.</span>

<span class="sd">    """</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">e</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">e</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">"""The sigmoid function."""</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>

<span class="n">sigmoid_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sigmoid_prime</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">"""Derivative of the sigmoid function."""</span>
    <span class="k">return</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

<span class="n">sigmoid_prime_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">sigmoid_prime</span><span class="p">)</span>
</pre></div>
<p></p><p>One of the more interesting changes in the code is to include L2
regularization.  Although this is a major conceptual change, it's so
trivial to implement that it's easy to miss in the code.  For the most
part it just involves passing the parameter <tt>lmbda</tt> to various
methods, notably the <tt>Network.SGD</tt> method.  The real work is done
in a single line of the program, the fourth-last line of the
<tt>Network.update_mini_batch</tt> method.  That's where we modify the
gradient descent update rule to include weight decay.  But although
the modification is tiny, it has a big impact on results!</p><p>This is, by the way, common when implementing new techniques in neural
networks.  We've spent thousands of words discussing regularization.
It's conceptually quite subtle and difficult to understand.  And yet
it was trivial to add to our program!  It occurs surprisingly often
that sophisticated techniques can be implemented with small changes to
code.</p><p>Another small but important change to our code is the addition of
several optional flags to the stochastic gradient descent method,
<tt>Network.SGD</tt>.  These flags make it possible to monitor the cost
and accuracy either on the <tt>training_data</tt> or on a set of
<tt>evaluation_data</tt> which can be passed to <tt>Network.SGD</tt>.
We've used these flags often earlier in the chapter, but let me give
an example of how it works, just to remind you:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">cost</span><span class="o">=</span><span class="n">network2</span><span class="o">.</span><span class="n">CrossEntropyCost</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_training_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_training_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>Here, we're setting the <tt>evaluation_data</tt> to be the
<tt>validation_data</tt>.  But we could also have monitored performance
on the <tt>test_data</tt> or any other data set.  We also have four
flags telling us to monitor the cost and accuracy on both the
<tt>evaluation_data</tt> and the <tt>training_data</tt>.  Those flags are
<tt>False</tt> by default, but they've been turned on here in order to
monitor our <tt>Network</tt>'s performance.  Furthermore,
<tt>network2.py</tt>'s <tt>Network.SGD</tt> method returns a four-element
tuple representing the results of the monitoring.  We can use this as
follows:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">evaluation_cost</span><span class="p">,</span> <span class="n">evaluation_accuracy</span><span class="p">,</span> 
<span class="o">...</span> <span class="n">training_cost</span><span class="p">,</span> <span class="n">training_accuracy</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_evaluation_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_training_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="o">...</span> <span class="n">monitor_training_cost</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p></p><p>So, for example, <tt>evaluation_cost</tt> will be a 30-element list
containing the cost on the evaluation data at the end of each epoch.
This sort of information is extremely useful in understanding a
network's behaviour.  It can, for example, be used to draw graphs
showing how the network learns over time.  Indeed, that's exactly how
I constructed all the graphs earlier in the chapter.  Note, however,
that if any of the monitoring flags are not set, then the
corresponding element in the tuple will be the empty list.</p><p>Other additions to the code include a <tt>Network.save</tt> method, to
save <tt>Network</tt> objects to disk, and a function to <tt>load</tt>
them back in again later.  Note that the saving and loading is done
using JSON, not Python's <tt>pickle</tt> or <tt>cPickle</tt> modules,
which are the usual way we save and load objects to and from disk in
Python.  Using JSON requires more code than <tt>pickle</tt> or
<tt>cPickle</tt> would.  To understand why I've used JSON, imagine that
at some time in the future we decided to change our <tt>Network</tt>
class to allow neurons other than sigmoid neurons.  To implement that
change we'd most likely change the attributes defined in the
<tt>Network.__init__</tt> method.  If we've simply pickled the objects
that would cause our <tt>load</tt> function to fail.  Using JSON to do
the serialization explicitly makes it easy to ensure that old
<tt>Network</tt>s will still <tt>load</tt>.</p><p>There are many other minor changes in the code for <tt>network2.py</tt>,
but they're all simple variations on <tt>network.py</tt>.  The net
result is to expand our 74-line program to a far more capable 152
lines.</p><p></p><h4><a name="problems_201277"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problems_201277">Problems</a></h4><ul>
<li> Modify the code above to implement L1 regularization, and use L1
  regularization to classify MNIST digits using a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-450-Frame"><nobr><span class="math" id="MathJax-Span-5076" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5077"><span class="mn" id="MathJax-Span-5078" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-450">30</script> hidden neuron
  network.  Can you find a regularization parameter that enables you
  to do better than running unregularized?<p></p><p></p></li><li> Take a look at the <tt>Network.cost_derivative</tt> method in
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network.py"><tt>network.py</tt></a>.
  That method was written for the quadratic cost.  How would you
  rewrite the method for the cross-entropy cost?  Can you think of a
  problem that might arise in the cross-entropy version?  In
  <tt>network2.py</tt> we've eliminated the
  <tt>Network.cost_derivative</tt> method entirely, instead
  incorporating its functionality into the
  <tt>CrossEntropyCost.delta</tt> method.  How does this solve the
  problem you've just identified?<p></p><p></p></li></ul><p></p><p></p><h3><a name="how_to_choose_a_neural_network&#39;s_hyper-parameters"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">How to choose a neural network's hyper-parameters?</a></h3><p></p><p>Up until now I haven't explained how I've been choosing values for
hyper-parameters such as the learning rate, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-451-Frame"><nobr><span class="math" id="MathJax-Span-5079" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5080"><span class="mi" id="MathJax-Span-5081" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-451">\eta</script>, the regularization
parameter, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-452-Frame"><nobr><span class="math" id="MathJax-Span-5082" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5083"><span class="mi" id="MathJax-Span-5084" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-452">\lambda</script>, and so on.  I've just been supplying values
which work pretty well.  In practice, when you're using neural nets to
attack a problem, it can be difficult to find good hyper-parameters.
Imagine, for example, that we've just been introduced to the MNIST
problem, and have begun working on it, knowing nothing at all about
what hyper-parameters to use.  Let's suppose that by good fortune in
our first experiments we choose many of the hyper-parameters in the
same way as was done earlier this chapter: 30 hidden neurons, a
mini-batch size of 10, training for 30 epochs using the cross-entropy.
But we choose a learning rate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-453-Frame"><nobr><span class="math" id="MathJax-Span-5085" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5086"><span class="mi" id="MathJax-Span-5087" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5088" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5089" style="font-family: MathJax_Main; padding-left: 0.297em;">10.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-453">\eta = 10.0</script> and regularization
parameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-454-Frame"><nobr><span class="math" id="MathJax-Span-5090" role="math" style="width: 4.855em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.757em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5091"><span class="mi" id="MathJax-Span-5092" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-5093" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5094" style="font-family: MathJax_Main; padding-left: 0.297em;">1000.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-454">\lambda = 1000.0</script>.  Here's what I saw on one such run:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">,</span>
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Epoch</span> <span class="mi">0</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">1030</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="n">Epoch</span> <span class="mi">1</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">990</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="n">Epoch</span> <span class="mi">2</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="o">...</span>

<span class="n">Epoch</span> <span class="mi">27</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="n">Epoch</span> <span class="mi">28</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">983</span> <span class="o">/</span> <span class="mi">10000</span>

<span class="n">Epoch</span> <span class="mi">29</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">967</span> <span class="o">/</span> <span class="mi">10000</span>
</pre></div>
<p></p><p>Our classification accuracies are no better than chance!  Our network
is acting as a random noise generator!</p><p>"Well, that's easy to fix," you might say, "just decrease the
learning rate and regularization hyper-parameters".  Unfortunately,
you don't <em>a priori</em> know those are the hyper-parameters you need
to adjust.  Maybe the real problem is that our 30 hidden neuron
network will never work well, no matter how the other hyper-parameters
are chosen?  Maybe we really need at least 100 hidden neurons?  Or 300
hidden neurons?  Or multiple hidden layers?  Or a different approach
to encoding the output?  Maybe our network is learning, but we need to
train for more epochs?  Maybe the mini-batches are too small?  Maybe
we'd do better switching back to the quadratic cost function?  Maybe
we need to try a different approach to weight initialization?  And so
on, on and on and on.  It's easy to feel lost in hyper-parameter
space.  This can be particularly frustrating if your network is very
large, or uses a lot of training data, since you may train for hours
or days or weeks, only to get no result.  If the situation persists,
it damages your confidence.  Maybe neural networks are the wrong
approach to your problem?  Maybe you should quit your job and take up
beekeeping?</p><p>In this section I explain some heuristics which can be used to set the
hyper-parameters in a neural network.  The goal is to help you develop
a workflow that enables you to do a pretty good job setting
hyper-parameters.  Of course, I won't cover everything about
hyper-parameter optimization.  That's a huge subject, and it's not, in
any case, a problem that is ever completely solved, nor is there
universal agreement amongst practitioners on the right strategies to
use.  There's always one more trick you can try to eke out a bit more
performance from your network.  But the heuristics in this section
should get you started.</p><p><strong>Broad strategy:</strong> When using neural networks to attack a new
problem the first challenge is to get <em>any</em> non-trivial learning,
i.e., for the network to achieve results better than chance.  This can
be surprisingly difficult, especially when confronting a new class of
problem.  Let's look at some strategies you can use if you're having
this kind of trouble.</p><p>Suppose, for example, that you're attacking MNIST for the first time.
You start out enthusiastic, but are a little discouraged when your
first network fails completely, as in the example above.  The way to
go is to strip the problem down.  Get rid of all the training and
validation images except images which are 0s or 1s.  Then try to train
a network to distinguish 0s from 1s.  Not only is that an inherently
easier problem than distinguishing all ten digits, it also reduces the
amount of training data by 80 percent, speeding up training by a
factor of 5.  That enables much more rapid experimentation, and so
gives you more rapid insight into how to build a good network.</p><p>You can further speed up experimentation by stripping your network
down to the simplest network likely to do meaningful learning.  If you
believe a <tt>[784, 10]</tt> network can likely do better-than-chance
classification of MNIST digits, then begin your experimentation with
such a network.  It'll be much faster than training a
<tt>[784, 30, 10]</tt> network, and you can build back up to the latter.</p><p>You can get another speed up in experimentation by increasing the
frequency of monitoring.  In <tt>network2.py</tt> we monitor performance
at the end of each training epoch.  With 50,000 images per epoch, that
means waiting quite a while - about a minute, on my laptop, when
training a <tt>[784, 30, 10]</tt> network - before getting feedback on
how well the network is learning.  Of course, a minute isn't really
very long, but if you want to trial dozens of hyper-parameter choices
it's annoying, and if you want to trial hundreds or thousands of
choices it starts to get debilitating.  We can get feedback more
quickly by monitoring the validation accuracy more often, say, after
every 1,000 training images.  Furthermore, instead of using the full
10,000 image validation set to monitor performance, we can get a much
faster estimate using just 100 validation images.  All that matters is
that the network sees enough images to do real learning, and to get a
pretty good rough estimate of performance. Of course, our program
<tt>network2.py</tt> doesn't currently do this kind of monitoring.  But
as a kludge to achieve a similar effect for the purposes of
illustration, we'll strip down our training data to just the first
1,000 MNIST training images.  Let's try it and see what happens.  (To
keep the code below simple I haven't implemented the idea of using
only 0 and 1 images.  Of course, that can be done with just a little
more work.)</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">,</span> \
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> \
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Epoch</span> <span class="mi">0</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">1</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">2</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>
<span class="o">...</span>
</pre></div>
<p></p><p>We're still getting pure noise!  But there's a big win: we're now
getting feedback every second, rather than once a minute or so.  That
means you can more quickly experiment with other choices of
hyper-parameter, or even conduct experiments trialling many different
choices of hyper-parameter nearly simultaneously.</p><p>In the above example I left <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-455-Frame"><nobr><span class="math" id="MathJax-Span-5095" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5096"><span class="mi" id="MathJax-Span-5097" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-455">\lambda</script> as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-456-Frame"><nobr><span class="math" id="MathJax-Span-5098" role="math" style="width: 4.855em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.757em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5099"><span class="mi" id="MathJax-Span-5100" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-5101" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5102" style="font-family: MathJax_Main; padding-left: 0.297em;">1000.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-456">\lambda = 1000.0</script>, as we
used earlier.  But since we changed the number of training examples we
should really change <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-457-Frame"><nobr><span class="math" id="MathJax-Span-5103" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5104"><span class="mi" id="MathJax-Span-5105" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-457">\lambda</script> to keep the weight decay the same.
That means changing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-458-Frame"><nobr><span class="math" id="MathJax-Span-5106" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5107"><span class="mi" id="MathJax-Span-5108" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-458">\lambda</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-459-Frame"><nobr><span class="math" id="MathJax-Span-5109" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5110"><span class="mn" id="MathJax-Span-5111" style="font-family: MathJax_Main;">20.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-459">20.0</script>.  If we do that then this is
what happens:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">20.0</span><span class="p">,</span> \
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> \
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Epoch</span> <span class="mi">0</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">12</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">1</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">14</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">2</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">25</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">3</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">18</span> <span class="o">/</span> <span class="mi">100</span>
<span class="o">...</span>
</pre></div>
<p></p><p>Ahah!  We have a signal.  Not a terribly good signal, but a signal
nonetheless.  That's something we can build on, modifying the
hyper-parameters to try to get further improvement.  Maybe we guess
that our learning rate needs to be higher.  (As you perhaps realize,
that's a silly guess, for reasons we'll discuss shortly, but please
bear with me.)  So to test our guess we try dialling <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-460-Frame"><nobr><span class="math" id="MathJax-Span-5112" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5113"><span class="mi" id="MathJax-Span-5114" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-460">\eta</script> up to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-461-Frame"><nobr><span class="math" id="MathJax-Span-5115" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5116"><span class="mn" id="MathJax-Span-5117" style="font-family: MathJax_Main;">100.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-461">100.0</script>:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">20.0</span><span class="p">,</span> \
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> \
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Epoch</span> <span class="mi">0</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">1</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">2</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">3</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">10</span> <span class="o">/</span> <span class="mi">100</span>

<span class="o">...</span>
</pre></div>
<p></p><p>That's no good!  It suggests that our guess was wrong, and the problem
wasn't that the learning rate was too low.  So instead we try dialling
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-462-Frame"><nobr><span class="math" id="MathJax-Span-5118" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5119"><span class="mi" id="MathJax-Span-5120" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\eta</script> down to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-463-Frame"><nobr><span class="math" id="MathJax-Span-5121" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5122"><span class="mi" id="MathJax-Span-5123" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5124" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5125" style="font-family: MathJax_Main; padding-left: 0.297em;">1.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-463">\eta = 1.0</script>:</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network2</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">lmbda</span> <span class="o">=</span> <span class="mf">20.0</span><span class="p">,</span> \
<span class="o">...</span> <span class="n">evaluation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> \
<span class="o">...</span> <span class="n">monitor_evaluation_accuracy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Epoch</span> <span class="mi">0</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">62</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">1</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">42</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">2</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">43</span> <span class="o">/</span> <span class="mi">100</span>

<span class="n">Epoch</span> <span class="mi">3</span> <span class="n">training</span> <span class="n">complete</span>
<span class="n">Accuracy</span> <span class="n">on</span> <span class="n">evaluation</span> <span class="n">data</span><span class="p">:</span> <span class="mi">61</span> <span class="o">/</span> <span class="mi">100</span>

<span class="o">...</span>
</pre></div>
<p></p><p>That's better!  And so we can continue, individually adjusting each
hyper-parameter, gradually improving performance.  Once we've explored
to find an improved value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-464-Frame"><nobr><span class="math" id="MathJax-Span-5126" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5127"><span class="mi" id="MathJax-Span-5128" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-464">\eta</script>, then we move on to find a good
value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-465-Frame"><nobr><span class="math" id="MathJax-Span-5129" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5130"><span class="mi" id="MathJax-Span-5131" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-465">\lambda</script>.  Then experiment with a more complex
architecture, say a network with 10 hidden neurons.  Then adjust the
values for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-466-Frame"><nobr><span class="math" id="MathJax-Span-5132" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5133"><span class="mi" id="MathJax-Span-5134" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-466">\eta</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-467-Frame"><nobr><span class="math" id="MathJax-Span-5135" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5136"><span class="mi" id="MathJax-Span-5137" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-467">\lambda</script> again.  Then increase to 20 hidden
neurons.  And then adjust other hyper-parameters some more.  And so
on, at each stage evaluating performance using our held-out validation
data, and using those evaluations to find better and better
hyper-parameters.  As we do so, it typically takes longer to witness
the impact due to modifications of the hyper-parameters, and so we can
gradually decrease the frequency of monitoring.</p><p>This all looks very promising as a broad strategy.  However, I want to
return to that initial stage of finding hyper-parameters that enable a
network to learn anything at all.  In fact, even the above discussion
conveys too positive an outlook.  It can be immensely frustrating to
work with a network that's learning nothing.  You can tweak
hyper-parameters for days, and still get no meaningful response.  And
so I'd like to re-emphasize that during the early stages you should
make sure you can get quick feedback from experiments.  Intuitively,
it may seem as though simplifying the problem and the architecture
will merely slow you down.  In fact, it speeds things up, since you
much more quickly find a network with a meaningful signal.  Once
you've got such a signal, you can often get rapid improvements by
tweaking the hyper-parameters.  As with many things in life, getting
started can be the hardest thing to do.</p><p>Okay, that's the broad strategy.  Let's now look at some specific
recommendations for setting hyper-parameters.  I will focus on the
learning rate, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-468-Frame"><nobr><span class="math" id="MathJax-Span-5138" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5139"><span class="mi" id="MathJax-Span-5140" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-468">\eta</script>, the L2 regularization parameter, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-469-Frame"><nobr><span class="math" id="MathJax-Span-5141" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5142"><span class="mi" id="MathJax-Span-5143" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-469">\lambda</script>, and
the mini-batch size.  However, many of the remarks apply also to other
hyper-parameters, including those associated to network architecture,
other forms of regularization, and some hyper-parameters we'll meet
later in the book, such as the momentum co-efficient.</p><p><strong>Learning rate:</strong> Suppose we run three MNIST networks with three
different learning rates, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-470-Frame"><nobr><span class="math" id="MathJax-Span-5144" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5145"><span class="mi" id="MathJax-Span-5146" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5147" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5148" style="font-family: MathJax_Main; padding-left: 0.297em;">0.025</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-470">\eta = 0.025</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-471-Frame"><nobr><span class="math" id="MathJax-Span-5149" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5150"><span class="mi" id="MathJax-Span-5151" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5152" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5153" style="font-family: MathJax_Main; padding-left: 0.297em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-471">\eta = 0.25</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-472-Frame"><nobr><span class="math" id="MathJax-Span-5154" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5155"><span class="mi" id="MathJax-Span-5156" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5157" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5158" style="font-family: MathJax_Main; padding-left: 0.297em;">2.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-472">\eta =
2.5</script>, respectively.  We'll set the other hyper-parameters as for the
experiments in earlier sections, running over 30 epochs, with a
mini-batch size of 10, and with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-473-Frame"><nobr><span class="math" id="MathJax-Span-5159" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5160"><span class="mi" id="MathJax-Span-5161" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-5162" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5163" style="font-family: MathJax_Main; padding-left: 0.297em;">5.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-473">\lambda = 5.0</script>.  We'll also return to
using the full <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-474-Frame"><nobr><span class="math" id="MathJax-Span-5164" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5165"><span class="mn" id="MathJax-Span-5166" style="font-family: MathJax_Main;">50</span><span class="mo" id="MathJax-Span-5167" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-5168" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-474">50,000</script> training images.  Here's a graph showing the
behaviour of the training cost as we train*<span class="marginnote">
*The graph was
  generated by
  <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/fig/multiple_eta.py">multiple_eta.py</a>.</span>:</p><p></p><center><img src="./Neural networks and deep learning 3_files/multiple_eta.png" width="520px"></center><p></p><p>With <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-475-Frame"><nobr><span class="math" id="MathJax-Span-5169" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5170"><span class="mi" id="MathJax-Span-5171" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5172" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5173" style="font-family: MathJax_Main; padding-left: 0.297em;">0.025</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-475">\eta = 0.025</script> the cost decreases smoothly until the final epoch.
With <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-476-Frame"><nobr><span class="math" id="MathJax-Span-5174" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5175"><span class="mi" id="MathJax-Span-5176" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5177" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5178" style="font-family: MathJax_Main; padding-left: 0.297em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-476">\eta = 0.25</script> the cost initially decreases, but after about <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-477-Frame"><nobr><span class="math" id="MathJax-Span-5179" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5180"><span class="mn" id="MathJax-Span-5181" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-477">20</script>
epochs it is near saturation, and thereafter most of the changes are
merely small and apparently random oscillations.  Finally, with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-478-Frame"><nobr><span class="math" id="MathJax-Span-5182" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5183"><span class="mi" id="MathJax-Span-5184" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5185" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5186" style="font-family: MathJax_Main; padding-left: 0.297em;">2.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-478">\eta
= 2.5</script> the cost makes large oscillations right from the start.  To
understand the reason for the oscillations, recall that stochastic
gradient descent is supposed to step us gradually down into a valley
of the cost function,</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz33.png">
</center><p></p><p>However, if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-479-Frame"><nobr><span class="math" id="MathJax-Span-5187" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5188"><span class="mi" id="MathJax-Span-5189" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-479">\eta</script> is too large then the steps will be so large that
they may actually overshoot the minimum, causing the algorithm to
climb up out of the valley instead.  That's likely*<span class="marginnote">
*This
  picture is helpful, but it's intended as an intuition-building
  illustration of what may go on, not as a complete, exhaustive
  explanation.  Briefly, a more complete explanation is as follows:
  gradient descent uses a first-order approximation to the cost
  function as a guide to how to decrease the cost.  For large <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-480-Frame"><nobr><span class="math" id="MathJax-Span-5190" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.498em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-5191"><span class="mi" id="MathJax-Span-5192" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.329em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-480">\eta</script>,
  higher-order terms in the cost function become more important, and
  may dominate the behaviour, causing gradient descent to break down.
  This is especially likely as we approach minima and quasi-minima of
  the cost function, since near such points the gradient becomes
  small, making it easier for higher-order terms to dominate
  behaviour.</span>  what's causing the cost to oscillate when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-481-Frame"><nobr><span class="math" id="MathJax-Span-5193" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5194"><span class="mi" id="MathJax-Span-5195" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5196" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5197" style="font-family: MathJax_Main; padding-left: 0.297em;">2.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-481">\eta = 2.5</script>.
When we choose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-482-Frame"><nobr><span class="math" id="MathJax-Span-5198" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5199"><span class="mi" id="MathJax-Span-5200" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5201" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5202" style="font-family: MathJax_Main; padding-left: 0.297em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-482">\eta = 0.25</script> the initial steps do take us toward a
minimum of the cost function, and it's only once we get near that
minimum that we start to suffer from the overshooting problem.  And
when we choose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-483-Frame"><nobr><span class="math" id="MathJax-Span-5203" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5204"><span class="mi" id="MathJax-Span-5205" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5206" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5207" style="font-family: MathJax_Main; padding-left: 0.297em;">0.025</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-483">\eta = 0.025</script> we don't suffer from this problem at all
during the first <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-484-Frame"><nobr><span class="math" id="MathJax-Span-5208" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5209"><span class="mn" id="MathJax-Span-5210" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-484">30</script> epochs.  Of course, choosing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-485-Frame"><nobr><span class="math" id="MathJax-Span-5211" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5212"><span class="mi" id="MathJax-Span-5213" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-485">\eta</script> so small
creates another problem, namely, that it slows down stochastic
gradient descent.  An even better approach would be to start with
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-486-Frame"><nobr><span class="math" id="MathJax-Span-5214" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5215"><span class="mi" id="MathJax-Span-5216" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5217" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5218" style="font-family: MathJax_Main; padding-left: 0.297em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-486">\eta = 0.25</script>, train for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-487-Frame"><nobr><span class="math" id="MathJax-Span-5219" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5220"><span class="mn" id="MathJax-Span-5221" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-487">20</script> epochs, and then switch to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-488-Frame"><nobr><span class="math" id="MathJax-Span-5222" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5223"><span class="mi" id="MathJax-Span-5224" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5225" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5226" style="font-family: MathJax_Main; padding-left: 0.297em;">0.025</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-488">\eta =
0.025</script>.  We'll discuss such variable learning rate schedules later.
For now, though, let's stick to figuring out how to find a single good
value for the learning rate, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-489-Frame"><nobr><span class="math" id="MathJax-Span-5227" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5228"><span class="mi" id="MathJax-Span-5229" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-489">\eta</script>.</p><p></p><p>With this picture in mind, we can set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-490-Frame"><nobr><span class="math" id="MathJax-Span-5230" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5231"><span class="mi" id="MathJax-Span-5232" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-490">\eta</script> as follows.  First, we
estimate the threshold value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-491-Frame"><nobr><span class="math" id="MathJax-Span-5233" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5234"><span class="mi" id="MathJax-Span-5235" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-491">\eta</script> at which the cost on the
training data immediately begins decreasing, instead of oscillating or
increasing.  This estimate doesn't need to be too accurate.  You can
estimate the order of magnitude by starting with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-492-Frame"><nobr><span class="math" id="MathJax-Span-5236" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5237"><span class="mi" id="MathJax-Span-5238" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5239" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5240" style="font-family: MathJax_Main; padding-left: 0.297em;">0.01</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-492">\eta = 0.01</script>.  If
the cost decreases during the first few epochs, then you should
successively try <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-493-Frame"><nobr><span class="math" id="MathJax-Span-5241" role="math" style="width: 6.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5242"><span class="mi" id="MathJax-Span-5243" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5244" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5245" style="font-family: MathJax_Main; padding-left: 0.297em;">0.1</span><span class="mo" id="MathJax-Span-5246" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-5247" style="font-family: MathJax_Main; padding-left: 0.15em;">1.0</span><span class="mo" id="MathJax-Span-5248" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-5249" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-493">\eta = 0.1, 1.0, \ldots</script> until you find a value for
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-494-Frame"><nobr><span class="math" id="MathJax-Span-5250" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5251"><span class="mi" id="MathJax-Span-5252" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-494">\eta</script> where the cost oscillates or increases during the first few
epochs.  Alternately, if the cost oscillates or increases during the
first few epochs when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-495-Frame"><nobr><span class="math" id="MathJax-Span-5253" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5254"><span class="mi" id="MathJax-Span-5255" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5256" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5257" style="font-family: MathJax_Main; padding-left: 0.297em;">0.01</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-495">\eta = 0.01</script>, then try <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-496-Frame"><nobr><span class="math" id="MathJax-Span-5258" role="math" style="width: 9.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.973em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5259"><span class="mi" id="MathJax-Span-5260" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5261" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5262" style="font-family: MathJax_Main; padding-left: 0.297em;">0.001</span><span class="mo" id="MathJax-Span-5263" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-5264" style="font-family: MathJax_Main; padding-left: 0.15em;">0.0001</span><span class="mo" id="MathJax-Span-5265" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-5266" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-496">\eta = 0.001, 0.0001,
\ldots</script> until you find a value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-497-Frame"><nobr><span class="math" id="MathJax-Span-5267" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5268"><span class="mi" id="MathJax-Span-5269" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-497">\eta</script> where the cost decreases
during the first few epochs.  Following this procedure will give us an
order of magnitude estimate for the threshold value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-498-Frame"><nobr><span class="math" id="MathJax-Span-5270" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5271"><span class="mi" id="MathJax-Span-5272" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-498">\eta</script>.  You
may optionally refine your estimate, to pick out the largest value of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-499-Frame"><nobr><span class="math" id="MathJax-Span-5273" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5274"><span class="mi" id="MathJax-Span-5275" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-499">\eta</script> at which the cost decreases during the first few epochs, say
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-500-Frame"><nobr><span class="math" id="MathJax-Span-5276" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5277"><span class="mi" id="MathJax-Span-5278" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5279" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5280" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-500">\eta = 0.5</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-501-Frame"><nobr><span class="math" id="MathJax-Span-5281" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5282"><span class="mi" id="MathJax-Span-5283" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5284" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5285" style="font-family: MathJax_Main; padding-left: 0.297em;">0.2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-501">\eta = 0.2</script> (there's no need for this to be
super-accurate).  This gives us an estimate for the threshold value of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-502-Frame"><nobr><span class="math" id="MathJax-Span-5286" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5287"><span class="mi" id="MathJax-Span-5288" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-502">\eta</script>.</p><p></p><p>Obviously, the actual value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-503-Frame"><nobr><span class="math" id="MathJax-Span-5289" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5290"><span class="mi" id="MathJax-Span-5291" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-503">\eta</script> that you use should be no larger
than the threshold value.  In fact, if the value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-504-Frame"><nobr><span class="math" id="MathJax-Span-5292" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5293"><span class="mi" id="MathJax-Span-5294" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-504">\eta</script> is to
remain useable over many epochs then you likely want to use a value
for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-505-Frame"><nobr><span class="math" id="MathJax-Span-5295" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5296"><span class="mi" id="MathJax-Span-5297" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-505">\eta</script> that is smaller, say, a factor of two below the threshold.
Such a choice will typically allow you to train for many epochs,
without causing too much of a slowdown in learning.</p><p></p><p>In the case of the MNIST data, following this strategy leads to an
estimate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-506-Frame"><nobr><span class="math" id="MathJax-Span-5298" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5299"><span class="mn" id="MathJax-Span-5300" style="font-family: MathJax_Main;">0.1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-506">0.1</script> for the order of magnitude of the threshold value of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-507-Frame"><nobr><span class="math" id="MathJax-Span-5301" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5302"><span class="mi" id="MathJax-Span-5303" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-507">\eta</script>.  After some more refinement, we obtain a threshold value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-508-Frame"><nobr><span class="math" id="MathJax-Span-5304" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5305"><span class="mi" id="MathJax-Span-5306" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5307" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5308" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-508">\eta
= 0.5</script>.  Following the prescription above, this suggests using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-509-Frame"><nobr><span class="math" id="MathJax-Span-5309" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5310"><span class="mi" id="MathJax-Span-5311" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5312" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5313" style="font-family: MathJax_Main; padding-left: 0.297em;">0.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-509">\eta =
0.25</script> as our value for the learning rate.  In fact, I found that using
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-510-Frame"><nobr><span class="math" id="MathJax-Span-5314" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5315"><span class="mi" id="MathJax-Span-5316" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-5317" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5318" style="font-family: MathJax_Main; padding-left: 0.297em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-510">\eta = 0.5</script> worked well enough over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-511-Frame"><nobr><span class="math" id="MathJax-Span-5319" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5320"><span class="mn" id="MathJax-Span-5321" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-511">30</script> epochs that for the most
part I didn't worry about using a lower value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-512-Frame"><nobr><span class="math" id="MathJax-Span-5322" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5323"><span class="mi" id="MathJax-Span-5324" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-512">\eta</script>.</p><p>This all seems quite straightforward.  However, using the training
cost to pick <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-513-Frame"><nobr><span class="math" id="MathJax-Span-5325" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5326"><span class="mi" id="MathJax-Span-5327" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-513">\eta</script> appears to contradict what I said earlier in this
section, namely, that we'd pick hyper-parameters by evaluating
performance using our held-out validation data.  In fact, we'll use
validation accuracy to pick the regularization hyper-parameter, the
mini-batch size, and network parameters such as the number of layers
and hidden neurons, and so on.  Why do things differently for the
learning rate?  Frankly, this choice is my personal aesthetic
preference, and is perhaps somewhat idiosyncratic.  The reasoning is
that the other hyper-parameters are intended to improve the final
classification accuracy on the test set, and so it makes sense to
select them on the basis of validation accuracy.  However, the
learning rate is only incidentally meant to impact the final
classification accuracy.  It's primary purpose is really to control
the step size in gradient descent, and monitoring the training cost is
the best way to detect if the step size is too big.  With that said,
this is a personal aesthetic preference.  Early on during learning the
training cost usually only decreases if the validation accuracy
improves, and so in practice it's unlikely to make much difference
which criterion you use.</p><p><a name="early_stopping"></a></p><p><strong>Use early stopping to determine the number of training
  epochs:</strong> As we discused earlier in the chapter, early stopping means
that at the end of each epoch we should compute the classification
accuracy on the validation data.  When that stops improving,
terminate.  This makes setting the number of epochs very simple.  In
particular, it means that we don't need to worry about explicitly
figuring out how the number of epochs depends on the other
hyper-parameters.  Instead, that's taken care of automatically.
Furthermore, early stopping also automatically prevents us from
overfitting.  This is, of course, a good thing, although in the early
stages of experimentation it can be helpful to turn off early
stopping, so you can see any signs of overfitting, and use it to
inform your approach to regularization.</p><p>To implement early stopping we need to say more precisely what it
means that the classification accuracy has stopped improving.  As
we've seen, the accuracy can jump around quite a bit, even when the
overall trend is to improve.  If we stop the first time the accuracy
decreases then we'll almost certainly stop when there are more
improvements to be had.  A better rule is to terminate if the best
classification accuracy doesn't improve for quite some time.  Suppose,
for example, that we're doing MNIST.  Then we might elect to terminate
if the classification accuracy hasn't improved during the last ten
epochs.  This ensures that we don't stop too soon, in response to bad
luck in training, but also that we're not waiting around forever for
an improvement that never comes.</p><p>This no-improvement-in-ten rule is good for initial exploration of
MNIST.  However, networks can sometimes plateau near a particular
classification accuracy for quite some time, only to then begin
improving again.  If you're trying to get really good performance, the
no-improvement-in-ten rule may be too aggressive about stopping.  In
that case, I suggest using the no-improvement-in-ten rule for initial
experimentation, and gradually adopting more lenient rules, as you
better understand the way your network trains:
no-improvement-in-twenty, no-improvement-in-fifty, and so on.  Of
course, this introduces a new hyper-parameter to optimize!  In
practice, however, it's usually easy to set this hyper-parameter to
get pretty good results.  Similarly, for problems other than MNIST,
the no-improvement-in-ten rule may be much too aggressive or not
nearly aggressive enough, depending on the details of the problem.
However, with a little experimentation it's usually easy to find a
pretty good strategy for early stopping.</p><p>We haven't used early stopping in our MNIST experiments to date.  The
reason is that we've been doing a lot of comparisons between different
approaches to learning.  For such comparisons it's helpful to use the
same number of epochs in each case.  However, it's well worth
modifying <tt>network2.py</tt> to implement early stopping:</p><p></p><h4><a name="problem_831601"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_831601">Problem</a></h4><ul>
<li> Modify <tt>network2.py</tt> so that it implements early stopping
  using a no-improvement-in-<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-514-Frame"><nobr><span class="math" id="MathJax-Span-5328" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5329"><span class="mi" id="MathJax-Span-5330" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-514">n</script> epochs strategy, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-515-Frame"><nobr><span class="math" id="MathJax-Span-5331" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5332"><span class="mi" id="MathJax-Span-5333" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-515">n</script> is a
  parameter that can be set.<p></p><p></p></li><li> Can you think of a rule for early stopping <em>other</em> than
  no-improvement-in-<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-516-Frame"><nobr><span class="math" id="MathJax-Span-5334" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5335"><span class="mi" id="MathJax-Span-5336" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-516">n</script>?  Ideally, the rule should compromise between
  getting high validation accuracies and not training too long.  Add
  your rule to <tt>network2.py</tt>, and run three experiments comparing
  the validation accuracies and number of epochs of training to
  no-improvement-in-<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-517-Frame"><nobr><span class="math" id="MathJax-Span-5337" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5338"><span class="mn" id="MathJax-Span-5339" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-517">10</script>.<p></p><p></p></li></ul><p></p><p><strong>Learning rate schedule:</strong> We've been holding the learning rate
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-518-Frame"><nobr><span class="math" id="MathJax-Span-5340" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5341"><span class="mi" id="MathJax-Span-5342" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-518">\eta</script> constant.  However, it's often advantageous to vary the
learning rate.  Early on during the learning process it's likely that
the weights are badly wrong.  And so it's best to use a large learning
rate that causes the weights to change quickly.  Later, we can reduce
the learning rate as we make more fine-tuned adjustments to our
weights.</p><p>How should we set our learning rate schedule?  Many approaches are
possible.  One natural approach is to use the same basic idea as early
stopping.  The idea is to hold the learning rate constant until the
validation accuracy starts to get worse.  Then decrease the learning
rate by some amount, say a factor of two or ten.  We repeat this many
times, until, say, the learning rate is a factor of 1,024 (or 1,000)
times lower than the initial value.  Then we terminate.</p><p></p><p>A variable learning schedule can improve performance, but it also
opens up a world of possible choices for the learning schedule.  Those
choices can be a headache - you can spend forever trying to optimize
your learning schedule.  For first experiments my suggestion is to use
a single, constant value for the learning rate.  That'll get you a
good first approximation.  Later, if you want to obtain the best
performance from your network, it's worth experimenting with a
learning schedule, along the lines I've described*<span class="marginnote">
*A readable
  recent paper which demonstrates the benefits of variable learning
  rates in attacking MNIST is
  <a href="http://arxiv.org/abs/1003.0358">Deep, Big, Simple Neural Nets
    Excel on Handwritten Digit Recognition</a>, by Dan Claudiu
  Cirean, Ueli Meier, Luca Maria Gambardella, and
  Jrgen Schmidhuber (2010).</span>.</p><p></p><h4><a name="exercise_336628"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_336628">Exercise</a></h4><ul>
<li> Modify <tt>network2.py</tt> so that it implements a learning
  schedule that: halves the learning rate each time the validation
  accuracy satisfies the no-improvement-in-<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-519-Frame"><nobr><span class="math" id="MathJax-Span-5343" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5344"><span class="mn" id="MathJax-Span-5345" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-519">10</script> rule; and terminates
  when the learning rate has dropped to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-520-Frame"><nobr><span class="math" id="MathJax-Span-5346" role="math" style="width: 2.551em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5347"><span class="mn" id="MathJax-Span-5348" style="font-family: MathJax_Main;">1</span><span class="texatom" id="MathJax-Span-5349"><span class="mrow" id="MathJax-Span-5350"><span class="mo" id="MathJax-Span-5351" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-5352" style="font-family: MathJax_Main;">128</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-520">1/128</script> of its original value.
</li></ul><p></p><p><strong>The regularization parameter, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-521-Frame"><nobr><span class="math" id="MathJax-Span-5353" role="math" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.585em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(3.158em 1000.002em 4.129em -999.998em); top: -3.978em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5354"><span class="mi" id="MathJax-Span-5355" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 3.983em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-521">\lambda</script>:</strong> I suggest starting
initially with no regularization (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-522-Frame"><nobr><span class="math" id="MathJax-Span-5356" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5357"><span class="mi" id="MathJax-Span-5358" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-5359" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5360" style="font-family: MathJax_Main; padding-left: 0.297em;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-522">\lambda = 0.0</script>), and determining a
value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-523-Frame"><nobr><span class="math" id="MathJax-Span-5361" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5362"><span class="mi" id="MathJax-Span-5363" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-523">\eta</script>, as above.  Using that choice of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-524-Frame"><nobr><span class="math" id="MathJax-Span-5364" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5365"><span class="mi" id="MathJax-Span-5366" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-524">\eta</script>, we can then
use the validation data to select a good value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-525-Frame"><nobr><span class="math" id="MathJax-Span-5367" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5368"><span class="mi" id="MathJax-Span-5369" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-525">\lambda</script>.  Start
by trialling <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-526-Frame"><nobr><span class="math" id="MathJax-Span-5370" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5371"><span class="mi" id="MathJax-Span-5372" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-5373" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-5374" style="font-family: MathJax_Main; padding-left: 0.297em;">1.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-526">\lambda = 1.0</script>*<span class="marginnote">
*I don't have a good principled
  justification for using this as a starting value.  If anyone knows
  of a good principled discussion of where to start with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-527-Frame"><nobr><span class="math" id="MathJax-Span-5375" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-5376"><span class="mi" id="MathJax-Span-5377" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-527">\lambda</script>,
  I'd appreciate hearing it (mn@michaelnielsen.org).</span>, and then
increase or decrease by factors of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-528-Frame"><nobr><span class="math" id="MathJax-Span-5378" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5379"><span class="mn" id="MathJax-Span-5380" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-528">10</script>, as needed to improve
performance on the validation data.  Once you've found a good order of
magnitude, you can fine tune your value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-529-Frame"><nobr><span class="math" id="MathJax-Span-5381" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5382"><span class="mi" id="MathJax-Span-5383" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-529">\lambda</script>.  That done, you
should return and re-optimize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-530-Frame"><nobr><span class="math" id="MathJax-Span-5384" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5385"><span class="mi" id="MathJax-Span-5386" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-530">\eta</script> again.</p><p></p><h4><a name="exercise_30392"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_30392">Exercise</a></h4><ul>
<li> It's tempting to use gradient descent to try to learn good
  values for hyper-parameters such as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-531-Frame"><nobr><span class="math" id="MathJax-Span-5387" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5388"><span class="mi" id="MathJax-Span-5389" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-531">\lambda</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-532-Frame"><nobr><span class="math" id="MathJax-Span-5390" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5391"><span class="mi" id="MathJax-Span-5392" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-532">\eta</script>.  Can you
  think of an obstacle to using gradient descent to determine
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-533-Frame"><nobr><span class="math" id="MathJax-Span-5393" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5394"><span class="mi" id="MathJax-Span-5395" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-533">\lambda</script>?  Can can you think of an obstacle to using gradient
  descent to determine <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-534-Frame"><nobr><span class="math" id="MathJax-Span-5396" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5397"><span class="mi" id="MathJax-Span-5398" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-534">\eta</script>?
</li></ul><p></p><p><strong>How I selected hyper-parameters earlier in this book:</strong> If you
use the recommendations in this section you'll find that you get
values for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-535-Frame"><nobr><span class="math" id="MathJax-Span-5399" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5400"><span class="mi" id="MathJax-Span-5401" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-535">\eta</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-536-Frame"><nobr><span class="math" id="MathJax-Span-5402" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5403"><span class="mi" id="MathJax-Span-5404" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-536">\lambda</script> which don't always exactly match the
values I've used earlier in the book.  The reason is that the book has
narrative constraints that have sometimes made it impractical to
optimize the hyper-parameters.  Think of all the comparisons we've
made of different approaches to learning, e.g., comparing the
quadratic and cross-entropy cost functions, comparing the old and new
methods of weight initialization, running with and without
regularization, and so on.  To make such comparisons meaningful, I've
usually tried to keep hyper-parameters constant across the approaches
being compared (or to scale them in an appropriate way).  Of course,
there's no reason for the same hyper-parameters to be optimal for all
the different approaches to learning, so the hyper-parameters I've
used are something of a compromise.</p><p>As an alternative to this compromise, I could have tried to optimize
the heck out of the hyper-parameters for every single approach to
learning.  In principle that'd be a better, fairer approach, since
then we'd see the best from every approach to learning.  However,
we've made dozens of comparisons along these lines, and in practice I
found it too computationally expensive.  That's why I've adopted the
compromise of using pretty good (but not necessarily optimal) choices
for the hyper-parameters.</p><p><strong>Mini-batch size:</strong> How should we set the mini-batch size?  To
answer this question, let's first suppose that we're doing online
learning, i.e., that we're using a mini-batch size of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-537-Frame"><nobr><span class="math" id="MathJax-Span-5405" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5406"><span class="mn" id="MathJax-Span-5407" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-537">1</script>.</p><p>The obvious worry about online learning is that using mini-batches
which contain just a single training example will cause significant
errors in our estimate of the gradient.  In fact, though, the errors
turn out to not be such a problem.  The reason is that the individual
gradient estimates don't need to be super-accurate.  All we need is an
estimate accurate enough that our cost function tends to keep
decreasing.  It's as though you are trying to get to the North
Magnetic Pole, but have a wonky compass that's 10-20 degrees off each
time you look at it.  Provided you stop to check the compass
frequently, and the compass gets the direction right on average,
you'll end up at the North Magnetic Pole just fine.</p><p>Based on this argument, it sounds as though we should use online
learning.  In fact, the situation turns out to be more complicated
than that.  In a <a href="http://neuralnetworksanddeeplearning.com/chap2.html#backprop_over_minibatch">problem
  in the last chapter</a> I pointed out that it's possible to use matrix
techniques to compute the gradient update for <em>all</em> examples in a
mini-batch simultaneously, rather than looping over them.  Depending
on the details of your hardware and linear algebra library this can
make it quite a bit faster to compute the gradient estimate for a
mini-batch of (for example) size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-538-Frame"><nobr><span class="math" id="MathJax-Span-5408" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5409"><span class="mn" id="MathJax-Span-5410" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-538">100</script>, rather than computing the
mini-batch gradient estimate by looping over the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-539-Frame"><nobr><span class="math" id="MathJax-Span-5411" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5412"><span class="mn" id="MathJax-Span-5413" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-539">100</script> training
examples separately.  It might take (say) only <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-540-Frame"><nobr><span class="math" id="MathJax-Span-5414" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5415"><span class="mn" id="MathJax-Span-5416" style="font-family: MathJax_Main;">50</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-540">50</script> times as long,
rather than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-541-Frame"><nobr><span class="math" id="MathJax-Span-5417" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5418"><span class="mn" id="MathJax-Span-5419" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-541">100</script> times as long.</p><p>Now, at first it seems as though this doesn't help us that much.  With
our mini-batch of size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-542-Frame"><nobr><span class="math" id="MathJax-Span-5420" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5421"><span class="mn" id="MathJax-Span-5422" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-542">100</script> the learning rule for the weights looks
like:
<a class="displaced_anchor" name="eqtn100"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-543-Frame"><nobr><span class="math" id="MathJax-Span-5423" role="math" style="width: 100%; display: inline-block; min-width: 20.444em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 20.444em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5424"><span class="mtable" id="MathJax-Span-5425" style="min-width: 20.836em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.444em;"><span style="display: inline-block; position: absolute; width: 13.091em; height: 0px; clip: rect(-1.664em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -6.517em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5429"><span class="mrow" id="MathJax-Span-5430"><span class="mi" id="MathJax-Span-5431" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5432" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-5433" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5434" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-5435" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5436" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5437" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-5438" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5439" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-5440"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5441" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mn" id="MathJax-Span-5442" style="font-family: MathJax_Main;">100</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-5443" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-5444" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-5445" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5446" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-5447"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5448" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5449" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5450" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-1.076em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-100"><span class="mrow" id="MathJax-Span-5427"><span class="mtext" id="MathJax-Span-5428" style="font-family: MathJax_Main;">(100)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-543">\begin{eqnarray}
  w \rightarrow w' = w-\eta \frac{1}{100} \sum_x \nabla C_x,
\tag{100}\end{eqnarray}</script>
where the sum is over training examples in the mini-batch.  This is
versus
<a class="displaced_anchor" name="eqtn101"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-544-Frame"><nobr><span class="math" id="MathJax-Span-5451" role="math" style="width: 100%; display: inline-block; min-width: 16.62em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.62em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5452"><span class="mtable" id="MathJax-Span-5453" style="min-width: 16.963em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.62em;"><span style="display: inline-block; position: absolute; width: 9.169em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -4.605em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.169em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5457"><span class="mrow" id="MathJax-Span-5458"><span class="mi" id="MathJax-Span-5459" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5460" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-5461" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5462" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-5463" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5464" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5465" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-5466" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5467" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-5468" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5469"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5470" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5471" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-101"><span class="mrow" id="MathJax-Span-5455"><span class="mtext" id="MathJax-Span-5456" style="font-family: MathJax_Main;">(101)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-544">\begin{eqnarray}
  w \rightarrow w' = w-\eta \nabla C_x
\tag{101}\end{eqnarray}</script>
for online learning.  Even if it only takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-545-Frame"><nobr><span class="math" id="MathJax-Span-5472" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5473"><span class="mn" id="MathJax-Span-5474" style="font-family: MathJax_Main;">50</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-545">50</script> times as long to do
the mini-batch update, it still seems likely to be better to do online
learning, because we'd be updating so much more frequently.  Suppose,
however, that in the mini-batch case we increase the learning rate by
a factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-546-Frame"><nobr><span class="math" id="MathJax-Span-5475" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5476"><span class="mn" id="MathJax-Span-5477" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-546">100</script>, so the update rule becomes
<a class="displaced_anchor" name="eqtn102"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-547-Frame"><nobr><span class="math" id="MathJax-Span-5478" role="math" style="width: 100%; display: inline-block; min-width: 18.581em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 18.581em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5479"><span class="mtable" id="MathJax-Span-5480" style="min-width: 18.973em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.581em;"><span style="display: inline-block; position: absolute; width: 11.228em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -5.586em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.228em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 5.346em -999.998em); top: -4.36em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5484"><span class="mrow" id="MathJax-Span-5485"><span class="mi" id="MathJax-Span-5486" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5487" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-5488" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5489" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-5490" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5491" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5492" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-5493" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5494" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="munderover" id="MathJax-Span-5495" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-5496" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-5497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5498" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-5499"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5500" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5502" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-1.272em 1000.002em 0.051em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.36em; right: 0.002em;"><span class="mtd" id="mjx-eqn-102"><span class="mrow" id="MathJax-Span-5482"><span class="mtext" id="MathJax-Span-5483" style="font-family: MathJax_Main;">(102)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-547">\begin{eqnarray}
  w \rightarrow w' = w-\eta \sum_x \nabla C_x.
\tag{102}\end{eqnarray}</script>
That's a lot like doing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-548-Frame"><nobr><span class="math" id="MathJax-Span-5503" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5504"><span class="mn" id="MathJax-Span-5505" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-548">100</script> separate instances of online learning
with a learning rate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-549-Frame"><nobr><span class="math" id="MathJax-Span-5506" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5507"><span class="mi" id="MathJax-Span-5508" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-549">\eta</script>.  But it only takes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-550-Frame"><nobr><span class="math" id="MathJax-Span-5509" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5510"><span class="mn" id="MathJax-Span-5511" style="font-family: MathJax_Main;">50</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-550">50</script> times as long
as doing a single instance of online learning.  Of course, it's not
truly the same as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-551-Frame"><nobr><span class="math" id="MathJax-Span-5512" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5513"><span class="mn" id="MathJax-Span-5514" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-551">100</script> instances of online learning, since in the
mini-batch the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-552-Frame"><nobr><span class="math" id="MathJax-Span-5515" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5516"><span class="mi" id="MathJax-Span-5517" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5518"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5519" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5520" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-552">\nabla C_x</script>'s are all evaluated for the same set of
weights, as opposed to the cumulative learning that occurs in the
online case.  Still, it seems distinctly possible that using the
larger mini-batch would speed things up.</p><p>With these factors in mind, choosing the best mini-batch size is a
compromise.  Too small, and you don't get to take full advantage of
the benefits of good matrix libraries optimized for fast hardware.
Too large and you're simply not updating your weights often enough.
What you need is to choose a compromise value which maximizes the
speed of learning.  Fortunately, the choice of mini-batch size at
which the speed is maximized is relatively independent of the other
hyper-parameters (apart from the overall architecture), so you don't
need to have optimized those hyper-parameters in order to find a good
mini-batch size.  The way to go is therefore to use some acceptable
(but not necessarily optimal) values for the other hyper-parameters,
and then trial a number of different mini-batch sizes, scaling <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-553-Frame"><nobr><span class="math" id="MathJax-Span-5521" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5522"><span class="mi" id="MathJax-Span-5523" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-553">\eta</script>
as above.  Plot the validation accuracy versus <em>time</em> (as in,
real elapsed time, not epoch!), and choose whichever mini-batch size
gives you the most rapid improvement in performance.  With the
mini-batch size chosen you can then proceed to optimize the other
hyper-parameters.</p><p>Of course, as you've no doubt realized, I haven't done this
optimization in our work.  Indeed, our implementation doesn't use the
faster approach to mini-batch updates at all.  I've simply used a
mini-batch size of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-554-Frame"><nobr><span class="math" id="MathJax-Span-5524" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5525"><span class="mn" id="MathJax-Span-5526" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-554">10</script> without comment or explanation in nearly all
examples.  Because of this, we could have sped up learning by reducing
the mini-batch size.  I haven't done this, in part because I wanted to
illustrate the use of mini-batches beyond size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-555-Frame"><nobr><span class="math" id="MathJax-Span-5527" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5528"><span class="mn" id="MathJax-Span-5529" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-555">1</script>, and in part
because my preliminary experiments suggested the speedup would be
rather modest.  In practical implementations, however, we would most
certainly implement the faster approach to mini-batch updates, and
then make an effort to optimize the mini-batch size, in order to
maximize our overall speed.</p><p></p><p><strong>Automated techniques:</strong> I've been describing these heuristics
as though you're optimizing your hyper-parameters by hand.
Hand-optimization is a good way to build up a feel for how neural
networks behave.  However, and unsurprisingly, a great deal of work
has been done on automating the process. A common technique is
<em>grid search</em>, which systematically searches through a grid in
hyper-parameter space.  A review of both the achievements and the
limitations of grid search (with suggestions for easily-implemented
alternatives) may be found in a 2012
paper*<span class="marginnote">
*<a href="http://dl.acm.org/citation.cfm?id=2188395">Random
    search for hyper-parameter optimization</a>, by James Bergstra and
  Yoshua Bengio (2012).</span> by James Bergstra and Yoshua Bengio.  Many
more sophisticated approaches have also been proposed.  I won't review
all that work here, but do want to mention a particularly promising
2012 paper which used a Bayesian approach to automatically optimize
hyper-parameters*<span class="marginnote">
*<a href="http://papers.nips.cc/paper/4522-practical-bayesian-optimization-of-machine-learning-algorithms.pdf">Practical
    Bayesian optimization of machine learning algorithms</a>, by Jasper
  Snoek, Hugo Larochelle, and Ryan Adams.</span>.  The code from the paper
is <a href="https://github.com/jaberg/hyperopt">publicly available</a>, and
has been used with some success by other researchers.</p><p><strong>Summing up:</strong> Following the rules-of-thumb I've described won't
give you the absolute best possible results from your neural network.
But it will likely give you a good start and a basis for further
improvements.  In particular, I've discussed the hyper-parameters
largely independently.  In practice, there are relationships between
the hyper-parameters.  You may experiment with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-556-Frame"><nobr><span class="math" id="MathJax-Span-5530" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5531"><span class="mi" id="MathJax-Span-5532" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-556">\eta</script>, feel that
you've got it just right, then start to optimize for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-557-Frame"><nobr><span class="math" id="MathJax-Span-5533" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5534"><span class="mi" id="MathJax-Span-5535" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-557">\lambda</script>, only
to find that it's messing up your optimization for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-558-Frame"><nobr><span class="math" id="MathJax-Span-5536" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5537"><span class="mi" id="MathJax-Span-5538" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-558">\eta</script>.  In
practice, it helps to bounce backward and forward, gradually closing
in good values.  Above all, keep in mind that the heuristics I've
described are rules of thumb, not rules cast in stone.  You should be
on the lookout for signs that things aren't working, and be willing to
experiment.  In particular, this means carefully monitoring your
network's behaviour, especially the validation accuracy.</p><p>The difficult of choosing hyper-parameters is exacerbated by the fact
that the lore about how to choose hyper-parameters is widely spread,
across many research papers and software programs, and often is only
available inside the heads of individual practitioners.  There are
many, many papers setting out (sometimes contradictory)
recommendations for how to proceed.  However, there are a few
particularly useful papers that synthesize and distill out much of
this lore.  Yoshua Bengio has a 2012
paper*<span class="marginnote">
*<a href="http://arxiv.org/abs/1206.5533">Practical
    recommendations for gradient-based training of deep
    architectures</a>, by Yoshua Bengio (2012).</span> that gives some
practical recommendations for using backpropagation and gradient
descent to train neural networks, including deep neural nets.  Bengio
discusses many issues in much more detail than I have, including how
to do more systematic hyper-parameter searches.  Another good paper is
a 1998
paper*<span class="marginnote">
*<a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">Efficient
    BackProp</a>, by Yann LeCun, Lon Bottou,
  Genevieve Orr and Klaus-Robert Mller (1998)</span> by
Yann LeCun, Lon Bottou, Genevieve Orr and
Klaus-Robert Mller.  Both these papers appear in
an extremely useful 2012 book that collects many tricks commonly used
in neural
nets*<span class="marginnote">
*<a href="http://www.springer.com/computer/theoretical+computer+science/book/978-3-642-35288-1">Neural
    Networks: Tricks of the Trade</a>, edited by
  Grgoire Montavon, Genevive Orr, and Klaus-Robert
    Mller.</span>.  The book is expensive, but many of the articles have
been placed online by their respective authors with, one presumes, the
blessing of the publisher, and may be located using a search engine.</p><p>One thing that becomes clear as you read these articles and,
especially, as you engage in your own experiments, is that
hyper-parameter optimization is not a problem that is ever completely
solved.  There's always another trick you can try to improve
performance.  There is a saying common among writers that books are
never finished, only abandoned.  The same is also true of neural
network optimization: the space of hyper-parameters is so large that
one never really finishes optimizing, one only abandons the network to
posterity.  So your goal should be to develop a workflow that enables
you to quickly do a pretty good job on the optimization, while leaving
you the flexibility to try more detailed optimizations, if that's
important.</p><p>The challenge of setting hyper-parameters has led some people to
complain that neural networks require a lot of work when compared with
other machine learning techniques.  I've heard many variations on the
following complaint: "Yes, a well-tuned neural network may get the
best performance on the problem.  On the other hand, I can try a
random forest [or SVM or<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-559-Frame"><nobr><span class="math" id="MathJax-Span-5539" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.777em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5540"><span class="mo" id="MathJax-Span-5541" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.202em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-559">\ldots</script> insert your own favourite technique]
and it just works.  I don't have time to figure out just the right
neural network."  Of course, from a practical point of view it's good
to have easy-to-apply techniques.  This is particularly true when
you're just getting started on a problem, and it may not be obvious
whether machine learning can help solve the problem at all.  On the
other hand, if getting optimal performance is important, then you may
need to try approaches that require more specialist knowledge.  While
it would be nice if machine learning were always easy, there is no
<em>a priori</em> reason it should be trivially simple.</p><p></p><h3><a name="other_techniques"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques">Other techniques</a></h3><p></p><p>Each technique developed in this chapter is valuable to know in its
own right, but that's not the only reason I've explained them.  The
larger point is to familiarize you with some of the problems which can
occur in neural networks, and with a style of analysis which can help
overcome those problems.  In a sense, we've been learning how to think
about neural nets.  Over the remainder of this chapter I briefly
sketch a handful of other techniques.  These sketches are less
in-depth than the earlier discussions, but should convey some feeling
for the diversity of techniques available for use in neural networks.</p><p></p><h4><a name="variations_on_stochastic_gradient_descent"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#variations_on_stochastic_gradient_descent">Variations on stochastic gradient descent</a></h4><p></p><p>Stochastic gradient descent by backpropagation has served us well in
attacking the MNIST digit classification problem.  However, there are
many other approaches to optimizing the cost function, and sometimes
those other approaches offer performance superior to mini-batch
stochastic gradient descent.  In this section I sketch two such
approaches, the Hessian and momentum techniques.</p><p><strong>Hessian technique:</strong> To begin our discussion it helps to put
neural networks aside for a bit.  Instead, we're just going to
consider the abstract problem of minimizing a cost function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-560-Frame"><nobr><span class="math" id="MathJax-Span-5542" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5543"><span class="mi" id="MathJax-Span-5544" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-560">C</script> which
is a function of many variables, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-561-Frame"><nobr><span class="math" id="MathJax-Span-5545" role="math" style="width: 6.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.424em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5546"><span class="mi" id="MathJax-Span-5547" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5548" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-5549" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5550" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-5551" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5552" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-5553" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5554" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-5555" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5556" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-5557" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-561">w = w_1, w_2, \ldots</script>, so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-562-Frame"><nobr><span class="math" id="MathJax-Span-5558" role="math" style="width: 4.463em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.365em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5559"><span class="mi" id="MathJax-Span-5560" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5561" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5562" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5563" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5564" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5565" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-562">C =
C(w)</script>.  By Taylor's theorem, the cost function can be approximated
near a point <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-563-Frame"><nobr><span class="math" id="MathJax-Span-5566" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5567"><span class="mi" id="MathJax-Span-5568" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-563">w</script> by
<a class="displaced_anchor" name="eqtn103"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-564-Frame"><nobr><span class="math" id="MathJax-Span-5569" role="math" style="width: 100%; display: inline-block; min-width: 27.895em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 27.895em;"><span style="position: absolute; clip: rect(3.532em 1000.002em 9.708em -999.998em); top: -6.86em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5570"><span class="mtable" id="MathJax-Span-5571" style="min-width: 28.434em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.895em;"><span style="display: inline-block; position: absolute; width: 20.689em; height: 0px; clip: rect(-3.331em 1000.002em 2.846em -999.998em); top: 0.002em; left: 50%; margin-left: -10.341em;"><span style="position: absolute; clip: rect(2.208em 1000.002em 6.375em -999.998em); top: -4.9em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.1em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.831em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5572"><span class="mrow" id="MathJax-Span-5573"><span class="mi" id="MathJax-Span-5574" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5575" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5576" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5577" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5578" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5579" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5580" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -2.694em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5611"><span class="mrow" id="MathJax-Span-5612"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.904em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.983em -999.998em); top: -4.507em; left: 5.346em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -5.831em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-5581"><span class="mrow" id="MathJax-Span-5582"><span class="mi" id="MathJax-Span-5583"></span><span class="mo" id="MathJax-Span-5584" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -2.694em; left: 50%; margin-left: 0.002em;"><span class="mtd" id="MathJax-Span-5613"><span class="mrow" id="MathJax-Span-5614"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.512em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 9.708em -999.998em); top: -6.86em; left: 6.718em;"><span style="display: inline-block; position: relative; width: 13.973em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.493em -999.998em); top: -5.831em; left: 0.002em;"><span class="mtd" id="MathJax-Span-5585"><span class="mrow" id="MathJax-Span-5586"><span class="mi" id="MathJax-Span-5587" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5588" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5589" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5590" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5591" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="munderover" id="MathJax-Span-5592" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-5593" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-5594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-5595" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-5596"><span class="mi" id="MathJax-Span-5597" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-5598" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-5599"><span class="mi" id="MathJax-Span-5600" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-5601"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5602" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5603" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.767em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5604" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5605"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5606" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.355em 1000.002em 5.542em -999.998em); top: -2.694em; left: 0.002em;"><span class="mtd" id="MathJax-Span-5615"><span class="mrow" id="MathJax-Span-5616"><span class="mi" id="MathJax-Span-5617"></span><span class="mo" id="MathJax-Span-5618" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-5619" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5620" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5621" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.64em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-5622" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-5623" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.89em; left: 0.395em;"><span class="texatom" id="MathJax-Span-5624"><span class="mrow" id="MathJax-Span-5625"><span class="mi" id="MathJax-Span-5626" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-5627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5628" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-5629"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5630" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5631" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-5632"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.929em;"><span class="mrow" id="MathJax-Span-5633"><span class="msubsup" id="MathJax-Span-5634"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5635" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mn" id="MathJax-Span-5636" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5637" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -1.664em;"><span class="mrow" id="MathJax-Span-5638"><span class="mi" id="MathJax-Span-5639" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-5640"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5641" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5642" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5643" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-5644"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5645" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.483em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5647" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5648"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5649" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5651" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-5652" style="font-family: MathJax_Main; padding-left: 0.248em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.865em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(0.444em 1000.002em 1.718em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.694em; right: 0.002em;"><span class="mtd" id="mjx-eqn-103"><span class="mrow" id="MathJax-Span-5609"><span class="mtext" id="MathJax-Span-5610" style="font-family: MathJax_Main;">(103)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.865em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 6.103em; vertical-align: -2.798em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-564">\begin{eqnarray}
  C(w+\Delta w) & = & C(w) + \sum_j \frac{\partial C}{\partial w_j} \Delta w_j
  \nonumber \\ & & + \frac{1}{2} \sum_{jk} \Delta w_j \frac{\partial^2 C}{\partial w_j
    \partial w_k} \Delta w_k + \ldots
\tag{103}\end{eqnarray}</script>
We can rewrite this more compactly as
<a class="displaced_anchor" name="eqtn104"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-565-Frame"><nobr><span class="math" id="MathJax-Span-5653" role="math" style="width: 100%; display: inline-block; min-width: 30.591em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 30.591em;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5654"><span class="mtable" id="MathJax-Span-5655" style="min-width: 31.228em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 30.591em;"><span style="display: inline-block; position: absolute; width: 23.483em; height: 0px; clip: rect(-1.419em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -11.713em;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 23.483em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5659"><span class="mrow" id="MathJax-Span-5660"><span class="mi" id="MathJax-Span-5661" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5662" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5663" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5664" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5665" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5666" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5667" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5668" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5669" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5670" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5671" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5672" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5673" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5674" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5675" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5676" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5677" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5678" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5679" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-5680" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5681" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5682" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.64em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5683" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5684"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5685" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mi" id="MathJax-Span-5686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5687" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-5688" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5689" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5690" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-5691" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mo" id="MathJax-Span-5692" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.831em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-104"><span class="mrow" id="MathJax-Span-5657"><span class="mtext" id="MathJax-Span-5658" style="font-family: MathJax_Main;">(104)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-565">\begin{eqnarray}
  C(w+\Delta w) = C(w) + \nabla C \cdot \Delta w +
  \frac{1}{2} \Delta w^T H \Delta w + \ldots,
\tag{104}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-566-Frame"><nobr><span class="math" id="MathJax-Span-5693" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5694"><span class="mi" id="MathJax-Span-5695" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5696" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-566">\nabla C</script> is the usual gradient vector, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-567-Frame"><nobr><span class="math" id="MathJax-Span-5697" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5698"><span class="mi" id="MathJax-Span-5699" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-567">H</script> is a matrix
known as the <em>Hessian matrix</em>, whose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-568-Frame"><nobr><span class="math" id="MathJax-Span-5700" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5701"><span class="mi" id="MathJax-Span-5702" style="font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-5703" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-568">jk</script>th entry is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-569-Frame"><nobr><span class="math" id="MathJax-Span-5704" role="math" style="width: 5.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.689em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5705"><span class="msubsup" id="MathJax-Span-5706"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5707" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mn" id="MathJax-Span-5708" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5709" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-5710"><span class="mrow" id="MathJax-Span-5711"><span class="mo" id="MathJax-Span-5712" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-5713" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-5714"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5715" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5717" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-5718"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5719" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-5720" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-569">\partial^2
C / \partial w_j \partial w_k</script>.  Suppose we approximate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-570-Frame"><nobr><span class="math" id="MathJax-Span-5721" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5722"><span class="mi" id="MathJax-Span-5723" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-570">C</script> by
discarding the higher-order terms represented by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-571-Frame"><nobr><span class="math" id="MathJax-Span-5724" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.777em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5725"><span class="mo" id="MathJax-Span-5726" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.202em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-571">\ldots</script> above,
<a class="displaced_anchor" name="eqtn105"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-572-Frame"><nobr><span class="math" id="MathJax-Span-5727" role="math" style="width: 100%; display: inline-block; min-width: 28.042em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 28.042em;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5728"><span class="mtable" id="MathJax-Span-5729" style="min-width: 28.63em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 28.042em;"><span style="display: inline-block; position: absolute; width: 20.885em; height: 0px; clip: rect(-1.419em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -10.439em;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 20.885em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5733"><span class="mrow" id="MathJax-Span-5734"><span class="mi" id="MathJax-Span-5735" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5736" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5737" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5738" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5739" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5740" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5741" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5742" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-5743" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5745" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5746" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5747" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5748" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5749" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5750" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5751" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5752" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5753" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-5754" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5755" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5756" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.64em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5757" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5758"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5759" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mi" id="MathJax-Span-5760" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5761" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-5762" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5763" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5764" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.831em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-105"><span class="mrow" id="MathJax-Span-5731"><span class="mtext" id="MathJax-Span-5732" style="font-family: MathJax_Main;">(105)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-572">\begin{eqnarray} 
  C(w+\Delta w) \approx C(w) + \nabla C \cdot \Delta w +
  \frac{1}{2} \Delta w^T H \Delta w.
\tag{105}\end{eqnarray}</script>
Using calculus we can show that the expression on the right-hand side
can be minimized*<span class="marginnote">
*Strictly speaking, for this to be a minimum,
  and not merely an extremum, we need to assume that the Hessian
  matrix is positive definite.  Intuitively, this means that the
  function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-573-Frame"><nobr><span class="math" id="MathJax-Span-5765" role="math" style="width: 0.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.027em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-5766"><span class="mi" id="MathJax-Span-5767" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.086em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-573">C</script> looks like a valley locally, not a mountain or a
  saddle.</span> by choosing
<a class="displaced_anchor" name="eqtn106"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-574-Frame"><nobr><span class="math" id="MathJax-Span-5768" role="math" style="width: 100%; display: inline-block; min-width: 14.953em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.953em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-5769"><span class="mtable" id="MathJax-Span-5770" style="min-width: 15.248em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.953em;"><span style="display: inline-block; position: absolute; width: 7.502em; height: 0px; clip: rect(-0.978em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.772em;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.502em; height: 0px;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5774"><span class="mrow" id="MathJax-Span-5775"><span class="mi" id="MathJax-Span-5776" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5777" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5778" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-5779" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msubsup" id="MathJax-Span-5780"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5781" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.934em;"><span class="texatom" id="MathJax-Span-5782"><span class="mrow" id="MathJax-Span-5783"><span class="mo" id="MathJax-Span-5784" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-5785" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5786" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5787" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5788" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.831em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-106"><span class="mrow" id="MathJax-Span-5772"><span class="mtext" id="MathJax-Span-5773" style="font-family: MathJax_Main;">(106)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-574">\begin{eqnarray}
  \Delta w = -H^{-1} \nabla C.
\tag{106}\end{eqnarray}</script>
Provided <span id="margin_81836007336_reveal" class="equation_link">(105)</span><span id="margin_81836007336" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn105" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-575-Frame"><nobr><span class="math" id="MathJax-Span-5789" role="math" style="width: 21.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5790"><span class="mtable" id="MathJax-Span-5791" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 20.591em; height: 0px;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 20.591em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5792"><span class="mrow" id="MathJax-Span-5793"><span class="mi" id="MathJax-Span-5794" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5795" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5796" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5797" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5798" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5799" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5800" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5801" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-5802" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5803" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5804" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5805" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5806" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5807" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5808" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5809" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5810" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5811" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5812" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-5813" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5814" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5815" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.64em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5816" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5817"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5818" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mi" id="MathJax-Span-5819" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5820" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-5821" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5822" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-575">\begin{eqnarray} 
  C(w+\Delta w) \approx C(w) + \nabla C \cdot \Delta w +
  \frac{1}{2} \Delta w^T H \Delta w \nonumber\end{eqnarray}</script></a></span><script>$('#margin_81836007336_reveal').click(function() {$('#margin_81836007336').toggle('slow', function() {});});</script> is a good approximate expression for the
cost function, then we'd expect that moving from the point <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-576-Frame"><nobr><span class="math" id="MathJax-Span-5823" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5824"><span class="mi" id="MathJax-Span-5825" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-576">w</script> to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-577-Frame"><nobr><span class="math" id="MathJax-Span-5826" role="math" style="width: 10.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5827"><span class="mi" id="MathJax-Span-5828" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5829" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5830" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5831" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5832" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5833" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-5834" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-5835" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5836" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.934em;"><span class="texatom" id="MathJax-Span-5837"><span class="mrow" id="MathJax-Span-5838"><span class="mo" id="MathJax-Span-5839" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-5840" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5841" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5842" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-577">w+\Delta w = w-H^{-1} \nabla C</script> should significantly decrease the
cost function.  That suggests a possible algorithm for minimizing the
cost:</p><p></p><ul>
<li> Choose a starting point, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-578-Frame"><nobr><span class="math" id="MathJax-Span-5843" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5844"><span class="mi" id="MathJax-Span-5845" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-578">w</script>.<p></p><p></p></li><li> Update <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-579-Frame"><nobr><span class="math" id="MathJax-Span-5846" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5847"><span class="mi" id="MathJax-Span-5848" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-579">w</script> to a new point <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-580-Frame"><nobr><span class="math" id="MathJax-Span-5849" role="math" style="width: 8.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5850"><span class="msup" id="MathJax-Span-5851"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5852" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-5853" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5854" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-5855" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-5856" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-5857" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5858" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.934em;"><span class="texatom" id="MathJax-Span-5859"><span class="mrow" id="MathJax-Span-5860"><span class="mo" id="MathJax-Span-5861" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-5862" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5863" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5864" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-580">w' = w-H^{-1} \nabla C</script>, where the
  Hessian <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-581-Frame"><nobr><span class="math" id="MathJax-Span-5865" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5866"><span class="mi" id="MathJax-Span-5867" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-581">H</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-582-Frame"><nobr><span class="math" id="MathJax-Span-5868" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5869"><span class="mi" id="MathJax-Span-5870" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5871" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-582">\nabla C</script> are computed at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-583-Frame"><nobr><span class="math" id="MathJax-Span-5872" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5873"><span class="mi" id="MathJax-Span-5874" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-583">w</script>.<p></p><p></p></li><li> Update <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-584-Frame"><nobr><span class="math" id="MathJax-Span-5875" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5876"><span class="msup" id="MathJax-Span-5877"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5878" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-5879" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-584">w'</script> to a new point <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-585-Frame"><nobr><span class="math" id="MathJax-Span-5880" role="math" style="width: 9.071em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.875em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5881"><span class="mi" id="MathJax-Span-5882" style="font-family: MathJax_Math-italic;">w</span><span class="texatom" id="MathJax-Span-5883"><span class="mrow" id="MathJax-Span-5884"><span class="msup" id="MathJax-Span-5885"><span style="display: inline-block; position: relative; width: 0.248em; height: 0px;"><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5886"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.002em;"><span class="mo" id="MathJax-Span-5887" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-5888"><span class="mrow" id="MathJax-Span-5889"><span class="msup" id="MathJax-Span-5890"><span style="display: inline-block; position: relative; width: 0.248em; height: 0px;"><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5891"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.002em;"><span class="mo" id="MathJax-Span-5892" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5893" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msup" id="MathJax-Span-5894" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5895" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-5896" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5897" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-5898" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5899" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.934em;"><span class="mrow" id="MathJax-Span-5900"><span class="mo" id="MathJax-Span-5901" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="texatom" id="MathJax-Span-5902"><span class="mrow" id="MathJax-Span-5903"><span class="mo" id="MathJax-Span-5904" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-5905" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msup" id="MathJax-Span-5906"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5907" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.836em;"><span class="mo" id="MathJax-Span-5908" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5909" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-585">w{'}{'} = w'-H'^{-1} \nabla' C</script>,
  where the Hessian <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-586-Frame"><nobr><span class="math" id="MathJax-Span-5910" role="math" style="width: 1.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5911"><span class="msup" id="MathJax-Span-5912"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5913" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.934em;"><span class="mo" id="MathJax-Span-5914" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-586">H'</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-587-Frame"><nobr><span class="math" id="MathJax-Span-5915" role="math" style="width: 1.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5916"><span class="msup" id="MathJax-Span-5917"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5918" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.836em;"><span class="mo" id="MathJax-Span-5919" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5920" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-587">\nabla' C</script> are computed at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-588-Frame"><nobr><span class="math" id="MathJax-Span-5921" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5922"><span class="msup" id="MathJax-Span-5923"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5924" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-5925" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-588">w'</script>.<p></p><p></p></li><li> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-589-Frame"><nobr><span class="math" id="MathJax-Span-5926" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.777em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5927"><span class="mo" id="MathJax-Span-5928" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.202em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-589">\ldots</script>
</li></ul>
In practice, <span id="margin_834324618946_reveal" class="equation_link">(105)</span><span id="margin_834324618946" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn105" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-590-Frame"><nobr><span class="math" id="MathJax-Span-5929" role="math" style="width: 21.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5930"><span class="mtable" id="MathJax-Span-5931" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 20.591em; height: 0px;"><span style="position: absolute; clip: rect(2.6em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 20.591em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.855em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-5932"><span class="mrow" id="MathJax-Span-5933"><span class="mi" id="MathJax-Span-5934" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5935" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5936" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5937" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5938" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5939" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5940" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5941" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-5942" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5943" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5944" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5945" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5946" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-5947" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5948" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-5949" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5950" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5951" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5952" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-5953" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5954" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-5955" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.64em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-5956" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-5957"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5958" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mi" id="MathJax-Span-5959" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5960" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-5961" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5962" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-590">\begin{eqnarray} 
  C(w+\Delta w) \approx C(w) + \nabla C \cdot \Delta w +
  \frac{1}{2} \Delta w^T H \Delta w \nonumber\end{eqnarray}</script></a></span><script>$('#margin_834324618946_reveal').click(function() {$('#margin_834324618946').toggle('slow', function() {});});</script> is only an approximation, and it's
better to take smaller steps.  We do this by repeatedly changing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-591-Frame"><nobr><span class="math" id="MathJax-Span-5963" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5964"><span class="mi" id="MathJax-Span-5965" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-591">w</script>
by an amount <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-592-Frame"><nobr><span class="math" id="MathJax-Span-5966" role="math" style="width: 7.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.748em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5967"><span class="mi" id="MathJax-Span-5968" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5969" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-5970" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-5971" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-5972" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="msubsup" id="MathJax-Span-5973"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-5974" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.934em;"><span class="texatom" id="MathJax-Span-5975"><span class="mrow" id="MathJax-Span-5976"><span class="mo" id="MathJax-Span-5977" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-5978" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-5979" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-5980" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-592">\Delta w = -\eta H^{-1} \nabla C</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-593-Frame"><nobr><span class="math" id="MathJax-Span-5981" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5982"><span class="mi" id="MathJax-Span-5983" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-593">\eta</script> is known
as the <em>learning rate</em>.<p></p><p>This approach to minimizing a cost function is known as the
<em>Hessian technique</em> or <em>Hessian optimization</em>.  There are
theoretical and empirical results showing that Hessian methods
converge on a minimum in fewer steps than standard gradient descent.
In particular, by incorporating information about second-order changes
in the cost function it's possible for the Hessian approach to avoid
many pathologies that can occur in gradient descent.  Furthermore,
there are versions of the backpropagation algorithm which can be used
to compute the Hessian.</p><p>If Hessian optimization is so great, why aren't we using it in our
neural networks?  Unfortunately, while it has many desirable
properties, it has one very undesirable property: the Hessian matrix
is very big.  Suppose you have a neural network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-594-Frame"><nobr><span class="math" id="MathJax-Span-5984" role="math" style="width: 1.473em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5985"><span class="msubsup" id="MathJax-Span-5986"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mn" id="MathJax-Span-5987" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.983em;"><span class="mn" id="MathJax-Span-5988" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-594">10^7</script> weights
and biases.  Then the corresponding Hessian matrix will contain <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-595-Frame"><nobr><span class="math" id="MathJax-Span-5989" role="math" style="width: 7.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-5990"><span class="msubsup" id="MathJax-Span-5991"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mn" id="MathJax-Span-5992" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.983em;"><span class="mn" id="MathJax-Span-5993" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5994" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-5995" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mn" id="MathJax-Span-5996" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.983em;"><span class="mn" id="MathJax-Span-5997" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-5998" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-5999" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mn" id="MathJax-Span-6000" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.983em;"><span class="texatom" id="MathJax-Span-6001"><span class="mrow" id="MathJax-Span-6002"><span class="mn" id="MathJax-Span-6003" style="font-size: 70.7%; font-family: MathJax_Main;">14</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-595">10^7
\times 10^7 = 10^{14}</script> entries.  That's a lot of entries to compute,
especially when you're going to need to invert the matrix as well!
That makes Hessian optimization difficult to apply in practice.
However, that doesn't mean that it's not useful to understand.  In
fact, there are many variations on gradient descent which are inspired
by Hessian optimization, but which avoid the problem with overly-large
matrices.  Let's take a look at one such technique, momentum-based
gradient descent.</p><p><a name="momentum"></a></p><p><strong>Momentum-based gradient descent:</strong> Intuitively, the advantage
Hessian optimization has is that it incorporates not just information
about the gradient, but also information about how the gradient is
changing.  Momentum-based gradient descent is based on a similar
intuition, but avoids large matrices of second derivatives.  To
understand the momentum technique, think back to our
<a href="http://neuralnetworksanddeeplearning.com/chap1.html#gradient_descent">original picture</a> of gradient
descent, in which we considered a ball rolling down into a valley.  At
the time, we observed that gradient descent is, despite its name, only
loosely similar to a ball falling to the bottom of a valley.  The
momentum technique modifies gradient descent in two ways that make it
more similar to the physical picture.  First, it introduces a notion
of "velocity" for the parameters we're trying to optimize.  The
gradient acts to change the velocity, not (directly) the "position",
in much the same way as physical forces change the velocity, and only
indirectly affect position.  Second, the momentum method introduces a
kind of friction term, which tends to gradually reduce the velocity.</p><p>Let's give a more precise mathematical description.  We introduce
velocity variables <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-596-Frame"><nobr><span class="math" id="MathJax-Span-6004" role="math" style="width: 5.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6005"><span class="mi" id="MathJax-Span-6006" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-6007" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-6008" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6009" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-6010" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6011" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-6012" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6013" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-6014" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6015" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-6016" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-596">v = v_1, v_2, \ldots</script>, one for each corresponding
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-597-Frame"><nobr><span class="math" id="MathJax-Span-6017" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6018"><span class="msubsup" id="MathJax-Span-6019"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6020" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-6021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-597">w_j</script> variable*<span class="marginnote">
*In a neural net the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-598-Frame"><nobr><span class="math" id="MathJax-Span-6022" role="math" style="width: 1.148em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.579em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-6023"><span class="msubsup" id="MathJax-Span-6024"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-6025" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.739em;"><span class="mi" id="MathJax-Span-6026" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-598">w_j</script> variables would, of
  course, include all weights and biases.</span>. Then we replace the
gradient descent update rule <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-599-Frame"><nobr><span class="math" id="MathJax-Span-6027" role="math" style="width: 8.973em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6028"><span class="mi" id="MathJax-Span-6029" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-6030" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-6031" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6032" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-6033" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6034" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6035" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-6036" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6037" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6038" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6039" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-599">w \rightarrow w'= w-\eta \nabla C</script> by
<a class="displaced_anchor" name="eqtn107"></a><a class="displaced_anchor" name="eqtn108"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-600-Frame"><nobr><span class="math" id="MathJax-Span-6040" role="math" style="width: 100%; display: inline-block; min-width: 16.571em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.571em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-6041"><span class="mtable" id="MathJax-Span-6042" style="min-width: 16.914em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.571em;"><span style="display: inline-block; position: absolute; width: 9.169em; height: 0px; clip: rect(-1.615em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -4.556em;"><span style="position: absolute; clip: rect(2.797em 1000.002em 4.904em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.654em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6046"><span class="mrow" id="MathJax-Span-6047"><span class="mi" id="MathJax-Span-6048" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6068"><span class="mrow" id="MathJax-Span-6069"><span class="mi" id="MathJax-Span-6070" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.699em 1000.002em 4.904em -999.998em); top: -4.017em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.654em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-6049"><span class="mrow" id="MathJax-Span-6050"><span class="mi" id="MathJax-Span-6051"></span><span class="mo" id="MathJax-Span-6052" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-6071"><span class="mrow" id="MathJax-Span-6072"><span class="mi" id="MathJax-Span-6073"></span><span class="mo" id="MathJax-Span-6074" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.404em 1000.002em 4.953em -999.998em); top: -4.017em; left: 2.551em;"><span style="display: inline-block; position: relative; width: 6.571em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -4.654em; left: 0.002em;"><span class="mtd" id="MathJax-Span-6053"><span class="mrow" id="MathJax-Span-6054"><span class="msup" id="MathJax-Span-6055"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6056" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-6057" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6058" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6059" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-6060" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-6061" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6062" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6063" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6064" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.042em 1000.002em 4.267em -999.998em); top: -3.331em; left: 0.002em;"><span class="mtd" id="MathJax-Span-6075"><span class="mrow" id="MathJax-Span-6076"><span class="msup" id="MathJax-Span-6077"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6078" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-6079" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6080" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6081" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-6082" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msup" id="MathJax-Span-6083" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6084" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-6085" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6086" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-1.566em 1000.002em 1.13em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.654em; right: 0.002em;"><span class="mtd" id="mjx-eqn-107"><span class="mrow" id="MathJax-Span-6044"><span class="mtext" id="MathJax-Span-6045" style="font-family: MathJax_Main;">(107)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.331em; right: 0.002em;"><span class="mtd" id="mjx-eqn-108"><span class="mrow" id="MathJax-Span-6066"><span class="mtext" id="MathJax-Span-6067" style="font-family: MathJax_Main;">(108)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.552em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-600">\begin{eqnarray} 
  v & \rightarrow  & v' = \mu v - \eta \nabla C \tag{107}\\
  
  w & \rightarrow & w' = w+v'.
\tag{108}\end{eqnarray}</script>
In these equations, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-601-Frame"><nobr><span class="math" id="MathJax-Span-6087" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6088"><span class="mi" id="MathJax-Span-6089" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-601">\mu</script> is a hyper-parameter which controls the
amount of damping or friction in the system.  To understand the
meaning of the equations it's helpful to first consider the case where
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-602-Frame"><nobr><span class="math" id="MathJax-Span-6090" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6091"><span class="mi" id="MathJax-Span-6092" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-6093" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-6094" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-602">\mu = 1</script>, which corresponds to no friction.  When that's the case,
inspection of the equations shows that the "force" <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-603-Frame"><nobr><span class="math" id="MathJax-Span-6095" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6096"><span class="mi" id="MathJax-Span-6097" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6098" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-603">\nabla C</script> is now
modifying the velocity, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-604-Frame"><nobr><span class="math" id="MathJax-Span-6099" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6100"><span class="mi" id="MathJax-Span-6101" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-604">v</script>, and the velocity is controlling the rate
of change of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-605-Frame"><nobr><span class="math" id="MathJax-Span-6102" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6103"><span class="mi" id="MathJax-Span-6104" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-605">w</script>.  Intuitively, we build up the velocity by repeatedly
adding gradient terms to it.  That means that if the gradient is in
(roughly) the same direction through several rounds of learning, we
can build up quite a bit of steam moving in that direction.  Think,
for example, of what happens if we're moving straight down a slope:</p><p></p><center>
<img src="./Neural networks and deep learning 3_files/tikz34.png">
</center><p></p><p>With each step the velocity gets larger down the slope, so we move
more and more quickly to the bottom of the valley.  This can enable
the momentum technique to work much faster than standard gradient
descent.  Of course, a problem is that once we reach the bottom of the
valley we will overshoot.  Or, if the gradient should change rapidly,
then we could find ourselves moving in the wrong direction.  That's
the reason for the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-606-Frame"><nobr><span class="math" id="MathJax-Span-6105" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6106"><span class="mi" id="MathJax-Span-6107" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-606">\mu</script> hyper-parameter in <span id="margin_372280252827_reveal" class="equation_link">(107)</span><span id="margin_372280252827" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn107" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-607-Frame"><nobr><span class="math" id="MathJax-Span-6108" role="math" style="width: 9.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.218em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6109"><span class="mtable" id="MathJax-Span-6110" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 8.924em; height: 0px;"><span style="position: absolute; clip: rect(3.483em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6111"><span class="mrow" id="MathJax-Span-6112"><span class="mi" id="MathJax-Span-6113" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.787em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-6114"><span class="mrow" id="MathJax-Span-6115"><span class="mi" id="MathJax-Span-6116"></span><span class="mo" id="MathJax-Span-6117" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 2.355em;"><span style="display: inline-block; position: relative; width: 6.571em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -3.968em; left: 0.002em;"><span class="mtd" id="MathJax-Span-6118"><span class="mrow" id="MathJax-Span-6119"><span class="msup" id="MathJax-Span-6120"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6121" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-6122" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6123" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6124" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-6125" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-6126" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6127" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6128" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6129" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-607">\begin{eqnarray} 
  v & \rightarrow  & v' = \mu v - \eta \nabla C  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_372280252827_reveal').click(function() {$('#margin_372280252827').toggle('slow', function() {});});</script>.  I
said earlier that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-608-Frame"><nobr><span class="math" id="MathJax-Span-6130" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6131"><span class="mi" id="MathJax-Span-6132" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-608">\mu</script> controls the amount of friction in the system;
to be a little more precise, you should think of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-609-Frame"><nobr><span class="math" id="MathJax-Span-6133" role="math" style="width: 2.404em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.355em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6134"><span class="mn" id="MathJax-Span-6135" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-6136" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6137" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-609">1-\mu</script> as the amount
of friction in the system.  When <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-610-Frame"><nobr><span class="math" id="MathJax-Span-6138" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6139"><span class="mi" id="MathJax-Span-6140" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-6141" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-6142" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-610">\mu = 1</script>, as we've seen, there is no
friction, and the velocity is completely driven by the gradient
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-611-Frame"><nobr><span class="math" id="MathJax-Span-6143" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6144"><span class="mi" id="MathJax-Span-6145" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6146" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-611">\nabla C</script>.  By contrast, when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-612-Frame"><nobr><span class="math" id="MathJax-Span-6147" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6148"><span class="mi" id="MathJax-Span-6149" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-6150" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-6151" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-612">\mu = 0</script> there's a lot of friction,
the velocity can't build up, and Equations <span id="margin_813321085033_reveal" class="equation_link">(107)</span><span id="margin_813321085033" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn107" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-613-Frame"><nobr><span class="math" id="MathJax-Span-6152" role="math" style="width: 9.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.218em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6153"><span class="mtable" id="MathJax-Span-6154" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 8.924em; height: 0px;"><span style="position: absolute; clip: rect(3.483em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6155"><span class="mrow" id="MathJax-Span-6156"><span class="mi" id="MathJax-Span-6157" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.787em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-6158"><span class="mrow" id="MathJax-Span-6159"><span class="mi" id="MathJax-Span-6160"></span><span class="mo" id="MathJax-Span-6161" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 2.355em;"><span style="display: inline-block; position: relative; width: 6.571em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -3.968em; left: 0.002em;"><span class="mtd" id="MathJax-Span-6162"><span class="mrow" id="MathJax-Span-6163"><span class="msup" id="MathJax-Span-6164"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6165" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-6166" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6167" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6168" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-6169" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-6170" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6171" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6172" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6173" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-613">\begin{eqnarray} 
  v & \rightarrow  & v' = \mu v - \eta \nabla C  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_813321085033_reveal').click(function() {$('#margin_813321085033').toggle('slow', function() {});});</script>
and <span id="margin_221174517915_reveal" class="equation_link">(108)</span><span id="margin_221174517915" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn108" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-614-Frame"><nobr><span class="math" id="MathJax-Span-6174" role="math" style="width: 8.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.993em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6175"><span class="mtable" id="MathJax-Span-6176" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 7.65em; height: 0px;"><span style="position: absolute; clip: rect(3.483em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6177"><span class="mrow" id="MathJax-Span-6178"><span class="mi" id="MathJax-Span-6179" style="font-family: MathJax_Math-italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.968em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-6180"><span class="mrow" id="MathJax-Span-6181"><span class="mi" id="MathJax-Span-6182"></span><span class="mo" id="MathJax-Span-6183" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 2.551em;"><span style="display: inline-block; position: relative; width: 5.1em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.267em -999.998em); top: -3.968em; left: 0.002em;"><span class="mtd" id="MathJax-Span-6184"><span class="mrow" id="MathJax-Span-6185"><span class="msup" id="MathJax-Span-6186"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6187" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="mo" id="MathJax-Span-6188" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6189" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6190" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-6191" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msup" id="MathJax-Span-6192" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6193" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-6194" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-614">\begin{eqnarray}  
  w & \rightarrow & w' = w+v' \nonumber\end{eqnarray}</script></a></span><script>$('#margin_221174517915_reveal').click(function() {$('#margin_221174517915').toggle('slow', function() {});});</script> reduce to the usual equation for gradient
descent, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-615-Frame"><nobr><span class="math" id="MathJax-Span-6195" role="math" style="width: 8.973em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6196"><span class="mi" id="MathJax-Span-6197" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-6198" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-6199" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6200" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.738em;"><span class="mo" id="MathJax-Span-6201" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6202" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-6203" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-6204" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6205" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6206" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6207" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-615">w \rightarrow w'=w-\eta \nabla C</script>.  In practice, using a
value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-616-Frame"><nobr><span class="math" id="MathJax-Span-6208" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6209"><span class="mi" id="MathJax-Span-6210" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-616">\mu</script> intermediate between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-617-Frame"><nobr><span class="math" id="MathJax-Span-6211" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6212"><span class="mn" id="MathJax-Span-6213" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-617">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-618-Frame"><nobr><span class="math" id="MathJax-Span-6214" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6215"><span class="mn" id="MathJax-Span-6216" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-618">1</script> can give us much of the
benefit of being able to build up speed, but without causing
overshooting.  We can choose such a value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-619-Frame"><nobr><span class="math" id="MathJax-Span-6217" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6218"><span class="mi" id="MathJax-Span-6219" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-619">\mu</script> using the held-out
validation data, in much the same way as we select <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-620-Frame"><nobr><span class="math" id="MathJax-Span-6220" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6221"><span class="mi" id="MathJax-Span-6222" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-620">\eta</script> and
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-621-Frame"><nobr><span class="math" id="MathJax-Span-6223" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6224"><span class="mi" id="MathJax-Span-6225" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-621">\lambda</script>.</p><p></p><p></p><p>I've avoided naming the hyper-parameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-622-Frame"><nobr><span class="math" id="MathJax-Span-6226" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6227"><span class="mi" id="MathJax-Span-6228" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-622">\mu</script> up to now.  The reason
is that the standard name for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-623-Frame"><nobr><span class="math" id="MathJax-Span-6229" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6230"><span class="mi" id="MathJax-Span-6231" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-623">\mu</script> is badly chosen: it's called the
<em>momentum co-efficient</em>.  This is potentially confusing, since
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-624-Frame"><nobr><span class="math" id="MathJax-Span-6232" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6233"><span class="mi" id="MathJax-Span-6234" style="font-family: MathJax_Math-italic;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-624">\mu</script> is not at all the same as the notion of momentum from
physics. Rather, it is much more closely related to friction.
However, the term momentum co-efficient is widely used, so we will
continue to use it.</p><p>A nice thing about the momentum technique is that it takes almost no
work to modify an implementation of gradient descent to incorporate
momentum.  We can still use backpropagation to compute the gradients,
just as before, and use ideas such as sampling stochastically chosen
mini-batches.  In this way, we can get some of the advantages of the
Hessian technique, using information about how the gradient is
changing.  But it's done without the disadvantages, and with only
minor modifications to our code.  In practice, the momentum technique
is commonly used, and often speeds up learning.</p><p></p><h4><a name="exercise_603875"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_603875">Exercise</a></h4><ul>
<li> What would go wrong if we used <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-625-Frame"><nobr><span class="math" id="MathJax-Span-6235" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6236"><span class="mi" id="MathJax-Span-6237" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-6238" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-6239" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-625">\mu > 1</script> in the momentum
  technique?<p></p><p></p></li><li> What would go wrong if we used <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-626-Frame"><nobr><span class="math" id="MathJax-Span-6240" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6241"><span class="mi" id="MathJax-Span-6242" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-6243" style="font-family: MathJax_Main; padding-left: 0.297em;">&lt;</span><span class="mn" id="MathJax-Span-6244" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-626">\mu < 0</script> in the momentum
  technique?
</li></ul><p></p><p></p><h4><a name="problem_713937"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#problem_713937">Problem</a></h4><ul>
<li> Add momentum-based stochastic gradient descent to
  <tt>network2.py</tt>.
</li></ul><p></p><p><strong>Other approaches to minimizing the cost function:</strong> Many other
approaches to minimizing the cost function have been developed, and
there isn't universal agreeement on which is the best approach.  As
you go deeper into neural networks it's worth digging into the other
techniques, understanding how they work, their strengths and
weaknesses, and how to apply them in practice.  A paper I mentioned
earlier*<span class="marginnote">
*<a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">Efficient
    BackProp</a>, by Yann LeCun, Lon Bottou,
  Genevieve Orr and Klaus-Robert Mller (1998).</span>
introduces and compares several of these techniques, including
conjugate gradient descent and the BFGS method (see also the closely
related limited-memory BFGS method, known as
<a href="http://en.wikipedia.org/wiki/Limited-memory_BFGS">L-BFGS</a>).
Another technique which has recently shown promising
results*<span class="marginnote">
*See, for example,
  <a href="http://www.cs.toronto.edu/~hinton/absps/momentum.pdf">On the
    importance of initialization and momentum in deep learning</a>, by
  Ilya Sutskever, James Martens, George Dahl, and Geoffrey Hinton
  (2012).</span> is Nesterov's accelerated gradient technique, which
improves on the momentum technique.  However, for many problems, plain
stochastic gradient descent works well, especially if momentum is
used, and so we'll stick to stochastic gradient descent through the
remainder of this book.</p><p></p><h4><a name="other_models_of_artificial_neuron"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_models_of_artificial_neuron">Other models of artificial neuron</a></h4><p></p><p>Up to now we've built our neural networks using sigmoid neurons.  In
principle, a network built from sigmoid neurons can compute any
function.  In practice, however, networks built using other model
neurons sometimes outperform sigmoid networks.  Depending on the
application, networks based on such alternate models may learn faster,
generalize better to test data, or perhaps do both.  Let me mention a
couple of alternate model neurons, to give you the flavour of some
variations in common use.</p><p>Perhaps the simplest variation is the tanh (pronounched "tanch")
neuron, which replaces the sigmoid function by the hyperbolic tangent
function.  The output of a tanh neuron with input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-627-Frame"><nobr><span class="math" id="MathJax-Span-6245" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6246"><span class="mi" id="MathJax-Span-6247" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-627">x</script>, weight vector
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-628-Frame"><nobr><span class="math" id="MathJax-Span-6248" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6249"><span class="mi" id="MathJax-Span-6250" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-628">w</script>, and bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-629-Frame"><nobr><span class="math" id="MathJax-Span-6251" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6252"><span class="mi" id="MathJax-Span-6253" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-629">b</script> is given by
<a class="displaced_anchor" name="eqtn109"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-630-Frame"><nobr><span class="math" id="MathJax-Span-6254" role="math" style="width: 100%; display: inline-block; min-width: 14.316em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.316em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-6255"><span class="mtable" id="MathJax-Span-6256" style="min-width: 14.561em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.316em;"><span style="display: inline-block; position: absolute; width: 6.816em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.429em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.816em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6260"><span class="mrow" id="MathJax-Span-6261"><span class="mi" id="MathJax-Span-6262" style="font-family: MathJax_Main;">tanh</span><span class="mo" id="MathJax-Span-6263"></span><span class="mo" id="MathJax-Span-6264" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6265" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-6266" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6267" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-6268" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-6269" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-6270" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6271" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-109"><span class="mrow" id="MathJax-Span-6258"><span class="mtext" id="MathJax-Span-6259" style="font-family: MathJax_Main;">(109)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-630">\begin{eqnarray}
 \tanh(w \cdot x+b), 
\tag{109}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-631-Frame"><nobr><span class="math" id="MathJax-Span-6272" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6273"><span class="mi" id="MathJax-Span-6274" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-631">\tanh</script> is, of course, the hyperbolic tangent function.  It
turns out that this is very closely related to the sigmoid neuron.  To
see this, recall that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-632-Frame"><nobr><span class="math" id="MathJax-Span-6275" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6276"><span class="mi" id="MathJax-Span-6277" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-632">\tanh</script> function is defined by
<a class="displaced_anchor" name="eqtn110"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-633-Frame"><nobr><span class="math" id="MathJax-Span-6278" role="math" style="width: 100%; display: inline-block; min-width: 16.277em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.277em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-6279"><span class="mtable" id="MathJax-Span-6280" style="min-width: 16.571em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.277em;"><span style="display: inline-block; position: absolute; width: 8.826em; height: 0px; clip: rect(-1.468em 1000.002em 0.983em -999.998em); top: 0.002em; left: 50%; margin-left: -4.409em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.826em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.953em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6284"><span class="mrow" id="MathJax-Span-6285"><span class="mi" id="MathJax-Span-6286" style="font-family: MathJax_Main;">tanh</span><span class="mo" id="MathJax-Span-6287"></span><span class="mo" id="MathJax-Span-6288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6289" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6290" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6291" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-6292" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -1.762em;"><span class="mrow" id="MathJax-Span-6293"><span class="msubsup" id="MathJax-Span-6294"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6295" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mi" id="MathJax-Span-6296" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6297" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-6298" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6299" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6300"><span class="mrow" id="MathJax-Span-6301"><span class="mo" id="MathJax-Span-6302" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6303" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.287em 1000.002em 4.267em -999.998em); top: -3.331em; left: 50%; margin-left: -1.762em;"><span class="mrow" id="MathJax-Span-6304"><span class="msubsup" id="MathJax-Span-6305"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6306" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.311em; left: 0.493em;"><span class="mi" id="MathJax-Span-6307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-6308" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-6309" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6310" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.311em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6311"><span class="mrow" id="MathJax-Span-6312"><span class="mo" id="MathJax-Span-6313" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.679em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-6315" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.831em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-110"><span class="mrow" id="MathJax-Span-6282"><span class="mtext" id="MathJax-Span-6283" style="font-family: MathJax_Main;">(110)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.897em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-633">\begin{eqnarray}
  \tanh(z) \equiv \frac{e^z-e^{-z}}{e^z+e^{-z}}.
\tag{110}\end{eqnarray}</script>
With a little algebra it can easily be verified that
<a class="displaced_anchor" name="eqtn111"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-634-Frame"><nobr><span class="math" id="MathJax-Span-6316" role="math" style="width: 100%; display: inline-block; min-width: 17.257em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 17.257em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-6317"><span class="mtable" id="MathJax-Span-6318" style="min-width: 17.6em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.257em;"><span style="display: inline-block; position: absolute; width: 9.855em; height: 0px; clip: rect(-1.468em 1000.002em 0.983em -999.998em); top: 0.002em; left: 50%; margin-left: -4.9em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.855em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 4.855em -999.998em); top: -3.87em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6322"><span class="mrow" id="MathJax-Span-6323"><span class="mi" id="MathJax-Span-6324" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6325" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6326" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6327" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6328" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-6329" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -2.988em;"><span class="mrow" id="MathJax-Span-6330"><span class="mn" id="MathJax-Span-6331" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-6332" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-6333" style="font-family: MathJax_Main; padding-left: 0.248em;">tanh</span><span class="mo" id="MathJax-Span-6334"></span><span class="mo" id="MathJax-Span-6335" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6336" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-6337"><span class="mrow" id="MathJax-Span-6338"><span class="mo" id="MathJax-Span-6339" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-6340" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-6341" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-6342" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 6.13em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-6343" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.733em 1000.002em 0.542em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.87em; right: 0.002em;"><span class="mtd" id="mjx-eqn-111"><span class="mrow" id="MathJax-Span-6320"><span class="mtext" id="MathJax-Span-6321" style="font-family: MathJax_Main;">(111)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.302em; vertical-align: -0.897em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-634">\begin{eqnarray} 
  \sigma(z) = \frac{1+\tanh(z/2)}{2},
\tag{111}\end{eqnarray}</script>
that is, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-635-Frame"><nobr><span class="math" id="MathJax-Span-6344" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6345"><span class="mi" id="MathJax-Span-6346" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-635">\tanh</script> is just a rescaled version of the sigmoid function.
We can also see graphically that the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-636-Frame"><nobr><span class="math" id="MathJax-Span-6347" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6348"><span class="mi" id="MathJax-Span-6349" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-636">\tanh</script> function has the same
shape as the sigmoid function,</p><p>
</p><div id="tanh"><svg width="600" height="290"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 100)"><g class="tick" transform="translate(36,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(72,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(144,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(180,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(251.99999999999997,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(288,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><path class="domain" d="M0,6V0H360V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-1.0</text></g><g class="tick" transform="translate(0,150)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-0.5</text></g><g class="tick" transform="translate(0,100)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.0</text></g><g class="tick" transform="translate(0,50)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.5</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1.0</text></g><path class="domain" d="M-6,0H0V200H-6"></path></g><path d="M0,199.9909204262595L0.8999999999999808,199.99045492877627L1.8000000000000256,199.98996556706325L2.6999999999999744,199.98945111782086L3.5999999999999868,199.98891029505543L4.5,199.98834174686775L5.400000000000013,199.98774405207666L6.299999999999993,199.9871157166704L7.1999999999999735,199.98645517007606L8.099999999999987,199.98576076123842L9,199.98503075449787L9.900000000000013,199.98426332525773L10.800000000000026,199.98345655542965L11.699999999999976,199.98260842864642L12.599999999999985,199.98171682522957L13.5,199.9807795169001L14.400000000000013,199.97979416121845L15.300000000000026,199.97875829574036L16.200000000000006,199.9776693318741L17.099999999999987,199.97652454842375L18,199.97532108480277L18.900000000000013,199.9740559339003L19.800000000000026,199.97272593458413L20.699999999999974,199.97132776381972L21.60000000000002,199.96985792838805L22.5,199.9683127561795L23.39999999999998,199.9666883870445L24.300000000000026,199.964980763177L25.200000000000006,199.96318561900733L26.099999999999987,199.96129847057975L27,199.95931460438894L27.900000000000016,199.9572290656471L28.799999999999997,199.95503664595333L29.699999999999978,199.95273187033553L30.599999999999987,199.95030898363214L31.499999999999996,199.94776193618088L32.40000000000001,199.94508436877973L33.300000000000026,199.94226959688305L34.199999999999974,199.9393105939942L35.09999999999999,199.93619997421465L36,199.93292997390668L36.90000000000001,199.92949243242575L37.80000000000001,199.92587877187472L38.700000000000024,199.92207997583225L39.59999999999999,199.9180865670028L40.5,199.9138885837351L41.40000000000001,199.9094755553519L42.299999999999976,199.9048364762323L43.19999999999999,199.89995977858408L44.10000000000002,199.89483330384067L45,199.88944427261526L45.89999999999998,199.88377925313966L46.80000000000001,199.87782412811313L47.700000000000024,199.87156405988281L48.59999999999998,199.86498345387344L49.50000000000001,199.85806592017988L50.40000000000001,199.85079423323268L51.299999999999976,199.8431502894418L52.19999999999999,199.83511506272032L53.09999999999999,199.82666855778416L54,199.81778976111988L54.900000000000006,199.80845658950795L55.80000000000001,199.79864583598288L56.69999999999999,199.78833311310683L57.599999999999994,199.77749279342794L58.5,199.7660979469889L59.40000000000001,199.7541202757445L60.30000000000001,199.74153004474255L61.200000000000024,199.72829600991423L62.09999999999999,199.7143853423155L62.99999999999999,199.69976354865258L63.90000000000002,199.68439438791924L64.79999999999998,199.6682397839651L65.69999999999999,199.651259733809L66.60000000000002,199.63341221150145L67.5,199.61465306733453L68.39999999999998,199.59493592219002L69.30000000000001,199.57421205680717L70.20000000000002,199.55243029574473L71.09999999999998,199.52953688580436L72,199.50547536867305L72.90000000000002,199.48018644753535L73.8,199.45360784739776L74.7,199.42567416885996L75.6,199.39631673505832L76.5,199.36546343150297L77.39999999999998,199.33303853851734L78.30000000000001,199.29896255598672L79.19999999999999,199.26315202011278L80.10000000000002,199.2255193118658L81,199.1859724568208L81.9,199.14441491605902L82.8,199.10074536781175L83.7,199.0548574795209L84.59999999999998,199.0066396699886L85.5,198.9559748612883L86.40000000000002,198.90274022010993L87.29999999999998,198.846806888215L88.2,198.78803970168315L89.10000000000002,198.7262968986369L90,198.66142981514307L90.89999999999998,198.59328256900096L91.8,198.5216917311436L92.70000000000002,198.44648598439701L93.59999999999998,198.367485769368L94.5,198.2845029172576L95.4,198.19734026943047L96.30000000000003,198.10579128361078L97.2,198.00963962661916L98.1,197.90865875361638L99.00000000000001,197.80261147388137L99.9,197.69124950321552L100.80000000000003,197.57431300314514L101.69999999999997,197.45153010717766L102.6,197.32261643446702L103.49999999999999,197.1872745913509L104.4,197.04519366134542L105.3,196.89604868431823L106.19999999999997,196.73950012571183L107.1,196.57519333685445L108,196.4027580075817L108.90000000000002,196.2218076125922L109.79999999999998,196.0319388531845L110.7,195.8327310962639L111.60000000000002,195.6237458127739L112.5,195.40452601799487L113.39999999999998,195.17459571646617L114.3,194.93345935462565L115.20000000000002,194.68060128462682L116.09999999999998,194.4154852431854L117,194.13755384972873L117.9,193.8462281285704L118.80000000000003,193.54090706030988L119.7,193.22096716816438L120.6,192.8857621454728L121.50000000000001,192.5346225311741L122.4,192.1668554406471L123.30000000000003,191.781744359907L124.19999999999997,191.37854901178278L125.1,190.95650530334248L125.99999999999999,190.51482536448665L126.9,190.05269768828865L127.8,189.56928738431645L128.7,189.06373655681185L129.6,188.53516482022624L130.5,187.98266996519848L131.4,187.4053287886007L132.29999999999998,186.80219810175626L133.2,186.17231593133064L134.10000000000002,185.51470292769645L135,184.8283639957513L135.89999999999998,184.1122901632043L136.8,183.36546070121554L137.70000000000002,182.58684551194574L138.6,181.77540779702878L139.5,180.9301070201781L140.4,180.04990217606297L141.3,179.13375537619973L142.20000000000002,178.1806357608774L143.1,177.18952374404185L144,176.1594155955765L144.9,175.08932836251668L145.80000000000004,173.97830512740038L146.69999999999996,172.82542059818118L147.6,171.62978701990244L148.5,170.39056039366213L149.4,169.10694698329306L150.29999999999998,167.77821008468297L151.2,166.40367702678492L152.1,164.98274636719205L153,163.51489523872874L153.9,161.99968679693737L154.79999999999995,160.4367777117164L155.7,158.82592563981052L156.59999999999997,157.1669966085117L157.5,155.45997223493822L158.40000000000003,153.70495669980352L159.3,151.90218338982223L160.20000000000005,150.0520211190235L161.1,148.1549798364308L162,146.211715726001L162.9,144.2230356045726L163.8,142.18990052500075L164.70000000000002,140.1134284947946L165.6,137.99489622552247L166.5,135.83573983507858L167.4,133.6375544336332L168.30000000000004,131.4020925346997L169.19999999999996,129.13126124515918L170.1,126.82711820216015L171,124.49186624037092L171.9,122.12784678984443L172.79999999999998,119.73753202249043L173.7,117.32351578346605L174.6,114.88850336233185L175.5,112.43530017715963L176.4,109.96679946249554L177.29999999999995,107.48596906874997L178.2,104.99583749578798L179.09999999999997,102.49947929684207L180,100L180.89999999999998,97.50052070315797L181.8,95.00416250421202L182.7,92.51403093125015L183.6,90.03320053750446L184.49999999999997,87.56469982284037L185.4,85.11149663766815L186.29999999999998,82.67648421653399L187.20000000000002,80.26246797750957L188.1,77.87215321015563L189,75.50813375962908L189.89999999999998,73.17288179783992L190.8,70.86873875484083L191.7,68.5979074653003L192.60000000000002,66.36244556636674L193.5,64.1642601649214L194.4,62.0051037744775L195.29999999999998,59.886571505205424L196.20000000000002,57.81009947499918L197.1,55.776964395427406L198.00000000000003,53.78828427399902L198.9,51.845020163569174L199.8,49.94797888097642L200.7,48.09781661017778L201.60000000000002,46.295043300196426L202.5,44.54002776506179L203.39999999999998,42.83300339148832L204.3,41.17407436018947L205.2,39.563222288283704L206.1,38.00031320306263L206.99999999999997,36.48510476127127L207.9,35.01725363280794L208.79999999999998,33.59632297321511L209.70000000000002,32.22178991531703L210.6,30.89305301670695L211.5,29.609439606337883L212.39999999999998,28.370212980097563L213.3,27.17457940181882L214.2,26.02169487259962L215.10000000000002,24.91067163748326L216,23.840584404423517L216.9,22.810476255958157L217.79999999999998,21.819364239122585L218.70000000000002,20.866244623800245L219.6,19.950097823937043L220.50000000000003,19.069892979821912L221.4,18.224592202971234L222.3,17.41315448805423L223.2,16.634539298784468L224.10000000000002,15.887709836795661L225,15.171636004248711L225.89999999999998,14.485297072303549L226.8,13.827684068669367L227.7,13.197801898243778L228.6,12.5946712113993L229.49999999999997,12.017330034801521L230.4,11.464835179773747L231.29999999999998,10.936263443188166L232.20000000000002,10.430712615683536L233.1,9.947302311711347L234,9.48517463551335L234.89999999999998,9.043494696657506L235.8,8.621450988217227L236.7,8.218255640092998L237.60000000000002,7.833144559352867L238.5,7.465377468825896L239.4,7.114237854527206L240.29999999999998,6.77903283183563L241.20000000000002,6.459092939690092L242.1,6.153771871429603L243.00000000000003,5.86244615027125L243.9,5.584514756814607L244.8,5.319398715373147L245.7,5.066540645374351L246.60000000000002,4.8254042835338185L247.5,4.595473982005127L248.39999999999998,4.376254187226092L249.3,4.16726890373611L250.2,3.968061146815516L251.1,3.7781923874078194L251.99999999999997,3.5972419924183097L252.9,3.424806663145552L253.79999999999998,3.2604998742881808L254.70000000000002,3.1039513156817744L255.6,2.954806338654592L256.5,2.812725408649097L257.4,2.677383565532976L258.3,2.548469892822336L259.2,2.425686996854859L260.1,2.308750496784473L261,2.1973885261186377L261.90000000000003,2.0913412463836156L262.8,1.9903603733808506L263.7,1.8942087163892118L264.6,1.8026597305695446L265.5,1.7154970827423899L266.4,1.6325142306319984L267.3,1.5535140156029748L268.2,1.4783082688563987L269.1,1.4067174309990271L270,1.3385701848569465L270.9,1.2737031013631217L271.8,1.2119602983168498L272.7,1.1531931117849892L273.6,1.0972597798900807L274.5,1.0440251387116906L275.4,0.9933603300114058L276.3,0.9451425204791031L277.2,0.8992546321882511L278.09999999999997,0.8555850839409906L279,0.8140275431792077L279.9,0.7744806881341937L280.8,0.736847979887223L281.7,0.701037444013286L282.6,0.6669614614826624L283.5,0.634536568497035L284.40000000000003,0.6036832649416901L285.3,0.5743258311400545L286.2,0.5463921526022375L287.1,0.5198135524646652L288,0.49452463132695357L288.9,0.4704631141956295L289.8,0.44756970425525733L290.69999999999993,0.42578794319283464L291.6000000000001,0.4050640778099801L292.5,0.3853469326654757L293.3999999999999,0.36658778849854023L294.30000000000007,0.3487402661909833L295.2,0.33176021603489314L296.1,0.31560561208077154L297,0.30023645134740207L297.9,0.28561465768450756L298.79999999999995,0.27170399008578094L299.7,0.25846995525746763L300.59999999999997,0.24587972425549331L301.5,0.23390205301110356L302.40000000000003,0.22250720657206458L303.3,0.21166688689318036L304.2,0.20135416401712014L305.09999999999997,0.19154341049203438L306,0.18221023888012056L306.90000000000003,0.1733314422158294L307.8,0.16488493727968567L308.70000000000005,0.1568497105582045L309.6,0.1492057667673352L310.5,0.1419340798201052L311.4,0.1350165461265762L312.3,0.12843594011719972L313.19999999999993,0.12217587188687595L314.1000000000001,0.11622074686032935L315,0.1105557273847424L315.8999999999999,0.10516669615934227L316.80000000000007,0.10004022141592017L317.7,0.09516352376768289L318.6,0.09052444464812126L319.5,0.08611141626491126L320.4,0.08191343299719378L321.29999999999995,0.07792002416775468L322.2,0.07412122812526789L323.09999999999997,0.0705075675742517L324,0.0670700260933188L324.90000000000003,0.06380002578536548L325.8,0.060689406005787205L326.7,0.05773040311694011L327.59999999999997,0.05491563122026477L328.5,0.05223806381913221L329.40000000000003,0.04969101636786988L330.3,0.04726812966446836L331.20000000000005,0.044963354046667625L332.1,0.04277093435289814L333,0.04068539561106199L333.9,0.038701529420248626L334.8,0.036814380992677975L335.69999999999993,0.035019236822986244L336.6000000000001,0.0333116129554778L337.5,0.03168724382049959L338.3999999999999,0.03014207161193827L339.30000000000007,0.028672236180282695L340.2,0.027274065415872073L341.1,0.025944066099703456L342,0.024678915197240414L342.9,0.023475451576238093L343.79999999999995,0.02233066812591389L344.7,0.021241704259633565L345.59999999999997,0.02020583878155069L346.5,0.019220483099902097L347.40000000000003,0.018283174770417077L348.3,0.0173915713535866L349.2,0.016543444570338295L350.09999999999997,0.01573667474226159L351,0.014969245502127748L351.90000000000003,0.014239238761581952L352.8,0.013544829923950452L353.70000000000005,0.012884283329617219L354.6,0.012255947923334176L355.5,0.011658253132251772L356.4,0.011089704944566847L357.3,0.010548882179151065L358.19999999999993,0.010034432936745219L359.1000000000001,0.009545071223726609"></path><text class="x label" text-anchor="end" x="380" y="108">z</text><text x="180" y="-10" text-anchor="middle" style="font-size: 16px;">tanh function</text></g></svg></div>
<script>
function s(x) {return (Math.exp(x)-Math.exp(-x))/(Math.exp(x)+Math.exp(-x));}
var m = [40, 120, 50, 120];
var height = 290 - m[0] - m[2];
var width = 600 - m[1] - m[3];
var xmin = -5;
var xmax = 5;
var sample = 400;
var x1 = d3.scale.linear().domain([0, sample]).range([xmin, xmax]);
var data = d3.range(sample).map(function(d){ return {
        x: x1(d), 
        y: s(x1(d))}; 
    });
var x = d3.scale.linear().domain([xmin, xmax]).range([0, width]);
var y = d3.scale.linear()
                .domain([-1,1])
                .range([height, 0]);
var line = d3.svg.line()
    .x(function(d) { return x(d.x); })
    .y(function(d) { return y(d.y); })
var graph = d3.select("#tanh")
    .append("svg")
    .attr("width", width + m[1] + m[3])
    .attr("height", height + m[0] + m[2])
    .append("g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");
var xAxis = d3.svg.axis()
                  .scale(x)
                  .tickValues(d3.range(-4, 5, 1))
                  .orient("bottom")
graph.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, " + height/2 + ")")
    .call(xAxis);
var yAxis = d3.svg.axis()
                  .scale(y)
                  .tickValues(d3.range(-1, 1.01, 0.5))
                  .orient("left")
graph.append("g")
    .attr("class", "y axis")
    .call(yAxis);
graph.append("path").attr("d", line(data));
graph.append("text")
     .attr("class", "x label")
     .attr("text-anchor", "end")
     .attr("x", width+20)
     .attr("y", height/2+8)
     .text("z");
graph.append("text")
        .attr("x", (width / 2))             
        .attr("y", -10)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .text("tanh function");
</script>
<p></p><p>One difference between tanh neurons and sigmoid neurons is that the
output from tanh neurons ranges from -1 to 1, not 0 to 1.  This means
that if you're going to build a network based on tanh neurons you may
need to normalize your outputs (and, depending on the details of the
application, possibly your inputs) a little differently than in
sigmoid networks.</p><p>Similar to sigmoid neurons, a network of tanh neurons can, in
principle, compute any function*<span class="marginnote">
*There are some technical
  caveats to this statement for both tanh and sigmoid neurons, as well
  as for the rectified linear neurons discussed below.  However,
  informally it's usually fine to think of neural networks as being
  able to approximate any function to arbitrary accuracy.</span> mapping
inputs to the range -1 to 1.  Furthermore, ideas such as
backpropagation and stochastic gradient descent are as easily applied
to a network of tanh neurons as to a network of sigmoid neurons.</p><p></p><h4><a name="exercise_1251"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#exercise_1251">Exercise</a></h4><ul>
<li> Prove the identity in Equation <span id="margin_584751901676_reveal" class="equation_link">(111)</span><span id="margin_584751901676" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap3.html#eqtn111" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-637-Frame"><nobr><span class="math" id="MathJax-Span-6350" role="math" style="width: 10.051em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.855em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6351"><span class="mtable" id="MathJax-Span-6352" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 9.561em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.002em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.561em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 4.855em -999.998em); top: -3.87em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6353"><span class="mrow" id="MathJax-Span-6354"><span class="mi" id="MathJax-Span-6355" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6356" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6357" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6358" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6359" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-6360" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.752em; left: 50%; margin-left: -2.988em;"><span class="mrow" id="MathJax-Span-6361"><span class="mn" id="MathJax-Span-6362" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-6363" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-6364" style="font-family: MathJax_Main; padding-left: 0.248em;">tanh</span><span class="mo" id="MathJax-Span-6365"></span><span class="mo" id="MathJax-Span-6366" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6367" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-6368"><span class="mrow" id="MathJax-Span-6369"><span class="mo" id="MathJax-Span-6370" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-6371" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-6372" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-6373" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 6.13em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.302em; vertical-align: -0.897em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-637">\begin{eqnarray} 
  \sigma(z) = \frac{1+\tanh(z/2)}{2} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_584751901676_reveal').click(function() {$('#margin_584751901676').toggle('slow', function() {});});</script>.
</li></ul><p></p><p>Which type of neuron should you use in your networks, the tanh or
sigmoid?  <em>A priori</em> the answer is not obvious, to put it mildly!
However, there are theoretical arguments and some empirical evidence
to suggest that the tanh sometimes performs better*<span class="marginnote">
*See, for
  example,
  <a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">Efficient
    BackProp</a>, by Yann LeCun, Lon Bottou,
  Genevieve Orr and Klaus-Robert Mller (1998), and
  <a href="http://jmlr.org/proceedings/papers/v9/glorot10a/glorot10a.pdf">Understanding
    the difficulty of training deep feedforward networks</a>, by Xavier
  Glorot and Yoshua Bengio (2010).</span>.  Let me briefly give you the
flavour of one of the theoretical arguments for tanh neurons.  Suppose
we're using sigmoid neurons, so all activations in our network are
positive.  Let's consider the weights <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-638-Frame"><nobr><span class="math" id="MathJax-Span-6374" role="math" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.659em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6375"><span class="msubsup" id="MathJax-Span-6376"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6377" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6378"><span class="mrow" id="MathJax-Span-6379"><span class="mi" id="MathJax-Span-6380" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6381" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6382" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6383"><span class="mrow" id="MathJax-Span-6384"><span class="mi" id="MathJax-Span-6385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-6386" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.502em; vertical-align: -0.547em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-638">w^{l+1}_{jk}</script> input to the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-639-Frame"><nobr><span class="math" id="MathJax-Span-6387" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6388"><span class="mi" id="MathJax-Span-6389" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-639">j</script>th neuron in the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-640-Frame"><nobr><span class="math" id="MathJax-Span-6390" role="math" style="width: 2.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.061em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6391"><span class="mi" id="MathJax-Span-6392" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6393" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mn" id="MathJax-Span-6394" style="font-family: MathJax_Main; padding-left: 0.248em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-640">l+1</script>th layer.  The rules for backpropagation (see
<a href="http://neuralnetworksanddeeplearning.com/chap2.html#eqtnBP4">here</a>) tell us that the associated gradient
will be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-641-Frame"><nobr><span class="math" id="MathJax-Span-6395" role="math" style="width: 2.699em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.65em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6396"><span class="msubsup" id="MathJax-Span-6397"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6398" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.36em; left: 0.542em;"><span class="mi" id="MathJax-Span-6399" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.542em;"><span class="mi" id="MathJax-Span-6400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6401"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6402" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6403"><span class="mrow" id="MathJax-Span-6404"><span class="mi" id="MathJax-Span-6405" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6406" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6407" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-6408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.453em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-641">a^l_k \delta^{l+1}_j</script>.  Because the activations are positive
the sign of this gradient will be the same as the sign of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-642-Frame"><nobr><span class="math" id="MathJax-Span-6409" role="math" style="width: 1.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6410"><span class="msubsup" id="MathJax-Span-6411"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6412" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6413"><span class="mrow" id="MathJax-Span-6414"><span class="mi" id="MathJax-Span-6415" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6416" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6417" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-6418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.453em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-642">\delta^{l+1}_j</script>.  What this means is that if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-643-Frame"><nobr><span class="math" id="MathJax-Span-6419" role="math" style="width: 1.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6420"><span class="msubsup" id="MathJax-Span-6421"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6422" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6423"><span class="mrow" id="MathJax-Span-6424"><span class="mi" id="MathJax-Span-6425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6426" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6427" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-6428" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.453em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-643">\delta^{l+1}_j</script> is
positive then <em>all</em> the weights <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-644-Frame"><nobr><span class="math" id="MathJax-Span-6429" role="math" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.659em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6430"><span class="msubsup" id="MathJax-Span-6431"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6432" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6433"><span class="mrow" id="MathJax-Span-6434"><span class="mi" id="MathJax-Span-6435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6436" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6437" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6438"><span class="mrow" id="MathJax-Span-6439"><span class="mi" id="MathJax-Span-6440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-6441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.502em; vertical-align: -0.547em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-644">w^{l+1}_{jk}</script> will decrease
during gradient descent, while if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-645-Frame"><nobr><span class="math" id="MathJax-Span-6442" role="math" style="width: 1.767em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6443"><span class="msubsup" id="MathJax-Span-6444"><span style="display: inline-block; position: relative; width: 1.718em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6445" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.493em;"><span class="texatom" id="MathJax-Span-6446"><span class="mrow" id="MathJax-Span-6447"><span class="mi" id="MathJax-Span-6448" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6449" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6450" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 0.444em;"><span class="mi" id="MathJax-Span-6451" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.453em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-645">\delta^{l+1}_j</script> is negative then
<em>all</em> the weights <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-646-Frame"><nobr><span class="math" id="MathJax-Span-6452" role="math" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.659em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6453"><span class="msubsup" id="MathJax-Span-6454"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6455" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.218em -999.998em); top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6456"><span class="mrow" id="MathJax-Span-6457"><span class="mi" id="MathJax-Span-6458" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-6459" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-6460" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.674em; left: 0.738em;"><span class="texatom" id="MathJax-Span-6461"><span class="mrow" id="MathJax-Span-6462"><span class="mi" id="MathJax-Span-6463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-6464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.502em; vertical-align: -0.547em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-646">w^{l+1}_{jk}</script> will increase during gradient
descent.  In other words, all weights to the same neuron must either
increase together or decrease together.  That's a problem, since some
of the weights may need to increase while others need to decrease.
That can only happen if some of the input activations have different
signs.  That suggests replacing the sigmoid by an activation function,
such as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-647-Frame"><nobr><span class="math" id="MathJax-Span-6465" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6466"><span class="mi" id="MathJax-Span-6467" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-647">\tanh</script>, which allows both positive and negative activations.
Indeed, because <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-648-Frame"><nobr><span class="math" id="MathJax-Span-6468" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6469"><span class="mi" id="MathJax-Span-6470" style="font-family: MathJax_Main;">tanh</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-648">\tanh</script> is symmetric about zero, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-649-Frame"><nobr><span class="math" id="MathJax-Span-6471" role="math" style="width: 9.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.561em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6472"><span class="mi" id="MathJax-Span-6473" style="font-family: MathJax_Main;">tanh</span><span class="mo" id="MathJax-Span-6474"></span><span class="mo" id="MathJax-Span-6475" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-6476" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-6477" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6478" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6479" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-6480" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-6481" style="font-family: MathJax_Main; padding-left: 0.15em;">tanh</span><span class="mo" id="MathJax-Span-6482"></span><span class="mo" id="MathJax-Span-6483" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6484" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6485" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-649">\tanh(-z) =
-\tanh(z)</script>, we might even expect that, roughly speaking, the
activations in hidden layers would be equally balanced between
positive and negative.  That would help ensure that there is no
systematic bias for the weight updates to be one way or the other.</p><p>How seriously should we take this argument?  While the argument is
suggestive, it's a heuristic, not a rigorous proof that tanh neurons
outperform sigmoid neurons.  Perhaps there are other properties of the
sigmoid neuron which compensate for this problem?  Indeed, for many
tasks the tanh is found empirically to provide only a small or no
improvement in performance over sigmoid neurons.  Unfortunately, we
don't yet have hard-and-fast rules to know which neuron types will
learn fastest, or give the best generalization performance, for any
particular application.</p><p>Another variation on the sigmoid neuron is the <em>rectified linear
  neuron</em> or <em>rectified linear unit</em>.  The output of a rectified
linear unit with input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-650-Frame"><nobr><span class="math" id="MathJax-Span-6486" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6487"><span class="mi" id="MathJax-Span-6488" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-650">x</script>, weight vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-651-Frame"><nobr><span class="math" id="MathJax-Span-6489" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6490"><span class="mi" id="MathJax-Span-6491" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-651">w</script>, and bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-652-Frame"><nobr><span class="math" id="MathJax-Span-6492" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6493"><span class="mi" id="MathJax-Span-6494" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-652">b</script> is given
by
<a class="displaced_anchor" name="eqtn112"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-653-Frame"><nobr><span class="math" id="MathJax-Span-6495" role="math" style="width: 100%; display: inline-block; min-width: 15.051em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.051em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-6496"><span class="mtable" id="MathJax-Span-6497" style="min-width: 15.346em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.051em;"><span style="display: inline-block; position: absolute; width: 7.6em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.821em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.6em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-6501"><span class="mrow" id="MathJax-Span-6502"><span class="mo" id="MathJax-Span-6503" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-6504" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-6505" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-6506" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6507" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">w</span><span class="mo" id="MathJax-Span-6508" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-6509" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-6510" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-6511" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-6512" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-6513" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 2.257em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-112"><span class="mrow" id="MathJax-Span-6499"><span class="mtext" id="MathJax-Span-6500" style="font-family: MathJax_Main;">(112)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-653">\begin{eqnarray}
  \max(0, w \cdot x+b).
\tag{112}\end{eqnarray}</script>
Graphically, the rectifying function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-654-Frame"><nobr><span class="math" id="MathJax-Span-6514" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6515"><span class="mo" id="MathJax-Span-6516" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-6517" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-6518" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-6519" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6520" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6521" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-654">\max(0, z)</script> looks like this:</p><p>
</p><div id="relu"><svg width="550" height="340"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 125)"><g class="tick" transform="translate(31,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(62,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(93,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(124,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(155,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(186,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(217,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(248,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(279,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><g class="tick" transform="translate(310,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">5</text></g><path class="domain" d="M0,6V0H310V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,225)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-4</text></g><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-3</text></g><g class="tick" transform="translate(0,175)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-2</text></g><g class="tick" transform="translate(0,150)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">-1</text></g><g class="tick" transform="translate(0,125)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0</text></g><g class="tick" transform="translate(0,100)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1</text></g><g class="tick" transform="translate(0,75.00000000000001)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">2</text></g><g class="tick" transform="translate(0,49.999999999999986)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">3</text></g><g class="tick" transform="translate(0,24.999999999999993)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">4</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">5</text></g><path class="domain" d="M-6,0H0V250H-6"></path></g><path d="M0,125L3.099999999999989,125L6.199999999999978,125L9.300000000000022,125L12.400000000000011,125L15.5,125L18.600000000000016,125L21.700000000000006,125L24.799999999999997,125L27.900000000000013,125L31,125L34.09999999999999,125L37.19999999999999,125L40.30000000000001,125L43.40000000000001,125L46.5,125L49.599999999999994,125L52.700000000000024,125L55.79999999999998,125L58.899999999999984,125L62,125L65.1,125L68.19999999999999,125L71.3,125L74.40000000000002,125L77.5,125L80.59999999999998,125L83.7,125L86.80000000000003,125L89.9,125L93,125L96.10000000000002,125L99.20000000000002,125L102.30000000000003,125L105.4,125L108.5,125L111.6,125L114.7,125L117.8,125L120.9,125L124,125L127.1,125L130.2,125L133.29999999999995,125L136.4,125L139.5,125L142.6,125L145.7,125L148.79999999999998,125L151.9,125L155,125L158.1,122.5L161.20000000000002,120L164.3,117.5L167.4,114.99999999999999L170.5,112.49999999999999L173.60000000000002,109.99999999999999L176.7,107.50000000000001L179.79999999999998,105.00000000000001L182.89999999999998,102.50000000000001L186,100L189.1,97.5L192.2,95L195.3,92.5L198.4,90L201.5,87.5L204.60000000000002,84.99999999999999L207.70000000000002,82.49999999999999L210.8,79.99999999999999L213.89999999999998,77.50000000000001L217,75.00000000000001L220.1,72.50000000000001L223.2,70L226.29999999999998,67.5L229.4,65L232.5,62.5L235.6,60L238.70000000000002,57.49999999999999L241.8,54.99999999999999L244.9,52.49999999999999L248,49.999999999999986L251.10000000000005,47.49999999999996L254.2,45.000000000000014L257.29999999999995,42.500000000000036L260.40000000000003,39.99999999999998L263.5,37.50000000000001L266.6,35L269.7,32.50000000000003L272.8,29.99999999999997L275.9,27.499999999999996L279,24.999999999999993L282.09999999999997,22.50000000000002L285.20000000000005,19.99999999999996L288.3,17.49999999999999L291.4,15.00000000000004L294.5,12.50000000000001L297.59999999999997,10.000000000000009L300.7,7.500000000000007L303.8,4.999999999999977L306.9,2.500000000000002"></path><text class="x label" text-anchor="end" x="330" y="133">z</text><text x="155" y="-10" text-anchor="middle" style="font-size: 16px;">max(0, z)</text></g></svg></div>
<script type="text/javascript">
function s(x) {return Math.max(0, x);}
var m = [40, 120, 50, 120];
var height = 340 - m[0] - m[2];
var width = 550 - m[1] - m[3];
var xmin = -5;
var xmax = 5;
var sample = 100;
var x1 = d3.scale.linear().domain([0, sample]).range([xmin, xmax]);
var data = d3.range(sample).map(function(d){ return {
        x: x1(d), 
        y: s(x1(d))}; 
    });
var x = d3.scale.linear().domain([xmin, xmax]).range([0, width]);
var y = d3.scale.linear()
                .domain([-5, 5])
                .range([height, 0]);
var line = d3.svg.line()
    .x(function(d) { return x(d.x); })
    .y(function(d) { return y(d.y); })
var graph = d3.select("#relu")
    .append("svg")
    .attr("width", width + m[1] + m[3])
    .attr("height", height + m[0] + m[2])
    .append("g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");
var xAxis = d3.svg.axis()
                  .scale(x)
                  .tickValues(d3.range(-4, 5.01, 1))
                  .orient("bottom")
graph.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, " + height/2 + ")")
    .call(xAxis);
var yAxis = d3.svg.axis()
                  .scale(y)
                  .tickValues(d3.range(-4, 5.01, 1))
                  .orient("left")
graph.append("g")
    .attr("class", "y axis")
    .call(yAxis);
graph.append("path").attr("d", line(data));
graph.append("text")
     .attr("class", "x label")
     .attr("text-anchor", "end")
     .attr("x", width+20)
     .attr("y", height/2+8)
     .text("z");
graph.append("text")
        .attr("x", (width / 2))             
        .attr("y", -10)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .text("max(0, z)");
</script><p></p><p>Obviously such neurons are quite different from both sigmoid and tanh
neurons.  However, like the sigmoid and tanh neurons, rectified linear
units can be used to compute any function, and they can be trained
using ideas such as backpropagation and stochastic gradient descent.</p><p>When should you use rectified linear units instead of sigmoid or tanh
neurons?  Some recent work on image recognition*<span class="marginnote">
*See, for
  example,
  <a href="http://yann.lecun.com/exdb/publis/pdf/jarrett-iccv-09.pdf">What
    is the Best Multi-Stage Architecture for Object Recognition?</a>, by
  Kevin Jarrett, Koray Kavukcuoglu, Marc'Aurelio Ranzato and Yann
  LeCun (2009),
  <a href="http://eprints.pascal-network.org/archive/00008596/01/glorot11a.pdf">Deep
    Sparse Rectier Neural Networks</a>, by Xavier Glorot, Antoine
  Bordes, and Yoshua Bengio (2011), and
  <a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">ImageNet
    Classification with Deep Convolutional Neural Networks</a>, by Alex
  Krizhevsky, Ilya Sutskever, and Geoffrey Hinton (2012).  Note that
  these papers fill in important details about how to set up the
  output layer, cost function, and regularization in networks using
  rectified linear units. I've glossed over all these details in this
  brief account. The papers also discuss in more detail the benefits
  and drawbacks of using rectified linear units.  Another informative
  paper is
  <a href="https://www.cs.toronto.edu/~hinton/absps/reluICML.pdf">Rectified
    Linear Units Improve Restricted Boltzmann Machines</a>, by Vinod Nair
  and Geoffrey Hinton (2010), which demonstrates the benefits of using
  rectified linear units in a somewhat different approach to neural
  networks.</span>  has found considerable benefit in using rectified linear
units through much of the network.  However, as with tanh neurons, we
do not yet have a really deep understanding of when, exactly,
rectified linear units are preferable, nor why.  To give you the
flavour of some of the issues, recall that sigmoid neurons stop
learning when they saturate, i.e., when their output is near either
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-655-Frame"><nobr><span class="math" id="MathJax-Span-6522" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6523"><span class="mn" id="MathJax-Span-6524" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-655">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-656-Frame"><nobr><span class="math" id="MathJax-Span-6525" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6526"><span class="mn" id="MathJax-Span-6527" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-656">1</script>.  As we've seen repeatedly in this chapter, the problem is
that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-657-Frame"><nobr><span class="math" id="MathJax-Span-6528" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-6529"><span class="msup" id="MathJax-Span-6530"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-6531" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mo" id="MathJax-Span-6532" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-657">\sigma'</script> terms reduce the gradient, and that slows down
learning.  Tanh neurons suffer from a similar problem when they
saturate.  By contrast, increasing the weighted input to a rectified
linear unit will never cause it to saturate, and so there is no
corresponding learning slowdown.  On the other hand, when the weighted
input to a rectified linear unit is negative, the gradient vanishes,
and so the neuron stops learning entirely.  These are just two of the
many issues that make it non-trivial to understand when and why
rectified linear units perform better than sigmoid or tanh neurons.</p><p>I've painted a picture of uncertainty here, stressing that we do not
yet have a solid theory of how activation functions should be chosen.
Indeed, the problem is harder even than I have described, for there
are infinitely many possible activation functions.  Which is the best
for any given problem?  Which will result in a network which learns
fastest?  Which will give the highest test accuracies? I am surprised
how little really deep and systematic investigation has been done of
these questions.  Ideally, we'd have a theory which tells us, in
detail, how to choose (and perhaps modify-on-the-fly) our activation
functions.  On the other hand, we shouldn't let the lack of a full
theory stop us!  We have powerful tools already at hand, and can make
a lot of progress with those tools.  Through the remainder of this
book I'll continue to use sigmoid neurons as our go-to neuron, since
they're powerful and provide concrete illustrations of the core ideas
about neural nets.  But keep in the back of your mind that these same
ideas can be applied to other types of neuron, and that there are
sometimes advantages in doing so.</p><p></p><h4><a name="on_stories_in_neural_networks"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#on_stories_in_neural_networks">On stories in neural networks</a></h4> <p></p><p></p><blockquote><em><strong>Question:</strong> How do you
  approach utilizing and researching machine learning techniques that
  are supported almost entirely empirically, as opposed to
  mathematically? Also in what situations have you noticed some of
  these techniques fail?<p></p><p>  <strong>Answer:</strong> You have to realize that our theoretical
  tools are very weak. Sometimes, we have good mathematical intuitions
  for why a particular technique should work. Sometimes our intuition
  ends up being wrong [...] The questions become: how well does my
  method work on this particular problem, and how large is the set of
  problems on which it works well.</p></em><p><em>  -
  <a href="http://www.reddit.com/r/MachineLearning/comments/25lnbt/ama_yann_lecun/chivdv7">Question
    and answer</a> with neural networks researcher Yann LeCun</em></p></blockquote><p></p><p>Once, attending a conference on the foundations of quantum mechanics,
I noticed what seemed to me a most curious verbal habit: when talks
finished, questions from the audience often began with "I'm very
sympathetic to your point of view, but [...]".  Quantum foundations
was not my usual field, and I noticed this style of questioning
because at other scientific conferences I'd rarely or never heard a
questioner express their sympathy for the point of view of the
speaker.  At the time, I thought the prevalence of the question
suggested that little genuine progress was being made in quantum
foundations, and people were merely spinning their wheels.  Later, I
realized that assessment was too harsh.  The speakers were wrestling
with some of the hardest problems human minds have ever confronted.
Of course progress was slow!  But there was still value in hearing
updates on how people were thinking, even if they didn't always have
unarguable new progress to report.</p><p>You may have noticed a verbal tic similar to "I'm very sympathetic
[...]" in the current book.  To explain what we're seeing I've often
fallen back on saying "Heuristically, [...]", or "Roughly speaking,
[...]", following up with a story to explain some phenomenon or
other.  These stories are plausible, but the empirical evidence I've
presented has often been pretty thin.  If you look through the
research literature you'll see that stories in a similar style appear
in many research papers on neural nets, often with thin supporting
evidence.  What should we think about such stories?</p><p>In many parts of science - especially those parts that deal with
simple phenomena - it's possible to obtain very solid, very reliable
evidence for quite general hypotheses.  But in neural networks there
are large numbers of parameters and hyper-parameters, and extremely
complex interactions between them.  In such extraordinarily complex
systems it's exceedingly difficult to establish reliable general
statements.  Understanding neural networks in their full generality is
a problem that, like quantum foundations, tests the limits of the
human mind.  Instead, we often make do with evidence for or against a
few specific instances of a general statement.  As a result those
statements sometimes later need to be modified or abandoned, when new
evidence comes to light.</p><p>One way of viewing this situation is that any heuristic story about
neural networks carries with it an implied challenge.  For example,
consider the statement I <a href="http://neuralnetworksanddeeplearning.com/chap3.html#dropout_explanation">quoted
  earlier</a>, explaining why dropout works*<span class="marginnote">
*From
  <a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">ImageNet
    Classification with Deep Convolutional Neural Networks</a> by Alex
  Krizhevsky, Ilya Sutskever, and Geoffrey Hinton (2012).</span>: "This
technique reduces complex co-adaptations of neurons, since a neuron
cannot rely on the presence of particular other neurons. It is,
therefore, forced to learn more robust features that are useful in
conjunction with many different random subsets of the other neurons."
This is a rich, provocative statement, and one could build a fruitful
research program entirely around unpacking the statement, figuring out
what in it is true, what is false, what needs variation and
refinement.  Indeed, there is now a small industry of researchers who
are investigating dropout (and many variations), trying to understand
how it works, and what its limits are.  And so it goes with many of
the heuristics we've discussed.  Each heuristic is not just a
(potential) explanation, it's also a challenge to investigate and
understand in more detail.</p><p>Of course, there is not time for any single person to investigate all
these heuristic explanations in depth.  It's going to take decades (or
longer) for the community of neural networks researchers to develop a
really powerful, evidence-based theory of how neural networks learn.
Does this mean you should reject heuristic explanations as unrigorous,
and not sufficiently evidence-based?  No!  In fact, we need such
heuristics to inspire and guide our thinking.  It's like the great age
of exploration: the early explorers sometimes explored (and made new
discoveries) on the basis of beliefs which were wrong in important
ways.  Later, those mistakes were corrected as we filled in our
knowledge of geography.  When you understand something poorly - as
the explorers understood geography, and as we understand neural nets
today - it's more important to explore boldly than it is to be
rigorously correct in every step of your thinking.  And so you should
view these stories as a useful guide to how to think about neural
nets, while retaining a healthy awareness of the limitations of such
stories, and carefully keeping track of just how strong the evidence
is for any given line of reasoning.  Put another way, we need good
stories to help motivate and inspire us, and rigorous in-depth
investigation in order to uncover the real facts of the matter.</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p></div><div class="footer"> <span class="left_footer"> In academic work,
please cite this book as: Michael A. Nielsen, "Neural Networks and
Deep Learning", Determination Press, 2015

<br>
<br>

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB" style="color: #eee;">Creative Commons Attribution-NonCommercial 3.0
Unported License</a>.  This means you're free to copy, share, and
build on this book, but not to sell it.  If you're interested in
commercial use, please <a href="https://mail.google.com/mail/?view=cm&fs=1&tf=1&to=mn@michaelnielsen.org" target="_blank">contact me</a>.
</span>
<span class="right_footer">
Last update: Sun Dec 21 14:49:05 2014
<br>
<br>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB"><img alt="Creative Commons Licence" style="border-width:0" src="./Neural networks and deep learning 3_files/88x31.png"></a>
</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44208967-1', 'neuralnetworksanddeeplearning.com');
  ga('send', 'pageview');

</script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>