<!DOCTYPE html>
<!-- saved from url=(0051)http://neuralnetworksanddeeplearning.com/chap1.html -->
<html lang="en"><!-- Produced from a LaTeX source file.  Note that the production is done --><!-- by a very rough-and-ready (and buggy) script, so the HTML and other  --><!-- code is quite ugly!  Later versions should be better.                --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8">
    <meta name="citation_title" content="Neural Networks and Deep Learning">
    <meta name="citation_author" content="Nielsen, Michael A.">
    <meta name="citation_publication_date" content="2015">
    <meta name="citation_fulltext_html_url" content="http://neuralnetworksanddeeplearning.com">
    <meta name="citation_publisher" content="Determination Press">
    <link rel="icon" href="http://neuralnetworksanddeeplearning.com/nnadl_favicon.ICO">
    <title>Neural networks and deep learning</title>
    <script async="" src="./Neural networks and deep learning 1_files/analytics.js"></script><script style="display:none">
<!--
/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.2.min.map
*/
(function(e,t){var n,r,i=typeof t,o=e.location,a=e.document,s=a.documentElement,l=e.jQuery,u=e.$,c={},p=[],f="1.10.2",d=p.concat,h=p.push,g=p.slice,m=p.indexOf,y=c.toString,v=c.hasOwnProperty,b=f.trim,x=function(e,t){return new x.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^[\],:{}\s]*$/,S=/(?:^|:|,)(?:\s*\[)+/g,A=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,j=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,D=/^-ms-/,L=/-([\da-z])/gi,H=function(e,t){return t.toUpperCase()},q=function(e){(a.addEventListener||"load"===e.type||"complete"===a.readyState)&&(_(),x.ready())},_=function(){a.addEventListener?(a.removeEventListener("DOMContentLoaded",q,!1),e.removeEventListener("load",q,!1)):(a.detachEvent("onreadystatechange",q),e.detachEvent("onload",q))};x.fn=x.prototype={jquery:f,constructor:x,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:a,!0)),k.test(i[1])&&x.isPlainObject(n))for(i in n)x.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=a.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=a,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||x.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(o=arguments[l]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(x.isPlainObject(r)||(n=x.isArray(r)))?(n?(n=!1,a=e&&x.isArray(e)?e:[]):a=e&&x.isPlainObject(e)?e:{},s[i]=x.extend(c,a,r)):r!==t&&(s[i]=r));return s},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=l),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){if(e===!0?!--x.readyWait:!x.isReady){if(!a.body)return setTimeout(x.ready);x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(a,[x]),x.fn.trigger&&x(a).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray||function(e){return"array"===x.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[y.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!v.call(e,"constructor")&&!v.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(x.support.ownLast)for(n in e)return v.call(e,n);for(n in e);return n===t||v.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||a;var r=k.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=x.trim(n),n&&E.test(n.replace(A,"@").replace(j,"]").replace(S,"")))?Function("return "+n)():(x.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&x.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(D,"ms-").replace(L,H)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("\ufeff\u00a0")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(C,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else while(n[o]!==t)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return d.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),x.isFunction(e)?(r=g.call(arguments,2),i=function(){return e.apply(n||this,r.concat(g.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):t},access:function(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;if("object"===x.type(r)){o=!0;for(l in r)x.access(e,n,l,r[l],!0,a,s)}else if(i!==t&&(o=!0,x.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(x(e),n)})),n))for(;u>l;l++)n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)));return o?e:c?n.call(e):u?n(e[0],r):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),x.ready.promise=function(t){if(!n)if(n=x.Deferred(),"complete"===a.readyState)setTimeout(x.ready);else if(a.addEventListener)a.addEventListener("DOMContentLoaded",q,!1),e.addEventListener("load",q,!1);else{a.attachEvent("onreadystatechange",q),e.attachEvent("onload",q);var r=!1;try{r=null==e.frameElement&&a.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!x.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}_(),x.ready()}}()}return n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});function M(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}r=x(a),function(e,t){var n,r,i,o,a,s,l,u,c,p,f,d,h,g,m,y,v,b="sizzle"+-new Date,w=e.document,T=0,C=0,N=st(),k=st(),E=st(),S=!1,A=function(e,t){return e===t?(S=!0,0):0},j=typeof t,D=1<<31,L={}.hasOwnProperty,H=[],q=H.pop,_=H.push,M=H.push,O=H.slice,F=H.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=R.replace("w","w#"),$="\\["+P+"*("+R+")"+P+"*(?:([*^$|!~]?=)"+P+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+P+"*\\]",I=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),X=RegExp("^"+P+"*,"+P+"*"),U=RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),V=RegExp(P+"*[+~]"),Y=RegExp("="+P+"*([^\\]'\"]*)"+P+"*\\]","g"),J=RegExp(I),G=RegExp("^"+W+"$"),Q={ID:RegExp("^#("+R+")"),CLASS:RegExp("^\\.("+R+")"),TAG:RegExp("^("+R.replace("w","w*")+")"),ATTR:RegExp("^"+$),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:RegExp("^(?:"+B+")$","i"),needsContext:RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{M.apply(H=O.call(w.childNodes),w.childNodes),H[w.childNodes.length].nodeType}catch(ot){M={apply:H.length?function(e,t){_.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function at(e,t,n,i){var o,a,s,l,u,c,d,m,y,x;if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,n=n||[],!e||"string"!=typeof e)return n;if(1!==(l=t.nodeType)&&9!==l)return[];if(h&&!i){if(o=Z.exec(e))if(s=o[1]){if(9===l){if(a=t.getElementById(s),!a||!a.parentNode)return n;if(a.id===s)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(s))&&v(t,a)&&a.id===s)return n.push(a),n}else{if(o[2])return M.apply(n,t.getElementsByTagName(e)),n;if((s=o[3])&&r.getElementsByClassName&&t.getElementsByClassName)return M.apply(n,t.getElementsByClassName(s)),n}if(r.qsa&&(!g||!g.test(e))){if(m=d=b,y=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){c=mt(e),(d=t.getAttribute("id"))?m=d.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",u=c.length;while(u--)c[u]=m+yt(c[u]);y=V.test(e)&&t.parentNode||t,x=c.join(",")}if(x)try{return M.apply(n,y.querySelectorAll(x)),n}catch(T){}finally{d||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,n,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>o.cacheLength&&delete t[e.shift()],t[n]=r}return t}function lt(e){return e[b]=!0,e}function ut(e){var t=f.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ct(e,t){var n=e.split("|"),r=e.length;while(r--)o.attrHandle[n[r]]=t}function pt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function dt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return lt(function(t){return t=+t,lt(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}s=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=at.support={},p=at.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==f&&9===n.nodeType&&n.documentElement?(f=n,d=n.documentElement,h=!s(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){p()}),r.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ut(function(e){return d.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(o.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),o.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==j?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},o.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==j&&h?n.getElementsByClassName(e):t},m=[],g=[],(r.qsa=K.test(n.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||g.push("\\["+P+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||g.push(":checked")}),ut(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&g.push("[*^$]="+P+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(r.matchesSelector=K.test(y=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut(function(e){r.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),m.push("!=",I)}),g=g.length&&RegExp(g.join("|")),m=m.length&&RegExp(m.join("|")),v=K.test(d.contains)||d.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},A=d.compareDocumentPosition?function(e,t){if(e===t)return S=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||v(w,e)?-1:t===n||v(w,t)?1:c?F.call(c,e)-F.call(c,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return S=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:c?F.call(c,e)-F.call(c,t):0;if(o===a)return pt(e,t);r=e;while(r=r.parentNode)s.unshift(r);r=t;while(r=r.parentNode)l.unshift(r);while(s[i]===l[i])i++;return i?pt(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},n):f},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(Y,"='$1']"),!(!r.matchesSelector||!h||m&&m.test(t)||g&&g.test(t)))try{var n=y.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return at(t,f,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),v(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==f&&p(e);var i=o.attrHandle[n.toLowerCase()],a=i&&L.call(o.attrHandle,n.toLowerCase())?i(e,n,!h):t;return a===t?r.attributes||!h?e.getAttribute(n):(a=e.getAttributeNode(n))&&a.specified?a.value:null:a},at.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],i=0,o=0;if(S=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(A),S){while(t=e[o++])t===e[o]&&(i=n.push(o));while(i--)e.splice(n[i],1)}return e},a=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=a(t);return n},o=at.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=N[e+" "];return t||(t=RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&N(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s;if(m){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[b]||(m[b]={}),u=c[e]||[],d=u[0]===T&&u[1],f=u[0]===T&&u[2],p=d&&m.childNodes[d];while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[T,d,f];break}}else if(v&&(u=(t[b]||(t[b]={}))[e])&&u[0]===T)f=u[1];else while(p=++d&&p&&p[g]||(f=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[b]||(p[b]={}))[e]=[T,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,n){var i,o=r(e,t),a=o.length;while(a--)i=F.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:lt(function(e){var t=[],n=[],r=l(e.replace(z,"$1"));return r[b]?lt(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:lt(function(e){return function(t){return at(e,t).length>0}}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}}),lang:lt(function(e){return G.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!o.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},o.pseudos.nth=o.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[n]=ft(n);for(n in{submit:!0,reset:!0})o.pseudos[n]=dt(n);function gt(){}gt.prototype=o.filters=o.pseudos,o.setFilters=new gt;function mt(e,t){var n,r,i,a,s,l,u,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,l=[],u=o.preFilter;while(s){(!n||(r=X.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length));for(a in o.filter)!(r=Q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?at.error(e):k(e,l).slice(0)}function yt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function vt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,s){var l,u,c,p=T+" "+a;if(s){while(t=t[r])if((1===t.nodeType||o)&&e(t,n,s))return!0}else while(t=t[r])if(1===t.nodeType||o)if(c=t[b]||(t[b]={}),(u=c[r])&&u[0]===p){if((l=u[1])===!0||l===i)return l===!0}else if(u=c[r]=[p],u[1]=e(t,n,s)||i,u[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=null!=t;for(;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function wt(e,t,n,r,i,o){return r&&!r[b]&&(r=wt(r)),i&&!i[b]&&(i=wt(i,o)),lt(function(o,a,s,l){var u,c,p,f=[],d=[],h=a.length,g=o||Nt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:xt(g,f,e,s,l),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,l),r){u=xt(y,d),r(u,[],s,l),c=u.length;while(c--)(p=u[c])&&(y[d[c]]=!(m[d[c]]=p))}if(o){if(i||e){if(i){u=[],c=y.length;while(c--)(p=y[c])&&u.push(m[c]=p);i(null,y=[],u,l)}c=y.length;while(c--)(p=y[c])&&(u=i?F.call(o,p):f[c])>-1&&(o[u]=!(a[u]=p))}}else y=xt(y===a?y.splice(h,y.length):y),i?i(null,a,y,l):M.apply(a,y)})}function Tt(e){var t,n,r,i=e.length,a=o.relative[e[0].type],s=a||o.relative[" "],l=a?1:0,c=vt(function(e){return e===t},s,!0),p=vt(function(e){return F.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;i>l;l++)if(n=o.relative[e[l].type])f=[vt(bt(f),n)];else{if(n=o.filter[e[l].type].apply(null,e[l].matches),n[b]){for(r=++l;i>r;r++)if(o.relative[e[r].type])break;return wt(l>1&&bt(f),l>1&&yt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&Tt(e.slice(l,r)),i>r&&Tt(e=e.slice(r)),i>r&&yt(e))}f.push(n)}return bt(f)}function Ct(e,t){var n=0,r=t.length>0,a=e.length>0,s=function(s,l,c,p,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,C=u,N=s||a&&o.find.TAG("*",d&&l.parentNode||l),k=T+=null==C?1:Math.random()||.1;for(w&&(u=l!==f&&l,i=n);null!=(h=N[b]);b++){if(a&&h){g=0;while(m=e[g++])if(m(h,l,c)){p.push(h);break}w&&(T=k,i=++n)}r&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,r&&b!==v){g=0;while(m=t[g++])m(x,y,l,c);if(s){if(v>0)while(b--)x[b]||y[b]||(y[b]=q.call(p));y=xt(y)}M.apply(p,y),w&&!s&&y.length>0&&v+t.length>1&&at.uniqueSort(p)}return w&&(T=k,u=C),x};return r?lt(s):s}l=at.compile=function(e,t){var n,r=[],i=[],o=E[e+" "];if(!o){t||(t=mt(e)),n=t.length;while(n--)o=Tt(t[n]),o[b]?r.push(o):i.push(o);o=E(e,Ct(i,r))}return o};function Nt(e,t,n){var r=0,i=t.length;for(;i>r;r++)at(e,t[r],n);return n}function kt(e,t,n,i){var a,s,u,c,p,f=mt(e);if(!i&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(u=s[0]).type&&r.getById&&9===t.nodeType&&h&&o.relative[s[1].type]){if(t=(o.find.ID(u.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}a=Q.needsContext.test(e)?0:s.length;while(a--){if(u=s[a],o.relative[c=u.type])break;if((p=o.find[c])&&(i=p(u.matches[0].replace(rt,it),V.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=i.length&&yt(s),!e)return M.apply(n,i),n;break}}}return l(e,f)(i,t,!h,n,V.test(e)),n}r.sortStable=b.split("").sort(A).join("")===b,r.detectDuplicates=S,p(),r.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ct("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ct("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||ct(B,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=at,x.expr=at.selectors,x.expr[":"]=x.expr.pseudos,x.unique=at.uniqueSort,x.text=at.getText,x.isXMLDoc=at.isXML,x.contains=at.contains}(e);var O={};function F(e){var t=O[e]={};return x.each(e.match(T)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?O[e]||F(e):x.extend({},e);var n,r,i,o,a,s,l=[],u=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=l.length,n=!0;l&&o>a;a++)if(l[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,l&&(u?u.length&&c(u.shift()):r?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;(function i(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?o=l.length:r&&(s=t,c(r))}return this},remove:function(){return l&&x.each(arguments,function(e,t){var r;while((r=x.inArray(t,l,r))>-1)l.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?x.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=u=r=t,this},disabled:function(){return!l},lock:function(){return u=t,r||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||i&&!u||(t=t||[],t=[e,t.slice?t.slice():t],n?u.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var a=o[0],s=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=g.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?g.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},s,l,u;if(r>1)for(s=Array(r),l=Array(r),u=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i;return i||o.resolveWith(u,n),o.promise()}}),x.support=function(t){var n,r,o,s,l,u,c,p,f,d=a.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],r=d.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;s=a.createElement("select"),u=s.appendChild(a.createElement("option")),o=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!o.value,t.optSelected=u.selected,t.enctype=!!a.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==a.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}o=a.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),l=a.createDocumentFragment(),l.appendChild(o),t.appendChecked=o.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;for(f in x(t))break;return t.ownLast="0"!==f,x(function(){var n,r,o,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];l&&(n=a.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=p&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",x.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(a.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(n),n=d=o=r=null)}),n=s=l=u=r=o=null,t
}({});var B=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;function R(e,n,r,i){if(x.acceptData(e)){var o,a,s=x.expando,l=e.nodeType,u=l?x.cache:e,c=l?e[s]:e[s]&&s;if(c&&u[c]&&(i||u[c].data)||r!==t||"string"!=typeof n)return c||(c=l?e[s]=p.pop()||x.guid++:s),u[c]||(u[c]=l?{}:{toJSON:x.noop}),("object"==typeof n||"function"==typeof n)&&(i?u[c]=x.extend(u[c],n):u[c].data=x.extend(u[c].data,n)),a=u[c],i||(a.data||(a.data={}),a=a.data),r!==t&&(a[x.camelCase(n)]=r),"string"==typeof n?(o=a[n],null==o&&(o=a[x.camelCase(n)])):o=a,o}}function W(e,t,n){if(x.acceptData(e)){var r,i,o=e.nodeType,a=o?x.cache:e,s=o?e[x.expando]:x.expando;if(a[s]){if(t&&(r=n?a[s]:a[s].data)){x.isArray(t)?t=t.concat(x.map(t,x.camelCase)):t in r?t=[t]:(t=x.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!I(r):!x.isEmptyObject(r))return}(n||(delete a[s].data,I(a[s])))&&(o?x.cleanData([e],!0):x.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}x.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?x.cache[e[x.expando]]:e[x.expando],!!e&&!I(e)},data:function(e,t,n){return R(e,t,n)},removeData:function(e,t){return W(e,t)},_data:function(e,t,n){return R(e,t,n,!0)},_removeData:function(e,t){return W(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&x.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),x.fn.extend({data:function(e,n){var r,i,o=null,a=0,s=this[0];if(e===t){if(this.length&&(o=x.data(s),1===s.nodeType&&!x._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>a;a++)i=r[a].name,0===i.indexOf("data-")&&(i=x.camelCase(i.slice(5)),$(s,i,o[i]));x._data(s,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){x.data(this,e)}):arguments.length>1?this.each(function(){x.data(this,e,n)}):s?$(s,e,x.data(s,e)):null},removeData:function(e){return this.each(function(){x.removeData(this,e)})}});function $(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(P,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:B.test(r)?x.parseJSON(r):r}catch(o){}x.data(e,n,r)}else r=t}return r}function I(e){var t;for(t in e)if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}x.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=x._data(e,n),r&&(!i||x.isArray(r)?i=x._data(e,n,x.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),a=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return x._data(e,n)||x._data(e,n,{empty:x.Callbacks("once memory").add(function(){x._removeData(e,t+"queue"),x._removeData(e,n)})})}}),x.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?x.queue(this[0],e):n===t?this:this.each(function(){var t=x.queue(this,e,n);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=x.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(s--)r=x._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var z,X,U=/[\t\r\n\f]/g,V=/\r/g,Y=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,G=/^(?:checked|selected)$/i,Q=x.support.getSetAttribute,K=x.support.input;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,l="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,r=0,o=x(this),a=e.match(T)||[];while(t=a[r++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===i||"boolean"===n)&&(this.className&&x._data(this,"__className__",this.className),this.className=this.className||e===!1?"":x._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(U," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=x.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,x(this).val()):e,null==o?o="":"number"==typeof o?o+="":x.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""})),r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))});if(o)return r=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(V,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;for(;s>l;l++)if(n=r[l],!(!n.selected&&l!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),a=i.length;while(a--)r=i[a],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,r){var o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===i?x.prop(e,n,r):(1===s&&x.isXMLDoc(e)||(n=n.toLowerCase(),o=x.attrHooks[n]||(x.expr.match.bool.test(n)?X:z)),r===t?o&&"get"in o&&null!==(a=o.get(e,n))?a:(a=x.find.attr(e,n),null==a?t:a):null!==r?o&&"set"in o&&(a=o.set(e,r,n))!==t?a:(e.setAttribute(n,r+""),r):(x.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(T);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)?K&&Q||!G.test(n)?e[r]=!1:e[x.camelCase("default-"+n)]=e[r]=!1:x.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!x.isXMLDoc(e),a&&(n=x.propFix[n]||n,o=x.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):Y.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?x.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&x.propFix[n]||n,n):e[x.camelCase("default-"+n)]=e[n]=!0,n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,n){var r=x.expr.attrHandle[n]||x.find.attr;x.expr.attrHandle[n]=K&&Q||!G.test(n)?function(e,n,i){var o=x.expr.attrHandle[n],a=i?t:(x.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return x.expr.attrHandle[n]=o,a}:function(e,n,r){return r?t:e[x.camelCase("default-"+n)]?n.toLowerCase():null}}),K&&Q||(x.attrHooks.value={set:function(e,n,r){return x.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)}}),Q||(z={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},x.expr.attrHandle.id=x.expr.attrHandle.name=x.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},x.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:z.set},x.attrHooks.contenteditable={set:function(e,t,n){z.set(e,""===t?!1:t,n)}},x.each(["width","height"],function(e,n){x.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),x.support.hrefNormalized||x.each(["href","src"],function(e,t){x.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.support.enctype||(x.propFix.enctype="encoding"),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,n){return x.isArray(n)?e.checked=x.inArray(x(e).val(),n)>=0:t}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;function it(){return!0}function ot(){return!1}function at(){try{return a.activeElement}catch(e){}}x.event={global:{},add:function(e,n,r,o,a){var s,l,u,c,p,f,d,h,g,m,y,v=x._data(e);if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=x.guid++),(l=v.events)||(l=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof x===i||e&&x.event.triggered===e.type?t:x.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(T)||[""],u=n.length;while(u--)s=rt.exec(n[u])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),g&&(p=x.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=x.event.special[g]||{},d=x.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=l[g])||(h=l[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),x.event.global[g]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,p,f,d,h,g,m=x.hasData(e)&&x._data(e);if(m&&(c=m.events)){t=(t||"").match(T)||[""],u=t.length;while(u--)if(s=rt.exec(t[u])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=x.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;while(o--)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));l&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||x.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)x.event.remove(e,d+t[u],n,r,!0);x.isEmptyObject(c)&&(delete m.handle,x._removeData(e,"events"))}},trigger:function(n,r,i,o){var s,l,u,c,p,f,d,h=[i||a],g=v.call(n,"type")?n.type:n,m=v.call(n,"namespace")?n.namespace.split("."):[];if(u=f=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+x.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),l=0>g.indexOf(":")&&"on"+g,n=n[x.expando]?n:new x.Event(g,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:x.makeArray(r,[n]),p=x.event.special[g]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!x.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(u=u.parentNode);u;u=u.parentNode)h.push(u),f=u;f===(i.ownerDocument||a)&&h.push(f.defaultView||f.parentWindow||e)}d=0;while((u=h[d++])&&!n.isPropagationStopped())n.type=d>1?c:p.bindType||g,s=(x._data(u,"events")||{})[n.type]&&x._data(u,"handle"),s&&s.apply(u,r),s=l&&u[l],s&&x.acceptData(u)&&s.apply&&s.apply(u,r)===!1&&n.preventDefault();if(n.type=g,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(h.pop(),r)===!1)&&x.acceptData(i)&&l&&i[g]&&!x.isWindow(i)){f=i[l],f&&(i[l]=null),x.event.triggered=g;try{i[g]()}catch(y){}x.event.triggered=t,f&&(i[l]=f)}return n.result}},dispatch:function(e){e=x.event.fix(e);var n,r,i,o,a,s=[],l=g.call(arguments),u=(x._data(this,"events")||{})[e.type]||[],c=x.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),n=0;while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((x.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],l=n.delegateCount,u=e.target;if(l&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?x(r,this).index(u)>=0:x.find(r,this,null,[u]).length),o[r]&&o.push(i);o.length&&s.push({elem:u,handlers:o})}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new x.Event(o),t=r.length;while(t--)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||a),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,s=n.button,l=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||a,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?n.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===at()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return x.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=a.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},x.Event=function(e,n){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,t):new x.Event(e,n)},x.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.submitBubbles||(x.event.special.submit={setup:function(){return x.nodeName(this,"form")?!1:(x.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=x.nodeName(n,"input")||x.nodeName(n,"button")?n.form:t;r&&!x._data(r,"submitBubbles")&&(x.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),x._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return x.nodeName(this,"form")?!1:(x.event.remove(this,"._submit"),t)}}),x.support.changeBubbles||(x.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),x.event.simulate("change",this,e,!0)})),!1):(x.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!x._data(t,"changeBubbles")&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)}),x._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return x.event.remove(this,"._change"),!Z.test(this.nodeName)}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&a.addEventListener(e,r,!0)},teardown:function(){0===--n&&a.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return x().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){x.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?x.event.trigger(e,n,r,!0):t}});var st=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ut=x.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=x(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(x.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e||[],!0))},filter:function(e){return this.pushStack(ft(this,e||[],!1))},is:function(e){return!!ft(this,"string"==typeof e&&ut.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],a=ut.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(ct[e]||(i=x.unique(i)),lt.test(e)&&(i=i.reverse())),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],o=e[n];while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!x(o).is(r)))1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function ft(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(st.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return x.inArray(e,t)>=0!==n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Ct=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:x.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(a),Dt=jt.appendChild(a.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===t?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(Ft(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&_t(Ft(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&x.cleanData(Ft(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&x.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!x.support.htmlSerialize&&mt.test(e)||!x.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(x.cleanData(Ft(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=d.apply([],e);var r,i,o,a,s,l,u=0,c=this.length,p=this,f=c-1,h=e[0],g=x.isFunction(h);if(g||!(1>=c||"string"!=typeof h||x.support.checkClone)&&Nt.test(h))return this.each(function(r){var i=p.eq(r);g&&(e[0]=h.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(l=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=l.firstChild,1===l.childNodes.length&&(l=r),r)){for(a=x.map(Ft(l,"script"),Ht),o=a.length;c>u;u++)i=l,u!==f&&(i=x.clone(i,!0,!0),o&&x.merge(a,Ft(i,"script"))),t.call(this[u],i,u);if(o)for(s=a[a.length-1].ownerDocument,x.map(a,qt),u=0;o>u;u++)i=a[u],kt.test(i.type||"")&&!x._data(i,"globalEval")&&x.contains(s,i)&&(i.src?x._evalUrl(i.src):x.globalEval((i.text||i.textContent||i.innerHTML||"").replace(St,"")));l=r=null}return this}});function Lt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ht(e){return e.type=(null!==x.find.attr(e,"type"))+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _t(e,t){var n,r=0;for(;null!=(n=e[r]);r++)x._data(n,"globalEval",!t||x._data(t[r],"globalEval"))}function Mt(e,t){if(1===t.nodeType&&x.hasData(e)){var n,r,i,o=x._data(e),a=x._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)x.event.add(t,n,s[n][r])}a.data&&(a.data=x.extend({},a.data))}}function Ot(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!x.support.noCloneEvent&&t[x.expando]){i=x._data(t);for(r in i.events)x.removeEvent(t,r,i.handle);t.removeAttribute(x.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),x.support.html5Clone&&e.innerHTML&&!x.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ct.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=0,i=[],o=x(e),a=o.length-1;for(;a>=r;r++)n=r===a?this:this.clone(!0),x(o[r])[t](n),h.apply(i,n.get());return this.pushStack(i)}});function Ft(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||x.nodeName(o,n)?s.push(o):x.merge(s,Ft(o,n));return n===t||n&&x.nodeName(e,n)?x.merge([e],s):s}function Bt(e){Ct.test(e.type)&&(e.defaultChecked=e.checked)}x.extend({clone:function(e,t,n){var r,i,o,a,s,l=x.contains(e.ownerDocument,e);if(x.support.html5Clone||x.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(r=Ft(o),s=Ft(e),a=0;null!=(i=s[a]);++a)r[a]&&Ot(i,r[a]);if(t)if(n)for(s=s||Ft(e),r=r||Ft(o),a=0;null!=(i=s[a]);a++)Mt(i,r[a]);else Mt(e,o);return r=Ft(o,"script"),r.length>0&&_t(r,!l&&Ft(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){var i,o,a,s,l,u,c,p=e.length,f=dt(t),d=[],h=0;for(;p>h;h++)if(o=e[h],o||0===o)if("object"===x.type(o))x.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),l=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[l]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];while(i--)s=s.lastChild;if(!x.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!x.support.tbody){o="table"!==l||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;while(i--)x.nodeName(u=o.childNodes[i],"tbody")&&!u.childNodes.length&&o.removeChild(u)}x.merge(d,s.childNodes),s.textContent="";while(s.firstChild)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));s&&f.removeChild(s),x.support.appendChecked||x.grep(Ft(d,"input"),Bt),h=0;while(o=d[h++])if((!r||-1===x.inArray(o,r))&&(a=x.contains(o.ownerDocument,o),s=Ft(f.appendChild(o),"script"),a&&_t(s),n)){i=0;while(o=s[i++])kt.test(o.type||"")&&n.push(o)}return s=null,f},cleanData:function(e,t){var n,r,o,a,s=0,l=x.expando,u=x.cache,c=x.support.deleteExpando,f=x.event.special;for(;null!=(n=e[s]);s++)if((t||x.acceptData(n))&&(o=n[l],a=o&&u[o])){if(a.events)for(r in a.events)f[r]?x.event.remove(n,r):x.removeEvent(n,r,a.handle);
u[o]&&(delete u[o],c?delete n[l]:typeof n.removeAttribute!==i?n.removeAttribute(l):n[l]=null,p.push(o))}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){if(x.isFunction(e))return this.each(function(t){x(this).wrapAll(e.call(this,t))});if(this[0]){var t=x(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+w+")(.*)$","i"),Yt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+w+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;for(;s>a;a++)r=e[a],r.style&&(o[a]=x._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=x._data(r,"olddisplay",ln(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&x._data(r,"olddisplay",i?n:x.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}x.fn.extend({css:function(e,n){return x.access(this,function(e,n,r){var i,o,a={},s=0;if(x.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=x.css(e,n[s],!1,o);return a}return r!==t?x.style(e,n,r):x.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=x.camelCase(n),u=e.style;if(n=x.cssProps[l]||(x.cssProps[l]=tn(u,l)),s=x.cssHooks[n]||x.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(x.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||x.cssNumber[l]||(r+="px"),x.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(u[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,l=x.camelCase(n);return n=x.cssProps[l]||(x.cssProps[l]=tn(e.style,l)),s=x.cssHooks[n]||x.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||x.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s.getPropertyValue(n)||s[n]:t,u=e.style;return s&&(""!==l||x.contains(e.ownerDocument,e)||(l=x.style(e,n)),Yt.test(l)&&Ut.test(n)&&(i=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=s.width,u.width=i,u.minWidth=o,u.maxWidth=a)),l}):a.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s[n]:t,u=e.style;return null==l&&u&&u[n]&&(l=u[n]),Yt.test(l)&&!zt.test(n)&&(i=u.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),u.left="fontSize"===n?"1em":l,l=u.pixelLeft+"px",u.left=i,a&&(o.left=a)),""===l?"auto":l});function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;for(;4>o;o+=2)"margin"===n&&(a+=x.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=x.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=x.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=x.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=x.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function ln(e){var t=a,n=Gt[e];return n||(n=un(e,t),"none"!==n&&n||(Pt=(Pt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=un(e,t),Pt.detach()),Gt[e]=n),n}function un(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,n){x.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(x.css(e,"display"))?x.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===x.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,n){return n?x.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,n){x.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?x(e).position()[n]+"px":r):t}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(x.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Ct.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),x.param=function(e,n){var r,i=[],o=function(e,t){t=x.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")};function gn(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,yn,vn=x.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Cn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=o.href}catch(Ln){yn=a.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[];function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(T)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){var o={},a=e===jn;function s(l){var u;return o[l]=!0,x.each(e[l]||[],function(e,l){var c=l(n,r,i);return"string"!=typeof c||a||o[c]?a?!(u=c):t:(n.dataTypes.unshift(c),s(c),!1)}),u}return s(n.dataTypes[0])||!o["*"]&&s("*")}function _n(e,n){var r,i,o=x.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),x.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&x.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Cn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_n(_n(e,x.ajaxSettings),t):_n(x.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,l,u,c,p=x.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?x(f):x.event,h=x.Deferred(),g=x.Callbacks("once memory"),m=p.statusCode||{},y={},v={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!c){c={};while(t=Tn.exec(a))c[t[1].toLowerCase()]=t[2]}t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),k(0,t),this}};if(h.promise(C).complete=g.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=x.trim(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),qn(An,p,n,C),2===b)return C;l=p.global,l&&0===x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Nn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(x.lastModified[o]&&C.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&C.setRequestHeader("If-None-Match",x.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)C.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,C,p)===!1||2===b))return C.abort();w="abort";for(i in{success:1,error:1,complete:1})C[i](p[i]);if(u=qn(jn,p,n,C)){C.readyState=1,l&&d.trigger("ajaxSend",[C,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){C.abort("timeout")},p.timeout));try{b=1,u.send(y,k)}catch(N){if(!(2>b))throw N;k(-1,N)}}else k(-1,"No Transport");function k(e,n,r,i){var c,y,v,w,T,N=n;2!==b&&(b=2,s&&clearTimeout(s),u=t,a=i||"",C.readyState=e>0?4:0,c=e>=200&&300>e||304===e,r&&(w=Mn(p,C,r)),w=On(p,w,C,c),c?(p.ifModified&&(T=C.getResponseHeader("Last-Modified"),T&&(x.lastModified[o]=T),T=C.getResponseHeader("etag"),T&&(x.etag[o]=T)),204===e||"HEAD"===p.type?N="nocontent":304===e?N="notmodified":(N=w.state,y=w.data,v=w.error,c=!v)):(v=N,(e||!N)&&(N="error",0>e&&(e=0))),C.status=e,C.statusText=(n||N)+"",c?h.resolveWith(f,[y,N,C]):h.rejectWith(f,[C,N,v]),C.statusCode(m),m=t,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,p,c?y:v]),g.fireWith(f,[C,N]),l&&(d.trigger("ajaxComplete",[C,p]),--x.active||x.event.trigger("ajaxStop")))}return C},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,n){return x.get(e,t,n,"script")}}),x.each(["get","post"],function(e,n){x[n]=function(e,r,i,o){return x.isFunction(r)&&(o=o||i,i=r,r=t),x.ajax({url:e,type:n,dataType:o,data:r,success:i})}});function Mn(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){u.unshift(s);break}if(u[0]in r)a=u[0];else{for(s in r){if(!u[0]||e.converters[s+" "+u[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==u[0]&&u.unshift(a),r[a]):t}function On(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a)for(i in u)if(s=i.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(p){return{state:"parsererror",error:a?p:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),x.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=a.head||x("head")[0]||a.documentElement;return{send:function(t,i){n=a.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Fn=[],Bn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||x.expando+"_"+vn++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=x.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&x.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}x.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=x.ajaxSettings.xhr(),x.support.cors=!!Rn&&"withCredentials"in Rn,Rn=x.support.ajax=!!Rn,Rn&&x.ajaxTransport(function(n){if(!n.crossDomain||x.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,p;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=x.noop,$n&&delete Pn[a]),i)4!==l.readyState&&l.abort();else{p={},s=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);try{c=l.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,u)},n.async?4===l.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},x(e).unload($n)),Pn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Yn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),a=(x.cssNumber[e]||"px"!==o&&+r)&&Yn.exec(x.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;do s=s||".5",a/=s,x.style(n.elem,e,a+o);while(s!==(s=n.cur()/r)&&1!==s&&--l)}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n}]};function Kn(){return setTimeout(function(){Xn=t}),Xn=x.now()}function Zn(e,t,n){var r,i=(Qn[t]||[]).concat(Qn["*"]),o=0,a=i.length;for(;a>o;o++)if(r=i[o].call(n,t,e))return r}function er(e,t,n){var r,i,o=0,a=Gn.length,s=x.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;var t=Xn||Kn(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,l=u.tweens.length;for(;l>a;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(tr(c,u.opts.specialEasing);a>o;o++)if(r=Gn[o].call(u,e,c,u.opts))return r;return x.map(c,Zn,u),x.isFunction(u.opts.start)&&u.opts.start.call(e,u),x.fx.timer(x.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function tr(e,t){var n,r,i,o,a;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=x.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(er,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}});function nr(e,t,n){var r,i,o,a,s,l,u=this,c={},p=e.style,f=e.nodeType&&nn(e),d=x._data(e,"fxshow");n.queue||(s=x._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ln(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",x.support.shrinkWrapBlocks||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Vn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show"))continue;c[r]=d&&d[r]||x.style(e,r)}if(!x.isEmptyObject(c)){d?"hidden"in d&&(f=d.hidden):d=x._data(e,"fxshow",{}),o&&(d.hidden=!f),f?x(e).show():u.done(function(){x(e).hide()}),u.done(function(){var t;x._removeData(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)a=Zn(f?d[r]:0,r,u),r in d||(d[r]=a.start,f&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}x.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),a=function(){var t=er(this,x.extend({},e),o);(i||x._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=x.timers,a=x._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=x._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,a=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=rr.prototype.init,x.fx.tick=function(){var e,n=x.timers,r=0;for(Xn=x.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||x.fx.stop(),Xn=t},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){Un||(Un=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(Un),Un=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){x.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return n=s.documentElement,x.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o},x.offset={setOffset:function(e,t,n){var r=x.css(e,"position");"static"===r&&(e.style.position="relative");var i=x(e),o=i.offset(),a=x.css(e,"top"),s=x.css(e,"left"),l=("absolute"===r||"fixed"===r)&&x.inArray("auto",[a,s])>-1,u={},c={},p,f;l?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),x.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(u.top=t.top-o.top+p),null!=t.left&&(u.left=t.left-o.left+f),"using"in t?t.using.call(e,u):i.css(u)}},x.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===x.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(n=e.offset()),n.top+=x.css(e[0],"borderTopWidth",!0),n.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-x.css(r,"marginTop",!0),left:t.left-n.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);x.fn[e]=function(i){return x.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?x(a).scrollLeft():o,r?o:x(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}});function or(e){return x.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}x.each({Height:"height",Width:"width"},function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){x.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return x.access(this,function(n,r,i){var o;return x.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?x.css(n,r,s):x.style(n,r,i,s)},n,a?i:t,a,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:(e.jQuery=e.$=x,"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}))})(window);

//-->
</script>
    <script type="text/x-mathjax-config;executed=true">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$']]},
        "HTML-CSS": 
          {scale: 92},
        TeX: { equationNumbers: { autoNumber: "AMS" }}});
    </script>
    <script type="text/javascript" src="./Neural networks and deep learning 1_files/MathJax.js"></script>


    <style style="display:none">/* Layout: 980px fixed-width: 40px margin, 600px main tex,           */
/* 40px margin, 240px for toc and marginalia, 40px margin            */
/*                                                                   */
/*                                                                   */
/* Colours:                                                          */
/*                                                                   */
/* #1C3950: header and h1 background, h2, h3 foreground, main links  */
/* HSV: 207, 65, 31                                                  */
/* Decimal RGB: 28, 57, 80                                           */
/*                                                                   */
/* #2A6EA6; link colour, graph line colour, d3 paths, widgets        */
/* HSV: 207, 75, 65                                                  */
/* Decimal RGB: 42, 110, 166                                         */
/*                                                                   */
/* #FFA933: complement to #2A6EA6, for use on graphs                 */
/*                                                                   */
/* Triad: #2A6EA6, #FFCD33, #FF7033                                  */
/*                                                                   */
/* #eee: header text                                                 */


/* Reset */

body {
    background: #fff;
    font-style: normal;
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    /* font-family: "Helvetica", "Arial", sans-serif; */
    color: #000;
    width: 100%;
    margin: 0;
    padding: 0;
    text-align: left;
    position: relative;
}


/* Header */

.header, .nonumber_header {
    position: relative;
    top: 0px;
    width: 100%;
    margin: 0;
    background-color: #1C3950;
}

.header {
    height: 120px;
}

.nonumber_header {
    height: 80px;
}

h1 {
    position: absolute;
    top: 0px;
    left: 40px;
    right: 40px;
    padding: 0px;
    margin: 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 34px;
    line-height: 1.2;
    color: #eee;
    white-space: nowrap;
    font-weight: 400;
}

h1.chapter_number {
    margin-top: 10px;
    font-size: 24px;
    border-bottom: 1px solid #BBB;
}

h1.chapter_number a {
    color: #eee;
}

h1.chapter_title {
    margin-top: 56px;
    font-size: 34px;
}

h1.chapter_title a {
    color: #eee;
}

h2 {
    position: absolute;
    top: 0px;
    left: 40px;
    right: 40px;
    padding: 0px;
    margin: 16px 0px 0px 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 34px;
    line-height: 1.2;
    color: #eee;
    white-space: nowrap;
}

h2 a {
    color: #eee;
}

/********/
/* Main */
/********/

#insertion {
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    color: #333;
    padding: 5px 10px 5px 10px;
    background: #ccaaaa;
    border: 1px solid;
    margin: 10px 0px 0px 0px;
}

p {
    font: 15pt 'Georgia', 'Times New Roman', serif; 
    line-height: 1.7;
    color: #333;
    margin: 0 0 1 0;
}

h3 {
    color: #1C3950;
    margin: 40px 0px 20px 0px;
    padding: 0;
    font-size: 32px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
    border-bottom: 1px solid #666;
}

h4 {
    color: #1C3950;
    margin: 30px 0px 15px 0px;
    padding: 0;
    padding-left: 0px;
    font-size: 26px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
}

h5 {
    color: #1C3950;
    margin: 20px 0px 10px 0px;
    padding: 0;
    padding-left: 0px;
    font-size: 26px;
    line-height: 1.2;
    font-family: "Helvetica", "Arial", sans-serif;
}

.section {
    width: 600px;
    margin-left: 40px;
}

a { 
    color: #2A6EA6;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

.equation_link {
    color: #2A6EA6;
}

.equation_link:hover {
    text-decoration: underline;
    cursor: pointer;
}

.MathJax {
    color: #2A2A2A;
}

/* Set the font size for Pygments */
.highlight {
    font-size: 10pt;
}

/* Set the font size for code */
tt {
    font-size: 12pt;
    font-style: monospace;
}


/* d3 styling */
path {
    stroke: rgb(42, 110, 166);
    stroke-width: 1;
    fill: none;
}
.axis {
    shape-rendering: crispEdges;
}
.axis text {
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 11px;
}
.axis line, .axis path {
    stroke: grey;
}

.axisLabel {
  font-size: 18px;
  font-family: "Helvetica", "Arial", sans-serif;
  font-style: italic;
  font-weight: bold;
}


/* Table of contents, and margin notes */

#toc, .marginnote, .marginequation {
    position: absolute;
    left: 680px;
    width: 260px;
    padding: 0;
    margin: 0;
}

.sidebar {
    margin: 0 0 5px 0;
    padding: 0;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_title {
    margin: 0; 
    padding: 0;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_not_mainchapter {
    margin: 0;
    padding: 0 0 0 15px;
    font-size: 12pt;
    line-height: 1.5;
}

.toc_mainchapter {
    margin: 0; 
    padding: 0 0 0 15px; 
    text-indent: -15px;
    font-size: 12pt;
    line-height: 1.5;
}


.toc_reveal {
    cursor: pointer;
}

.toc_section {
    padding: 0 0 0 15px; 
    margin: 0;
}

#toc ul {
    padding: 0 0 0 15px;
    list-style-position: inside;
    margin: 0;
    line-height: 1.5;
}

.sidebar_title {
    font-size: 18pt;
    font-family: "Helvetica", "Arial", sans-serif;
}

.marginnote {
    font-size: 9pt;
    color: #666;
    display: inline-block;
}

.marginnote .MathJax {
    color: #666;
}

.marginnote tt {
    font-size: 9pt
}

.marginequation .MathJax {
    color: #2A6EA6;
}

#toc {
    font-size: 12pt;
    color: #000;
}

/* Footer */

.footer {
    position: relative;
    top: 0px;
    width: 100%;
    height: 130px;
    margin: 0;
    background-color: #1C3950;
}

span.left_footer, span.right_footer {
    position: absolute;
    top: 12px;
    left: 40px;
    padding: 0px;
    margin: 0px;
    font-family: "Helvetica", "Arial", sans-serif;
    font-size: 9pt;
    font-style: bold;
    line-height: 1.5;
    color: #eee;
}

span.left_footer {
    display: block;
    width: 600px;
    word-wrap:break-word;
}

span.right_footer {
    right: 40px;
    text-align: right;
}

.MathJax_Display {
    color: #333 !important;
}



/* Adapted from http://worrydream.com/ScrubbingCalculator/style.css, */
/* by Bret Victor */
.videoOverlay {
    position: absolute;
    cursor: pointer;
    background-color: white;
    z-index: 100;
}

.videoOverlay img {
    position: absolute;
    display: block;
}

/* class for text labels on the 3d graphs */
.graph3D {
    position: absolute;
    font: 15px MJX_Math;
    background-color: white;
    border-radius: 5px;
    line-height: 18px;
    padding-top: 0;
    padding-right: 3px;
    padding-bottom: 0px;
    padding-left: 3px;
}

</style>

    <style style="display:none">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

    <style style="display:none">/*! jQuery UI - v1.11.2 - 2014-10-16
* http://jqueryui.com
* Includes: core.css, accordion.css, autocomplete.css, button.css, datepicker.css, dialog.css, draggable.css, menu.css, progressbar.css, resizable.css, selectable.css, selectmenu.css, slider.css, sortable.css, spinner.css, tabs.css, tooltip.css, theme.css
* To view and modify this theme, visit http://jqueryui.com/themeroller/?ffDefault=Verdana%2CArial%2Csans-serif&fwDefault=normal&fsDefault=1.1em&cornerRadius=4px&bgColorHeader=cccccc&bgTextureHeader=highlight_soft&bgImgOpacityHeader=75&borderColorHeader=aaaaaa&fcHeader=222222&iconColorHeader=222222&bgColorContent=ffffff&bgTextureContent=flat&bgImgOpacityContent=75&borderColorContent=aaaaaa&fcContent=222222&iconColorContent=222222&bgColorDefault=e6e6e6&bgTextureDefault=glass&bgImgOpacityDefault=75&borderColorDefault=d3d3d3&fcDefault=555555&iconColorDefault=888888&bgColorHover=dadada&bgTextureHover=glass&bgImgOpacityHover=75&borderColorHover=999999&fcHover=212121&iconColorHover=454545&bgColorActive=ffffff&bgTextureActive=glass&bgImgOpacityActive=65&borderColorActive=aaaaaa&fcActive=212121&iconColorActive=454545&bgColorHighlight=fbf9ee&bgTextureHighlight=glass&bgImgOpacityHighlight=55&borderColorHighlight=fcefa1&fcHighlight=363636&iconColorHighlight=2e83ff&bgColorError=fef1ec&bgTextureError=glass&bgImgOpacityError=95&borderColorError=cd0a0a&fcError=cd0a0a&iconColorError=cd0a0a&bgColorOverlay=aaaaaa&bgTextureOverlay=flat&bgImgOpacityOverlay=0&opacityOverlay=30&bgColorShadow=aaaaaa&bgTextureShadow=flat&bgImgOpacityShadow=0&opacityShadow=30&thicknessShadow=8px&offsetTopShadow=-8px&offsetLeftShadow=-8px&cornerRadiusShadow=8px
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */

/* Layout helpers
----------------------------------*/
.ui-helper-hidden {
	display: none;
}
.ui-helper-hidden-accessible {
	border: 0;
	clip: rect(0 0 0 0);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
}
.ui-helper-reset {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	line-height: 1.3;
	text-decoration: none;
	font-size: 100%;
	list-style: none;
}
.ui-helper-clearfix:before,
.ui-helper-clearfix:after {
	content: "";
	display: table;
	border-collapse: collapse;
}
.ui-helper-clearfix:after {
	clear: both;
}
.ui-helper-clearfix {
	min-height: 0; /* support: IE7 */
}
.ui-helper-zfix {
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	position: absolute;
	opacity: 0;
	filter:Alpha(Opacity=0); /* support: IE8 */
}

.ui-front {
	z-index: 100;
}


/* Interaction Cues
----------------------------------*/
.ui-state-disabled {
	cursor: default !important;
}


/* Icons
----------------------------------*/

/* states and images */
.ui-icon {
	display: block;
	text-indent: -99999px;
	overflow: hidden;
	background-repeat: no-repeat;
}


/* Misc visuals
----------------------------------*/

/* Overlays */
.ui-widget-overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
}
.ui-accordion .ui-accordion-header {
	display: block;
	cursor: pointer;
	position: relative;
	margin: 2px 0 0 0;
	padding: .5em .5em .5em .7em;
	min-height: 0; /* support: IE7 */
	font-size: 100%;
}
.ui-accordion .ui-accordion-icons {
	padding-left: 2.2em;
}
.ui-accordion .ui-accordion-icons .ui-accordion-icons {
	padding-left: 2.2em;
}
.ui-accordion .ui-accordion-header .ui-accordion-header-icon {
	position: absolute;
	left: .5em;
	top: 50%;
	margin-top: -8px;
}
.ui-accordion .ui-accordion-content {
	padding: 1em 2.2em;
	border-top: 0;
	overflow: auto;
}
.ui-autocomplete {
	position: absolute;
	top: 0;
	left: 0;
	cursor: default;
}
.ui-button {
	display: inline-block;
	position: relative;
	padding: 0;
	line-height: normal;
	margin-right: .1em;
	cursor: pointer;
	vertical-align: middle;
	text-align: center;
	overflow: visible; /* removes extra width in IE */
}
.ui-button,
.ui-button:link,
.ui-button:visited,
.ui-button:hover,
.ui-button:active {
	text-decoration: none;
}
/* to make room for the icon, a width needs to be set here */
.ui-button-icon-only {
	width: 2.2em;
}
/* button elements seem to need a little more width */
button.ui-button-icon-only {
	width: 2.4em;
}
.ui-button-icons-only {
	width: 3.4em;
}
button.ui-button-icons-only {
	width: 3.7em;
}

/* button text element */
.ui-button .ui-button-text {
	display: block;
	line-height: normal;
}
.ui-button-text-only .ui-button-text {
	padding: .4em 1em;
}
.ui-button-icon-only .ui-button-text,
.ui-button-icons-only .ui-button-text {
	padding: .4em;
	text-indent: -9999999px;
}
.ui-button-text-icon-primary .ui-button-text,
.ui-button-text-icons .ui-button-text {
	padding: .4em 1em .4em 2.1em;
}
.ui-button-text-icon-secondary .ui-button-text,
.ui-button-text-icons .ui-button-text {
	padding: .4em 2.1em .4em 1em;
}
.ui-button-text-icons .ui-button-text {
	padding-left: 2.1em;
	padding-right: 2.1em;
}
/* no icon support for input elements, provide padding by default */
input.ui-button {
	padding: .4em 1em;
}

/* button icon element(s) */
.ui-button-icon-only .ui-icon,
.ui-button-text-icon-primary .ui-icon,
.ui-button-text-icon-secondary .ui-icon,
.ui-button-text-icons .ui-icon,
.ui-button-icons-only .ui-icon {
	position: absolute;
	top: 50%;
	margin-top: -8px;
}
.ui-button-icon-only .ui-icon {
	left: 50%;
	margin-left: -8px;
}
.ui-button-text-icon-primary .ui-button-icon-primary,
.ui-button-text-icons .ui-button-icon-primary,
.ui-button-icons-only .ui-button-icon-primary {
	left: .5em;
}
.ui-button-text-icon-secondary .ui-button-icon-secondary,
.ui-button-text-icons .ui-button-icon-secondary,
.ui-button-icons-only .ui-button-icon-secondary {
	right: .5em;
}

/* button sets */
.ui-buttonset {
	margin-right: 7px;
}
.ui-buttonset .ui-button {
	margin-left: 0;
	margin-right: -.3em;
}

/* workarounds */
/* reset extra padding in Firefox, see h5bp.com/l */
input.ui-button::-moz-focus-inner,
button.ui-button::-moz-focus-inner {
	border: 0;
	padding: 0;
}
.ui-datepicker {
	width: 17em;
	padding: .2em .2em 0;
	display: none;
}
.ui-datepicker .ui-datepicker-header {
	position: relative;
	padding: .2em 0;
}
.ui-datepicker .ui-datepicker-prev,
.ui-datepicker .ui-datepicker-next {
	position: absolute;
	top: 2px;
	width: 1.8em;
	height: 1.8em;
}
.ui-datepicker .ui-datepicker-prev-hover,
.ui-datepicker .ui-datepicker-next-hover {
	top: 1px;
}
.ui-datepicker .ui-datepicker-prev {
	left: 2px;
}
.ui-datepicker .ui-datepicker-next {
	right: 2px;
}
.ui-datepicker .ui-datepicker-prev-hover {
	left: 1px;
}
.ui-datepicker .ui-datepicker-next-hover {
	right: 1px;
}
.ui-datepicker .ui-datepicker-prev span,
.ui-datepicker .ui-datepicker-next span {
	display: block;
	position: absolute;
	left: 50%;
	margin-left: -8px;
	top: 50%;
	margin-top: -8px;
}
.ui-datepicker .ui-datepicker-title {
	margin: 0 2.3em;
	line-height: 1.8em;
	text-align: center;
}
.ui-datepicker .ui-datepicker-title select {
	font-size: 1em;
	margin: 1px 0;
}
.ui-datepicker select.ui-datepicker-month,
.ui-datepicker select.ui-datepicker-year {
	width: 45%;
}
.ui-datepicker table {
	width: 100%;
	font-size: .9em;
	border-collapse: collapse;
	margin: 0 0 .4em;
}
.ui-datepicker th {
	padding: .7em .3em;
	text-align: center;
	font-weight: bold;
	border: 0;
}
.ui-datepicker td {
	border: 0;
	padding: 1px;
}
.ui-datepicker td span,
.ui-datepicker td a {
	display: block;
	padding: .2em;
	text-align: right;
	text-decoration: none;
}
.ui-datepicker .ui-datepicker-buttonpane {
	background-image: none;
	margin: .7em 0 0 0;
	padding: 0 .2em;
	border-left: 0;
	border-right: 0;
	border-bottom: 0;
}
.ui-datepicker .ui-datepicker-buttonpane button {
	float: right;
	margin: .5em .2em .4em;
	cursor: pointer;
	padding: .2em .6em .3em .6em;
	width: auto;
	overflow: visible;
}
.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current {
	float: left;
}

/* with multiple calendars */
.ui-datepicker.ui-datepicker-multi {
	width: auto;
}
.ui-datepicker-multi .ui-datepicker-group {
	float: left;
}
.ui-datepicker-multi .ui-datepicker-group table {
	width: 95%;
	margin: 0 auto .4em;
}
.ui-datepicker-multi-2 .ui-datepicker-group {
	width: 50%;
}
.ui-datepicker-multi-3 .ui-datepicker-group {
	width: 33.3%;
}
.ui-datepicker-multi-4 .ui-datepicker-group {
	width: 25%;
}
.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header,
.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header {
	border-left-width: 0;
}
.ui-datepicker-multi .ui-datepicker-buttonpane {
	clear: left;
}
.ui-datepicker-row-break {
	clear: both;
	width: 100%;
	font-size: 0;
}

/* RTL support */
.ui-datepicker-rtl {
	direction: rtl;
}
.ui-datepicker-rtl .ui-datepicker-prev {
	right: 2px;
	left: auto;
}
.ui-datepicker-rtl .ui-datepicker-next {
	left: 2px;
	right: auto;
}
.ui-datepicker-rtl .ui-datepicker-prev:hover {
	right: 1px;
	left: auto;
}
.ui-datepicker-rtl .ui-datepicker-next:hover {
	left: 1px;
	right: auto;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane {
	clear: right;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane button {
	float: left;
}
.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current,
.ui-datepicker-rtl .ui-datepicker-group {
	float: right;
}
.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header,
.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header {
	border-right-width: 0;
	border-left-width: 1px;
}
.ui-dialog {
	overflow: hidden;
	position: absolute;
	top: 0;
	left: 0;
	padding: .2em;
	outline: 0;
}
.ui-dialog .ui-dialog-titlebar {
	padding: .4em 1em;
	position: relative;
}
.ui-dialog .ui-dialog-title {
	float: left;
	margin: .1em 0;
	white-space: nowrap;
	width: 90%;
	overflow: hidden;
	text-overflow: ellipsis;
}
.ui-dialog .ui-dialog-titlebar-close {
	position: absolute;
	right: .3em;
	top: 50%;
	width: 20px;
	margin: -10px 0 0 0;
	padding: 1px;
	height: 20px;
}
.ui-dialog .ui-dialog-content {
	position: relative;
	border: 0;
	padding: .5em 1em;
	background: none;
	overflow: auto;
}
.ui-dialog .ui-dialog-buttonpane {
	text-align: left;
	border-width: 1px 0 0 0;
	background-image: none;
	margin-top: .5em;
	padding: .3em 1em .5em .4em;
}
.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset {
	float: right;
}
.ui-dialog .ui-dialog-buttonpane button {
	margin: .5em .4em .5em 0;
	cursor: pointer;
}
.ui-dialog .ui-resizable-se {
	width: 12px;
	height: 12px;
	right: -5px;
	bottom: -5px;
	background-position: 16px 16px;
}
.ui-draggable .ui-dialog-titlebar {
	cursor: move;
}
.ui-draggable-handle {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-menu {
	list-style: none;
	padding: 0;
	margin: 0;
	display: block;
	outline: none;
}
.ui-menu .ui-menu {
	position: absolute;
}
.ui-menu .ui-menu-item {
	position: relative;
	margin: 0;
	padding: 3px 1em 3px .4em;
	cursor: pointer;
	min-height: 0; /* support: IE7 */
	/* support: IE10, see #8844 */
	list-style-image: url("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");
}
.ui-menu .ui-menu-divider {
	margin: 5px 0;
	height: 0;
	font-size: 0;
	line-height: 0;
	border-width: 1px 0 0 0;
}
.ui-menu .ui-state-focus,
.ui-menu .ui-state-active {
	margin: -1px;
}

/* icon support */
.ui-menu-icons {
	position: relative;
}
.ui-menu-icons .ui-menu-item {
	padding-left: 2em;
}

/* left-aligned */
.ui-menu .ui-icon {
	position: absolute;
	top: 0;
	bottom: 0;
	left: .2em;
	margin: auto 0;
}

/* right-aligned */
.ui-menu .ui-menu-icon {
	left: auto;
	right: 0;
}
.ui-progressbar {
	height: 2em;
	text-align: left;
	overflow: hidden;
}
.ui-progressbar .ui-progressbar-value {
	margin: -1px;
	height: 100%;
}
.ui-progressbar .ui-progressbar-overlay {
	background: url("data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==");
	height: 100%;
	filter: alpha(opacity=25); /* support: IE8 */
	opacity: 0.25;
}
.ui-progressbar-indeterminate .ui-progressbar-value {
	background-image: none;
}
.ui-resizable {
	position: relative;
}
.ui-resizable-handle {
	position: absolute;
	font-size: 0.1px;
	display: block;
	-ms-touch-action: none;
	touch-action: none;
}
.ui-resizable-disabled .ui-resizable-handle,
.ui-resizable-autohide .ui-resizable-handle {
	display: none;
}
.ui-resizable-n {
	cursor: n-resize;
	height: 7px;
	width: 100%;
	top: -5px;
	left: 0;
}
.ui-resizable-s {
	cursor: s-resize;
	height: 7px;
	width: 100%;
	bottom: -5px;
	left: 0;
}
.ui-resizable-e {
	cursor: e-resize;
	width: 7px;
	right: -5px;
	top: 0;
	height: 100%;
}
.ui-resizable-w {
	cursor: w-resize;
	width: 7px;
	left: -5px;
	top: 0;
	height: 100%;
}
.ui-resizable-se {
	cursor: se-resize;
	width: 12px;
	height: 12px;
	right: 1px;
	bottom: 1px;
}
.ui-resizable-sw {
	cursor: sw-resize;
	width: 9px;
	height: 9px;
	left: -5px;
	bottom: -5px;
}
.ui-resizable-nw {
	cursor: nw-resize;
	width: 9px;
	height: 9px;
	left: -5px;
	top: -5px;
}
.ui-resizable-ne {
	cursor: ne-resize;
	width: 9px;
	height: 9px;
	right: -5px;
	top: -5px;
}
.ui-selectable {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-selectable-helper {
	position: absolute;
	z-index: 100;
	border: 1px dotted black;
}
.ui-selectmenu-menu {
	padding: 0;
	margin: 0;
	position: absolute;
	top: 0;
	left: 0;
	display: none;
}
.ui-selectmenu-menu .ui-menu {
	overflow: auto;
	/* Support: IE7 */
	overflow-x: hidden;
	padding-bottom: 1px;
}
.ui-selectmenu-menu .ui-menu .ui-selectmenu-optgroup {
	font-size: 1em;
	font-weight: bold;
	line-height: 1.5;
	padding: 2px 0.4em;
	margin: 0.5em 0 0 0;
	height: auto;
	border: 0;
}
.ui-selectmenu-open {
	display: block;
}
.ui-selectmenu-button {
	display: inline-block;
	overflow: hidden;
	position: relative;
	text-decoration: none;
	cursor: pointer;
}
.ui-selectmenu-button span.ui-icon {
	right: 0.5em;
	left: auto;
	margin-top: -8px;
	position: absolute;
	top: 50%;
}
.ui-selectmenu-button span.ui-selectmenu-text {
	text-align: left;
	padding: 0.4em 2.1em 0.4em 1em;
	display: block;
	line-height: 1.4;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}
.ui-slider {
	position: relative;
	text-align: left;
}
.ui-slider .ui-slider-handle {
	position: absolute;
	z-index: 2;
	width: 1.2em;
	height: 1.2em;
	cursor: default;
	-ms-touch-action: none;
	touch-action: none;
}
.ui-slider .ui-slider-range {
	position: absolute;
	z-index: 1;
	font-size: .7em;
	display: block;
	border: 0;
	background-position: 0 0;
}

/* support: IE8 - See #6727 */
.ui-slider.ui-state-disabled .ui-slider-handle,
.ui-slider.ui-state-disabled .ui-slider-range {
	filter: inherit;
}

.ui-slider-horizontal {
	height: .8em;
}
.ui-slider-horizontal .ui-slider-handle {
	top: -.3em;
	margin-left: -.6em;
}
.ui-slider-horizontal .ui-slider-range {
	top: 0;
	height: 100%;
}
.ui-slider-horizontal .ui-slider-range-min {
	left: 0;
}
.ui-slider-horizontal .ui-slider-range-max {
	right: 0;
}

.ui-slider-vertical {
	width: .8em;
	height: 100px;
}
.ui-slider-vertical .ui-slider-handle {
	left: -.3em;
	margin-left: 0;
	margin-bottom: -.6em;
}
.ui-slider-vertical .ui-slider-range {
	left: 0;
	width: 100%;
}
.ui-slider-vertical .ui-slider-range-min {
	bottom: 0;
}
.ui-slider-vertical .ui-slider-range-max {
	top: 0;
}
.ui-sortable-handle {
	-ms-touch-action: none;
	touch-action: none;
}
.ui-spinner {
	position: relative;
	display: inline-block;
	overflow: hidden;
	padding: 0;
	vertical-align: middle;
}
.ui-spinner-input {
	border: none;
	background: none;
	color: inherit;
	padding: 0;
	margin: .2em 0;
	vertical-align: middle;
	margin-left: .4em;
	margin-right: 22px;
}
.ui-spinner-button {
	width: 16px;
	height: 50%;
	font-size: .5em;
	padding: 0;
	margin: 0;
	text-align: center;
	position: absolute;
	cursor: default;
	display: block;
	overflow: hidden;
	right: 0;
}
/* more specificity required here to override default borders */
.ui-spinner a.ui-spinner-button {
	border-top: none;
	border-bottom: none;
	border-right: none;
}
/* vertically center icon */
.ui-spinner .ui-icon {
	position: absolute;
	margin-top: -8px;
	top: 50%;
	left: 0;
}
.ui-spinner-up {
	top: 0;
}
.ui-spinner-down {
	bottom: 0;
}

/* TR overrides */
.ui-spinner .ui-icon-triangle-1-s {
	/* need to fix icons sprite */
	background-position: -65px -16px;
}
.ui-tabs {
	position: relative;/* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as "fixed") */
	padding: .2em;
}
.ui-tabs .ui-tabs-nav {
	margin: 0;
	padding: .2em .2em 0;
}
.ui-tabs .ui-tabs-nav li {
	list-style: none;
	float: left;
	position: relative;
	top: 0;
	margin: 1px .2em 0 0;
	border-bottom-width: 0;
	padding: 0;
	white-space: nowrap;
}
.ui-tabs .ui-tabs-nav .ui-tabs-anchor {
	float: left;
	padding: .5em 1em;
	text-decoration: none;
}
.ui-tabs .ui-tabs-nav li.ui-tabs-active {
	margin-bottom: -1px;
	padding-bottom: 1px;
}
.ui-tabs .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor,
.ui-tabs .ui-tabs-nav li.ui-state-disabled .ui-tabs-anchor,
.ui-tabs .ui-tabs-nav li.ui-tabs-loading .ui-tabs-anchor {
	cursor: text;
}
.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor {
	cursor: pointer;
}
.ui-tabs .ui-tabs-panel {
	display: block;
	border-width: 0;
	padding: 1em 1.4em;
	background: none;
}
.ui-tooltip {
	padding: 8px;
	position: absolute;
	z-index: 9999;
	max-width: 300px;
	-webkit-box-shadow: 0 0 5px #aaa;
	box-shadow: 0 0 5px #aaa;
}
body .ui-tooltip {
	border-width: 2px;
}

/* Component containers
----------------------------------*/
.ui-widget {
	font-family: Verdana,Arial,sans-serif;
	font-size: 1.1em;
}
.ui-widget .ui-widget {
	font-size: 1em;
}
.ui-widget input,
.ui-widget select,
.ui-widget textarea,
.ui-widget button {
	font-family: Verdana,Arial,sans-serif;
	font-size: 1em;
}
.ui-widget-content {
	border: 1px solid #aaaaaa;
	background: #ffffff url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_75_ffffff_40x100.png") 50% 50% repeat-x;
	color: #222222;
}
.ui-widget-content a {
	color: #222222;
}
.ui-widget-header {
	border: 1px solid #aaaaaa;
	background: #cccccc url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_highlight-soft_75_cccccc_1x100.png") 50% 50% repeat-x;
	color: #222222;
	font-weight: bold;
}
.ui-widget-header a {
	color: #222222;
}

/* Interaction states
----------------------------------*/
.ui-state-default,
.ui-widget-content .ui-state-default,
.ui-widget-header .ui-state-default {
	border: 1px solid #d3d3d3;
	background: #e6e6e6 url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_75_e6e6e6_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #555555;
}
.ui-state-default a,
.ui-state-default a:link,
.ui-state-default a:visited {
	color: #555555;
	text-decoration: none;
}
.ui-state-hover,
.ui-widget-content .ui-state-hover,
.ui-widget-header .ui-state-hover,
.ui-state-focus,
.ui-widget-content .ui-state-focus,
.ui-widget-header .ui-state-focus {
	border: 1px solid #999999;
	background: #dadada url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_75_dadada_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #212121;
}
.ui-state-hover a,
.ui-state-hover a:hover,
.ui-state-hover a:link,
.ui-state-hover a:visited,
.ui-state-focus a,
.ui-state-focus a:hover,
.ui-state-focus a:link,
.ui-state-focus a:visited {
	color: #212121;
	text-decoration: none;
}
.ui-state-active,
.ui-widget-content .ui-state-active,
.ui-widget-header .ui-state-active {
	border: 1px solid #aaaaaa;
	background: #ffffff url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_65_ffffff_1x400.png") 50% 50% repeat-x;
	font-weight: normal;
	color: #212121;
}
.ui-state-active a,
.ui-state-active a:link,
.ui-state-active a:visited {
	color: #212121;
	text-decoration: none;
}

/* Interaction Cues
----------------------------------*/
.ui-state-highlight,
.ui-widget-content .ui-state-highlight,
.ui-widget-header .ui-state-highlight {
	border: 1px solid #fcefa1;
	background: #fbf9ee url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_55_fbf9ee_1x400.png") 50% 50% repeat-x;
	color: #363636;
}
.ui-state-highlight a,
.ui-widget-content .ui-state-highlight a,
.ui-widget-header .ui-state-highlight a {
	color: #363636;
}
.ui-state-error,
.ui-widget-content .ui-state-error,
.ui-widget-header .ui-state-error {
	border: 1px solid #cd0a0a;
	background: #fef1ec url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_glass_95_fef1ec_1x400.png") 50% 50% repeat-x;
	color: #cd0a0a;
}
.ui-state-error a,
.ui-widget-content .ui-state-error a,
.ui-widget-header .ui-state-error a {
	color: #cd0a0a;
}
.ui-state-error-text,
.ui-widget-content .ui-state-error-text,
.ui-widget-header .ui-state-error-text {
	color: #cd0a0a;
}
.ui-priority-primary,
.ui-widget-content .ui-priority-primary,
.ui-widget-header .ui-priority-primary {
	font-weight: bold;
}
.ui-priority-secondary,
.ui-widget-content .ui-priority-secondary,
.ui-widget-header .ui-priority-secondary {
	opacity: .7;
	filter:Alpha(Opacity=70); /* support: IE8 */
	font-weight: normal;
}
.ui-state-disabled,
.ui-widget-content .ui-state-disabled,
.ui-widget-header .ui-state-disabled {
	opacity: .35;
	filter:Alpha(Opacity=35); /* support: IE8 */
	background-image: none;
}
.ui-state-disabled .ui-icon {
	filter:Alpha(Opacity=35); /* support: IE8 - See #6059 */
}

/* Icons
----------------------------------*/

/* states and images */
.ui-icon {
	width: 16px;
	height: 16px;
}
.ui-icon,
.ui-widget-content .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_222222_256x240.png");
}
.ui-widget-header .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_222222_256x240.png");
}
.ui-state-default .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_888888_256x240.png");
}
.ui-state-hover .ui-icon,
.ui-state-focus .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_454545_256x240.png");
}
.ui-state-active .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_454545_256x240.png");
}
.ui-state-highlight .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_2e83ff_256x240.png");
}
.ui-state-error .ui-icon,
.ui-state-error-text .ui-icon {
	background-image: url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-icons_cd0a0a_256x240.png");
}

/* positioning */
.ui-icon-blank { background-position: 16px 16px; }
.ui-icon-carat-1-n { background-position: 0 0; }
.ui-icon-carat-1-ne { background-position: -16px 0; }
.ui-icon-carat-1-e { background-position: -32px 0; }
.ui-icon-carat-1-se { background-position: -48px 0; }
.ui-icon-carat-1-s { background-position: -64px 0; }
.ui-icon-carat-1-sw { background-position: -80px 0; }
.ui-icon-carat-1-w { background-position: -96px 0; }
.ui-icon-carat-1-nw { background-position: -112px 0; }
.ui-icon-carat-2-n-s { background-position: -128px 0; }
.ui-icon-carat-2-e-w { background-position: -144px 0; }
.ui-icon-triangle-1-n { background-position: 0 -16px; }
.ui-icon-triangle-1-ne { background-position: -16px -16px; }
.ui-icon-triangle-1-e { background-position: -32px -16px; }
.ui-icon-triangle-1-se { background-position: -48px -16px; }
.ui-icon-triangle-1-s { background-position: -64px -16px; }
.ui-icon-triangle-1-sw { background-position: -80px -16px; }
.ui-icon-triangle-1-w { background-position: -96px -16px; }
.ui-icon-triangle-1-nw { background-position: -112px -16px; }
.ui-icon-triangle-2-n-s { background-position: -128px -16px; }
.ui-icon-triangle-2-e-w { background-position: -144px -16px; }
.ui-icon-arrow-1-n { background-position: 0 -32px; }
.ui-icon-arrow-1-ne { background-position: -16px -32px; }
.ui-icon-arrow-1-e { background-position: -32px -32px; }
.ui-icon-arrow-1-se { background-position: -48px -32px; }
.ui-icon-arrow-1-s { background-position: -64px -32px; }
.ui-icon-arrow-1-sw { background-position: -80px -32px; }
.ui-icon-arrow-1-w { background-position: -96px -32px; }
.ui-icon-arrow-1-nw { background-position: -112px -32px; }
.ui-icon-arrow-2-n-s { background-position: -128px -32px; }
.ui-icon-arrow-2-ne-sw { background-position: -144px -32px; }
.ui-icon-arrow-2-e-w { background-position: -160px -32px; }
.ui-icon-arrow-2-se-nw { background-position: -176px -32px; }
.ui-icon-arrowstop-1-n { background-position: -192px -32px; }
.ui-icon-arrowstop-1-e { background-position: -208px -32px; }
.ui-icon-arrowstop-1-s { background-position: -224px -32px; }
.ui-icon-arrowstop-1-w { background-position: -240px -32px; }
.ui-icon-arrowthick-1-n { background-position: 0 -48px; }
.ui-icon-arrowthick-1-ne { background-position: -16px -48px; }
.ui-icon-arrowthick-1-e { background-position: -32px -48px; }
.ui-icon-arrowthick-1-se { background-position: -48px -48px; }
.ui-icon-arrowthick-1-s { background-position: -64px -48px; }
.ui-icon-arrowthick-1-sw { background-position: -80px -48px; }
.ui-icon-arrowthick-1-w { background-position: -96px -48px; }
.ui-icon-arrowthick-1-nw { background-position: -112px -48px; }
.ui-icon-arrowthick-2-n-s { background-position: -128px -48px; }
.ui-icon-arrowthick-2-ne-sw { background-position: -144px -48px; }
.ui-icon-arrowthick-2-e-w { background-position: -160px -48px; }
.ui-icon-arrowthick-2-se-nw { background-position: -176px -48px; }
.ui-icon-arrowthickstop-1-n { background-position: -192px -48px; }
.ui-icon-arrowthickstop-1-e { background-position: -208px -48px; }
.ui-icon-arrowthickstop-1-s { background-position: -224px -48px; }
.ui-icon-arrowthickstop-1-w { background-position: -240px -48px; }
.ui-icon-arrowreturnthick-1-w { background-position: 0 -64px; }
.ui-icon-arrowreturnthick-1-n { background-position: -16px -64px; }
.ui-icon-arrowreturnthick-1-e { background-position: -32px -64px; }
.ui-icon-arrowreturnthick-1-s { background-position: -48px -64px; }
.ui-icon-arrowreturn-1-w { background-position: -64px -64px; }
.ui-icon-arrowreturn-1-n { background-position: -80px -64px; }
.ui-icon-arrowreturn-1-e { background-position: -96px -64px; }
.ui-icon-arrowreturn-1-s { background-position: -112px -64px; }
.ui-icon-arrowrefresh-1-w { background-position: -128px -64px; }
.ui-icon-arrowrefresh-1-n { background-position: -144px -64px; }
.ui-icon-arrowrefresh-1-e { background-position: -160px -64px; }
.ui-icon-arrowrefresh-1-s { background-position: -176px -64px; }
.ui-icon-arrow-4 { background-position: 0 -80px; }
.ui-icon-arrow-4-diag { background-position: -16px -80px; }
.ui-icon-extlink { background-position: -32px -80px; }
.ui-icon-newwin { background-position: -48px -80px; }
.ui-icon-refresh { background-position: -64px -80px; }
.ui-icon-shuffle { background-position: -80px -80px; }
.ui-icon-transfer-e-w { background-position: -96px -80px; }
.ui-icon-transferthick-e-w { background-position: -112px -80px; }
.ui-icon-folder-collapsed { background-position: 0 -96px; }
.ui-icon-folder-open { background-position: -16px -96px; }
.ui-icon-document { background-position: -32px -96px; }
.ui-icon-document-b { background-position: -48px -96px; }
.ui-icon-note { background-position: -64px -96px; }
.ui-icon-mail-closed { background-position: -80px -96px; }
.ui-icon-mail-open { background-position: -96px -96px; }
.ui-icon-suitcase { background-position: -112px -96px; }
.ui-icon-comment { background-position: -128px -96px; }
.ui-icon-person { background-position: -144px -96px; }
.ui-icon-print { background-position: -160px -96px; }
.ui-icon-trash { background-position: -176px -96px; }
.ui-icon-locked { background-position: -192px -96px; }
.ui-icon-unlocked { background-position: -208px -96px; }
.ui-icon-bookmark { background-position: -224px -96px; }
.ui-icon-tag { background-position: -240px -96px; }
.ui-icon-home { background-position: 0 -112px; }
.ui-icon-flag { background-position: -16px -112px; }
.ui-icon-calendar { background-position: -32px -112px; }
.ui-icon-cart { background-position: -48px -112px; }
.ui-icon-pencil { background-position: -64px -112px; }
.ui-icon-clock { background-position: -80px -112px; }
.ui-icon-disk { background-position: -96px -112px; }
.ui-icon-calculator { background-position: -112px -112px; }
.ui-icon-zoomin { background-position: -128px -112px; }
.ui-icon-zoomout { background-position: -144px -112px; }
.ui-icon-search { background-position: -160px -112px; }
.ui-icon-wrench { background-position: -176px -112px; }
.ui-icon-gear { background-position: -192px -112px; }
.ui-icon-heart { background-position: -208px -112px; }
.ui-icon-star { background-position: -224px -112px; }
.ui-icon-link { background-position: -240px -112px; }
.ui-icon-cancel { background-position: 0 -128px; }
.ui-icon-plus { background-position: -16px -128px; }
.ui-icon-plusthick { background-position: -32px -128px; }
.ui-icon-minus { background-position: -48px -128px; }
.ui-icon-minusthick { background-position: -64px -128px; }
.ui-icon-close { background-position: -80px -128px; }
.ui-icon-closethick { background-position: -96px -128px; }
.ui-icon-key { background-position: -112px -128px; }
.ui-icon-lightbulb { background-position: -128px -128px; }
.ui-icon-scissors { background-position: -144px -128px; }
.ui-icon-clipboard { background-position: -160px -128px; }
.ui-icon-copy { background-position: -176px -128px; }
.ui-icon-contact { background-position: -192px -128px; }
.ui-icon-image { background-position: -208px -128px; }
.ui-icon-video { background-position: -224px -128px; }
.ui-icon-script { background-position: -240px -128px; }
.ui-icon-alert { background-position: 0 -144px; }
.ui-icon-info { background-position: -16px -144px; }
.ui-icon-notice { background-position: -32px -144px; }
.ui-icon-help { background-position: -48px -144px; }
.ui-icon-check { background-position: -64px -144px; }
.ui-icon-bullet { background-position: -80px -144px; }
.ui-icon-radio-on { background-position: -96px -144px; }
.ui-icon-radio-off { background-position: -112px -144px; }
.ui-icon-pin-w { background-position: -128px -144px; }
.ui-icon-pin-s { background-position: -144px -144px; }
.ui-icon-play { background-position: 0 -160px; }
.ui-icon-pause { background-position: -16px -160px; }
.ui-icon-seek-next { background-position: -32px -160px; }
.ui-icon-seek-prev { background-position: -48px -160px; }
.ui-icon-seek-end { background-position: -64px -160px; }
.ui-icon-seek-start { background-position: -80px -160px; }
/* ui-icon-seek-first is deprecated, use ui-icon-seek-start instead */
.ui-icon-seek-first { background-position: -80px -160px; }
.ui-icon-stop { background-position: -96px -160px; }
.ui-icon-eject { background-position: -112px -160px; }
.ui-icon-volume-off { background-position: -128px -160px; }
.ui-icon-volume-on { background-position: -144px -160px; }
.ui-icon-power { background-position: 0 -176px; }
.ui-icon-signal-diag { background-position: -16px -176px; }
.ui-icon-signal { background-position: -32px -176px; }
.ui-icon-battery-0 { background-position: -48px -176px; }
.ui-icon-battery-1 { background-position: -64px -176px; }
.ui-icon-battery-2 { background-position: -80px -176px; }
.ui-icon-battery-3 { background-position: -96px -176px; }
.ui-icon-circle-plus { background-position: 0 -192px; }
.ui-icon-circle-minus { background-position: -16px -192px; }
.ui-icon-circle-close { background-position: -32px -192px; }
.ui-icon-circle-triangle-e { background-position: -48px -192px; }
.ui-icon-circle-triangle-s { background-position: -64px -192px; }
.ui-icon-circle-triangle-w { background-position: -80px -192px; }
.ui-icon-circle-triangle-n { background-position: -96px -192px; }
.ui-icon-circle-arrow-e { background-position: -112px -192px; }
.ui-icon-circle-arrow-s { background-position: -128px -192px; }
.ui-icon-circle-arrow-w { background-position: -144px -192px; }
.ui-icon-circle-arrow-n { background-position: -160px -192px; }
.ui-icon-circle-zoomin { background-position: -176px -192px; }
.ui-icon-circle-zoomout { background-position: -192px -192px; }
.ui-icon-circle-check { background-position: -208px -192px; }
.ui-icon-circlesmall-plus { background-position: 0 -208px; }
.ui-icon-circlesmall-minus { background-position: -16px -208px; }
.ui-icon-circlesmall-close { background-position: -32px -208px; }
.ui-icon-squaresmall-plus { background-position: -48px -208px; }
.ui-icon-squaresmall-minus { background-position: -64px -208px; }
.ui-icon-squaresmall-close { background-position: -80px -208px; }
.ui-icon-grip-dotted-vertical { background-position: 0 -224px; }
.ui-icon-grip-dotted-horizontal { background-position: -16px -224px; }
.ui-icon-grip-solid-vertical { background-position: -32px -224px; }
.ui-icon-grip-solid-horizontal { background-position: -48px -224px; }
.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px; }
.ui-icon-grip-diagonal-se { background-position: -80px -224px; }


/* Misc visuals
----------------------------------*/

/* Corner radius */
.ui-corner-all,
.ui-corner-top,
.ui-corner-left,
.ui-corner-tl {
	border-top-left-radius: 4px;
}
.ui-corner-all,
.ui-corner-top,
.ui-corner-right,
.ui-corner-tr {
	border-top-right-radius: 4px;
}
.ui-corner-all,
.ui-corner-bottom,
.ui-corner-left,
.ui-corner-bl {
	border-bottom-left-radius: 4px;
}
.ui-corner-all,
.ui-corner-bottom,
.ui-corner-right,
.ui-corner-br {
	border-bottom-right-radius: 4px;
}

/* Overlays */
.ui-widget-overlay {
	background: #aaaaaa url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png") 50% 50% repeat-x;
	opacity: .3;
	filter: Alpha(Opacity=30); /* support: IE8 */
}
.ui-widget-shadow {
	margin: -8px 0 0 -8px;
	padding: 8px;
	background: #aaaaaa url("http://code.jquery.com/ui/1.11.2/themes/smoothness/images/ui-bg_flat_0_aaaaaa_40x100.png") 50% 50% repeat-x;
	opacity: .3;
	filter: Alpha(Opacity=30); /* support: IE8 */
	border-radius: 8px;
}

</style>


<style>
/* Adapted from */
/* https://groups.google.com/d/msg/mathjax-users/jqQxrmeG48o/oAaivLgLN90J, */
/* by David Cervone */

@font-face {
    font-family: 'MJX_Math';
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); /* IE9 Compat Modes */
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot?iefix') format('eot'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff')  format('woff'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf')  format('opentype'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Math-Italic.svg#MathJax_Math-Italic') format('svg');
}

@font-face {
    font-family: 'MJX_Main';
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); /* IE9 Compat Modes */
    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot?iefix') format('eot'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff')  format('woff'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf')  format('opentype'),
    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Main-Regular.svg#MathJax_Main-Regular') format('svg');
}
</style>

  <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.5.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.5.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.5.1') format('woff'), url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.5.1') format('opentype')}
</style></head>
  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div class="header"><h1 class="chapter_number">
  <a href="">CHAPTER 1</a></h1>
  <h1 class="chapter_title"><a href="">Using neural nets to recognize handwritten digits</a></h1></div><div class="section"><div id="toc"> 
<p class="toc_title"><a href="http://neuralnetworksanddeeplearning.com/index.html">Neural Networks and Deep Learning</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/about.html">What this book is about</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/exercises_and_problems.html">On the exercises and problems</a></p><p class="toc_mainchapter"><a id="toc_using_neural_nets_to_recognize_handwritten_digits_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_using_neural_nets_to_recognize_handwritten_digits" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a><a href="./Neural networks and deep learning 1_files/Neural networks and deep learning 1.html">Using neural nets to recognize handwritten digits</a></p><div id="toc_using_neural_nets_to_recognize_handwritten_digits" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons"><li>Perceptrons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons"><li>Sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#the_architecture_of_neural_networks"><li>The architecture of neural networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#a_simple_network_to_classify_handwritten_digits"><li>A simple network to classify handwritten digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent"><li>Learning with gradient descent</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits"><li>Implementing our network to classify digits</li></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#toward_deep_learning"><li>Toward deep learning</li></a></ul><p></p></div>
<script>
$('#toc_using_neural_nets_to_recognize_handwritten_digits_reveal').click(function() { 
   var src = $('#toc_img_using_neural_nets_to_recognize_handwritten_digits').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow.png');
   };
   $('#toc_using_neural_nets_to_recognize_handwritten_digits').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_how_the_backpropagation_algorithm_works_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_how_the_backpropagation_algorithm_works" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html">How the backpropagation algorithm works</a></p><div id="toc_how_the_backpropagation_algorithm_works" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap2.html#warm_up_a_fast_matrix-based_approach_to_computing_the_output_from_a_neural_network"><li>Warm up: a fast matrix-based approach to computing the output
  from a neural network</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_two_assumptions_we_need_about_the_cost_function"><li>The two assumptions we need about the cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_hadamard_product_$s_\odot_t$"><li>The Hadamard product, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame"><nobr><span class="math" id="MathJax-Span-1" role="math" style="width: 2.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.11em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">t</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">s \odot t</script></li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation"><li>The four fundamental equations behind backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#proof_of_the_four_fundamental_equations_(optional)"><li>Proof of the four fundamental equations (optional)</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_backpropagation_algorithm"><li>The backpropagation algorithm</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#the_code_for_backpropagation"><li>The code for backpropagation</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#in_what_sense_is_backpropagation_a_fast_algorithm"><li>In what sense is backpropagation a fast algorithm?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap2.html#backpropagation_the_big_picture"><li>Backpropagation: the big picture</li></a></ul><p></p></div>
<script>
$('#toc_how_the_backpropagation_algorithm_works_reveal').click(function() { 
   var src = $('#toc_img_how_the_backpropagation_algorithm_works').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow.png');
   };
   $('#toc_how_the_backpropagation_algorithm_works').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_improving_the_way_neural_networks_learn_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_improving_the_way_neural_networks_learn" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html">Improving the way neural networks learn</a></p><div id="toc_improving_the_way_neural_networks_learn" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function"><li>The cross-entropy cost function</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization"><li>Overfitting and regularization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization"><li>Weight initialization</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code"><li>Handwriting recognition revisited: the code</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters"><li>How to choose a neural network's hyper-parameters?</li></a><a href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques"><li>Other techniques</li></a></ul><p></p></div>
<script>
$('#toc_improving_the_way_neural_networks_learn_reveal').click(function() { 
   var src = $('#toc_img_improving_the_way_neural_networks_learn').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow.png');
   };
   $('#toc_improving_the_way_neural_networks_learn').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_a_visual_proof_that_neural_nets_can_compute_any_function" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html">A visual proof that neural nets can compute any function</a></p><div id="toc_a_visual_proof_that_neural_nets_can_compute_any_function" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap4.html#two_caveats"><li>Two caveats</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#universality_with_one_input_and_one_output"><li>Universality with one input and one output</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#many_input_variables"><li>Many input variables</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#extension_beyond_sigmoid_neurons"><li>Extension beyond sigmoid neurons</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#fixing_up_the_step_functions"><li>Fixing up the step functions</li></a><a href="http://neuralnetworksanddeeplearning.com/chap4.html#conclusion"><li>Conclusion</li></a></ul><p></p></div>
<script>
$('#toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal').click(function() { 
   var src = $('#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow.png');
   };
   $('#toc_a_visual_proof_that_neural_nets_can_compute_any_function').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_why_are_deep_neural_networks_hard_to_train_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_why_are_deep_neural_networks_hard_to_train" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html">Why are deep neural networks hard to train?</a></p><div id="toc_why_are_deep_neural_networks_hard_to_train" style="display: none;"><p class="toc_section"></p><ul><a href="http://neuralnetworksanddeeplearning.com/chap5.html#the_vanishing_gradient_problem"><li>The vanishing gradient problem</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets"><li>What's causing the vanishing gradient problem?  Unstable gradients in deep neural nets</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#unstable_gradients_in_more_complex_networks"><li>Unstable gradients in more complex networks</li></a><a href="http://neuralnetworksanddeeplearning.com/chap5.html#other_obstacles_to_deep_learning"><li>Other obstacles to deep learning</li></a></ul><p></p></div>
<script>
$('#toc_why_are_deep_neural_networks_hard_to_train_reveal').click(function() { 
   var src = $('#toc_img_why_are_deep_neural_networks_hard_to_train').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow.png');
   };
   $('#toc_why_are_deep_neural_networks_hard_to_train').toggle('fast', function() {});  
});</script><p class="toc_mainchapter"><a id="toc_deep_learning_reveal" class="toc_reveal" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><img id="toc_img_deep_learning" src="./Neural networks and deep learning 1_files/arrow.png" width="15px"></a>Deep learning</p><div id="toc_deep_learning" style="display: none;"><p class="toc_section"></p><ul><li>Convolutional neural networks</li><li>Pretraining</li><li>Recurrent neural networks, Boltzmann machines, and other
  models</li><li>Is there a universal thinking algorithm?</li><li>On the future of neural networks</li></ul><p></p></div>
<script>
$('#toc_deep_learning_reveal').click(function() { 
   var src = $('#toc_img_deep_learning').attr('src');
   if(src == 'images/arrow.png') {
     $("#toc_img_deep_learning").attr('src', 'images/arrow_down.png');
   } else {
     $("#toc_img_deep_learning").attr('src', 'images/arrow.png');
   };
   $('#toc_deep_learning').toggle('fast', function() {});  
});</script><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/acknowledgements.html">Acknowledgements</a></p><p class="toc_not_mainchapter"><a href="http://neuralnetworksanddeeplearning.com/faq.html">Frequently Asked Questions</a></p>
<hr>
<span class="sidebar_title">Sponsors</span>
<br>
<a href="http://www.ersatz1.com/"><img src="./Neural networks and deep learning 1_files/ersatz.png" width="140px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://gsquaredcapital.com/"><img src="./Neural networks and deep learning 1_files/gsquared.png" width="150px" style="padding: 0px 0px 10px 10px; border-style: none;"></a>

<a href="http://www.tineye.com/"><img src="./Neural networks and deep learning 1_files/tineye.png" width="150px" style="padding: 0px 0px 10px 8px; border-style: none;"></a>

<a href="http://www.visionsmarts.com/"><img src="./Neural networks and deep learning 1_files/visionsmarts.png" width="160px" style="padding: 0px 0px
0px 0px; border-style: none;"></a> <br> 

<p class="sidebar">Thanks to all the <a href="http://neuralnetworksanddeeplearning.com/supporters.html">supporters</a> who made the book possible.
Thanks also to all the contributors to the <a href="http://neuralnetworksanddeeplearning.com/bugfinder.html">Bugfinder Hall of Fame</a>.  </p>

<p class="sidebar">The book is currently a beta release, and is still
under active development.  Please send error reports to
mn@michaelnielsen.org.  For other enquiries, please see the <a href="http://neuralnetworksanddeeplearning.com/faq.html">FAQ</a> first.</p>

<hr>
<span class="sidebar_title">Resources</span>

<p class="sidebar">
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning">Code repository</a></p>

<p class="sidebar">
<a href="http://eepurl.com/BYr9L">Mailing list for book announcements</a>
</p>

<p class="sidebar">
<a href="http://eepurl.com/0Xxjb">Michael Nielsen's project announcement mailing list</a>
</p>

<hr>
<a href="http://michaelnielsen.org/"><img src="./Neural networks and deep learning 1_files/Michael_Nielsen_Web_Small.jpg" width="160px" style="border-style: none;"></a>

<p class="sidebar">
By <a href="http://michaelnielsen.org/">Michael Nielsen</a> / Dec 2014
</p>
</div>
<p></p><p>The human visual system is one of the wonders of the world.  Consider
the following sequence of handwritten digits: <a name="complete_zero"></a></p><p></p><center><img src="./Neural networks and deep learning 1_files/digits.png" width="160px"></center> <p></p><p>Most people effortlessly recognize those digits as 504192.  That ease
is deceptive.  In each hemisphere of our brain, humans have a primary
visual cortex, also known as V1, containing 140 million neurons, with
tens of billions of connections between them.  And yet human vision
involves not just V1, but an entire series of visual cortices - V2,
V3, V4, and V5 - doing progressively more complex image processing.
We carry in our heads a supercomputer, tuned by evolution over
hundreds of millions of years, and superbly adapted to understand the
visual world.  Recognizing handwritten digits isn't easy.  Rather, we
humans are stupendously, astoundingly good at making sense of what our
eyes show us.  But nearly all that work is done unconsciously.  And so
we don't usually appreciate how tough a problem our visual systems
solve.</p><p>The difficulty of visual pattern recognition becomes apparent if you
attempt to write a computer program to recognize digits like those
above.  What seems easy when we do it ourselves suddenly becomes
extremely difficult.  Simple intuitions about how we recognize shapes
- "a 9 has a loop at the top, and a vertical stroke in the bottom
right" - turn out to be not so simple to express algorithmically.
When you try to make such rules precise, you quickly get lost in a
morass of exceptions and caveats and special cases.  It seems
hopeless.</p><p></p><p>
Neural networks approach the problem in a different way.  The idea is
to take a large number of handwritten digits, known as training
examples,</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_100_digits.png" width="440px"></center><p></p><p>and then develop a system which can learn from those training
examples. In other words, the neural network uses the examples to
automatically infer rules for recognizing handwritten digits.
Furthermore, by increasing the number of training examples, the
network can learn more about handwriting, and so improve its accuracy.
So while I've shown just 100 training digits above, perhaps we could
build a better handwriting recognizer by using thousands or even
millions or billions of training examples.</p><p>In this chapter we'll write a computer program implementing a neural
network that learns to recognize handwritten digits.  The program is
just 74 lines long, and uses no special neural network libraries.  But
this short program can recognize digits with an accuracy over 96
percent, without human intervention.  Furthermore, in later chapters
we'll develop ideas which can improve accuracy to over 99 percent.  In
fact, the best commercial neural networks are now so good that they
are used by banks to process cheques, and by post offices to recognize
addresses.</p><p>We're focusing on handwriting recognition because it's an excellent
prototype problem for learning about neural networks in general.  As a
prototype it hits a sweet spot: it's challenging - it's no small
feat to recognize handwritten digits - but it's not so difficult as
to require an extremely complicated solution, or tremendous
computational power.  Furthermore, it's a great way to develop more
advanced techniques, such as deep learning.  And so throughout the
book we'll return repeatedly to the problem of handwriting
recognition.  Later in the book, we'll discuss how these ideas may be
applied to other problems in computer vision, and also in speech,
natural language processing, and other domains.</p><p>Of course, if the point of the chapter was only to write a computer
program to recognize handwritten digits, then the chapter would be
much shorter!  But along the way we'll develop many key ideas about
neural networks, including two important types of artificial neuron
(the perceptron and the sigmoid neuron), and the standard learning
algorithm for neural networks, known as stochastic gradient descent.
Throughout, I focus on explaining <em>why</em> things are done the way
they are, and on building your neural networks intuition.  That
requires a lengthier discussion than if I just presented the basic
mechanics of what's going on, but it's worth it for the deeper
understanding you'll attain.  Amongst the payoffs, by the end of the
chapter we'll be in position to understand what deep learning is, and
why it matters.</p><p></p><h3><a name="perceptrons"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons">Perceptrons</a></h3><p></p><p>What is a neural network?  To get started, I'll explain a type of
artificial neuron called a <em>perceptron</em>.
Perceptrons were
<a href="http://books.google.ca/books/about/Principles_of_neurodynamics.html?id=7FhRAAAAMAAJ">developed</a>
in the 1950s and 1960s by the scientist
<a href="http://en.wikipedia.org/wiki/Frank_Rosenblatt">Frank
  Rosenblatt</a>, inspired by earlier
<a href="http://scholar.google.ca/scholar?cluster=4035975255085082870">work</a>
by <a href="http://en.wikipedia.org/wiki/Warren_McCulloch">Warren
  McCulloch</a> and
<a href="http://en.wikipedia.org/wiki/Walter_Pitts">Walter
  Pitts</a>.  Today, it's more common to use other
models of artificial neurons - in this book, and in much modern work
on neural networks, the main neuron model used is one called the
<em>sigmoid neuron</em>.  We'll get to sigmoid neurons shortly.  But to
understand why sigmoid neurons are defined the way they are, it's
worth taking the time to first understand perceptrons.</p><p>So how do perceptrons work?  A perceptron takes several binary inputs,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame"><nobr><span class="math" id="MathJax-Span-6" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-12" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">x_1, x_2, \ldots</script>, and produces a single binary output:
</p><center>
<img src="./Neural networks and deep learning 1_files/tikz0.png">
</center>
In the example shown the perceptron has three inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame"><nobr><span class="math" id="MathJax-Span-17" role="math" style="width: 3.973em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.875em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-18"><span class="msubsup" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-23" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-27" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">x_1, x_2, x_3</script>.
In general it could have more or fewer inputs.  Rosenblatt proposed a
simple rule to compute the output.  He introduced
<em>weights</em>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame"><nobr><span class="math" id="MathJax-Span-30" role="math" style="width: 4.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.316em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">w_1,w_2,\ldots</script>, real numbers
expressing the importance of the respective inputs to the output.  The
neuron's output, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame"><nobr><span class="math" id="MathJax-Span-41" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-42"><span class="mn" id="MathJax-Span-43" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame"><nobr><span class="math" id="MathJax-Span-44" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-45"><span class="mn" id="MathJax-Span-46" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">1</script>, is determined by whether the weighted sum
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame"><nobr><span class="math" id="MathJax-Span-47" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-48"><span class="munderover" id="MathJax-Span-49"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-52" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\sum_j w_j x_j</script> is less than or greater than some <em>threshold
  value</em>.  Just like the weights, the
threshold is a real number which is a parameter of the neuron.  To put
it in more precise algebraic terms:
<a class="displaced_anchor" name="eqtn1"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-8-Frame"><nobr><span class="math" id="MathJax-Span-58" role="math" style="width: 100%; display: inline-block; min-width: 22.748em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 22.748em;"><span style="position: absolute; clip: rect(2.11em 1000.002em 5.395em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-59"><span class="mtable" id="MathJax-Span-60" style="min-width: 23.189em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.748em;"><span style="display: inline-block; position: absolute; width: 17.453em; height: 0px; clip: rect(-1.909em 1000.002em 1.375em -999.998em); top: 0.002em; left: 50%; margin-left: -8.723em;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-64"><span class="mrow" id="MathJax-Span-65"><span class="mtext" id="MathJax-Span-66" style="font-family: MathJax_Main;">output</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.017em; left: 3.238em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.532em 1000.002em 4.169em -999.998em); top: -4.017em; left: 50%; margin-left: -0.537em;"><span class="mtd" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69"></span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.11em 1000.002em 5.395em -999.998em); top: -4.017em; left: 4.561em;"><span style="display: inline-block; position: relative; width: 12.895em; height: 0px;"><span style="position: absolute; clip: rect(2.11em 1000.002em 5.395em -999.998em); top: -4.017em; left: 0.002em;"><span class="mtd" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mo" id="MathJax-Span-74" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size4;">{</span></span><span class="mtable" id="MathJax-Span-75" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 11.767em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 4.904em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.9em; left: 0.002em;"><span class="mtd" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="mn" id="MathJax-Span-78" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.282em; left: 0.002em;"><span class="mtd" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="mn" id="MathJax-Span-95" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.257em 1000.002em 5.346em -999.998em); top: -4.017em; left: 1.522em;"><span style="display: inline-block; position: relative; width: 10.248em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.9em; left: 0.002em;"><span class="mtd" id="MathJax-Span-79"><span class="mrow" id="MathJax-Span-80"><span class="mtext" id="MathJax-Span-81" style="font-family: MathJax_Main;">if&nbsp;</span><span class="munderover" id="MathJax-Span-82" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-84" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-85" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mtext" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.297em;">&nbsp;threshold</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -3.282em; left: 0.002em;"><span class="mtd" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mtext" id="MathJax-Span-98" style="font-family: MathJax_Main;">if&nbsp;</span><span class="munderover" id="MathJax-Span-99" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-102" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-105"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mtext" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.297em;">&nbsp;threshold</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-110"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.88em 1000.002em 0.395em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-62"><span class="mtext" id="MathJax-Span-63" style="font-family: MathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.152em; vertical-align: -1.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\begin{eqnarray}
  \mbox{output} & = & \left\{ \begin{array}{ll}
      0 & \mbox{if } \sum_j w_j x_j \leq \mbox{ threshold} \\
      1 & \mbox{if } \sum_j w_j x_j > \mbox{ threshold}
      \end{array} \right.
\tag{1}\end{eqnarray}</script>
That's all there is to how a perceptron works!<p></p><p>That's the basic mathematical model.  A way you can think about the
perceptron is that it's a device that makes decisions by weighing up
evidence.  Let me give an example.  It's not a very realistic example,
but it's easy to understand, and we'll soon get to more realistic
examples.  Suppose the weekend is coming up, and you've heard that
there's going to be a cheese festival in your city.  You like cheese,
and are trying to decide whether or not to go to the festival.  You
might make your decision by weighing up three factors:
</p><ol>
<li> Is the weather good?
</li><li> Does your boyfriend or girlfriend want to accompany you?
</li><li> Is the festival near public transit? (You don't own a car).
</li></ol>
We can represent these three factors by corresponding binary variables
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame"><nobr><span class="math" id="MathJax-Span-111" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-112"><span class="msubsup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-117" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">x_1, x_2</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame"><nobr><span class="math" id="MathJax-Span-120" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-121"><span class="msubsup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">x_3</script>.  For instance, we'd have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame"><nobr><span class="math" id="MathJax-Span-125" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-126"><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">x_1 = 1</script> if the
weather is good, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame"><nobr><span class="math" id="MathJax-Span-132" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-133"><span class="msubsup" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">x_1 = 0</script> if the weather is bad.  Similarly, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame"><nobr><span class="math" id="MathJax-Span-139" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-140"><span class="msubsup" id="MathJax-Span-141"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">x_2
= 1</script> if your boyfriend or girlfriend wants to go, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame"><nobr><span class="math" id="MathJax-Span-146" role="math" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-147"><span class="msubsup" id="MathJax-Span-148"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">x_2 = 0</script> if
not.  And similarly again for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame"><nobr><span class="math" id="MathJax-Span-153" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-154"><span class="msubsup" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">x_3</script> and public transit.<p></p><p>Now, suppose you absolutely adore cheese, so much so that you're happy
to go to the festival even if your boyfriend or girlfriend is
uninterested and the festival is hard to get to.  But perhaps you
really loathe bad weather, and there's no way you'd go to the festival
if the weather is bad.  You can use perceptrons to model this kind of
decision-making.  One way to do this is to choose a weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame"><nobr><span class="math" id="MathJax-Span-158" role="math" style="width: 3.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.042em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-159"><span class="msubsup" id="MathJax-Span-160"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.297em;">6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">w_1 = 6</script>
for the weather, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame"><nobr><span class="math" id="MathJax-Span-165" role="math" style="width: 3.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.042em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-166"><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">w_2 = 2</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame"><nobr><span class="math" id="MathJax-Span-172" role="math" style="width: 3.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.042em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.297em;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">w_3 = 2</script> for the other conditions.
The larger value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame"><nobr><span class="math" id="MathJax-Span-179" role="math" style="width: 1.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">w_1</script> indicates that the weather matters a lot to
you, much more than whether your boyfriend or girlfriend joins you, or
the nearness of public transit.  Finally, suppose you choose a
threshold of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame"><nobr><span class="math" id="MathJax-Span-184" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-185"><span class="mn" id="MathJax-Span-186" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">5</script> for the perceptron.  With these choices, the
perceptron implements the desired decision-making model, outputting
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame"><nobr><span class="math" id="MathJax-Span-187" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-188"><span class="mn" id="MathJax-Span-189" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">1</script> whenever the weather is good, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame"><nobr><span class="math" id="MathJax-Span-190" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-191"><span class="mn" id="MathJax-Span-192" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">0</script> whenever the weather is bad.
It makes no difference to the output whether your boyfriend or
girlfriend wants to go, or whether public transit is nearby.</p><p>By varying the weights and the threshold, we can get different models
of decision-making.  For example, suppose we instead chose a threshold
of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame"><nobr><span class="math" id="MathJax-Span-193" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-194"><span class="mn" id="MathJax-Span-195" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">3</script>.  Then the perceptron would decide that you should go to the
festival whenever the weather was good <em>or</em> when both the
festival was near public transit <em>and</em> your boyfriend or
girlfriend was willing to join you.  In other words, it'd be a
different model of decision-making.  Dropping the threshold means
you're more willing to go to the festival.</p><p>Obviously, the perceptron isn't a complete model of human
decision-making!  But what the example illustrates is how a perceptron
can weigh up different kinds of evidence in order to make decisions.
And it should seem plausible that a complex network of perceptrons
could make quite subtle decisions:
</p><center>
<img src="./Neural networks and deep learning 1_files/tikz1.png">
</center>
In this network, the first column of perceptrons - what we'll call
the first <em>layer</em> of perceptrons - is making three very simple
decisions, by weighing the input evidence.  What about the perceptrons
in the second layer?  Each of those perceptrons is making a decision
by weighing up the results from the first layer of decision-making.
In this way a perceptron in the second layer can make a decision at a
more complex and more abstract level than perceptrons in the first
layer.  And even more complex decisions can be made by the perceptron
in the third layer.  In this way, a many-layer network of perceptrons
can engage in sophisticated decision making.<p></p><p>Incidentally, when I defined perceptrons I said that a perceptron has
just a single output.  In the network above the perceptrons look like
they have multiple outputs.  In fact, they're still single output.
The multiple output arrows are merely a useful way of indicating that
the output from a perceptron is being used as the input to several
other perceptrons.  It's less unwieldy than drawing a single output
line which then splits.</p><p>Let's simplify the way we describe perceptrons.  The condition <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame"><nobr><span class="math" id="MathJax-Span-196" role="math" style="width: 9.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-197"><span class="munderover" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-201" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mtext" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.297em;">threshold</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\sum_j
w_j x_j > \mbox{threshold}</script> is cumbersome, and we can make two
notational changes to simplify it.
 The first change is to write
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame"><nobr><span class="math" id="MathJax-Span-209" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-210"><span class="munderover" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-214" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-217"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\sum_j w_j x_j</script> as a dot product, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame"><nobr><span class="math" id="MathJax-Span-220" role="math" style="width: 7.159em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-223" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="munderover" id="MathJax-Span-226" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-227" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-229" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-232"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">w \cdot x \equiv \sum_j w_j x_j</script>,
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame"><nobr><span class="math" id="MathJax-Span-235" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame"><nobr><span class="math" id="MathJax-Span-238" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">x</script> are vectors whose components are the weights and
inputs, respectively.  The second change is to move the threshold to
the other side of the inequality, and to replace it by what's known as
the perceptron's <em>bias</em>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame"><nobr><span class="math" id="MathJax-Span-241" role="math" style="width: 6.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mtext" id="MathJax-Span-246" style="font-family: MathJax_Main;">threshold</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">b \equiv
-\mbox{threshold}</script>.  Using the bias instead of the threshold, the
perceptron rule can be
rewritten:
<a class="displaced_anchor" name="eqtn2"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-30-Frame"><nobr><span class="math" id="MathJax-Span-247" role="math" style="width: 100%; display: inline-block; min-width: 18.728em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 18.728em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-248"><span class="mtable" id="MathJax-Span-249" style="min-width: 19.12em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.728em;"><span style="display: inline-block; position: absolute; width: 13.336em; height: 0px; clip: rect(-1.615em 1000.002em 1.081em -999.998em); top: 0.002em; left: 50%; margin-left: -6.664em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 13.336em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="MathJax-Span-253"><span class="mrow" id="MathJax-Span-254"><span class="mtext" id="MathJax-Span-255" style="font-family: MathJax_Main;">output</span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mrow" id="MathJax-Span-257" style="padding-left: 0.297em;"><span class="mo" id="MathJax-Span-258" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-259" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 7.993em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.904em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.654em; left: 0.002em;"><span class="mtd" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mn" id="MathJax-Span-262" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.282em; left: 0.002em;"><span class="mtd" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mn" id="MathJax-Span-275" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 5.002em -999.998em); top: -4.017em; left: 1.522em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.654em; left: 0.002em;"><span class="mtd" id="MathJax-Span-263"><span class="mrow" id="MathJax-Span-264"><span class="mtext" id="MathJax-Span-265" style="font-family: MathJax_Main;">if&nbsp;</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -3.282em; left: 0.002em;"><span class="mtd" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mtext" id="MathJax-Span-278" style="font-family: MathJax_Main;">if&nbsp;</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-286"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.88em 1000.002em 0.395em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; right: 0.002em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-251"><span class="mtext" id="MathJax-Span-252" style="font-family: MathJax_Main;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.552em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\begin{eqnarray}
  \mbox{output} = \left\{ 
    \begin{array}{ll} 
      0 & \mbox{if } w\cdot x + b \leq 0 \\
      1 & \mbox{if } w\cdot x + b > 0
    \end{array}
  \right.
\tag{2}\end{eqnarray}</script>
You can think of the bias as a measure of how easy it is to get the
perceptron to output a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame"><nobr><span class="math" id="MathJax-Span-287" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-288"><span class="mn" id="MathJax-Span-289" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">1</script>.  Or to put it in more biological terms,
the bias is a measure of how easy it is to get the perceptron to
<em>fire</em>.  For a perceptron with a really big bias, it's extremely
easy for the perceptron to output a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame"><nobr><span class="math" id="MathJax-Span-290" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-291"><span class="mn" id="MathJax-Span-292" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">1</script>.  But if the bias is very
negative, then it's difficult for the perceptron to output a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame"><nobr><span class="math" id="MathJax-Span-293" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-294"><span class="mn" id="MathJax-Span-295" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">1</script>.
Obviously, introducing the bias is only a small change in how we
describe perceptrons, but we'll see later that it leads to further
notational simplifications.  Because of this, in the remainder of the
book we won't use the threshold, we'll always use the bias.</p><p>I've described perceptrons as a method for weighing evidence to make
decisions.  Another way perceptrons can be used is to compute the
elementary logical functions we usually think of as underlying
computation, functions such as <code>AND</code>, <code>OR</code>, and
<code>NAND</code>.  For example, suppose we have a perceptron with two
inputs, each with weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame"><nobr><span class="math" id="MathJax-Span-296" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-297"><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-299" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">-2</script>, and an overall bias of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame"><nobr><span class="math" id="MathJax-Span-300" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-301"><span class="mn" id="MathJax-Span-302" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">3</script>.  Here's our
perceptron:
</p><center>
<img src="./Neural networks and deep learning 1_files/tikz2.png">
</center>
Then we see that input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame"><nobr><span class="math" id="MathJax-Span-303" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-304"><span class="mn" id="MathJax-Span-305" style="font-family: MathJax_Main;">00</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">00</script> produces output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame"><nobr><span class="math" id="MathJax-Span-306" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-307"><span class="mn" id="MathJax-Span-308" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">1</script>, since
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame"><nobr><span class="math" id="MathJax-Span-309" role="math" style="width: 12.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-310"><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-313" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.248em;">0</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-320" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-323" style="font-family: MathJax_Main; padding-left: 0.248em;">0</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mn" id="MathJax-Span-325" style="font-family: MathJax_Main; padding-left: 0.248em;">3</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-327" style="font-family: MathJax_Main; padding-left: 0.297em;">3</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">(-2)*0+(-2)*0+3 = 3</script> is positive.  Here, I've introduced the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame"><nobr><span class="math" id="MathJax-Span-328" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.12em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-329"><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: 0.003em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">*</script>
symbol to make the multiplications explicit.  Similar calculations
show that the inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame"><nobr><span class="math" id="MathJax-Span-331" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-332"><span class="mn" id="MathJax-Span-333" style="font-family: MathJax_Main;">01</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">01</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame"><nobr><span class="math" id="MathJax-Span-334" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-335"><span class="mn" id="MathJax-Span-336" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">10</script> produce output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame"><nobr><span class="math" id="MathJax-Span-337" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-338"><span class="mn" id="MathJax-Span-339" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">1</script>.  But the input
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame"><nobr><span class="math" id="MathJax-Span-340" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-341"><span class="mn" id="MathJax-Span-342" style="font-family: MathJax_Main;">11</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">11</script> produces output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame"><nobr><span class="math" id="MathJax-Span-343" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-344"><span class="mn" id="MathJax-Span-345" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">0</script>, since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame"><nobr><span class="math" id="MathJax-Span-346" role="math" style="width: 13.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.797em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-347"><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-350" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.248em;">1</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.248em;">(</span><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-357" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-360" style="font-family: MathJax_Main; padding-left: 0.248em;">1</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mn" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.248em;">3</span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-365" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">(-2)*1+(-2)*1+3 = -1</script> is negative.
And so our perceptron implements a <code>NAND</code>
gate!<p></p><p><a name="universality"></a></p><p>The <code>NAND</code> example shows that we can use perceptrons to compute
simple logical functions.
 In fact, we can use
networks of perceptrons to compute <em>any</em> logical function at all.
The reason is that the <code>NAND</code> gate is universal for
computation, that is, we can build any computation up out of
<code>NAND</code> gates.  For example, we can use <code>NAND</code> gates to
build a circuit which adds two bits, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame"><nobr><span class="math" id="MathJax-Span-366" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-367"><span class="msubsup" id="MathJax-Span-368"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">x_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame"><nobr><span class="math" id="MathJax-Span-371" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-372"><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">x_2</script>.  This requires
computing the bitwise sum, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame"><nobr><span class="math" id="MathJax-Span-376" role="math" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.287em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-377"><span class="msubsup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-380" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="msubsup" id="MathJax-Span-382" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">x_1 \oplus x_2</script>, as well as a carry bit
which is set to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame"><nobr><span class="math" id="MathJax-Span-385" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-386"><span class="mn" id="MathJax-Span-387" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">1</script> when both <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame"><nobr><span class="math" id="MathJax-Span-388" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-389"><span class="msubsup" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-392" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">x_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame"><nobr><span class="math" id="MathJax-Span-393" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-394"><span class="msubsup" id="MathJax-Span-395"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-397" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">x_2</script> are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame"><nobr><span class="math" id="MathJax-Span-398" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-399"><span class="mn" id="MathJax-Span-400" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">1</script>, i.e., the carry
bit is just the bitwise product <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame"><nobr><span class="math" id="MathJax-Span-401" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-402"><span class="msubsup" id="MathJax-Span-403"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-405" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">x_1 x_2</script>:
</p><center>
 <img src="./Neural networks and deep learning 1_files/tikz3.png">
</center>
To get an equivalent network of perceptrons we replace all the
<code>NAND</code> gates by perceptrons with two inputs, each with weight
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame"><nobr><span class="math" id="MathJax-Span-409" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-410"><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-412" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">-2</script>, and an overall bias of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame"><nobr><span class="math" id="MathJax-Span-413" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-414"><span class="mn" id="MathJax-Span-415" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">3</script>.  Here's the resulting network.  Note
that I've moved the perceptron corresponding to the bottom right
<code>NAND</code> gate a little, just to make it easier to draw the arrows
on the diagram:
<center>
 <img src="./Neural networks and deep learning 1_files/tikz4.png">
</center>
One notable aspect of this network of perceptrons is that the output
from the leftmost perceptron is used twice as input to the bottommost
perceptron.  When I defined the perceptron model I didn't say whether
this kind of double-output-to-the-same-place was allowed.  Actually,
it doesn't much matter.  If we don't want to allow this kind of thing,
then it's possible to simply merge the two lines, into a single
connection with a weight of -4 instead of two connections with -2
weights.  (If you don't find this obvious, you should stop and prove
to yourself that this is equivalent.)  With that change, the network
looks as follows, with all unmarked weights equal to -2, all biases
equal to 3, and a single weight of -4, as marked:
<center>
 <img src="./Neural networks and deep learning 1_files/tikz5.png">
</center>
Up to now I've been drawing inputs like <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame"><nobr><span class="math" id="MathJax-Span-416" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-417"><span class="msubsup" id="MathJax-Span-418"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">x_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame"><nobr><span class="math" id="MathJax-Span-421" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">x_2</script> as variables
floating to the left of the network of perceptrons.  In fact, it's
conventional to draw an extra layer of perceptrons - the <em>input
  layer</em> - to encode the inputs:
<center>
 <img src="./Neural networks and deep learning 1_files/tikz6.png">
</center>
This notation for input perceptrons, in which we have an output, but
no inputs,
<center>
<img src="./Neural networks and deep learning 1_files/tikz7.png">
</center>
is a shorthand.  It doesn't actually mean a perceptron with no inputs.
To see this, suppose we did have a perceptron with no inputs.  Then
the weighted sum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame"><nobr><span class="math" id="MathJax-Span-426" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-427"><span class="munderover" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-429" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-431" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-436" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.302em; vertical-align: -0.497em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">\sum_j w_j x_j</script> would always be zero, and so the
perceptron would output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame"><nobr><span class="math" id="MathJax-Span-437" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-438"><span class="mn" id="MathJax-Span-439" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">1</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame"><nobr><span class="math" id="MathJax-Span-440" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-441"><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">b > 0</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame"><nobr><span class="math" id="MathJax-Span-445" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-446"><span class="mn" id="MathJax-Span-447" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">0</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame"><nobr><span class="math" id="MathJax-Span-448" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-452" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">b \leq 0</script>.  That
is, the perceptron would simply output a fixed value, not the desired
valued (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame"><nobr><span class="math" id="MathJax-Span-453" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-454"><span class="msubsup" id="MathJax-Span-455"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">x_1</script>, in the example above). It's better to think of the
input perceptrons as not really being perceptrons at all, but rather
special units which are simply defined to output the desired values,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame"><nobr><span class="math" id="MathJax-Span-458" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-459"><span class="msubsup" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-462" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-464" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-466" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">x_1, x_2,\ldots</script>.<p></p><p>The adder example demonstrates how a network of perceptrons can be
used to simulate a circuit containing many <code>NAND</code> gates.  And
because <code>NAND</code> gates are universal for computation, it follows
that perceptrons are also universal for computation.</p><p>The computational universality of perceptrons is simultaneously
reassuring and disappointing.  It's reassuring because it tells us
that networks of perceptrons can be as powerful as any other computing
device.  But it's also disappointing, because it makes it seem as
though perceptrons are merely a new type of <code>NAND</code> gate.
That's hardly big news!</p><p>However, the situation is better than this view suggests.  It turns
out that we can devise <em>learning
  algorithms</em> which can
automatically tune the weights and biases of a network of artificial
neurons.  This tuning happens in response to external stimuli, without
direct intervention by a programmer.  These learning algorithms enable
us to use artificial neurons in a way which is radically different to
conventional logic gates.  Instead of explicitly laying out a circuit
of <code>NAND</code> and other gates, our neural networks can simply learn
to solve problems, sometimes problems where it would be extremely
difficult to directly design a conventional circuit.</p><p></p><h3><a name="sigmoid_neurons"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons">Sigmoid neurons</a></h3><p></p><p>Learning algorithms sound terrific.  But how can we devise such
algorithms for a neural network?  Suppose we have a network of
perceptrons that we'd like to use to learn to solve some problem.  For
example, the inputs to the network might be the raw pixel data from a
scanned, handwritten image of a digit.  And we'd like the network to
learn weights and biases so that the output from the network correctly
classifies the digit.  To see how learning might work, suppose we make
a small change in some weight (or bias) in the network.  What we'd
like is for this small change in weight to cause only a small
corresponding change in the output from the network.  As we'll see in
a moment, this property will make learning possible.  Schematically,
here's what we want (obviously this network is too simple to do
handwriting recognition!):</p><p></p><center>
<img src="./Neural networks and deep learning 1_files/tikz8.png">
</center><p></p><p>If it were true that a small change in a weight (or bias) causes only
a small change in output, then we could use this fact to modify the
weights and biases to get our network to behave more in the manner we
want.  For example, suppose the network was mistakenly classifying an
image as an "8" when it should be a "9".  We could figure out how
to make a small change in the weights and biases so the network gets a
little closer to classifying the image as a "9".  And then we'd
repeat this, changing the weights and biases over and over to produce
better and better output.  The network would be learning.</p><p>The problem is that this isn't what happens when our network contains
perceptrons.  In fact, a small change in the weights or bias of any
single perceptron in the network can sometimes cause the output of
that perceptron to completely flip, say from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame"><nobr><span class="math" id="MathJax-Span-469" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-470"><span class="mn" id="MathJax-Span-471" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">0</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame"><nobr><span class="math" id="MathJax-Span-472" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-473"><span class="mn" id="MathJax-Span-474" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">1</script>.  That flip
may then cause the behaviour of the rest of the network to completely
change in some very complicated way.  So while your "9" might now be
classified correctly, the behaviour of the network on all the other
images is likely to have completely changed in some hard-to-control
way.  That makes it difficult to see how to gradually modify the
weights and biases so that the network gets closer to the desired
behaviour.  Perhaps there's some clever way of getting around this
problem.  But it's not immediately obvious how we can get a network of
perceptrons to learn.</p><p>We can overcome this problem by introducing a new type of artificial
neuron called a <em>sigmoid</em> neuron.
Sigmoid neurons are similar to perceptrons, but modified so that small
changes in their weights and bias cause only a small change in their
output.  That's the crucial fact which will allow a network of sigmoid
neurons to learn.</p><p>Okay, let me describe the sigmoid neuron.  We'll depict sigmoid
neurons in the same way we depicted perceptrons:
</p><center>
<img src="./Neural networks and deep learning 1_files/tikz9.png">
</center>
Just like a perceptron, the sigmoid neuron has inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame"><nobr><span class="math" id="MathJax-Span-475" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-476"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-481" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">x_1, x_2,
\ldots</script>.  But instead of being just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame"><nobr><span class="math" id="MathJax-Span-486" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-487"><span class="mn" id="MathJax-Span-488" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame"><nobr><span class="math" id="MathJax-Span-489" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-490"><span class="mn" id="MathJax-Span-491" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">1</script>, these inputs can also
take on any values <em>between</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame"><nobr><span class="math" id="MathJax-Span-492" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-493"><span class="mn" id="MathJax-Span-494" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame"><nobr><span class="math" id="MathJax-Span-495" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-496"><span class="mn" id="MathJax-Span-497" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">1</script>.  So, for instance,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame"><nobr><span class="math" id="MathJax-Span-498" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-499"><span class="mn" id="MathJax-Span-500" style="font-family: MathJax_Main;">0.638</span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">0.638\ldots</script> is a valid input for a sigmoid neuron. Also just like a
perceptron, the sigmoid neuron has weights for each input, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame"><nobr><span class="math" id="MathJax-Span-502" role="math" style="width: 4.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.316em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-503"><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-508" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">w_1, w_2,
\ldots</script>, and an overall bias, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame"><nobr><span class="math" id="MathJax-Span-513" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">b</script>.  But the output is not <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame"><nobr><span class="math" id="MathJax-Span-516" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-517"><span class="mn" id="MathJax-Span-518" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame"><nobr><span class="math" id="MathJax-Span-519" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-520"><span class="mn" id="MathJax-Span-521" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">1</script>.
Instead, it's <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame"><nobr><span class="math" id="MathJax-Span-522" role="math" style="width: 5.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.1em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">\sigma(w \cdot x+b)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame"><nobr><span class="math" id="MathJax-Span-532" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">\sigma</script> is called the
<em>sigmoid function</em>*<span class="marginnote">
*Incidentally, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame"><nobr><span class="math" id="MathJax-Span-535" role="math" style="width: 0.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.588em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">\sigma</script> is sometimes
  called the <em>logistic
    function</em>, and this
  new class of neurons called <em>logistic
    neurons</em>.  It's useful
  to remember this terminology, since these terms are used by many
  people working with neural nets.  However, we'll stick with the
  sigmoid terminology.</span>, and is defined
by:
<a class="displaced_anchor" name="eqtn3"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-80-Frame"><nobr><span class="math" id="MathJax-Span-538" role="math" style="width: 100%; display: inline-block; min-width: 12.551em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.551em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-539"><span class="mtable" id="MathJax-Span-540" style="min-width: 12.797em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.551em;"><span style="display: inline-block; position: absolute; width: 7.012em; height: 0px; clip: rect(-1.468em 1000.002em 0.934em -999.998em); top: 0.002em; left: 50%; margin-left: -3.527em;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 7.012em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-544"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-551" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-552" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -3.331em; left: 50%; margin-left: -1.615em;"><span class="mrow" id="MathJax-Span-553"><span class="mn" id="MathJax-Span-554" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-556" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.311em; left: 0.493em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mo" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.336em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-542"><span class="mtext" id="MathJax-Span-543" style="font-family: MathJax_Main;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">\begin{eqnarray} 
  \sigma(z) \equiv \frac{1}{1+e^{-z}}.
\tag{3}\end{eqnarray}</script>
To put it all a little more explicitly, the output of a sigmoid neuron
with inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame"><nobr><span class="math" id="MathJax-Span-563" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-564"><span class="msubsup" id="MathJax-Span-565"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-569" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-570" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mn" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">x_1,x_2,\ldots</script>, weights <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame"><nobr><span class="math" id="MathJax-Span-574" role="math" style="width: 4.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.316em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-575"><span class="msubsup" id="MathJax-Span-576"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-580" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mn" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">w_1,w_2,\ldots</script>, and bias <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame"><nobr><span class="math" id="MathJax-Span-585" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">b</script> is
<a class="displaced_anchor" name="eqtn4"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-84-Frame"><nobr><span class="math" id="MathJax-Span-588" role="math" style="width: 100%; display: inline-block; min-width: 16.375em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.375em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-589"><span class="mtable" id="MathJax-Span-590" style="min-width: 16.718em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.375em;"><span style="display: inline-block; position: absolute; width: 10.934em; height: 0px; clip: rect(-1.615em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -5.488em;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.934em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.297em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="mfrac" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-597" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -3.282em; left: 50%; margin-left: -5.145em;"><span class="mrow" id="MathJax-Span-598"><span class="mn" id="MathJax-Span-599" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Main; padding-left: 0.248em;">exp</span><span class="mo" id="MathJax-Span-602"></span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;"></span><span class="munderover" id="MathJax-Span-605" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-608" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-611"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-614" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 10.444em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-592"><span class="mtext" id="MathJax-Span-593" style="font-family: MathJax_Main;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-84">\begin{eqnarray} 
  \frac{1}{1+\exp(-\sum_j w_j x_j-b)}.
\tag{4}\end{eqnarray}</script><p></p><p>At first sight, sigmoid neurons appear very different to perceptrons.
The algebraic form of the sigmoid function may seem opaque and
forbidding if you're not already familiar with it.  In fact, there are
many similarities between perceptrons and sigmoid neurons, and the
algebraic form of the sigmoid function turns out to be more of a
technical detail than a true barrier to understanding.</p><p>To understand the similarity to the perceptron model, suppose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame"><nobr><span class="math" id="MathJax-Span-618" role="math" style="width: 5.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-619"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">z
\equiv w \cdot x + b</script> is a large positive number.  Then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame"><nobr><span class="math" id="MathJax-Span-627" role="math" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-628"><span class="msubsup" id="MathJax-Span-629"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mo" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-636" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">e^{-z}
\approx 0</script> and so <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame"><nobr><span class="math" id="MathJax-Span-637" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-638"><span class="mi" id="MathJax-Span-639" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-644" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">\sigma(z) \approx 1</script>.  In other words, when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame"><nobr><span class="math" id="MathJax-Span-645" role="math" style="width: 5.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">z = w
\cdot x+b</script> is large and positive, the output from the sigmoid neuron
is approximately <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame"><nobr><span class="math" id="MathJax-Span-654" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-655"><span class="mn" id="MathJax-Span-656" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">1</script>, just as it would have been for a perceptron.
Suppose on the other hand that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame"><nobr><span class="math" id="MathJax-Span-657" role="math" style="width: 5.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-663" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">z = w \cdot x+b</script> is very negative.
Then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame"><nobr><span class="math" id="MathJax-Span-666" role="math" style="width: 4.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.022em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-667"><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="texatom" id="MathJax-Span-670"><span class="mrow" id="MathJax-Span-671"><span class="mo" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">e^{-z} \rightarrow \infty</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame"><nobr><span class="math" id="MathJax-Span-676" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-681" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-683" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\sigma(z) \approx 0</script>.  So when
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame"><nobr><span class="math" id="MathJax-Span-684" role="math" style="width: 5.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">w</span><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-691" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">z = w \cdot x +b</script> is very negative, the behaviour of a sigmoid neuron
also closely approximates a perceptron.  It's only when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame"><nobr><span class="math" id="MathJax-Span-693" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-697" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-699" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">w \cdot x+b</script>
is of modest size that there's much deviation from the perceptron
model.</p><p>What about the algebraic form of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame"><nobr><span class="math" id="MathJax-Span-700" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-701"><span class="mi" id="MathJax-Span-702" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">\sigma</script>?  How can we understand
that?  In fact, the exact form of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame"><nobr><span class="math" id="MathJax-Span-703" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">\sigma</script> isn't so important - what
really matters is the shape of the function when plotted.  Here's the
shape:</p><p>

</p><div id="sigmoid_graph"><a name="sigmoid_graph"></a><svg width="600" height="290"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 200)"><g class="tick" transform="translate(36,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(72,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(144,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(180,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(251.99999999999997,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(288,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><path class="domain" d="M0,6V0H360V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.0</text></g><g class="tick" transform="translate(0,160)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.2</text></g><g class="tick" transform="translate(0,120)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.4</text></g><g class="tick" transform="translate(0,80)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.6</text></g><g class="tick" transform="translate(0,39.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.8</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1.0</text></g><path class="domain" d="M-6,0H0V200H-6"></path></g><path d="M0,198.66142981514304L0.8999999999999808,198.62777624590345L1.8000000000000256,198.59328256900096L2.6999999999999744,198.5579281173962L3.5999999999999868,198.5216917311436L4.5,198.48455174642783L5.400000000000013,198.44648598439701L6.299999999999993,198.40747173979165L7.1999999999999735,198.36748576936802L8.099999999999987,198.32650428011408L9,198.2845029172576L9.900000000000013,198.241456752065L10.800000000000026,198.19734026943044L11.699999999999976,198.15212735525424L12.599999999999985,198.10579128361078L13.5,198.05830470370518L14.400000000000013,198.00963962661913L15.300000000000026,197.95976741184606L16.200000000000006,197.90865875361638L17.099999999999987,197.8562836670134L18,197.80261147388137L18.900000000000013,197.74761078852686L19.800000000000026,197.69124950321554L20.699999999999974,197.63349477346625L21.60000000000002,197.57431300314514L22.5,197.5136698293628L23.39999999999998,197.4515301071777L24.300000000000026,197.3878578941094L25.200000000000006,197.32261643446705L26.099999999999987,197.25576814349623L27,197.1872745913509L27.900000000000016,197.11709648689578L28.799999999999997,197.0451936613454L29.699999999999978,196.97152505174753L30.599999999999987,196.89604868431823L31.499999999999996,196.81872165763704L32.40000000000001,196.73950012571183L33.300000000000026,196.65833928092235L34.199999999999974,196.57519333685445L35.09999999999999,196.49001551103512L36,196.4027580075817L36.90000000000001,196.31337199977804L37.80000000000001,196.2218076125922L38.700000000000024,196.12801390515048L39.59999999999999,196.0319388531845L40.5,195.93352933146826L41.40000000000001,195.8327310962639L42.299999999999976,195.72948876779589L43.19999999999999,195.6237458127739L44.10000000000002,195.51544452698747L45,195.40452601799487L45.89999999999998,195.2909301879319L46.80000000000001,195.17459571646617L47.700000000000024,195.05546004392485L48.59999999999998,194.93345935462565L49.50000000000001,194.80852856044064L50.40000000000001,194.68060128462682L51.299999999999976,194.5496098459568L52.19999999999999,194.4154852431854L53.09999999999999,194.2781571398908L54,194.13755384972873L54.900000000000006,193.99360232214235L55.80000000000001,193.8462281285704L56.69999999999999,193.69535544919972L57.599999999999994,193.5409070603099L58.5,193.38280432225918L59.40000000000001,193.22096716816438L60.30000000000001,193.0553140933285L61.200000000000024,192.88576214547274L62.09999999999999,192.71222691583196L62.99999999999999,192.5346225311741L63.90000000000002,192.35286164680835L64.79999999999998,192.16685544064714L65.69999999999999,191.9765136083909L66.60000000000002,191.781744359907L67.5,191.58245441687623L68.39999999999998,191.37854901178278L69.30000000000001,191.16993188832708L70.20000000000002,190.95650530334248L71.09999999999998,190.73817003029993L72,190.51482536448665L72.90000000000002,190.28636912994875L73.8,190.05269768828865L74.7,189.8137059494113L75.6,189.56928738431645L76.5,189.31933404003516L77.39999999999998,189.06373655681185L78.30000000000001,188.80238418763565L79.19999999999999,188.53516482022624L80.10000000000002,188.26196500158176L81,187.98266996519848L81.9,187.6971636610731L82.8,187.4053287886007L83.7,187.10704683248207L84.59999999999998,186.80219810175623L85.5,186.4906617720742L86.40000000000002,186.17231593133064L87.29999999999998,185.84703762877183L88.2,185.51470292769645L89.10000000000002,185.17518696186735L90,184.8283639957513L90.89999999999998,184.47410748870232L91.8,184.1122901632043L92.70000000000002,183.7427840772854L93.59999999999998,183.36546070121554L94.5,182.98019099859596L95.4,182.58684551194574L96.30000000000003,182.18529445288735L97.2,181.77540779702878L98.1,181.3570553836353L99.00000000000001,180.9301070201781L99.9,180.49443259184147L100.80000000000003,180.04990217606297L101.69999999999997,179.59638616217393L102.6,179.13375537619976L103.49999999999999,178.66188121086978L104.4,178.1806357608774L105.3,177.68989196342073L106.19999999999997,177.18952374404185L107.1,176.67940616777213L108,176.1594155955765L108.90000000000002,175.62942984607636L109.79999999999998,175.08932836251674L110.7,174.53899238492565L111.60000000000002,173.97830512740043L112.5,173.40715196043413L113.39999999999998,172.82542059818115L114.3,172.23300129053857L115.20000000000002,171.62978701990244L116.09999999999998,171.01567370243544L117,170.39056039366213L117.9,169.75434949818515L118.80000000000003,169.10694698329306L119.7,168.448262596206L120.6,167.77821008468297L121.50000000000001,167.09670742068735L122.4,166.4036770267849L123.30000000000003,165.69904600491984L124.19999999999997,164.98274636719205L125.1,164.25471526822992L125.99999999999999,163.51489523872874L126.9,162.76323441969828L127.8,161.99968679693743L128.7,161.22421243522805L129.6,160.43677771171636L130.5,159.63735554792424L131.4,158.82592563981052L132.29999999999998,158.0024746852795L133.2,157.1669966085117L134.10000000000002,156.3194927804731L135,155.45997223493825L135.89999999999998,154.5884518793477L136.8,153.70495669980352L137.70000000000002,152.8095199594932L138.6,151.90218338982223L139.5,150.98299737352565L140.4,150.05202111902352L141.3,149.10932282528051L142.20000000000002,148.15497983643078L143.1,147.1890787854297L144,146.211715726001L144.9,145.2229962521558L145.80000000000004,144.2230356045726L146.69999999999996,143.21195876314198L147.6,142.18990052500084L148.5,141.15700556740225L149.4,140.1134284947946L150.29999999999998,139.05933386951307L151.2,137.9948962255225L152.1,136.92030006468616L153,135.83573983507858L153.9,134.74141989090427L154.79999999999995,133.63755443363323L155.7,132.5243674340165L156.59999999999997,131.40209253469973L157.5,130.27097293321086L158.40000000000003,129.13126124515907L159.3,127.98321934754684L160.20000000000005,126.82711820216011L161.1,125.66323765907326L162,124.49186624037092L162.9,123.31330090426384L163.8,122.12784678984438L164.70000000000002,120.93581694280186L165.6,119.7375320224904L166.5,118.53331999081398L167.4,117.32351578346601L168.30000000000004,116.1084609641319L169.19999999999996,114.88850336233185L170.1,113.66399669564964L171,112.43530017715963L171.9,111.20277810892398L172.79999999999998,109.96679946249559L173.7,108.72773744741579L174.6,107.48596906874992L175.5,106.24187467475126L176.4,104.99583749578795L177.29999999999995,103.74824317570707L178.2,102.49947929684207L179.09999999999997,101.24993489990209L180,100L180.89999999999998,98.75006510009794L181.8,97.50052070315793L182.7,96.25175682429298L183.6,95.00416250421202L184.49999999999997,93.75812532524874L185.4,92.51403093125006L186.29999999999998,91.27226255258425L187.20000000000002,90.03320053750441L188.1,88.79722189107602L189,87.56469982284037L189.89999999999998,86.33600330435043L190.8,85.11149663766817L191.7,83.8915390358681L192.60000000000002,82.67648421653398L193.5,81.46668000918605L194.4,80.26246797750957L195.29999999999998,79.06418305719814L196.20000000000002,77.87215321015559L197.1,76.68669909573616L198.00000000000003,75.50813375962908L198.9,74.33676234092674L199.8,73.17288179783984L200.7,72.01678065245316L201.60000000000002,70.86873875484088L202.5,69.72902706678916L203.39999999999998,68.59790746530025L204.3,67.4756325659835L205.2,66.36244556636682L206.1,65.25858010909573L206.99999999999997,64.1642601649214L207.9,63.07969993531384L208.79999999999998,62.0051037744775L209.70000000000002,60.94066613048692L210.6,59.886571505205424L211.5,58.84299443259775L212.39999999999998,57.81009947499922L213.3,56.78804123685799L214.2,55.776964395427406L215.10000000000002,54.777003747844155L216,53.78828427399902L216.9,52.81092121457029L217.79999999999998,51.845020163569224L218.70000000000002,50.89067717471947L219.6,49.94797888097651L220.50000000000003,49.01700262647435L221.4,48.0978166101778L222.3,47.19048004050676L223.2,46.29504330019649L224.10000000000002,45.41154812065229L225,44.54002776506179L225.89999999999998,43.68050721952692L226.8,42.833003391488276L227.7,41.99752531472054L228.6,41.17407436018945L229.49999999999997,40.362644452075756L230.4,39.56322228828364L231.29999999999998,38.77578756477196L232.20000000000002,38.00031320306259L233.1,37.236765580301736L234,36.48510476127127L234.89999999999998,35.74528473177012L235.8,35.01725363280794L236.7,34.3009539950802L237.60000000000002,33.59632297321509L238.5,32.90329257931261L239.4,32.22178991531705L240.29999999999998,31.551737403794L241.20000000000002,30.89305301670695L242.1,30.245650501814847L243.00000000000003,29.609439606337883L243.9,28.98432629756458L244.8,28.37021298009754L245.7,27.766998709461443L246.60000000000002,27.174579401818843L247.5,26.592848039565876L248.39999999999998,26.021694872599575L249.3,25.46100761507435L250.2,24.910671637483283L251.1,24.37057015392361L251.99999999999997,23.840584404423538L252.9,23.320593832227885L253.79999999999998,22.81047625595818L254.70000000000002,22.31010803657929L255.6,21.819364239122585L256.5,21.338118789130256L257.4,20.866244623800267L258.3,20.40361383782605L259.2,19.950097823937043L260.1,19.505567408158498L261,19.06989297982189L261.90000000000003,18.64294461636473L262.8,18.224592202971234L263.7,17.81470554711264L264.6,17.41315448805427L265.5,17.019809001404052L266.4,16.634539298784468L267.3,16.257215922714565L268.2,15.887709836795683L269.1,15.525892511297702L270,15.17163600424869L270.9,14.824813038132634L271.8,14.485297072303549L272.7,14.152962371228185L273.6,13.827684068669388L274.5,13.509338227925817L275.4,13.197801898243755L276.3,12.892953167517929L277.2,12.5946712113993L278.09999999999997,12.302836338926904L279,12.017330034801521L279.9,11.738034998418257L280.8,11.464835179773747L281.7,11.197615812364337L282.6,10.936263443188166L283.5,10.680665959964863L284.40000000000003,10.430712615683536L285.3,10.186294050588707L286.2,9.947302311711326L287.1,9.713630870051237L288,9.48517463551337L288.9,9.261829969700063L289.8,9.043494696657506L290.69999999999993,8.830068111672906L291.6000000000001,8.621450988217227L292.5,8.417545583123776L293.3999999999999,8.21825564009302L294.30000000000007,8.023486391609126L295.2,7.833144559352867L296.1,7.647138353191618L297,7.465377468825873L297.9,7.287773084168037L298.79999999999995,7.114237854527228L299.7,6.944685906671522L300.59999999999997,6.77903283183563L301.5,6.617195677740839L302.40000000000003,6.459092939690114L303.3,6.304644550800287L304.2,6.153771871429603L305.09999999999997,6.0063976778576444L306,5.862446150271272L306.90000000000003,5.721842860109216L307.8,5.584514756814585L308.70000000000005,5.450390154043205L309.6,5.319398715373191L310.5,5.191471439559381L311.4,5.066540645374329L312.3,4.9445399560751335L313.19999999999993,4.825404283533841L314.1000000000001,4.70906981206809L315,4.595473982005127L315.8999999999999,4.484555473012519L316.80000000000007,4.376254187226114L317.7,4.2705112322040994L318.6,4.167268903736088L319.5,4.066470668531763L320.4,3.9680611468154936L321.29999999999995,3.871986094849511L322.2,3.7781923874078194L323.09999999999997,3.68662800022197L324,3.5972419924183097L324.90000000000003,3.509984488964868L325.8,3.42480666314553L326.7,3.3416607190776437L327.59999999999997,3.2604998742881808L328.5,3.1812783423629476L329.40000000000003,3.1039513156817744L330.3,3.0284749482524465L331.20000000000005,2.954806338654614L332.1,2.882903513104207L333,2.8127254086491194L333.9,2.744231856503787L334.8,2.677383565532976L335.69999999999993,2.6121421058906247L336.6000000000001,2.5484698928223137L337.5,2.4863301706371743L338.3999999999999,2.425686996854859L339.30000000000007,2.366505226533766L340.2,2.3087504967844508L341.1,2.252389211473149L342,2.1973885261186377L342.9,2.1437163329866227L343.79999999999995,2.091341246383638L344.7,2.040232588153934L345.59999999999997,1.9903603733808506L346.5,1.9416952962948208L347.40000000000003,1.894208716389234L348.3,1.8478726447457516L349.2,1.802659730569589L350.09999999999997,1.758543247934985L351,1.7154970827423899L351.90000000000003,1.6734957198859313L352.8,1.6325142306319762L353.70000000000005,1.592528260208348L354.6,1.5535140156030192L355.5,1.5154482535721492L356.4,1.4783082688563765L357.3,1.4420718826037904L358.19999999999993,1.4067174309990271L359.1000000000001,1.3722237540965354"></path><text class="x label" text-anchor="end" x="180" y="235">z</text><text x="180" y="-10" text-anchor="middle" style="font-size: 16px;">sigmoid function</text></g></svg></div>
<script style="display:none">
<!--
!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return t>n?-1:n>t?1:n>=t?0:0/0}function r(n){return null===n?0/0:+n}function u(n){return!isNaN(n)}function i(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)<0?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)>0?u=i:r=i+1}return r}}}function o(n){return n.length}function a(n){for(var t=1;n*t%1;)t*=10;return t}function c(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function l(){this._=Object.create(null)}function s(n){return(n+="")===pa||n[0]===va?va+n:n}function f(n){return(n+="")[0]===va?n.slice(1):n}function h(n){return s(n)in this._}function g(n){return(n=s(n))in this._&&delete this._[n]}function p(){var n=[];for(var t in this._)n.push(f(t));return n}function v(){var n=0;for(var t in this._)++n;return n}function d(){for(var n in this._)return!1;return!0}function m(){this._=Object.create(null)}function y(n){return n}function M(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function x(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=da.length;r>e;++e){var u=da[e]+t;if(u in n)return u}}function b(){}function _(){}function w(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new l;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function S(){ta.event.preventDefault()}function k(){for(var n,t=ta.event;n=t.sourceEvent;)t=n;return t}function E(n){for(var t=new _,e=0,r=arguments.length;++e<r;)t[arguments[e]]=w(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=ta.event;u.target=n,ta.event=u,t[u.type].apply(e,r)}finally{ta.event=i}}},t}function A(n){return ya(n,_a),n}function N(n){return"function"==typeof n?n:function(){return Ma(n,this)}}function C(n){return"function"==typeof n?n:function(){return xa(n,this)}}function z(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=ta.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function q(n){return n.trim().replace(/\s+/g," ")}function L(n){return new RegExp("(?:^|\\s+)"+ta.requote(n)+"(?:\\s+|$)","g")}function T(n){return(n+"").trim().split(/^|\s+/)}function R(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=T(n).map(D);var u=n.length;return"function"==typeof t?r:e}function D(n){var t=L(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",q(u+" "+n))):e.setAttribute("class",q(u.replace(t," ")))}}function P(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function U(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function j(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e?t.createElementNS(e,n):t.createElement(n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=ta.ns.qualify(n)).local?e:t}function F(){var n=this.parentNode;n&&n.removeChild(this)}function H(n){return{__data__:n}}function O(n){return function(){return ba(this,n)}}function I(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],o=0,a=i.length;a>o;o++)(u=i[o])&&t(u,o,e);return n}function Z(n){return ya(n,Sa),n}function V(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;);return o}}function X(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=c(t,ra(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+ta.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),c=$;a>0&&(n=n.slice(0,a));var l=ka.get(n);return l&&(n=l,c=B),a?t?u:r:t?b:i}function $(n,t){return function(e){var r=ta.event;ta.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{ta.event=r}}}function B(n,t){var e=$(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function W(e){var r=".dragsuppress-"+ ++Aa,u="click"+r,i=ta.select(t(e)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==Ea&&(Ea="onselectstart"in e?!1:x(e.style,"userSelect")),Ea){var o=n(e).style,a=o[Ea];o[Ea]="none"}return function(n){if(i.on(r,null),Ea&&(o[Ea]=a),n){var t=function(){i.on(u,null)};i.on(u,function(){S(),t()},!0),setTimeout(t,0)}}}function J(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var u=r.createSVGPoint();if(0>Na){var i=t(n);if(i.scrollX||i.scrollY){r=ta.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=r[0][0].getScreenCTM();Na=!(o.f||o.e),r.remove()}}return Na?(u.x=e.pageX,u.y=e.pageY):(u.x=e.clientX,u.y=e.clientY),u=u.matrixTransform(n.getScreenCTM().inverse()),[u.x,u.y]}var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}function G(){return ta.event.changedTouches[0].identifier}function K(n){return n>0?1:0>n?-1:0}function Q(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function nt(n){return n>1?0:-1>n?qa:Math.acos(n)}function tt(n){return n>1?Ra:-1>n?-Ra:Math.asin(n)}function et(n){return((n=Math.exp(n))-1/n)/2}function rt(n){return((n=Math.exp(n))+1/n)/2}function ut(n){return((n=Math.exp(2*n))-1)/(n+1)}function it(n){return(n=Math.sin(n/2))*n}function ot(){}function at(n,t,e){return this instanceof at?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof at?new at(n.h,n.s,n.l):bt(""+n,_t,at):new at(n,t,e)}function ct(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,i=2*e-o,new mt(u(n+120),u(n),u(n-120))}function lt(n,t,e){return this instanceof lt?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof lt?new lt(n.h,n.c,n.l):n instanceof ft?gt(n.l,n.a,n.b):gt((n=wt((n=ta.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new lt(n,t,e)}function st(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new ft(e,Math.cos(n*=Da)*t,Math.sin(n)*t)}function ft(n,t,e){return this instanceof ft?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof ft?new ft(n.l,n.a,n.b):n instanceof lt?st(n.h,n.c,n.l):wt((n=mt(n)).r,n.g,n.b):new ft(n,t,e)}function ht(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=pt(u)*Xa,r=pt(r)*$a,i=pt(i)*Ba,new mt(dt(3.2404542*u-1.5371385*r-.4985314*i),dt(-.969266*u+1.8760108*r+.041556*i),dt(.0556434*u-.2040259*r+1.0572252*i))}function gt(n,t,e){return n>0?new lt(Math.atan2(e,t)*Pa,Math.sqrt(t*t+e*e),n):new lt(0/0,0/0,n)}function pt(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function vt(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function dt(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function mt(n,t,e){return this instanceof mt?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof mt?new mt(n.r,n.g,n.b):bt(""+n,mt,ct):new mt(n,t,e)}function yt(n){return new mt(n>>16,n>>8&255,255&n)}function Mt(n){return yt(n)+""}function xt(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function bt(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(kt(u[0]),kt(u[1]),kt(u[2]))}return(i=Ga.get(n.toLowerCase()))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&i)>>4,o=o>>4|o,a=240&i,a=a>>4|a,c=15&i,c=c<<4|c):7===n.length&&(o=(16711680&i)>>16,a=(65280&i)>>8,c=255&i)),t(o,a,c))}function _t(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),new at(r,u,c)}function wt(n,t,e){n=St(n),t=St(t),e=St(e);var r=vt((.4124564*n+.3575761*t+.1804375*e)/Xa),u=vt((.2126729*n+.7151522*t+.072175*e)/$a),i=vt((.0193339*n+.119192*t+.9503041*e)/Ba);return ft(116*u-16,500*(r-u),200*(u-i))}function St(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function kt(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function Et(n){return"function"==typeof n?n:function(){return n}}function At(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Nt(t,e,n,r)}}function Nt(n,t,e,r){function u(){var n,t=c.status;if(!t&&zt(c)||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return void o.error.call(i,r)}o.load.call(i,n)}else o.error.call(i,c)}var i={},o=ta.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=ta.event;ta.event=n;try{o.progress.call(i,c)}finally{ta.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(l=n,i):l},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(ra(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),c.setRequestHeader)for(var s in a)c.setRequestHeader(s,a[s]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=l&&(c.responseType=l),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},ta.rebind(i,o,"on"),null==r?i:i.get(Ct(r))}function Ct(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function zt(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qt(){var n=Lt(),t=Tt()-n;t>24?(isFinite(t)&&(clearTimeout(tc),tc=setTimeout(qt,t)),nc=0):(nc=1,rc(qt))}function Lt(){var n=Date.now();for(ec=Ka;ec;)n>=ec.t&&(ec.f=ec.c(n-ec.t)),ec=ec.n;return n}function Tt(){for(var n,t=Ka,e=1/0;t;)t.f?t=n?n.n=t.n:Ka=t.n:(t.t<e&&(e=t.t),t=(n=t).n);return Qa=n,e}function Rt(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Dt(n,t){var e=Math.pow(10,3*ga(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function Pt(n){var t=n.decimal,e=n.thousands,r=n.grouping,u=n.currency,i=r&&e?function(n,t){for(var u=n.length,i=[],o=0,a=r[0],c=0;u>0&&a>0&&(c+a+1>t&&(a=Math.max(1,t-c)),i.push(n.substring(u-=a,u+a)),!((c+=a+1)>t));)a=r[o=(o+1)%r.length];return i.reverse().join(e)}:y;return function(n){var e=ic.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",c=e[4]||"",l=e[5],s=+e[6],f=e[7],h=e[8],g=e[9],p=1,v="",d="",m=!1,y=!0;switch(h&&(h=+h.substring(1)),(l||"0"===r&&"="===o)&&(l=r="0",o="="),g){case"n":f=!0,g="g";break;case"%":p=100,d="%",g="f";break;case"p":p=100,d="%",g="r";break;case"b":case"o":case"x":case"X":"#"===c&&(v="0"+g.toLowerCase());case"c":y=!1;case"d":m=!0,h=0;break;case"s":p=-1,g="r"}"$"===c&&(v=u[0],d=u[1]),"r"!=g||h||(g="g"),null!=h&&("g"==g?h=Math.max(1,Math.min(21,h)):("e"==g||"f"==g)&&(h=Math.max(0,Math.min(20,h)))),g=oc.get(g)||Ut;var M=l&&f;return function(n){var e=d;if(m&&n%1)return"";var u=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===a?"":a;if(0>p){var c=ta.formatPrefix(n,h);n=c.scale(n),e=c.symbol+d}else n*=p;n=g(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=y?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!l&&f&&(x=i(x,1/0));var S=v.length+x.length+b.length+(M?0:u.length),k=s>S?new Array(S=s-S+1).join(r):"";return M&&(x=i(k+x,k.length?s-b.length:1/0)),u+=v,n=x+b,("<"===o?u+n+k:">"===o?k+u+n:"^"===o?k.substring(0,S>>=1)+u+n+k.substring(S):u+(M?n:k+n))+e}}}function Ut(n){return n+""}function jt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ft(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new cc(e-1)),1),e}function i(n,e){return t(n=new cc(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1)for(;r>o;)e(o)%i||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{cc=jt;var r=new jt;return r._=n,o(r,t,e)}finally{cc=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=Ht(n);return c.floor=c,c.round=Ht(r),c.ceil=Ht(u),c.offset=Ht(i),c.range=a,n}function Ht(n){return function(t,e){try{cc=jt;var r=new jt;return r._=t,n(r,e)._}finally{cc=Date}}}function Ot(n){function t(n){function t(t){for(var e,u,i,o=[],a=-1,c=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(c,a)),null!=(u=sc[e=n.charAt(++a)])&&(e=n.charAt(++a)),(i=N[e])&&(e=i(t,null==u?"e"===e?" ":"0":u)),o.push(e),c=a+1);return o.push(n.slice(c,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},u=e(r,n,t,0);if(u!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&cc!==jt,o=new(i?jt:cc);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),i?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var u,i,o,a=0,c=t.length,l=e.length;c>a;){if(r>=l)return-1;if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=C[o in sc?t.charAt(a++):o],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){E.lastIndex=0;var r=E.exec(t.slice(e));return r?(n.m=A.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,N.c.toString(),t,r)}function c(n,t,r){return e(n,N.x.toString(),t,r)}function l(n,t,r){return e(n,N.X.toString(),t,r)}function s(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var f=n.dateTime,h=n.date,g=n.time,p=n.periods,v=n.days,d=n.shortDays,m=n.months,y=n.shortMonths;t.utc=function(n){function e(n){try{cc=jt;var t=new cc;return t._=n,r(t)}finally{cc=Date}}var r=t(n);return e.parse=function(n){try{cc=jt;var t=r.parse(n);return t&&t._}finally{cc=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ae;var M=ta.map(),x=Yt(v),b=Zt(v),_=Yt(d),w=Zt(d),S=Yt(m),k=Zt(m),E=Yt(y),A=Zt(y);p.forEach(function(n,t){M.set(n.toLowerCase(),t)});var N={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return y[n.getMonth()]},B:function(n){return m[n.getMonth()]},c:t(f),d:function(n,t){return It(n.getDate(),t,2)},e:function(n,t){return It(n.getDate(),t,2)},H:function(n,t){return It(n.getHours(),t,2)},I:function(n,t){return It(n.getHours()%12||12,t,2)},j:function(n,t){return It(1+ac.dayOfYear(n),t,3)},L:function(n,t){return It(n.getMilliseconds(),t,3)},m:function(n,t){return It(n.getMonth()+1,t,2)},M:function(n,t){return It(n.getMinutes(),t,2)},p:function(n){return p[+(n.getHours()>=12)]},S:function(n,t){return It(n.getSeconds(),t,2)},U:function(n,t){return It(ac.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return It(ac.mondayOfYear(n),t,2)},x:t(h),X:t(g),y:function(n,t){return It(n.getFullYear()%100,t,2)},Y:function(n,t){return It(n.getFullYear()%1e4,t,4)},Z:ie,"%":function(){return"%"}},C={a:r,A:u,b:i,B:o,c:a,d:Qt,e:Qt,H:te,I:te,j:ne,L:ue,m:Kt,M:ee,p:s,S:re,U:Xt,w:Vt,W:$t,x:c,X:l,y:Wt,Y:Bt,Z:Jt,"%":oe};return t}function It(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function Yt(n){return new RegExp("^(?:"+n.map(ta.requote).join("|")+")","i")}function Zt(n){for(var t=new l,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Vt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Xt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function $t(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Bt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Wt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.y=Gt(+r[0]),e+r[0].length):-1}function Jt(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Gt(n){return n+(n>68?1900:2e3)}function Kt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Qt(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function ne(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function te(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function ee(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function re(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ue(n,t,e){fc.lastIndex=0;var r=fc.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function ie(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=ga(t)/60|0,u=ga(t)%60;return e+It(r,"0",2)+It(u,"0",2)}function oe(n,t,e){hc.lastIndex=0;var r=hc.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ae(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ce(){}function le(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function se(n,t){n&&dc.hasOwnProperty(n.type)&&dc[n.type](n,t)}function fe(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function he(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)fe(n[e],t,1);t.polygonEnd()}function ge(){function n(n,t){n*=Da,t=t*Da/2+qa/4;var e=n-r,o=e>=0?1:-1,a=o*e,c=Math.cos(t),l=Math.sin(t),s=i*l,f=u*c+s*Math.cos(a),h=s*o*Math.sin(a);yc.add(Math.atan2(h,f)),r=n,u=c,i=l}var t,e,r,u,i;Mc.point=function(o,a){Mc.point=n,r=(t=o)*Da,u=Math.cos(a=(e=a)*Da/2+qa/4),i=Math.sin(a)},Mc.lineEnd=function(){n(t,e)}}function pe(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function ve(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function de(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function me(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ye(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Me(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function xe(n){return[Math.atan2(n[1],n[0]),tt(n[2])]}function be(n,t){return ga(n[0]-t[0])<Ca&&ga(n[1]-t[1])<Ca}function _e(n,t){n*=Da;var e=Math.cos(t*=Da);we(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function we(n,t,e){++xc,_c+=(n-_c)/xc,wc+=(t-wc)/xc,Sc+=(e-Sc)/xc}function Se(){function n(n,u){n*=Da;var i=Math.cos(u*=Da),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),l=Math.atan2(Math.sqrt((l=e*c-r*a)*l+(l=r*o-t*c)*l+(l=t*a-e*o)*l),t*o+e*a+r*c);bc+=l,kc+=l*(t+(t=o)),Ec+=l*(e+(e=a)),Ac+=l*(r+(r=c)),we(t,e,r)}var t,e,r;qc.point=function(u,i){u*=Da;var o=Math.cos(i*=Da);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),qc.point=n,we(t,e,r)}}function ke(){qc.point=_e}function Ee(){function n(n,t){n*=Da;var e=Math.cos(t*=Da),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),l=u*c-i*a,s=i*o-r*c,f=r*a-u*o,h=Math.sqrt(l*l+s*s+f*f),g=r*o+u*a+i*c,p=h&&-nt(g)/h,v=Math.atan2(h,g);Nc+=p*l,Cc+=p*s,zc+=p*f,bc+=v,kc+=v*(r+(r=o)),Ec+=v*(u+(u=a)),Ac+=v*(i+(i=c)),we(r,u,i)}var t,e,r,u,i;qc.point=function(o,a){t=o,e=a,qc.point=n,o*=Da;var c=Math.cos(a*=Da);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),we(r,u,i)},qc.lineEnd=function(){n(t,e),qc.lineEnd=ke,qc.point=_e}}function Ae(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function Ne(){return!0}function Ce(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(be(e,r)){u.lineStart();for(var a=0;t>a;++a)u.point((e=n[a])[0],e[1]);return void u.lineEnd()}var c=new qe(e,n,null,!0),l=new qe(e,null,c,!1);c.o=l,i.push(c),o.push(l),c=new qe(r,n,null,!1),l=new qe(r,null,c,!0),c.o=l,i.push(c),o.push(l)}}),o.sort(t),ze(i),ze(o),i.length){for(var a=0,c=e,l=o.length;l>a;++a)o[a].e=c=!c;for(var s,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;s=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var a=0,l=s.length;l>a;++a)u.point((f=s[a])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){s=g.p.z;for(var a=s.length-1;a>=0;--a)u.point((f=s[a])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,s=g.z,p=!p}while(!g.v);u.lineEnd()}}}function ze(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function qe(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Le(n,t,e,r){return function(u,i){function o(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function a(n,t){var e=u(n,t);d.point(e[0],e[1])}function c(){y.point=a,d.lineStart()}function l(){y.point=o,d.lineEnd()}function s(n,t){v.push([n,t]);var e=u(n,t);x.point(e[0],e[1])}function f(){x.lineStart(),v=[]}function h(){s(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r)if(1&t){n=e[0];var u,r=n.length-1,o=-1;if(r>0){for(b||(i.polygonStart(),b=!0),i.lineStart();++o<r;)i.point((u=n[o])[0],u[1]);i.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Te))}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:o,lineStart:c,lineEnd:l,polygonStart:function(){y.point=s,y.lineStart=f,y.lineEnd=h,g=[],p=[]},polygonEnd:function(){y.point=o,y.lineStart=c,y.lineEnd=l,g=ta.merge(g);var n=Fe(m,p);g.length?(b||(i.polygonStart(),b=!0),Ce(g,De,n,e,i)):n&&(b||(i.polygonStart(),b=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),b&&(i.polygonEnd(),b=!1),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},M=Re(),x=t(M),b=!1;return y}}function Te(n){return n.length>1}function Re(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:b,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function De(n,t){return((n=n.x)[0]<0?n[1]-Ra-Ca:Ra-n[1])-((t=t.x)[0]<0?t[1]-Ra-Ca:Ra-t[1])}function Pe(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?qa:-qa,c=ga(i-e);ga(c-qa)<Ca?(n.point(e,r=(r+o)/2>0?Ra:-Ra),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=qa&&(ga(e-u)<Ca&&(e-=u*Ca),ga(i-a)<Ca&&(i-=a*Ca),r=Ue(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function Ue(n,t,e,r){var u,i,o=Math.sin(n-e);return ga(o)>Ca?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function je(n,t,e,r){var u;if(null==n)u=e*Ra,r.point(-qa,u),r.point(0,u),r.point(qa,u),r.point(qa,0),r.point(qa,-u),r.point(0,-u),r.point(-qa,-u),r.point(-qa,0),r.point(-qa,u);else if(ga(n[0]-t[0])>Ca){var i=n[0]<t[0]?qa:-qa;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function Fe(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=0;yc.reset();for(var a=0,c=t.length;c>a;++a){var l=t[a],s=l.length;if(s)for(var f=l[0],h=f[0],g=f[1]/2+qa/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===s&&(d=0),n=l[d];var m=n[0],y=n[1]/2+qa/4,M=Math.sin(y),x=Math.cos(y),b=m-h,_=b>=0?1:-1,w=_*b,S=w>qa,k=p*M;if(yc.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),i+=S?b+_*La:b,S^h>=e^m>=e){var E=de(pe(f),pe(n));Me(E);var A=de(u,E);Me(A);var N=(S^b>=0?-1:1)*tt(A[2]);(r>N||r===N&&(E[0]||E[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=m,p=M,v=x,f=n}}return(-Ca>i||Ca>i&&0>yc)^1&o}function He(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,c,l,s;return{lineStart:function(){l=c=!1,s=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=o?v?0:u(f,h):v?u(f+(0>f?qa:-qa),h):0;if(!e&&(l=c=v)&&n.lineStart(),v!==c&&(g=r(e,p),(be(e,g)||be(p,g))&&(p[0]+=Ca,p[1]+=Ca,v=t(p[0],p[1]))),v!==c)s=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(a&&e&&o^v){var m;d&i||!(m=r(p,e,!0))||(s=0,o?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&be(e,p)||n.point(p[0],p[1]),e=p,c=v,i=d},lineEnd:function(){c&&n.lineEnd(),e=null},clean:function(){return s|(l&&c)<<1}}}function r(n,t,e){var r=pe(n),u=pe(t),o=[1,0,0],a=de(r,u),c=ve(a,a),l=a[0],s=c-l*l;if(!s)return!e&&n;var f=i*c/s,h=-i*l/s,g=de(o,a),p=ye(o,f),v=ye(a,h);me(p,v);var d=g,m=ve(p,d),y=ve(d,d),M=m*m-y*(ve(p,p)-1);if(!(0>M)){var x=Math.sqrt(M),b=ye(d,(-m-x)/y);if(me(b,p),b=xe(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],E=t[1];w>S&&(_=w,w=S,S=_);var A=S-w,N=ga(A-qa)<Ca,C=N||Ca>A;if(!N&&k>E&&(_=k,k=E,E=_),C?N?k+E>0^b[1]<(ga(b[0]-w)<Ca?k:E):k<=b[1]&&b[1]<=E:A>qa^(w<=b[0]&&b[0]<=S)){var z=ye(d,(-m+x)/y);return me(z,p),[b,xe(z)]}}}function u(t,e){var r=o?n:qa-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),o=i>0,a=ga(i)>Ca,c=gr(n,6*Da);return Le(t,e,c,o?[0,-n]:[-qa,n-qa])}function Oe(n,t,e,r){return function(u){var i,o=u.a,a=u.b,c=o.x,l=o.y,s=a.x,f=a.y,h=0,g=1,p=s-c,v=f-l;if(i=n-c,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-c,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-l,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-l,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:c+h*p,y:l+h*v}),1>g&&(u.b={x:c+g*p,y:l+g*v}),u}}}}}}function Ie(n,t,e,r){function u(r,u){return ga(r[0]-n)<Ca?u>0?0:3:ga(r[0]-e)<Ca?u>0?2:1:ga(r[1]-t)<Ca?u>0?1:0:u>0?3:2}function i(n,t){return o(n.x,t.x)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n){for(var t=0,e=d.length,r=n[1],u=0;e>u;++u)for(var i,o=1,a=d[u],c=a.length,l=a[0];c>o;++o)i=a[o],l[1]<=r?i[1]>r&&Q(l,i,n)>0&&++t:i[1]<=r&&Q(l,i,n)<0&&--t,l=i;return 0!==t}function l(i,a,c,l){var s=0,f=0;if(null==i||(s=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do l.point(0===s||3===s?n:e,s>1?r:t);while((s=(s+c+4)%4)!==f)}else l.point(a[0],a[1])}function s(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function f(n,t){s(n,t)&&a.point(n,t)}function h(){C.point=p,d&&d.push(m=[]),S=!0,w=!1,b=_=0/0}function g(){v&&(p(y,M),x&&w&&A.rejoin(),v.push(A.buffer())),C.point=f,w&&a.lineEnd()}function p(n,t){n=Math.max(-Tc,Math.min(Tc,n)),t=Math.max(-Tc,Math.min(Tc,t));var e=s(n,t);if(d&&m.push([n,t]),S)y=n,M=t,x=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};N(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,m,y,M,x,b,_,w,S,k,E=a,A=Re(),N=Oe(n,t,e,r),C={point:f,lineStart:h,lineEnd:g,polygonStart:function(){a=A,v=[],d=[],k=!0},polygonEnd:function(){a=E,v=ta.merge(v);var t=c([n,r]),e=k&&t,u=v.length;(e||u)&&(a.polygonStart(),e&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),u&&Ce(v,i,t,l,a),a.polygonEnd()),v=d=m=null}};return C}}function Ye(n){var t=0,e=qa/3,r=ir(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*qa/180,e=n[1]*qa/180):[t/qa*180,e/qa*180]},u}function Ze(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,tt((i-(n*n+e*e)*u*u)/(2*u))]},e}function Ve(){function n(n,t){Dc+=u*n-r*t,r=n,u=t}var t,e,r,u;Hc.point=function(i,o){Hc.point=n,t=r=i,e=u=o},Hc.lineEnd=function(){n(t,e)}}function Xe(n,t){Pc>n&&(Pc=n),n>jc&&(jc=n),Uc>t&&(Uc=t),t>Fc&&(Fc=t)}function $e(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=Be(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=Be(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Be(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function We(n,t){_c+=n,wc+=t,++Sc}function Je(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);kc+=o*(t+n)/2,Ec+=o*(e+r)/2,Ac+=o,We(t=n,e=r)}var t,e;Ic.point=function(r,u){Ic.point=n,We(t=r,e=u)}}function Ge(){Ic.point=We}function Ke(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);kc+=o*(r+n)/2,Ec+=o*(u+t)/2,Ac+=o,o=u*n-r*t,Nc+=o*(r+n),Cc+=o*(u+t),zc+=3*o,We(r=n,u=t)}var t,e,r,u;Ic.point=function(i,o){Ic.point=n,We(t=r=i,e=u=o)},Ic.lineEnd=function(){n(t,e)}}function Qe(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,La)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:b};return a}function nr(n){function t(n){return(a?r:e)(n)}function e(t){return rr(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=0/0,S.point=i,t.lineStart()}function i(e,r){var i=pe([e,r]),o=n(e,r);u(M,x,y,b,_,w,M=o[0],x=o[1],y=e,b=i[0],_=i[1],w=i[2],a,t),t.point(M,x)}function o(){S.point=e,t.lineEnd()}function c(){r(),S.point=l,S.lineEnd=s}function l(n,t){i(f=n,h=t),g=M,p=x,v=b,d=_,m=w,S.point=i}function s(){u(M,x,y,b,_,w,g,p,f,v,d,m,a,t),S.lineEnd=o,o()}var f,h,g,p,v,d,m,y,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=c
},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function u(t,e,r,a,c,l,s,f,h,g,p,v,d,m){var y=s-t,M=f-e,x=y*y+M*M;if(x>4*i&&d--){var b=a+g,_=c+p,w=l+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),E=ga(ga(w)-1)<Ca||ga(r-h)<Ca?(r+h)/2:Math.atan2(_,b),A=n(E,k),N=A[0],C=A[1],z=N-t,q=C-e,L=M*z-y*q;(L*L/x>i||ga((y*z+M*q)/x-.5)>.3||o>a*g+c*p+l*v)&&(u(t,e,r,a,c,l,N,C,E,b/=S,_/=S,w,d,m),m.point(N,C),u(N,C,E,b,_,w,s,f,h,g,p,v,d,m))}}var i=.5,o=Math.cos(30*Da),a=16;return t.precision=function(n){return arguments.length?(a=(i=n*n)>0&&16,t):Math.sqrt(i)},t}function tr(n){var t=nr(function(t,e){return n([t*Pa,e*Pa])});return function(n){return or(t(n))}}function er(n){this.stream=n}function rr(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function ur(n){return ir(function(){return n})()}function ir(n){function t(n){return n=a(n[0]*Da,n[1]*Da),[n[0]*h+c,l-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(l-n[1])/h),n&&[n[0]*Pa,n[1]*Pa]}function r(){a=Ae(o=lr(m,M,x),i);var n=i(v,d);return c=g-n[0]*h,l=p+n[1]*h,u()}function u(){return s&&(s.valid=!1,s=null),t}var i,o,a,c,l,s,f=nr(function(n,t){return n=i(n,t),[n[0]*h+c,l-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,M=0,x=0,b=Lc,_=y,w=null,S=null;return t.stream=function(n){return s&&(s.valid=!1),s=or(b(o,f(_(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(b=null==n?(w=n,Lc):He((w=+n)*Da),u()):w},t.clipExtent=function(n){return arguments.length?(S=n,_=n?Ie(n[0][0],n[0][1],n[1][0],n[1][1]):y,u()):S},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Da,d=n[1]%360*Da,r()):[v*Pa,d*Pa]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Da,M=n[1]%360*Da,x=n.length>2?n[2]%360*Da:0,r()):[m*Pa,M*Pa,x*Pa]},ta.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function or(n){return rr(n,function(t,e){n.point(t*Da,e*Da)})}function ar(n,t){return[n,t]}function cr(n,t){return[n>qa?n-La:-qa>n?n+La:n,t]}function lr(n,t,e){return n?t||e?Ae(fr(n),hr(t,e)):fr(n):t||e?hr(t,e):cr}function sr(n){return function(t,e){return t+=n,[t>qa?t-La:-qa>t?t+La:t,e]}}function fr(n){var t=sr(n);return t.invert=sr(-n),t}function hr(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*r+a*u;return[Math.atan2(c*i-s*o,a*r-l*u),tt(s*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*i-c*o;return[Math.atan2(c*i+l*o,a*r+s*u),tt(s*r-a*u)]},e}function gr(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=pr(e,u),i=pr(e,i),(o>0?i>u:u>i)&&(u+=o*La)):(u=n+o*La,i=n-.5*c);for(var l,s=u;o>0?s>i:i>s;s-=c)a.point((l=xe([e,-r*Math.cos(s),-r*Math.sin(s)]))[0],l[1])}}function pr(n,t){var e=pe(t);e[0]-=n,Me(e);var r=nt(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Ca)%(2*Math.PI)}function vr(n,t,e){var r=ta.range(n,t-Ca,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function dr(n,t,e){var r=ta.range(n,t-Ca,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function mr(n){return n.source}function yr(n){return n.target}function Mr(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),l=u*Math.sin(n),s=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(it(r-t)+u*o*it(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*s,u=e*l+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Pa,Math.atan2(o,Math.sqrt(r*r+u*u))*Pa]}:function(){return[n*Pa,t*Pa]};return p.distance=h,p}function xr(){function n(n,u){var i=Math.sin(u*=Da),o=Math.cos(u),a=ga((n*=Da)-t),c=Math.cos(a);Yc+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;Zc.point=function(u,i){t=u*Da,e=Math.sin(i*=Da),r=Math.cos(i),Zc.point=n},Zc.lineEnd=function(){Zc.point=Zc.lineEnd=b}}function br(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function _r(n,t){function e(n,t){o>0?-Ra+Ca>t&&(t=-Ra+Ca):t>Ra-Ca&&(t=Ra-Ca);var e=o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(qa/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=K(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Ra]},e):Sr}function wr(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return ga(u)<Ca?ar:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-K(u)*Math.sqrt(n*n+e*e)]},e)}function Sr(n,t){return[n,Math.log(Math.tan(qa/4+t/2))]}function kr(n){var t,e=ur(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=qa*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Er(n,t){return[Math.log(Math.tan(qa/4+t/2)),-n]}function Ar(n){return n[0]}function Nr(n){return n[1]}function Cr(n){for(var t=n.length,e=[0,1],r=2,u=2;t>u;u++){for(;r>1&&Q(n[e[r-2]],n[e[r-1]],n[u])<=0;)--r;e[r++]=u}return e.slice(0,r)}function zr(n,t){return n[0]-t[0]||n[1]-t[1]}function qr(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Lr(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],l=e[1],s=t[1]-c,f=r[1]-l,h=(a*(c-l)-f*(u-i))/(f*o-a*s);return[u+h*o,c+h*s]}function Tr(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Rr(){tu(this),this.edge=this.site=this.circle=null}function Dr(n){var t=el.pop()||new Rr;return t.site=n,t}function Pr(n){Xr(n),Qc.remove(n),el.push(n),tu(n)}function Ur(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,o=n.N,a=[n];Pr(n);for(var c=i;c.circle&&ga(e-c.circle.x)<Ca&&ga(r-c.circle.cy)<Ca;)i=c.P,a.unshift(c),Pr(c),c=i;a.unshift(c),Xr(c);for(var l=o;l.circle&&ga(e-l.circle.x)<Ca&&ga(r-l.circle.cy)<Ca;)o=l.N,a.push(l),Pr(l),l=o;a.push(l),Xr(l);var s,f=a.length;for(s=1;f>s;++s)l=a[s],c=a[s-1],Kr(l.edge,c.site,l.site,u);c=a[0],l=a[f-1],l.edge=Jr(c.site,l.site,null,u),Vr(c),Vr(l)}function jr(n){for(var t,e,r,u,i=n.x,o=n.y,a=Qc._;a;)if(r=Fr(a,o)-i,r>Ca)a=a.L;else{if(u=i-Hr(a,o),!(u>Ca)){r>-Ca?(t=a.P,e=a):u>-Ca?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var c=Dr(n);if(Qc.insert(t,c),t||e){if(t===e)return Xr(t),e=Dr(t.site),Qc.insert(c,e),c.edge=e.edge=Jr(t.site,c.site),Vr(t),void Vr(e);if(!e)return void(c.edge=Jr(t.site,c.site));Xr(t),Xr(e);var l=t.site,s=l.x,f=l.y,h=n.x-s,g=n.y-f,p=e.site,v=p.x-s,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,M=v*v+d*d,x={x:(d*y-g*M)/m+s,y:(h*M-v*y)/m+f};Kr(e.edge,l,p,x),c.edge=Jr(l,n,null,x),e.edge=Jr(n,p,null,x),Vr(t),Vr(e)}}function Fr(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var o=n.P;if(!o)return-1/0;e=o.site;var a=e.x,c=e.y,l=c-t;if(!l)return a;var s=a-r,f=1/i-1/l,h=s/l;return f?(-h+Math.sqrt(h*h-2*f*(s*s/(-2*l)-c+l/2+u-i/2)))/f+r:(r+a)/2}function Hr(n,t){var e=n.N;if(e)return Fr(e,t);var r=n.site;return r.y===t?r.x:1/0}function Or(n){this.site=n,this.edges=[]}function Ir(n){for(var t,e,r,u,i,o,a,c,l,s,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=Kc,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(a=i.edges,c=a.length,o=0;c>o;)s=a[o].end(),r=s.x,u=s.y,l=a[++o%c].start(),t=l.x,e=l.y,(ga(r-t)>Ca||ga(u-e)>Ca)&&(a.splice(o,0,new Qr(Gr(i.site,s,ga(r-f)<Ca&&p-u>Ca?{x:f,y:ga(t-f)<Ca?e:p}:ga(u-p)<Ca&&h-r>Ca?{x:ga(e-p)<Ca?t:h,y:p}:ga(r-h)<Ca&&u-g>Ca?{x:h,y:ga(t-h)<Ca?e:g}:ga(u-g)<Ca&&r-f>Ca?{x:ga(e-g)<Ca?t:f,y:g}:null),i.site,null)),++c)}function Yr(n,t){return t.angle-n.angle}function Zr(){tu(this),this.x=this.y=this.arc=this.site=this.cy=null}function Vr(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var o=u.x,a=u.y,c=r.x-o,l=r.y-a,s=i.x-o,f=i.y-a,h=2*(c*f-l*s);if(!(h>=-za)){var g=c*c+l*l,p=s*s+f*f,v=(f*g-l*p)/h,d=(c*p-s*g)/h,f=d+a,m=rl.pop()||new Zr;m.arc=n,m.site=u,m.x=v+o,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,M=tl._;M;)if(m.y<M.y||m.y===M.y&&m.x<=M.x){if(!M.L){y=M.P;break}M=M.L}else{if(!M.R){y=M;break}M=M.R}tl.insert(y,m),y||(nl=m)}}}}function Xr(n){var t=n.circle;t&&(t.P||(nl=t.N),tl.remove(t),rl.push(t),tu(t),n.circle=null)}function $r(n){for(var t,e=Gc,r=Oe(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!Br(t,n)||!r(t)||ga(t.a.x-t.b.x)<Ca&&ga(t.a.y-t.b.y)<Ca)&&(t.a=t.b=null,e.splice(u,1))}function Br(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,o=t[0][0],a=t[1][0],c=t[0][1],l=t[1][1],s=n.l,f=n.r,h=s.x,g=s.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(o>d||d>=a)return;if(h>p){if(i){if(i.y>=l)return}else i={x:d,y:c};e={x:d,y:l}}else{if(i){if(i.y<c)return}else i={x:d,y:l};e={x:d,y:c}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=l)return}else i={x:(c-u)/r,y:c};e={x:(l-u)/r,y:l}}else{if(i){if(i.y<c)return}else i={x:(l-u)/r,y:l};e={x:(c-u)/r,y:c}}else if(v>g){if(i){if(i.x>=a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}else{if(i){if(i.x<o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}return n.a=i,n.b=e,!0}function Wr(n,t){this.l=n,this.r=t,this.a=this.b=null}function Jr(n,t,e,r){var u=new Wr(n,t);return Gc.push(u),e&&Kr(u,n,t,e),r&&Kr(u,t,n,r),Kc[n.i].edges.push(new Qr(u,n,t)),Kc[t.i].edges.push(new Qr(u,t,n)),u}function Gr(n,t,e){var r=new Wr(n,null);return r.a=t,r.b=e,Gc.push(r),r}function Kr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function Qr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function nu(){this._=null}function tu(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function eu(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ru(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function uu(n){for(;n.L;)n=n.L;return n}function iu(n,t){var e,r,u,i=n.sort(ou).pop();for(Gc=[],Kc=new Array(n.length),Qc=new nu,tl=new nu;;)if(u=nl,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(Kc[i.i]=new Or(i),jr(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;Ur(u.arc)}t&&($r(t),Ir(t));var o={cells:Kc,edges:Gc};return Qc=tl=Gc=Kc=null,o}function ou(n,t){return t.y-n.y||t.x-n.x}function au(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function cu(n){return n.x}function lu(n){return n.y}function su(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fu(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=.5*(e+u),a=.5*(r+i),c=t.nodes;c[0]&&fu(n,c[0],e,r,o,a),c[1]&&fu(n,c[1],o,r,u,a),c[2]&&fu(n,c[2],e,a,o,i),c[3]&&fu(n,c[3],o,a,u,i)}}function hu(n,t,e,r,u,i,o){var a,c=1/0;return function l(n,s,f,h,g){if(!(s>i||f>o||r>h||u>g)){if(p=n.point){var p,v=t-n.x,d=e-n.y,m=v*v+d*d;if(c>m){var y=Math.sqrt(c=m);r=t-y,u=e-y,i=t+y,o=e+y,a=p}}for(var M=n.nodes,x=.5*(s+h),b=.5*(f+g),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:l(n,s,f,x,b);break;case 1:l(n,x,f,h,b);break;case 2:l(n,s,b,x,g);break;case 3:l(n,x,b,h,g)}}}(n,r,u,i,o),a}function gu(n,t){n=ta.rgb(n),t=ta.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+xt(Math.round(e+i*n))+xt(Math.round(r+o*n))+xt(Math.round(u+a*n))}}function pu(n,t){var e,r={},u={};for(e in n)e in t?r[e]=mu(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function vu(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function du(n,t){var e,r,u,i=il.lastIndex=ol.lastIndex=0,o=-1,a=[],c=[];for(n+="",t+="";(e=il.exec(n))&&(r=ol.exec(t));)(u=r.index)>i&&(u=t.slice(i,u),a[o]?a[o]+=u:a[++o]=u),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:vu(e,r)})),i=ol.lastIndex;return i<t.length&&(u=t.slice(i),a[o]?a[o]+=u:a[++o]=u),a.length<2?c[0]?(t=c[0].x,function(n){return t(n)+""}):function(){return t}:(t=c.length,function(n){for(var e,r=0;t>r;++r)a[(e=c[r]).i]=e.x(n);return a.join("")})}function mu(n,t){for(var e,r=ta.interpolators.length;--r>=0&&!(e=ta.interpolators[r](n,t)););return e}function yu(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(mu(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;o>e;++e)u[e]=t[e];return function(n){for(e=0;a>e;++e)u[e]=r[e](n);return u}}function Mu(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function xu(n){return function(t){return 1-n(1-t)}}function bu(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function _u(n){return n*n}function wu(n){return n*n*n}function Su(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function ku(n){return function(t){return Math.pow(t,n)}}function Eu(n){return 1-Math.cos(n*Ra)}function Au(n){return Math.pow(2,10*(n-1))}function Nu(n){return 1-Math.sqrt(1-n*n)}function Cu(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/La*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*La/t)}}function zu(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function qu(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Lu(n,t){n=ta.hcl(n),t=ta.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return st(e+i*n,r+o*n,u+a*n)+""}}function Tu(n,t){n=ta.hsl(n),t=ta.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return ct(e+i*n,r+o*n,u+a*n)+""}}function Ru(n,t){n=ta.lab(n),t=ta.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return ht(e+i*n,r+o*n,u+a*n)+""}}function Du(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Pu(n){var t=[n.a,n.b],e=[n.c,n.d],r=ju(t),u=Uu(t,e),i=ju(Fu(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Pa,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Pa:0}function Uu(n,t){return n[0]*t[0]+n[1]*t[1]}function ju(n){var t=Math.sqrt(Uu(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Fu(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Hu(n,t){var e,r=[],u=[],i=ta.transform(n),o=ta.transform(t),a=i.translate,c=o.translate,l=i.rotate,s=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:vu(a[0],c[0])},{i:3,x:vu(a[1],c[1])})):r.push(c[0]||c[1]?"translate("+c+")":""),l!=s?(l-s>180?s+=360:s-l>180&&(l+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:vu(l,s)})):s&&r.push(r.pop()+"rotate("+s+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:vu(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:vu(g[0],p[0])},{i:e-2,x:vu(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function Ou(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Iu(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Yu(n){for(var t=n.source,e=n.target,r=Vu(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function Zu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Vu(n,t){if(n===t)return n;for(var e=Zu(n),r=Zu(t),u=e.pop(),i=r.pop(),o=null;u===i;)o=u,u=e.pop(),i=r.pop();return o}function Xu(n){n.fixed|=2}function $u(n){n.fixed&=-7}function Bu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function Wu(n){n.fixed&=-5}function Ju(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,o=n.nodes,a=o.length,c=-1;++c<a;)i=o[c],null!=i&&(Ju(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var l=t*e[n.point.index];n.charge+=n.pointCharge=l,r+=l*n.point.x,u+=l*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function Gu(n,t){return ta.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=ri,n}function Ku(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(u=n.children)&&(r=u.length))for(var r,u;--r>=0;)e.push(u[r])}function Qu(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(i=n.children)&&(u=i.length))for(var u,i,o=-1;++o<u;)e.push(i[o]);for(;null!=(n=r.pop());)t(n)}function ni(n){return n.children}function ti(n){return n.value}function ei(n,t){return t.value-n.value}function ri(n){return ta.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function ui(n){return n.x}function ii(n){return n.y}function oi(n,t,e){n.y0=t,n.y=e}function ai(n){return ta.range(n.length)}function ci(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function li(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function si(n){return n.reduce(fi,0)}function fi(n,t){return n+t[1]}function hi(n,t){return gi(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function gi(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function pi(n){return[ta.min(n),ta.max(n)]}function vi(n,t){return n.value-t.value}function di(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function mi(n,t){n._pack_next=t,t._pack_prev=n}function yi(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function Mi(n){function t(n){s=Math.min(n.x-n.r,s),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(l=e.length)){var e,r,u,i,o,a,c,l,s=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(xi),r=e[0],r.x=-r.r,r.y=0,t(r),l>1&&(u=e[1],u.x=u.r,u.y=0,t(u),l>2))for(i=e[2],wi(r,u,i),t(i),di(r,i),r._pack_prev=i,di(i,u),u=r._pack_next,o=3;l>o;o++){wi(r,u,i=e[o]);var p=0,v=1,d=1;for(a=u._pack_next;a!==u;a=a._pack_next,v++)if(yi(a,i)){p=1;break}if(1==p)for(c=r._pack_prev;c!==a._pack_prev&&!yi(c,i);c=c._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?mi(r,u=a):mi(r=c,u),o--):(di(r,i),u=i,t(i))}var m=(s+f)/2,y=(h+g)/2,M=0;for(o=0;l>o;o++)i=e[o],i.x-=m,i.y-=y,M=Math.max(M,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=M,e.forEach(bi)}}function xi(n){n._pack_next=n._pack_prev=n}function bi(n){delete n._pack_next,delete n._pack_prev}function _i(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,o=u.length;++i<o;)_i(u[i],t,e,r)}function wi(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=.5+(r-o)/(2*a),l=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+l*i,e.y=n.y+c*i-l*u}else e.x=n.x+r,e.y=n.y}function Si(n,t){return n.parent==t.parent?1:2}function ki(n){var t=n.children;return t.length?t[0]:n.t}function Ei(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ai(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Ni(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Ci(n,t,e){return n.a.parent===t.parent?n.a:e}function zi(n){return 1+ta.max(n,function(n){return n.y})}function qi(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Li(n){var t=n.children;return t&&t.length?Li(t[0]):n}function Ti(n){var t,e=n.children;return e&&(t=e.length)?Ti(e[t-1]):n}function Ri(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Di(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Pi(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Ui(n){return n.rangeExtent?n.rangeExtent():Pi(n.range())}function ji(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Fi(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function Hi(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:ml}function Oi(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]));return function(t){var e=ta.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function Ii(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Oi:ji,c=r?Iu:Ou;return o=u(n,t,c,e),a=u(t,n,c,mu),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Du)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return Xi(n,t)},i.tickFormat=function(t,e){return $i(n,t,e)},i.nice=function(t){return Zi(n,t),u()},i.copy=function(){return Ii(n,t,e,r)},u()}function Yi(n,t){return ta.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Zi(n,t){return Fi(n,Hi(Vi(n,t)[2]))}function Vi(n,t){null==t&&(t=10);var e=Pi(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function Xi(n,t){return ta.range.apply(ta,Vi(n,t))}function $i(n,t,e){var r=Vi(n,t);if(e){var u=ic.exec(e);if(u.shift(),"s"===u[8]){var i=ta.formatPrefix(Math.max(ga(r[0]),ga(r[1])));return u[7]||(u[7]="."+Bi(i.scale(r[2]))),u[8]="f",e=ta.format(u.join("")),function(n){return e(i.scale(n))+i.symbol}}u[7]||(u[7]="."+Wi(u[8],r)),e=u.join("")}else e=",."+Bi(r[2])+"f";return ta.format(e)}function Bi(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function Wi(n,t){var e=Bi(t[2]);return n in yl?Math.abs(e-Bi(Math.max(ga(t[0]),ga(t[1]))))+ +("e"!==n):e-2*("%"===n)}function Ji(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=Fi(r.map(u),e?Math:xl);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=Pi(r),o=[],a=n[0],c=n[1],l=Math.floor(u(a)),s=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(s-l)){if(e){for(;s>l;l++)for(var h=1;f>h;h++)o.push(i(l)*h);o.push(i(l))}else for(o.push(i(l));l++<s;)for(var h=f-1;h>0;h--)o.push(i(l)*h);for(l=0;o[l]<a;l++);for(s=o.length;o[s-1]>c;s--);o=o.slice(l,s)}return o},o.tickFormat=function(n,t){if(!arguments.length)return Ml;arguments.length<2?t=Ml:"function"!=typeof t&&(t=ta.format(t));var r,a=Math.max(.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return Ji(n.copy(),t,e,r)},Yi(o,n)}function Gi(n,t,e){function r(t){return n(u(t))}var u=Ki(t),i=Ki(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return Xi(e,n)},r.tickFormat=function(n,t){return $i(e,n,t)},r.nice=function(n){return r.domain(Zi(e,n))},r.exponent=function(o){return arguments.length?(u=Ki(t=o),i=Ki(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return Gi(n.copy(),t,e)},Yi(r,n)}function Ki(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function Qi(n,t){function e(e){return i[((u.get(e)||("range"===t.t?u.set(e,n.push(e)):0/0))-1)%i.length]}function r(t,e){return ta.range(n.length).map(function(n){return t+e*n})}var u,i,o;return e.domain=function(r){if(!arguments.length)return n;n=[],u=new l;for(var i,o=-1,a=r.length;++o<a;)u.has(i=r[o])||u.set(i,n.push(i));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(i=n,o=0,t={t:"range",a:arguments},e):i},e.rangePoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=(c+l)/2,0):(l-c)/(n.length-1+a);return i=r(c+s*a/2,s),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=l=Math.round((c+l)/2),0):(l-c)/(n.length-1+a)|0;return i=r(c+Math.round(s*a/2+(l-c-(n.length-1+a)*s)/2),s),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=(f-s)/(n.length-a+2*c);return i=r(s+h*c,h),l&&i.reverse(),o=h*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=Math.floor((f-s)/(n.length-a+2*c));return i=r(s+Math.round((f-s-(n.length-a)*h)/2),h),l&&i.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Pi(t.a[0])},e.copy=function(){return Qi(n,t)},e.domain(n)}function no(n,t){function i(){var e=0,r=t.length;for(a=[];++e<r;)a[e-1]=ta.quantile(n,e/r);return o}function o(n){return isNaN(n=+n)?void 0:t[ta.bisect(a,n)]}var a;return o.domain=function(t){return arguments.length?(n=t.map(r).filter(u).sort(e),i()):n},o.range=function(n){return arguments.length?(t=n,i()):t},o.quantiles=function(){return a},o.invertExtent=function(e){return e=t.indexOf(e),0>e?[0/0,0/0]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},o.copy=function(){return no(n,t)},i()}function to(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return to(n,t,e)},u()}function eo(n,t){function e(e){return e>=e?t[ta.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return eo(n,t)},e}function ro(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Xi(n,t)},t.tickFormat=function(t,e){return $i(n,t,e)},t.copy=function(){return ro(n)},t}function uo(){return 0}function io(n){return n.innerRadius}function oo(n){return n.outerRadius}function ao(n){return n.startAngle}function co(n){return n.endAngle}function lo(n){return n&&n.padAngle}function so(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function fo(n,t,e,r,u){var i=n[0]-t[0],o=n[1]-t[1],a=(u?r:-r)/Math.sqrt(i*i+o*o),c=a*o,l=-a*i,s=n[0]+c,f=n[1]+l,h=t[0]+c,g=t[1]+l,p=(s+h)/2,v=(f+g)/2,d=h-s,m=g-f,y=d*d+m*m,M=e-r,x=s*g-h*f,b=(0>m?-1:1)*Math.sqrt(M*M*y-x*x),_=(x*m-d*b)/y,w=(-x*d-m*b)/y,S=(x*m+d*b)/y,k=(-x*d+m*b)/y,E=_-p,A=w-v,N=S-p,C=k-v;return E*E+A*A>N*N+C*C&&(_=S,w=k),[[_-c,w-l],[_*e/M,w*e/M]]}function ho(n){function t(t){function o(){l.push("M",i(n(s),a))}for(var c,l=[],s=[],f=-1,h=t.length,g=Et(e),p=Et(r);++f<h;)u.call(this,c=t[f],f)?s.push([+g.call(this,c,f),+p.call(this,c,f)]):s.length&&(o(),s=[]);return s.length&&o(),l.length?l.join(""):null}var e=Ar,r=Nr,u=Ne,i=go,o=i.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=El.get(n)||go).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function go(n){return n.join("L")}function po(n){return go(n)+"Z"}function vo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function mo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function yo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function Mo(n,t){return n.length<4?go(n):n[1]+_o(n.slice(1,-1),wo(n,t))}function xo(n,t){return n.length<3?go(n):n[0]+_o((n.push(n[0]),n),wo([n[n.length-2]].concat(n,[n[1]]),t))}function bo(n,t){return n.length<3?go(n):n[0]+_o(n,wo(n,t))}function _o(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return go(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var l=2;l<t.length;l++,c++)i=n[c],a=t[l],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}if(e){var s=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+s[0]+","+s[1]}return r}function wo(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;)e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])]);return r}function So(n){if(n.length<3)return go(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",No(Cl,o),",",No(Cl,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Co(c,o,a);return n.pop(),c.push("L",r),c.join("")}function ko(n){if(n.length<4)return go(n);for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;)t=n[r],i.push(t[0]),o.push(t[1]);for(e.push(No(Cl,i)+","+No(Cl,o)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),Co(e,i,o);return e.join("")}function Eo(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;)e=n[r%u],o.push(e[0]),a.push(e[1]);for(t=[No(Cl,o),",",No(Cl,a)],--r;++r<i;)e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Co(t,o,a);return t.join("")}function Ao(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,l=-1;++l<=e;)r=n[l],u=l/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c);return So(n)}function No(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Co(n,t,e){n.push("C",No(Al,t),",",No(Al,e),",",No(Nl,t),",",No(Nl,e),",",No(Cl,t),",",No(Cl,e))}function zo(n,t){return(t[1]-n[1])/(t[0]-n[0])}function qo(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=zo(u,i);++t<e;)r[t]=(o+(o=zo(u=i,i=n[t+1])))/2;return r[t]=o,r}function Lo(n){for(var t,e,r,u,i=[],o=qo(n),a=-1,c=n.length-1;++a<c;)t=zo(n[a],n[a+1]),ga(t)<Ca?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r));for(a=-1;++a<=c;)u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0]);return i}function To(n){return n.length<3?go(n):n[0]+_o(n,Lo(n))}function Ro(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]-Ra,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Do(n){function t(t){function c(){v.push("M",a(n(m),f),s,l(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,M=t.length,x=Et(e),b=Et(u),_=e===r?function(){return g}:Et(r),w=u===i?function(){return p}:Et(i);++y<M;)o.call(this,h=t[y],y)?(d.push([g=+x.call(this,h,y),p=+b.call(this,h,y)]),m.push([+_.call(this,h,y),+w.call(this,h,y)])):d.length&&(c(),d=[],m=[]);return d.length&&c(),v.length?v.join(""):null}var e=Ar,r=Ar,u=0,i=Nr,o=Ne,a=go,c=a.key,l=a,s="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r
},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=El.get(n)||go).key,l=a.reverse||a,s=a.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Po(n){return n.radius}function Uo(n){return[n.x,n.y]}function jo(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Ra;return[e*Math.cos(r),e*Math.sin(r)]}}function Fo(){return 64}function Ho(){return"circle"}function Oo(n){var t=Math.sqrt(n/qa);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Io(n){return function(){var t,e;(t=this[n])&&(e=t[t.active])&&(--t.count?delete t[t.active]:delete this[n],t.active+=.5,e.event&&e.event.interrupt.call(this,this.__data__,e.index))}}function Yo(n,t,e){return ya(n,Pl),n.namespace=t,n.id=e,n}function Zo(n,t,e,r){var u=n.id,i=n.namespace;return Y(n,"function"==typeof e?function(n,o,a){n[i][u].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[i][u].tween.set(t,e)}))}function Vo(n){return null==n&&(n=""),function(){this.textContent=n}}function Xo(n){return null==n?"__transition__":"__transition_"+n+"__"}function $o(n,t,e,r,u){var i=n[e]||(n[e]={active:0,count:0}),o=i[r];if(!o){var a=u.time;o=i[r]={tween:new l,time:a,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++i.count,ta.timer(function(u){function c(e){if(i.active>r)return s();var u=i[i.active];u&&(--i.count,delete i[i.active],u.event&&u.event.interrupt.call(n,n.__data__,u.index)),i.active=r,o.event&&o.event.start.call(n,n.__data__,t),o.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&v.push(r)}),h=o.ease,f=o.duration,ta.timer(function(){return p.c=l(e||1)?Ne:l,1},0,a)}function l(e){if(i.active!==r)return 1;for(var u=e/f,a=h(u),c=v.length;c>0;)v[--c].call(n,a);return u>=1?(o.event&&o.event.end.call(n,n.__data__,t),s()):void 0}function s(){return--i.count?delete i[r]:delete n[e],1}var f,h,g=o.delay,p=ec,v=[];return p.t=g+a,u>=g?c(u-g):void(p.c=c)},0,a)}}function Bo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function Wo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function Jo(n){return n.toISOString()}function Go(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=ta.bisect(Vl,u);return i==Vl.length?[t.year,Vi(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/Vl[i-1]<Vl[i]/u?i-1:i]:[Bl,Vi(n,e)[2]]}return r.invert=function(t){return Ko(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Ko)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Ko(+e+1),t).length}var i=r.domain(),o=Pi(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(Fi(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Ko(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Ko(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Pi(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],Ko(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Go(n.copy(),t,e)},Yi(r,n)}function Ko(n){return new Date(n)}function Qo(n){return JSON.parse(n.responseText)}function na(n){var t=ua.createRange();return t.selectNode(ua.body),t.createContextualFragment(n.responseText)}var ta={version:"3.5.5"},ea=[].slice,ra=function(n){return ea.call(n)},ua=this.document;if(ua)try{ra(ua.documentElement.childNodes)[0].nodeType}catch(ia){ra=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),ua)try{ua.createElement("DIV").style.setProperty("opacity",0,"")}catch(oa){var aa=this.Element.prototype,ca=aa.setAttribute,la=aa.setAttributeNS,sa=this.CSSStyleDeclaration.prototype,fa=sa.setProperty;aa.setAttribute=function(n,t){ca.call(this,n,t+"")},aa.setAttributeNS=function(n,t,e){la.call(this,n,t,e+"")},sa.setProperty=function(n,t,e){fa.call(this,n,t+"",e)}}ta.ascending=e,ta.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},ta.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},ta.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},ta.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=n[i])&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<o;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},ta.sum=function(n,t){var e,r=0,i=n.length,o=-1;if(1===arguments.length)for(;++o<i;)u(e=+n[o])&&(r+=e);else for(;++o<i;)u(e=+t.call(n,n[o],o))&&(r+=e);return r},ta.mean=function(n,t){var e,i=0,o=n.length,a=-1,c=o;if(1===arguments.length)for(;++a<o;)u(e=r(n[a]))?i+=e:--c;else for(;++a<o;)u(e=r(t.call(n,n[a],a)))?i+=e:--c;return c?i/c:void 0},ta.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},ta.median=function(n,t){var i,o=[],a=n.length,c=-1;if(1===arguments.length)for(;++c<a;)u(i=r(n[c]))&&o.push(i);else for(;++c<a;)u(i=r(t.call(n,n[c],c)))&&o.push(i);return o.length?ta.quantile(o.sort(e),.5):void 0},ta.variance=function(n,t){var e,i,o=n.length,a=0,c=0,l=-1,s=0;if(1===arguments.length)for(;++l<o;)u(e=r(n[l]))&&(i=e-a,a+=i/++s,c+=i*(e-a));else for(;++l<o;)u(e=r(t.call(n,n[l],l)))&&(i=e-a,a+=i/++s,c+=i*(e-a));return s>1?c/(s-1):void 0},ta.deviation=function(){var n=ta.variance.apply(this,arguments);return n?Math.sqrt(n):n};var ha=i(e);ta.bisectLeft=ha.left,ta.bisect=ta.bisectRight=ha.right,ta.bisector=function(n){return i(1===n.length?function(t,r){return e(n(t),r)}:n)},ta.shuffle=function(n,t,e){(i=arguments.length)<3&&(e=n.length,2>i&&(t=0));for(var r,u,i=e-t;i;)u=Math.random()*i--|0,r=n[i+t],n[i+t]=n[u+t],n[u+t]=r;return n},ta.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},ta.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},ta.zip=function(){if(!(r=arguments.length))return[];for(var n=-1,t=ta.min(arguments,o),e=new Array(t);++n<t;)for(var r,u=-1,i=e[n]=new Array(r);++u<r;)i[u]=arguments[u][n];return e},ta.transpose=function(n){return ta.zip.apply(ta,n)},ta.keys=function(n){var t=[];for(var e in n)t.push(e);return t},ta.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},ta.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},ta.merge=function(n){for(var t,e,r,u=n.length,i=-1,o=0;++i<u;)o+=n[i].length;for(e=new Array(o);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--o]=r[t];return e};var ga=Math.abs;ta.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e===1/0)throw new Error("infinite range");var r,u=[],i=a(ga(e)),o=-1;if(n*=i,t*=i,e*=i,0>e)for(;(r=n+e*++o)>t;)u.push(r/i);else for(;(r=n+e*++o)<t;)u.push(r/i);return u},ta.map=function(n,t){var e=new l;if(n instanceof l)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,u=-1,i=n.length;if(1===arguments.length)for(;++u<i;)e.set(u,n[u]);else for(;++u<i;)e.set(t.call(n,r=n[u],u),r)}else for(var o in n)e.set(o,n[o]);return e};var pa="__proto__",va="\x00";c(l,{has:h,get:function(n){return this._[s(n)]},set:function(n,t){return this._[s(n)]=t},remove:g,keys:p,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:f(t),value:this._[t]});return n},size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t),this._[t])}}),ta.nest=function(){function n(t,o,a){if(a>=i.length)return r?r.call(u,o):e?o.sort(e):o;for(var c,s,f,h,g=-1,p=o.length,v=i[a++],d=new l;++g<p;)(h=d.get(c=v(s=o[g])))?h.push(s):d.set(c,[s]);return t?(s=t(),f=function(e,r){s.set(e,n(t,r,a))}):(s={},f=function(e,r){s[e]=n(t,r,a)}),d.forEach(f),s}function t(n,e){if(e>=i.length)return n;var r=[],u=o[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,u={},i=[],o=[];return u.map=function(t,e){return n(e,t,0)},u.entries=function(e){return t(n(ta.map,e,0),0)},u.key=function(n){return i.push(n),u},u.sortKeys=function(n){return o[i.length-1]=n,u},u.sortValues=function(n){return e=n,u},u.rollup=function(n){return r=n,u},u},ta.set=function(n){var t=new m;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},c(m,{has:h,add:function(n){return this._[s(n+="")]=!0,n},remove:g,values:p,size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,f(t))}}),ta.behavior={},ta.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=M(n,t,t[e]);return n};var da=["webkit","ms","moz","Moz","o","O"];ta.dispatch=function(){for(var n=new _,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=w(n);return n},_.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},ta.event=null,ta.requote=function(n){return n.replace(ma,"\\$&")};var ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ya={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},Ma=function(n,t){return t.querySelector(n)},xa=function(n,t){return t.querySelectorAll(n)},ba=function(n,t){var e=n.matches||n[x(n,"matchesSelector")];return(ba=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(Ma=function(n,t){return Sizzle(n,t)[0]||null},xa=Sizzle,ba=Sizzle.matchesSelector),ta.selection=function(){return ta.select(ua.documentElement)};var _a=ta.selection.prototype=[];_a.select=function(n){var t,e,r,u,i=[];n=N(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,l=r.length;++c<l;)(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return A(i)},_a.selectAll=function(n){var t,e,r=[];n=C(n);for(var u=-1,i=this.length;++u<i;)for(var o=this[u],a=-1,c=o.length;++a<c;)(e=o[a])&&(r.push(t=ra(n.call(e,e.__data__,a,u))),t.parentNode=e);return A(r)};var wa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ta.ns={prefix:wa,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.slice(0,t),n=n.slice(t+1)),wa.hasOwnProperty(e)?{space:wa[e],local:n}:n}},_a.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=ta.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(z(t,n[t]));return this}return this.each(z(n,t))},_a.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=T(n)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!L(n[u]).test(t))return!1;return!0}for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},_a.style=function(n,e,r){var u=arguments.length;if(3>u){if("string"!=typeof n){2>u&&(e="");for(r in n)this.each(P(r,n[r],e));return this}if(2>u){var i=this.node();return t(i).getComputedStyle(i,null).getPropertyValue(n)}r=""}return this.each(P(n,e,r))},_a.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(U(t,n[t]));return this}return this.each(U(n,t))},_a.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},_a.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},_a.append=function(n){return n=j(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},_a.insert=function(n,t){return n=j(n),t=N(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},_a.remove=function(){return this.each(F)},_a.data=function(n,t){function e(n,e){var r,u,i,o=n.length,f=e.length,h=Math.min(o,f),g=new Array(f),p=new Array(f),v=new Array(o);if(t){var d,m=new l,y=new Array(o);for(r=-1;++r<o;)m.has(d=t.call(u=n[r],u.__data__,r))?v[r]=u:m.set(d,u),y[r]=d;for(r=-1;++r<f;)(u=m.get(d=t.call(e,i=e[r],r)))?u!==!0&&(g[r]=u,u.__data__=i):p[r]=H(i),m.set(d,!0);for(r=-1;++r<o;)m.get(y[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)u=n[r],i=e[r],u?(u.__data__=i,g[r]=u):p[r]=H(i);for(;f>r;++r)p[r]=H(e[r]);for(;o>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,a.push(p),c.push(g),s.push(v)}var r,u,i=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++i<o;)(u=r[i])&&(n[i]=u.__data__);return n}var a=Z([]),c=A([]),s=A([]);if("function"==typeof n)for(;++i<o;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<o;)e(r=this[i],n);return c.enter=function(){return a},c.exit=function(){return s},c},_a.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},_a.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return A(u)},_a.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},_a.sort=function(n){n=I.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},_a.each=function(n){return Y(this,function(t,e,r){n.call(t,t.__data__,e,r)})},_a.call=function(n){var t=ra(arguments);return n.apply(t[0]=this,t),this},_a.empty=function(){return!this.node()},_a.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},_a.size=function(){var n=0;return Y(this,function(){++n}),n};var Sa=[];ta.selection.enter=Z,ta.selection.enter.prototype=Sa,Sa.append=_a.append,Sa.empty=_a.empty,Sa.node=_a.node,Sa.call=_a.call,Sa.size=_a.size,Sa.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var l=-1,s=u.length;++l<s;)(i=u[l])?(t.push(r[l]=e=n.call(u.parentNode,i.__data__,l,a)),e.__data__=i.__data__):t.push(null)}return A(o)},Sa.insert=function(n,t){return arguments.length<2&&(t=V(this)),_a.insert.call(this,n,t)},ta.select=function(t){var e;return"string"==typeof t?(e=[Ma(t,ua)],e.parentNode=ua.documentElement):(e=[t],e.parentNode=n(t)),A([e])},ta.selectAll=function(n){var t;return"string"==typeof n?(t=ra(xa(n,ua)),t.parentNode=ua.documentElement):(t=n,t.parentNode=null),A([t])},_a.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(X(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(X(n,t,e))};var ka=ta.map({mouseenter:"mouseover",mouseleave:"mouseout"});ua&&ka.forEach(function(n){"on"+n in ua&&ka.remove(n)});var Ea,Aa=0;ta.mouse=function(n){return J(n,k())};var Na=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ta.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=k().changedTouches),t)for(var r,u=0,i=t.length;i>u;++u)if((r=t[u]).identifier===e)return J(n,r)},ta.behavior.drag=function(){function n(){this.on("mousedown.drag",i).on("touchstart.drag",o)}function e(n,t,e,i,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],p|=n|e,M=r,g({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:n,dy:e}))}function c(){t(h,v)&&(m.on(i+d,null).on(o+d,null),y(p&&ta.event.target===f),g({type:"dragend"}))}var l,s=this,f=ta.event.target,h=s.parentNode,g=r.of(s,arguments),p=0,v=n(),d=".drag"+(null==v?"":"-"+v),m=ta.select(e(f)).on(i+d,a).on(o+d,c),y=W(f),M=t(h,v);u?(l=u.apply(s,arguments),l=[l.x-M[0],l.y-M[1]]):l=[0,0],g({type:"dragstart"})}}var r=E(n,"drag","dragstart","dragend"),u=null,i=e(b,ta.mouse,t,"mousemove","mouseup"),o=e(G,ta.touch,y,"touchmove","touchend");return n.origin=function(t){return arguments.length?(u=t,n):u},ta.rebind(n,r,"on")},ta.touches=function(n,t){return arguments.length<2&&(t=k().touches),t?ra(t).map(function(t){var e=J(n,t);return e.identifier=t.identifier,e}):[]};var Ca=1e-6,za=Ca*Ca,qa=Math.PI,La=2*qa,Ta=La-Ca,Ra=qa/2,Da=qa/180,Pa=180/qa,Ua=Math.SQRT2,ja=2,Fa=4;ta.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=rt(v),o=i/(ja*h)*(e*ut(Ua*t+v)-et(v));return[r+o*l,u+o*s,i*e/rt(Ua*t+v)]}return[r+n*l,u+n*s,i*Math.exp(Ua*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],l=o-r,s=a-u,f=l*l+s*s,h=Math.sqrt(f),g=(c*c-i*i+Fa*f)/(2*i*ja*h),p=(c*c-i*i-Fa*f)/(2*c*ja*h),v=Math.log(Math.sqrt(g*g+1)-g),d=Math.log(Math.sqrt(p*p+1)-p),m=d-v,y=(m||Math.log(c/i))/Ua;return e.duration=1e3*y,e},ta.behavior.zoom=function(){function n(n){n.on(q,f).on(Oa+".zoom",g).on("dblclick.zoom",p).on(R,h)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function u(n){k.k=Math.max(N[0],Math.min(N[1],n))}function i(n,t){t=r(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function o(t,e,r,o){t.__chart__={x:k.x,y:k.y,k:k.k},u(Math.pow(2,o)),i(d=e,r),t=ta.select(t),C>0&&(t=t.transition().duration(C)),t.call(n.event)}function a(){b&&b.domain(x.range().map(function(n){return(n-k.x)/k.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function c(n){z++||n({type:"zoomstart"})}function l(n){a(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function s(n){--z||n({type:"zoomend"}),d=null}function f(){function n(){f=1,i(ta.mouse(u),g),l(a)}function r(){h.on(L,null).on(T,null),p(f&&ta.event.target===o),s(a)}var u=this,o=ta.event.target,a=D.of(u,arguments),f=0,h=ta.select(t(u)).on(L,n).on(T,r),g=e(ta.mouse(u)),p=W(u);Dl.call(u),c(a)}function h(){function n(){var n=ta.touches(p);return g=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=ta.event.target;ta.select(t).on(x,r).on(b,a),_.push(t);for(var e=ta.event.changedTouches,u=0,i=e.length;i>u;++u)d[e[u].identifier]=null;var c=n(),l=Date.now();if(1===c.length){if(500>l-M){var s=c[0];o(p,s,d[s.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),S()}M=l}else if(c.length>1){var s=c[0],f=c[1],h=s[0]-f[0],g=s[1]-f[1];m=h*h+g*g}}function r(){var n,t,e,r,o=ta.touches(p);Dl.call(p);for(var a=0,c=o.length;c>a;++a,r=null)if(e=o[a],r=d[e.identifier]){if(t)break;n=e,t=r}if(r){var s=(s=e[0]-n[0])*s+(s=e[1]-n[1])*s,f=m&&Math.sqrt(s/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],u(f*g)}M=null,i(n,t),l(v)}function a(){if(ta.event.touches.length){for(var t=ta.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var u in d)return void n()}ta.selectAll(_).on(y,null),w.on(q,f).on(R,h),E(),s(v)}var g,p=this,v=D.of(p,arguments),d={},m=0,y=".zoom-"+ta.event.changedTouches[0].identifier,x="touchmove"+y,b="touchend"+y,_=[],w=ta.select(p),E=W(p);t(),c(v),w.on(q,null).on(R,t)}function g(){var n=D.of(this,arguments);y?clearTimeout(y):(v=e(d=m||ta.mouse(this)),Dl.call(this),c(n)),y=setTimeout(function(){y=null,s(n)},50),S(),u(Math.pow(2,.002*Ha())*k.k),i(d,v),l(n)}function p(){var n=ta.mouse(this),t=Math.log(k.k)/Math.LN2;o(this,n,e(n),ta.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var v,d,m,y,M,x,b,_,w,k={x:0,y:0,k:1},A=[960,500],N=Ia,C=250,z=0,q="mousedown.zoom",L="mousemove.zoom",T="mouseup.zoom",R="touchstart.zoom",D=E(n,"zoomstart","zoom","zoomend");return Oa||(Oa="onwheel"in ua?(Ha=function(){return-ta.event.deltaY*(ta.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ua?(Ha=function(){return ta.event.wheelDelta},"mousewheel"):(Ha=function(){return-ta.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=D.of(this,arguments),t=k;Tl?ta.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},c(n)}).tween("zoom:zoom",function(){var e=A[0],r=A[1],u=d?d[0]:e/2,i=d?d[1]:r/2,o=ta.interpolateZoom([(u-k.x)/k.k,(i-k.y)/k.k,e/k.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:u-r[0]*a,y:i-r[1]*a,k:a},l(n)}}).each("interrupt.zoom",function(){s(n)}).each("end.zoom",function(){s(n)}):(this.__chart__=k,c(n),l(n),s(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},a(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:+t},a(),n):k.k},n.scaleExtent=function(t){return arguments.length?(N=null==t?Ia:[+t[0],+t[1]],n):N},n.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],n):m},n.size=function(t){return arguments.length?(A=t&&[+t[0],+t[1]],n):A},n.duration=function(t){return arguments.length?(C=+t,n):C},n.x=function(t){return arguments.length?(b=t,x=t.copy(),k={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),k={x:0,y:0,k:1},n):w},ta.rebind(n,D,"on")};var Ha,Oa,Ia=[0,1/0];ta.color=ot,ot.prototype.toString=function(){return this.rgb()+""},ta.hsl=at;var Ya=at.prototype=new ot;Ya.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new at(this.h,this.s,this.l/n)},Ya.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new at(this.h,this.s,n*this.l)},Ya.rgb=function(){return ct(this.h,this.s,this.l)},ta.hcl=lt;var Za=lt.prototype=new ot;Za.brighter=function(n){return new lt(this.h,this.c,Math.min(100,this.l+Va*(arguments.length?n:1)))},Za.darker=function(n){return new lt(this.h,this.c,Math.max(0,this.l-Va*(arguments.length?n:1)))},Za.rgb=function(){return st(this.h,this.c,this.l).rgb()},ta.lab=ft;var Va=18,Xa=.95047,$a=1,Ba=1.08883,Wa=ft.prototype=new ot;Wa.brighter=function(n){return new ft(Math.min(100,this.l+Va*(arguments.length?n:1)),this.a,this.b)},Wa.darker=function(n){return new ft(Math.max(0,this.l-Va*(arguments.length?n:1)),this.a,this.b)},Wa.rgb=function(){return ht(this.l,this.a,this.b)},ta.rgb=mt;var Ja=mt.prototype=new ot;Ja.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),new mt(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new mt(u,u,u)},Ja.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new mt(n*this.r,n*this.g,n*this.b)},Ja.hsl=function(){return _t(this.r,this.g,this.b)},Ja.toString=function(){return"#"+xt(this.r)+xt(this.g)+xt(this.b)};var Ga=ta.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ga.forEach(function(n,t){Ga.set(n,yt(t))}),ta.functor=Et,ta.xhr=At(y),ta.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=Nt(n,t,null==e?r:u(e),i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function i(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),c=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(s>=l)return o;if(u)return u=!1,i;var t=s;if(34===n.charCodeAt(t)){for(var e=t;e++<l;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}s=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++s):10===r&&(u=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;l>s;){var r=n.charCodeAt(s++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(s)&&(++s,++a);else if(r!==c)continue;return n.slice(t,s-a)}return n.slice(t)}for(var r,u,i={},o={},a=[],l=n.length,s=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,f++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new m,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(o).join(n)].concat(t.map(function(t){return u.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(i).join("\n")},e},ta.csv=ta.dsv(",","text/csv"),ta.tsv=ta.dsv("	","text/tab-separated-values");var Ka,Qa,nc,tc,ec,rc=this[x(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};ta.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,f:!1,n:null};Qa?Qa.n=i:Ka=i,Qa=i,nc||(tc=clearTimeout(tc),nc=1,rc(qt))},ta.timer.flush=function(){Lt(),Tt()},ta.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var uc=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Dt);ta.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=ta.round(n,Rt(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),uc[8+e/3]};var ic=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,oc=ta.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=ta.round(n,Rt(n,t))).toFixed(Math.max(0,Math.min(20,Rt(n*(1+1e-15),t))))}}),ac=ta.time={},cc=Date;jt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){lc.setUTCDate.apply(this._,arguments)},setDay:function(){lc.setUTCDay.apply(this._,arguments)},setFullYear:function(){lc.setUTCFullYear.apply(this._,arguments)},setHours:function(){lc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){lc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){lc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){lc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){lc.setUTCSeconds.apply(this._,arguments)},setTime:function(){lc.setTime.apply(this._,arguments)}};var lc=Date.prototype;ac.year=Ft(function(n){return n=ac.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),ac.years=ac.year.range,ac.years.utc=ac.year.utc.range,ac.day=Ft(function(n){var t=new cc(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),ac.days=ac.day.range,ac.days.utc=ac.day.utc.range,ac.dayOfYear=function(n){var t=ac.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=ac[n]=Ft(function(n){return(n=ac.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=ac.year(n).getDay();return Math.floor((ac.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});ac[n+"s"]=e.range,ac[n+"s"].utc=e.utc.range,ac[n+"OfYear"]=function(n){var e=ac.year(n).getDay();return Math.floor((ac.dayOfYear(n)+(e+t)%7)/7)}}),ac.week=ac.sunday,ac.weeks=ac.sunday.range,ac.weeks.utc=ac.sunday.utc.range,ac.weekOfYear=ac.sundayOfYear;var sc={"-":"",_:" ",0:"0"},fc=/^\s*\d+/,hc=/^%/;ta.locale=function(n){return{numberFormat:Pt(n),timeFormat:Ot(n)}};var gc=ta.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ta.format=gc.numberFormat,ta.geo={},ce.prototype={s:0,t:0,add:function(n){le(n,this.t,pc),le(pc.s,this.s,this),this.s?this.t+=pc.t:this.s=pc.t
},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var pc=new ce;ta.geo.stream=function(n,t){n&&vc.hasOwnProperty(n.type)?vc[n.type](n,t):se(n,t)};var vc={Feature:function(n,t){se(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)se(e[r].geometry,t)}},dc={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){fe(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)fe(e[r],t,0)},Polygon:function(n,t){he(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)he(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)se(e[r],t)}};ta.geo.area=function(n){return mc=0,ta.geo.stream(n,Mc),mc};var mc,yc=new ce,Mc={sphere:function(){mc+=4*qa},point:b,lineStart:b,lineEnd:b,polygonStart:function(){yc.reset(),Mc.lineStart=ge},polygonEnd:function(){var n=2*yc;mc+=0>n?4*qa+n:n,Mc.lineStart=Mc.lineEnd=Mc.point=b}};ta.geo.bounds=function(){function n(n,t){M.push(x=[s=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=pe([t*Da,e*Da]);if(m){var u=de(m,r),i=[u[1],-u[0],0],o=de(i,u);Me(o),o=xe(o);var c=t-p,l=c>0?1:-1,v=o[0]*Pa*l,d=ga(c)>180;if(d^(v>l*p&&l*t>v)){var y=o[1]*Pa;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>l*p&&l*t>v)){var y=-o[1]*Pa;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t):h>=s?(s>t&&(s=t),t>h&&(h=t)):t>p?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t)}else n(t,e);m=r,p=t}function e(){b.point=t}function r(){x[0]=s,x[1]=h,b.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=ga(r)>180?r+(r>0?360:-360):r}else v=n,d=e;Mc.point(n,e),t(n,e)}function i(){Mc.lineStart()}function o(){u(v,d),Mc.lineEnd(),ga(y)>Ca&&(s=-(h=180)),x[0]=s,x[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var s,f,h,g,p,v,d,m,y,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=u,b.lineStart=i,b.lineEnd=o,y=0,Mc.polygonStart()},polygonEnd:function(){Mc.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>yc?(s=-(h=180),f=-(g=90)):y>Ca?g=90:-Ca>y&&(f=-90),x[0]=s,x[1]=h}};return function(n){g=h=-(s=f=1/0),M=[],ta.geo.stream(n,b);var t=M.length;if(t){M.sort(c);for(var e,r=1,u=M[0],i=[u];t>r;++r)e=M[r],l(e[0],u)||l(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(o=a(u[1],e[0]))>p&&(p=o,s=e[0],h=u[1])}return M=x=null,1/0===s||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[s,f],[h,g]]}}(),ta.geo.centroid=function(n){xc=bc=_c=wc=Sc=kc=Ec=Ac=Nc=Cc=zc=0,ta.geo.stream(n,qc);var t=Nc,e=Cc,r=zc,u=t*t+e*e+r*r;return za>u&&(t=kc,e=Ec,r=Ac,Ca>bc&&(t=_c,e=wc,r=Sc),u=t*t+e*e+r*r,za>u)?[0/0,0/0]:[Math.atan2(e,t)*Pa,tt(r/Math.sqrt(u))*Pa]};var xc,bc,_c,wc,Sc,kc,Ec,Ac,Nc,Cc,zc,qc={sphere:b,point:_e,lineStart:Se,lineEnd:ke,polygonStart:function(){qc.lineStart=Ee},polygonEnd:function(){qc.lineStart=Se}},Lc=Le(Ne,Pe,je,[-qa,-qa/2]),Tc=1e9;ta.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=Ie(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(ta.geo.conicEqualArea=function(){return Ye(Ze)}).raw=Ze,ta.geo.albers=function(){return ta.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ta.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=ta.geo.albers(),o=ta.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ta.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?o:u>=.166&&.234>u&&r>=-.214&&-.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var l=i.scale(),s=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[s-.455*l,f-.238*l],[s+.455*l,f+.238*l]]).stream(c).point,r=o.translate([s-.307*l,f+.201*l]).clipExtent([[s-.425*l+Ca,f+.12*l+Ca],[s-.214*l-Ca,f+.234*l-Ca]]).stream(c).point,u=a.translate([s-.205*l,f+.212*l]).clipExtent([[s-.214*l+Ca,f+.166*l+Ca],[s-.115*l-Ca,f+.234*l-Ca]]).stream(c).point,n},n.scale(1070)};var Rc,Dc,Pc,Uc,jc,Fc,Hc={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Dc=0,Hc.lineStart=Ve},polygonEnd:function(){Hc.lineStart=Hc.lineEnd=Hc.point=b,Rc+=ga(Dc/2)}},Oc={point:Xe,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Ic={point:We,lineStart:Je,lineEnd:Ge,polygonStart:function(){Ic.lineStart=Ke},polygonEnd:function(){Ic.point=We,Ic.lineStart=Je,Ic.lineEnd=Ge}};ta.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),ta.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return Rc=0,ta.geo.stream(n,u(Hc)),Rc},n.centroid=function(n){return _c=wc=Sc=kc=Ec=Ac=Nc=Cc=zc=0,ta.geo.stream(n,u(Ic)),zc?[Nc/zc,Cc/zc]:Ac?[kc/Ac,Ec/Ac]:Sc?[_c/Sc,wc/Sc]:[0/0,0/0]},n.bounds=function(n){return jc=Fc=-(Pc=Uc=1/0),ta.geo.stream(n,u(Oc)),[[Pc,Uc],[jc,Fc]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||tr(n):y,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new $e:new Qe(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(ta.geo.albersUsa()).context(null)},ta.geo.transform=function(n){return{stream:function(t){var e=new er(t);for(var r in n)e[r]=n[r];return e}}},er.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ta.geo.projection=ur,ta.geo.projectionMutator=ir,(ta.geo.equirectangular=function(){return ur(ar)}).raw=ar.invert=ar,ta.geo.rotation=function(n){function t(t){return t=n(t[0]*Da,t[1]*Da),t[0]*=Pa,t[1]*=Pa,t}return n=lr(n[0]%360*Da,n[1]*Da,n.length>2?n[2]*Da:0),t.invert=function(t){return t=n.invert(t[0]*Da,t[1]*Da),t[0]*=Pa,t[1]*=Pa,t},t},cr.invert=ar,ta.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=lr(-n[0]*Da,-n[1]*Da,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Pa,n[1]*=Pa}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=gr((t=+r)*Da,u*Da),n):t},n.precision=function(r){return arguments.length?(e=gr(t*Da,(u=+r)*Da),n):u},n.angle(90)},ta.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Da,u=n[1]*Da,i=t[1]*Da,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),l=Math.cos(u),s=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=l*s-c*f*a)*e),c*s+l*f*a)},ta.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return ta.range(Math.ceil(i/d)*d,u,d).map(h).concat(ta.range(Math.ceil(l/m)*m,c,m).map(g)).concat(ta.range(Math.ceil(r/p)*p,e,p).filter(function(n){return ga(n%d)>Ca}).map(s)).concat(ta.range(Math.ceil(a/v)*v,o,v).filter(function(n){return ga(n%m)>Ca}).map(f))}var e,r,u,i,o,a,c,l,s,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(l).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],l=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),l>c&&(t=l,l=c,c=t),n.precision(y)):[[i,l],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,s=vr(a,o,90),f=dr(r,e,y),h=vr(l,c,90),g=dr(i,u,y),n):y},n.majorExtent([[-180,-90+Ca],[180,90-Ca]]).minorExtent([[-180,-80-Ca],[180,80+Ca]])},ta.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=mr,u=yr;return n.distance=function(){return ta.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},ta.geo.interpolate=function(n,t){return Mr(n[0]*Da,n[1]*Da,t[0]*Da,t[1]*Da)},ta.geo.length=function(n){return Yc=0,ta.geo.stream(n,Zc),Yc};var Yc,Zc={sphere:b,point:b,lineStart:xr,lineEnd:b,polygonStart:b,polygonEnd:b},Vc=br(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(ta.geo.azimuthalEqualArea=function(){return ur(Vc)}).raw=Vc;var Xc=br(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},y);(ta.geo.azimuthalEquidistant=function(){return ur(Xc)}).raw=Xc,(ta.geo.conicConformal=function(){return Ye(_r)}).raw=_r,(ta.geo.conicEquidistant=function(){return Ye(wr)}).raw=wr;var $c=br(function(n){return 1/n},Math.atan);(ta.geo.gnomonic=function(){return ur($c)}).raw=$c,Sr.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Ra]},(ta.geo.mercator=function(){return kr(Sr)}).raw=Sr;var Bc=br(function(){return 1},Math.asin);(ta.geo.orthographic=function(){return ur(Bc)}).raw=Bc;var Wc=br(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(ta.geo.stereographic=function(){return ur(Wc)}).raw=Wc,Er.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Ra]},(ta.geo.transverseMercator=function(){var n=kr(Er),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Er,ta.geom={},ta.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u=Et(e),i=Et(r),o=n.length,a=[],c=[];for(t=0;o>t;t++)a.push([+u.call(this,n[t],t),+i.call(this,n[t],t),t]);for(a.sort(zr),t=0;o>t;t++)c.push([a[t][0],-a[t][1]]);var l=Cr(a),s=Cr(c),f=s[0]===l[0],h=s[s.length-1]===l[l.length-1],g=[];for(t=l.length-1;t>=0;--t)g.push(n[a[l[t]][2]]);for(t=+f;t<s.length-h;++t)g.push(n[a[s[t]][2]]);return g}var e=Ar,r=Nr;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},ta.geom.polygon=function(n){return ya(n,Jc),n};var Jc=ta.geom.polygon.prototype=[];Jc.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},Jc.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[i*n,o*n]},Jc.clip=function(n){for(var t,e,r,u,i,o,a=Tr(n),c=-1,l=this.length-Tr(this),s=this[l-1];++c<l;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],qr(o,s,u)?(qr(i,s,u)||n.push(Lr(i,o,s,u)),n.push(o)):qr(i,s,u)&&n.push(Lr(i,o,s,u)),i=o;a&&n.push(n[0]),s=u}return n};var Gc,Kc,Qc,nl,tl,el=[],rl=[];Or.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Yr),t.length},Qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},nu.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=uu(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(eu(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ru(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(ru(this,e),n=e,e=n.U),e.C=!1,r.C=!0,eu(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,o=n.R;if(e=i?o?uu(o):i:o,u?u.L===n?u.L=e:u.R=e:this._=e,i&&o?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==o?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=o,o.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,eu(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ru(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,eu(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,ru(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,eu(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,ru(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},ta.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],u=a[0][1],i=a[1][0],o=a[1][1];return iu(e(n),a).cells.forEach(function(e,a){var c=e.edges,l=e.site,s=t[a]=c.length?c.map(function(n){var t=n.start();return[t.x,t.y]}):l.x>=r&&l.x<=i&&l.y>=u&&l.y<=o?[[r,o],[i,o],[i,u],[r,u]]:[];s.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/Ca)*Ca,y:Math.round(o(n,t)/Ca)*Ca,i:t}})}var r=Ar,u=Nr,i=r,o=u,a=ul;return n?t(n):(t.links=function(n){return iu(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return iu(e(n)).cells.forEach(function(e,r){for(var u,i,o=e.site,a=e.edges.sort(Yr),c=-1,l=a.length,s=a[l-1].edge,f=s.l===o?s.r:s.l;++c<l;)u=s,i=f,s=a[c].edge,f=s.l===o?s.r:s.l,r<i.i&&r<f.i&&au(o,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=Et(r=n),t):r},t.y=function(n){return arguments.length?(o=Et(u=n),t):u},t.clipExtent=function(n){return arguments.length?(a=null==n?ul:n,t):a===ul?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===ul?null:a&&a[1]},t)};var ul=[[-1e6,-1e6],[1e6,1e6]];ta.geom.delaunay=function(n){return ta.geom.voronoi().triangles(n)},ta.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var c=n.x,s=n.y;if(null!=c)if(ga(c-e)+ga(s-r)<.01)l(n,t,e,r,u,i,o,a);else{var f=n.point;n.x=n.y=n.point=null,l(n,f,c,s,u,i,o,a),l(n,t,e,r,u,i,o,a)}else n.x=e,n.y=r,n.point=t}else l(n,t,e,r,u,i,o,a)}function l(n,t,e,r,u,o,a,c){var l=.5*(u+a),s=.5*(o+c),f=e>=l,h=r>=s,g=h<<1|f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=su()),f?u=l:a=l,h?o=s:c=s,i(n,t,e,r,u,o,a,c)}var s,f,h,g,p,v,d,m,y,M=Et(a),x=Et(c);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,o)for(g=0;p>g;++g)s=n[g],s.x<v&&(v=s.x),s.y<d&&(d=s.y),s.x>m&&(m=s.x),s.y>y&&(y=s.y),f.push(s.x),h.push(s.y);else for(g=0;p>g;++g){var b=+M(s=n[g],g),_=+x(s,g);v>b&&(v=b),d>_&&(d=_),b>m&&(m=b),_>y&&(y=_),f.push(b),h.push(_)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=su();if(k.add=function(n){i(k,n,+M(n,++g),+x(n,g),v,d,m,y)},k.visit=function(n){fu(n,k,v,d,m,y)},k.find=function(n){return hu(k,n[0],n[1],v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=s=null,k}var o,a=Ar,c=Nr;return(o=arguments.length)?(a=cu,c=lu,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},ta.interpolateRgb=gu,ta.interpolateObject=pu,ta.interpolateNumber=vu,ta.interpolateString=du;var il=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ol=new RegExp(il.source,"g");ta.interpolate=mu,ta.interpolators=[function(n,t){var e=typeof t;return("string"===e?Ga.has(t)||/^(#|rgb\(|hsl\()/.test(t)?gu:du:t instanceof ot?gu:Array.isArray(t)?yu:"object"===e&&isNaN(t)?pu:vu)(n,t)}],ta.interpolateArray=yu;var al=function(){return y},cl=ta.map({linear:al,poly:ku,quad:function(){return _u},cubic:function(){return wu},sin:function(){return Eu},exp:function(){return Au},circle:function(){return Nu},elastic:Cu,back:zu,bounce:function(){return qu}}),ll=ta.map({"in":y,out:xu,"in-out":bu,"out-in":function(n){return bu(xu(n))}});ta.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=cl.get(e)||al,r=ll.get(r)||y,Mu(r(e.apply(null,ea.call(arguments,1))))},ta.interpolateHcl=Lu,ta.interpolateHsl=Tu,ta.interpolateLab=Ru,ta.interpolateRound=Du,ta.transform=function(n){var t=ua.createElementNS(ta.ns.prefix.svg,"g");return(ta.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Pu(e?e.matrix:sl)})(n)},Pu.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var sl={a:1,b:0,c:0,d:1,e:0,f:0};ta.interpolateTransform=Hu,ta.layout={},ta.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Yu(n[e]));return t}},ta.layout.chord=function(){function n(){var n,l,f,h,g,p={},v=[],d=ta.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(l=0,g=-1;++g<i;)l+=u[h][g];v.push(l),m.push(ta.range(i)),n+=l}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(La-s*i)/n,l=0,h=-1;++h<i;){for(f=l,g=-1;++g<i;){var y=d[h],M=m[y][g],x=u[y][M],b=l,_=l+=x*n;p[y+"-"+M]={index:y,subindex:M,startAngle:b,endAngle:_,value:x}}r[y]={index:y,startAngle:f,endAngle:l,value:(l-f)/n},l+=s}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,l={},s=0;return l.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,l):u},l.padding=function(n){return arguments.length?(s=n,e=r=null,l):s},l.sortGroups=function(n){return arguments.length?(o=n,e=r=null,l):o},l.sortSubgroups=function(n){return arguments.length?(a=n,e=null,l):a},l.sortChords=function(n){return arguments.length?(c=n,e&&t(),l):c},l.chords=function(){return e||n(),e},l.groups=function(){return r||n(),r},l},ta.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=u-e,c=i*i+o*o;if(c>a*a/d){if(p>c){var l=t.charge/c;n.px-=i*l,n.py-=o*l}return!0}if(t.point&&c&&p>c){var l=t.pointCharge/c;n.px-=i*l,n.py-=o*l}}return!t.charge}}function t(n){n.px=ta.event.x,n.py=ta.event.y,a.resume()}var e,r,u,i,o,a={},c=ta.dispatch("start","tick","end"),l=[1,1],s=.9,f=fl,h=hl,g=-30,p=gl,v=.1,d=.64,m=[],M=[];return a.tick=function(){if((r*=.99)<.005)return c.end({type:"end",alpha:r=0}),!0;var t,e,a,f,h,p,d,y,x,b=m.length,_=M.length;for(e=0;_>e;++e)a=M[e],f=a.source,h=a.target,y=h.x-f.x,x=h.y-f.y,(p=y*y+x*x)&&(p=r*i[e]*((p=Math.sqrt(p))-u[e])/p,y*=p,x*=p,h.x-=y*(d=f.weight/(h.weight+f.weight)),h.y-=x*d,f.x+=y*(d=1-d),f.y+=x*d);if((d=r*v)&&(y=l[0]/2,x=l[1]/2,e=-1,d))for(;++e<b;)a=m[e],a.x+=(y-a.x)*d,a.y+=(x-a.y)*d;if(g)for(Ju(t=ta.geom.quadtree(m),r,o),e=-1;++e<b;)(a=m[e]).fixed||t.visit(n(a));for(e=-1;++e<b;)a=m[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*s,a.y-=(a.py-(a.py=a.y))*s);c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(m=n,a):m},a.links=function(n){return arguments.length?(M=n,a):M},a.size=function(n){return arguments.length?(l=n,a):l},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(s=+n,a):s},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.chargeDistance=function(n){return arguments.length?(p=n*n,a):Math.sqrt(p)},a.gravity=function(n){return arguments.length?(v=+n,a):v},a.theta=function(n){return arguments.length?(d=n*n,a):Math.sqrt(d)},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),ta.timer(a.tick)),a):r},a.start=function(){function n(n,r){if(!e){for(e=new Array(c),a=0;c>a;++a)e[a]=[];for(a=0;s>a;++a){var u=M[a];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var i,o=e[t],a=-1,l=o.length;++a<l;)if(!isNaN(i=o[a][n]))return i;return Math.random()*r}var t,e,r,c=m.length,s=M.length,p=l[0],v=l[1];for(t=0;c>t;++t)(r=m[t]).index=t,r.weight=0;for(t=0;s>t;++t)r=M[t],"number"==typeof r.source&&(r.source=m[r.source]),"number"==typeof r.target&&(r.target=m[r.target]),++r.source.weight,++r.target.weight;for(t=0;c>t;++t)r=m[t],isNaN(r.x)&&(r.x=n("x",p)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof f)for(t=0;s>t;++t)u[t]=+f.call(this,M[t],t);else for(t=0;s>t;++t)u[t]=f;if(i=[],"function"==typeof h)for(t=0;s>t;++t)i[t]=+h.call(this,M[t],t);else for(t=0;s>t;++t)i[t]=h;if(o=[],"function"==typeof g)for(t=0;c>t;++t)o[t]=+g.call(this,m[t],t);else for(t=0;c>t;++t)o[t]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=ta.behavior.drag().origin(y).on("dragstart.force",Xu).on("drag.force",t).on("dragend.force",$u)),arguments.length?void this.on("mouseover.force",Bu).on("mouseout.force",Wu).call(e):e},ta.rebind(a,c,"on")};var fl=20,hl=1,gl=1/0;ta.layout.hierarchy=function(){function n(u){var i,o=[u],a=[];for(u.depth=0;null!=(i=o.pop());)if(a.push(i),(l=e.call(n,i,i.depth))&&(c=l.length)){for(var c,l,s;--c>=0;)o.push(s=l[c]),s.parent=i,s.depth=i.depth+1;r&&(i.value=0),i.children=l}else r&&(i.value=+r.call(n,i,i.depth)||0),delete i.children;return Qu(u,function(n){var e,u;t&&(e=n.children)&&e.sort(t),r&&(u=n.parent)&&(u.value+=n.value)}),a}var t=ei,e=ni,r=ti;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(Ku(t,function(n){n.children&&(n.value=0)}),Qu(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},ta.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,l=-1;for(r=t.value?r/t.value:0;++l<o;)n(a=i[l],e,c=a.value*r,u),e+=c}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=ta.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},Gu(e,r)},ta.layout.pie=function(){function n(o){var a,c=o.length,l=o.map(function(e,r){return+t.call(n,e,r)}),s=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof u?u.apply(this,arguments):u)-s,h=Math.min(Math.abs(f)/c,+("function"==typeof i?i.apply(this,arguments):i)),g=h*(0>f?-1:1),p=(f-c*g)/ta.sum(l),v=ta.range(c),d=[];return null!=e&&v.sort(e===pl?function(n,t){return l[t]-l[n]}:function(n,t){return e(o[n],o[t])}),v.forEach(function(n){d[n]={data:o[n],value:a=l[n],startAngle:s,endAngle:s+=a*p+g,padAngle:h}}),d}var t=Number,e=pl,r=0,u=La,i=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n.padAngle=function(t){return arguments.length?(i=t,n):i},n};var pl={};ta.layout.stack=function(){function n(a,c){if(!(h=a.length))return a;var l=a.map(function(e,r){return t.call(n,e,r)}),s=l.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,s,c);l=ta.permute(l,f),s=ta.permute(s,f);var h,g,p,v,d=r.call(n,s,c),m=l[0].length;for(p=0;m>p;++p)for(u.call(n,l[0][p],v=d[p],s[0][p][1]),g=1;h>g;++g)u.call(n,l[g][p],v+=s[g-1][p][1],s[g][p][1]);return a}var t=y,e=ai,r=ci,u=oi,i=ui,o=ii;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:vl.get(t)||ai,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:dl.get(t)||ci,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var vl=ta.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(li),i=n.map(si),o=ta.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,l=[],s=[];for(t=0;r>t;++t)e=o[t],c>a?(a+=i[e],l.push(e)):(c+=i[e],s.push(e));return s.reverse().concat(l)},reverse:function(n){return ta.range(n.length).reverse()},"default":ai}),dl=ta.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;i>e;++e)c[e]=(a-o[e])/2;return c},wiggle:function(n){var t,e,r,u,i,o,a,c,l,s=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=l=0,e=1;h>e;++e){for(t=0,u=0;s>t;++t)u+=n[t][e][1];for(t=0,i=0,a=f[e][0]-f[e-1][0];s>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,l>c&&(l=c)}for(e=0;h>e;++e)g[e]-=l;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=o}for(e=0;i>e;++e)a[e]=0;return a},zero:ci});ta.layout.histogram=function(){function n(n,i){for(var o,a,c=[],l=n.map(e,this),s=r.call(this,l,i),f=u.call(this,s,l,i),i=-1,h=l.length,g=f.length-1,p=t?1:1/h;++i<g;)o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0;if(g>0)for(i=-1;++i<h;)a=l[i],a>=s[0]&&a<=s[1]&&(o=c[ta.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]));return c}var t=!0,e=Number,r=pi,u=hi;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=Et(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return gi(n,t)}:Et(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},ta.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],l=u[1],s=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Qu(a,function(n){n.r=+s(n.value)}),Qu(a,Mi),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/l))/2;Qu(a,function(n){n.r+=f}),Qu(a,Mi),Qu(a,function(n){n.r-=f})}return _i(a,c/2,l/2,t?1:1/Math.max(2*a.r/c,2*a.r/l)),o}var t,e=ta.layout.hierarchy().sort(vi),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},Gu(n,e)},ta.layout.tree=function(){function n(n,u){var s=o.call(this,n,u),f=s[0],h=t(f);if(Qu(h,e),h.parent.m=-h.z,Ku(h,r),l)Ku(f,i);else{var g=f,p=f,v=f;Ku(f,function(n){n.x<g.x&&(g=n),n.x>p.x&&(p=n),n.depth>v.depth&&(v=n)});var d=a(g,p)/2-g.x,m=c[0]/(p.x+a(p,g)/2+d),y=c[1]/(v.depth||1);Ku(f,function(n){n.x=(n.x+d)*m,n.y=n.depth*y})}return s}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var u,i=t.children,o=0,a=i.length;a>o;++o)r.push((i[o]=u={_:i[o],parent:t,children:(u=i[o].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=u);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Ni(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+a(n._,r._));n.parent.A=u(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,t,e){if(t){for(var r,u=n,i=n,o=t,c=u.parent.children[0],l=u.m,s=i.m,f=o.m,h=c.m;o=Ei(o),u=ki(u),o&&u;)c=ki(c),i=Ei(i),i.a=n,r=o.z+f-u.z-l+a(o._,u._),r>0&&(Ai(Ci(o,n,e),n,r),l+=r,s+=r),f+=o.m,l+=u.m,h+=c.m,s+=i.m;o&&!Ei(i)&&(i.t=o,i.m+=f-s),u&&!ki(c)&&(c.t=u,c.m+=l-h,e=n)}return e}function i(n){n.x*=c[0],n.y=n.depth*c[1]}var o=ta.layout.hierarchy().sort(null).value(null),a=Si,c=[1,1],l=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(l=null==(c=t)?i:null,n):l?null:c},n.nodeSize=function(t){return arguments.length?(l=null==(c=t)?null:i,n):l?c:null},Gu(n,o)},ta.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],l=0;Qu(c,function(n){var t=n.children;t&&t.length?(n.x=qi(t),n.y=zi(t)):(n.x=o?l+=e(n,o):0,n.y=0,o=n)});var s=Li(c),f=Ti(c),h=s.x-e(s,f)/2,g=f.x+e(f,s)/2;return Qu(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=ta.layout.hierarchy().sort(null).value(null),e=Si,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},Gu(n,t)},ta.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var o,a,c,l=f(e),s=[],h=i.slice(),p=1/0,v="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(n(h,l.dx*l.dy/e.value),s.area=0;(c=h.length)>0;)s.push(o=h[c-1]),s.area+=o.area,"squarify"!==g||(a=r(s,v))<=p?(h.pop(),p=a):(s.area-=s.pop().area,u(s,v,l,!1),v=Math.min(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(u(s,v,l,!0),s.length=s.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();)c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,l=e.y,s=t?c(n.area/t):0;if(t==e.dx){for((r||s>e.dy)&&(s=e.dy);++i<o;)u=n[i],u.x=a,u.y=l,u.dy=s,a+=u.dx=Math.min(e.x+e.dx-a,s?c(u.area/s):0);u.z=!0,u.dx+=e.x+e.dx-a,e.y+=s,e.dy-=s}else{for((r||s>e.dx)&&(s=e.dx);++i<o;)u=n[i],u.x=a,u.y=l,u.dx=s,l+=u.dy=Math.min(e.y+e.dy-l,s?c(u.area/s):0);u.z=!1,u.dy+=e.y+e.dy-l,e.x+=s,e.dx-=s}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=l[0],i.dy=l[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=ta.layout.hierarchy(),c=Math.round,l=[1,1],s=null,f=Ri,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));
return i.size=function(n){return arguments.length?(l=n,i):l},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Ri(t):Di(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Di(t,n)}if(!arguments.length)return s;var r;return f=null==(s=n)?Ri:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},Gu(i,a)},ta.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=ta.random.normal.apply(ta,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=ta.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},ta.scale={};var ml={floor:y,ceil:y};ta.scale.linear=function(){return Ii([0,1],[0,1],mu,!1)};var yl={s:1,g:1,p:1,r:1,e:1};ta.scale.log=function(){return Ji(ta.scale.linear().domain([0,1]),10,!0,[1,10])};var Ml=ta.format(".0e"),xl={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};ta.scale.pow=function(){return Gi(ta.scale.linear(),1,[0,1])},ta.scale.sqrt=function(){return ta.scale.pow().exponent(.5)},ta.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},ta.scale.category10=function(){return ta.scale.ordinal().range(bl)},ta.scale.category20=function(){return ta.scale.ordinal().range(_l)},ta.scale.category20b=function(){return ta.scale.ordinal().range(wl)},ta.scale.category20c=function(){return ta.scale.ordinal().range(Sl)};var bl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Mt),_l=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Mt),wl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Mt),Sl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Mt);ta.scale.quantile=function(){return no([],[])},ta.scale.quantize=function(){return to(0,1,[0,1])},ta.scale.threshold=function(){return eo([.5],[0,1])},ta.scale.identity=function(){return ro([0,1])},ta.svg={},ta.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),l=Math.max(0,+r.apply(this,arguments)),s=o.apply(this,arguments)-Ra,f=a.apply(this,arguments)-Ra,h=Math.abs(f-s),g=s>f?0:1;if(n>l&&(p=l,l=n,n=p),h>=Ta)return t(l,g)+(n?t(n,1-g):"")+"Z";var p,v,d,m,y,M,x,b,_,w,S,k,E=0,A=0,N=[];if((m=(+c.apply(this,arguments)||0)/2)&&(d=i===kl?Math.sqrt(n*n+l*l):+i.apply(this,arguments),g||(A*=-1),l&&(A=tt(d/l*Math.sin(m))),n&&(E=tt(d/n*Math.sin(m)))),l){y=l*Math.cos(s+A),M=l*Math.sin(s+A),x=l*Math.cos(f-A),b=l*Math.sin(f-A);var C=Math.abs(f-s-2*A)<=qa?0:1;if(A&&so(y,M,x,b)===g^C){var z=(s+f)/2;y=l*Math.cos(z),M=l*Math.sin(z),x=b=null}}else y=M=0;if(n){_=n*Math.cos(f-E),w=n*Math.sin(f-E),S=n*Math.cos(s+E),k=n*Math.sin(s+E);var q=Math.abs(s-f+2*E)<=qa?0:1;if(E&&so(_,w,S,k)===1-g^q){var L=(s+f)/2;_=n*Math.cos(L),w=n*Math.sin(L),S=k=null}}else _=w=0;if((p=Math.min(Math.abs(l-n)/2,+u.apply(this,arguments)))>.001){v=l>n^g?0:1;var T=null==S?[_,w]:null==x?[y,M]:Lr([y,M],[S,k],[x,b],[_,w]),R=y-T[0],D=M-T[1],P=x-T[0],U=b-T[1],j=1/Math.sin(Math.acos((R*P+D*U)/(Math.sqrt(R*R+D*D)*Math.sqrt(P*P+U*U)))/2),F=Math.sqrt(T[0]*T[0]+T[1]*T[1]);if(null!=x){var H=Math.min(p,(l-F)/(j+1)),O=fo(null==S?[_,w]:[S,k],[y,M],l,H,g),I=fo([x,b],[_,w],l,H,g);p===H?N.push("M",O[0],"A",H,",",H," 0 0,",v," ",O[1],"A",l,",",l," 0 ",1-g^so(O[1][0],O[1][1],I[1][0],I[1][1]),",",g," ",I[1],"A",H,",",H," 0 0,",v," ",I[0]):N.push("M",O[0],"A",H,",",H," 0 1,",v," ",I[0])}else N.push("M",y,",",M);if(null!=S){var Y=Math.min(p,(n-F)/(j-1)),Z=fo([y,M],[S,k],n,-Y,g),V=fo([_,w],null==x?[y,M]:[x,b],n,-Y,g);p===Y?N.push("L",V[0],"A",Y,",",Y," 0 0,",v," ",V[1],"A",n,",",n," 0 ",g^so(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-g," ",Z[1],"A",Y,",",Y," 0 0,",v," ",Z[0]):N.push("L",V[0],"A",Y,",",Y," 0 0,",v," ",Z[0])}else N.push("L",_,",",w)}else N.push("M",y,",",M),null!=x&&N.push("A",l,",",l," 0 ",C,",",g," ",x,",",b),N.push("L",_,",",w),null!=S&&N.push("A",n,",",n," 0 ",q,",",1-g," ",S,",",k);return N.push("Z"),N.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=io,r=oo,u=uo,i=kl,o=ao,a=co,c=lo;return n.innerRadius=function(t){return arguments.length?(e=Et(t),n):e},n.outerRadius=function(t){return arguments.length?(r=Et(t),n):r},n.cornerRadius=function(t){return arguments.length?(u=Et(t),n):u},n.padRadius=function(t){return arguments.length?(i=t==kl?kl:Et(t),n):i},n.startAngle=function(t){return arguments.length?(o=Et(t),n):o},n.endAngle=function(t){return arguments.length?(a=Et(t),n):a},n.padAngle=function(t){return arguments.length?(c=Et(t),n):c},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Ra;return[Math.cos(t)*n,Math.sin(t)*n]},n};var kl="auto";ta.svg.line=function(){return ho(y)};var El=ta.map({linear:go,"linear-closed":po,step:vo,"step-before":mo,"step-after":yo,basis:So,"basis-open":ko,"basis-closed":Eo,bundle:Ao,cardinal:bo,"cardinal-open":Mo,"cardinal-closed":xo,monotone:To});El.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Al=[0,2/3,1/3,0],Nl=[0,1/3,2/3,0],Cl=[0,1/6,2/3,1/6];ta.svg.line.radial=function(){var n=ho(Ro);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},mo.reverse=yo,yo.reverse=mo,ta.svg.area=function(){return Do(y)},ta.svg.area.radial=function(){var n=Do(Ro);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},ta.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),l=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,l)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)-Ra,s=l.call(n,u,r)-Ra;return{r:i,a0:o,a1:s,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(s),i*Math.sin(s)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>qa)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=mr,o=yr,a=Po,c=ao,l=co;return n.radius=function(t){return arguments.length?(a=Et(t),n):a},n.source=function(t){return arguments.length?(i=Et(t),n):i},n.target=function(t){return arguments.length?(o=Et(t),n):o},n.startAngle=function(t){return arguments.length?(c=Et(t),n):c},n.endAngle=function(t){return arguments.length?(l=Et(t),n):l},n},ta.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=mr,e=yr,r=Uo;return n.source=function(e){return arguments.length?(t=Et(e),n):t},n.target=function(t){return arguments.length?(e=Et(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},ta.svg.diagonal.radial=function(){var n=ta.svg.diagonal(),t=Uo,e=n.projection;return n.projection=function(n){return arguments.length?e(jo(t=n)):t},n},ta.svg.symbol=function(){function n(n,r){return(zl.get(t.call(this,n,r))||Oo)(e.call(this,n,r))}var t=Ho,e=Fo;return n.type=function(e){return arguments.length?(t=Et(e),n):t},n.size=function(t){return arguments.length?(e=Et(t),n):e},n};var zl=ta.map({circle:Oo,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*Ll)),e=t*Ll;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/ql),e=t*ql/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/ql),e=t*ql/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});ta.svg.symbolTypes=zl.keys();var ql=Math.sqrt(3),Ll=Math.tan(30*Da);_a.transition=function(n){for(var t,e,r=Tl||++Ul,u=Xo(n),i=[],o=Rl||{time:Date.now(),ease:Su,delay:0,duration:250},a=-1,c=this.length;++a<c;){i.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(e=l[s])&&$o(e,s,u,r,o),t.push(e)}return Yo(i,u,r)},_a.interrupt=function(n){return this.each(null==n?Dl:Io(Xo(n)))};var Tl,Rl,Dl=Io(Xo()),Pl=[],Ul=0;Pl.call=_a.call,Pl.empty=_a.empty,Pl.node=_a.node,Pl.size=_a.size,ta.transition=function(n,t){return n&&n.transition?Tl?n.transition(t):n:ta.selection().transition(n)},ta.transition.prototype=Pl,Pl.select=function(n){var t,e,r,u=this.id,i=this.namespace,o=[];n=N(n);for(var a=-1,c=this.length;++a<c;){o.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(r=l[s])&&(e=n.call(r,r.__data__,s,a))?("__data__"in r&&(e.__data__=r.__data__),$o(e,s,i,u,r[i][u]),t.push(e)):t.push(null)}return Yo(o,i,u)},Pl.selectAll=function(n){var t,e,r,u,i,o=this.id,a=this.namespace,c=[];n=C(n);for(var l=-1,s=this.length;++l<s;)for(var f=this[l],h=-1,g=f.length;++h<g;)if(r=f[h]){i=r[a][o],e=n.call(r,r.__data__,h,l),c.push(t=[]);for(var p=-1,v=e.length;++p<v;)(u=e[p])&&$o(u,p,a,o,i),t.push(u)}return Yo(c,a,o)},Pl.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=O(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return Yo(u,this.namespace,this.id)},Pl.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):Y(this,null==t?function(t){t[r][e].tween.remove(n)}:function(u){u[r][e].tween.set(n,t)})},Pl.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?Hu:mu,a=ta.ns.qualify(n);return Zo(this,"attr."+n,t,a.local?i:u)},Pl.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=ta.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Pl.style=function(n,e,r){function u(){this.style.removeProperty(n)}function i(e){return null==e?u:(e+="",function(){var u,i=t(this).getComputedStyle(this,null).getPropertyValue(n);return i!==e&&(u=mu(i,e),function(t){this.style.setProperty(n,u(t),r)})})}var o=arguments.length;if(3>o){if("string"!=typeof n){2>o&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Zo(this,"style."+n,e,i)},Pl.styleTween=function(n,e,r){function u(u,i){var o=e.call(this,u,i,t(this).getComputedStyle(this,null).getPropertyValue(n));return o&&function(t){this.style.setProperty(n,o(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+n,u)},Pl.text=function(n){return Zo(this,"text",n,Vo)},Pl.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Pl.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=ta.ease.apply(ta,arguments)),Y(this,function(r){r[e][t].ease=n}))},Pl.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:Y(this,"function"==typeof n?function(r,u,i){r[e][t].delay=+n.call(r,r.__data__,u,i)}:(n=+n,function(r){r[e][t].delay=n}))},Pl.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:Y(this,"function"==typeof n?function(r,u,i){r[e][t].duration=Math.max(1,n.call(r,r.__data__,u,i))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Pl.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var u=Rl,i=Tl;try{Tl=e,Y(this,function(t,u,i){Rl=t[r][e],n.call(t,t.__data__,u,i)})}finally{Rl=u,Tl=i}}else Y(this,function(u){var i=u[r][e];(i.event||(i.event=ta.dispatch("start","end","interrupt"))).on(n,t)});return this},Pl.transition=function(){for(var n,t,e,r,u=this.id,i=++Ul,o=this.namespace,a=[],c=0,l=this.length;l>c;c++){a.push(n=[]);for(var t=this[c],s=0,f=t.length;f>s;s++)(e=t[s])&&(r=e[o][u],$o(e,s,o,i,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Yo(a,o,i)},ta.svg.axis=function(){function n(n){n.each(function(){var n,l=ta.select(this),s=this.__chart__||e,f=this.__chart__=e.copy(),h=null==c?f.ticks?f.ticks.apply(f,a):f.domain():c,g=null==t?f.tickFormat?f.tickFormat.apply(f,a):y:t,p=l.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Ca),d=ta.transition(p.exit()).style("opacity",Ca).remove(),m=ta.transition(p.order()).style("opacity",1),M=Math.max(u,0)+o,x=Ui(f),b=l.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),ta.transition(b));v.append("line"),v.append("text");var w,S,k,E,A=v.select("line"),N=m.select("line"),C=p.select("text").text(g),z=v.select("text"),q=m.select("text"),L="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=Bo,w="x",k="y",S="x2",E="y2",C.attr("dy",0>L?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+L*i+"V0H"+x[1]+"V"+L*i)):(n=Wo,w="y",k="x",S="y2",E="x2",C.attr("dy",".32em").style("text-anchor",0>L?"end":"start"),_.attr("d","M"+L*i+","+x[0]+"H0V"+x[1]+"H"+L*i)),A.attr(E,L*u),z.attr(k,L*M),N.attr(S,0).attr(E,L*u),q.attr(w,0).attr(k,L*M),f.rangeBand){var T=f,R=T.rangeBand()/2;s=f=function(n){return T(n)+R}}else s.rangeBand?s=f:d.call(n,f,s);v.call(n,s,f),m.call(n,f,f)})}var t,e=ta.scale.linear(),r=jl,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Fl?t+"":jl,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var jl="bottom",Fl={top:1,right:1,bottom:1,left:1};ta.svg.brush=function(){function n(t){t.each(function(){var t=ta.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),o=t.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=t.selectAll(".resize").data(v,y);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Hl[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var c,f=ta.transition(t),h=ta.transition(o);l&&(c=Ui(l),h.attr("x",c[0]).attr("width",c[1]-c[0]),r(f)),s&&(c=Ui(s),h.attr("y",c[0]).attr("height",c[1]-c[0]),u(f)),e(f)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+f[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",f[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1]-f[0])}function u(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function i(){function i(){32==ta.event.keyCode&&(C||(M=null,q[0]-=f[1],q[1]-=h[1],C=2),S())}function v(){32==ta.event.keyCode&&2==C&&(q[0]+=f[1],q[1]+=h[1],C=0,S())}function d(){var n=ta.mouse(b),t=!1;x&&(n[0]+=x[0],n[1]+=x[1]),C||(ta.event.altKey?(M||(M=[(f[0]+f[1])/2,(h[0]+h[1])/2]),q[0]=f[+(n[0]<M[0])],q[1]=h[+(n[1]<M[1])]):M=null),A&&m(n,l,0)&&(r(k),t=!0),N&&m(n,s,1)&&(u(k),t=!0),t&&(e(k),w({type:"brush",mode:C?"move":"resize"}))}function m(n,t,e){var r,u,i=Ui(t),c=i[0],l=i[1],s=q[e],v=e?h:f,d=v[1]-v[0];return C&&(c-=s,l-=d+s),r=(e?p:g)?Math.max(c,Math.min(l,n[e])):n[e],C?u=(r+=s)+d:(M&&(s=Math.max(c,Math.min(l,2*M[e]-r))),r>s?(u=r,r=s):u=s),v[0]!=r||v[1]!=u?(e?a=null:o=null,v[0]=r,v[1]=u,!0):void 0}function y(){d(),k.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),ta.select("body").style("cursor",null),L.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),w({type:"brushend"})}var M,x,b=this,_=ta.select(ta.event.target),w=c.of(b,arguments),k=ta.select(b),E=_.datum(),A=!/^(n|s)$/.test(E)&&l,N=!/^(e|w)$/.test(E)&&s,C=_.classed("extent"),z=W(b),q=ta.mouse(b),L=ta.select(t(b)).on("keydown.brush",i).on("keyup.brush",v);if(ta.event.changedTouches?L.on("touchmove.brush",d).on("touchend.brush",y):L.on("mousemove.brush",d).on("mouseup.brush",y),k.interrupt().selectAll("*").interrupt(),C)q[0]=f[0]-q[0],q[1]=h[0]-q[1];else if(E){var T=+/w$/.test(E),R=+/^n/.test(E);x=[f[1-T]-q[0],h[1-R]-q[1]],q[0]=f[T],q[1]=h[R]}else ta.event.altKey&&(M=q.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),ta.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),d()}var o,a,c=E(n,"brushstart","brush","brushend"),l=null,s=null,f=[0,0],h=[0,0],g=!0,p=!0,v=Ol[0];return n.event=function(n){n.each(function(){var n=c.of(this,arguments),t={x:f,y:h,i:o,j:a},e=this.__chart__||t;this.__chart__=t,Tl?ta.select(this).transition().each("start.brush",function(){o=e.i,a=e.j,f=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=yu(f,t.x),r=yu(h,t.y);return o=a=null,function(u){f=t.x=e(u),h=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(l=t,v=Ol[!l<<1|!s],n):l},n.y=function(t){return arguments.length?(s=t,v=Ol[!l<<1|!s],n):s},n.clamp=function(t){return arguments.length?(l&&s?(g=!!t[0],p=!!t[1]):l?g=!!t:s&&(p=!!t),n):l&&s?[g,p]:l?g:s?p:null},n.extent=function(t){var e,r,u,i,c;return arguments.length?(l&&(e=t[0],r=t[1],s&&(e=e[0],r=r[0]),o=[e,r],l.invert&&(e=l(e),r=l(r)),e>r&&(c=e,e=r,r=c),(e!=f[0]||r!=f[1])&&(f=[e,r])),s&&(u=t[0],i=t[1],l&&(u=u[1],i=i[1]),a=[u,i],s.invert&&(u=s(u),i=s(i)),u>i&&(c=u,u=i,i=c),(u!=h[0]||i!=h[1])&&(h=[u,i])),n):(l&&(o?(e=o[0],r=o[1]):(e=f[0],r=f[1],l.invert&&(e=l.invert(e),r=l.invert(r)),e>r&&(c=e,e=r,r=c))),s&&(a?(u=a[0],i=a[1]):(u=h[0],i=h[1],s.invert&&(u=s.invert(u),i=s.invert(i)),u>i&&(c=u,u=i,i=c))),l&&s?[[e,u],[r,i]]:l?[e,r]:s&&[u,i])},n.clear=function(){return n.empty()||(f=[0,0],h=[0,0],o=a=null),n},n.empty=function(){return!!l&&f[0]==f[1]||!!s&&h[0]==h[1]},ta.rebind(n,c,"on")};var Hl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ol=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Il=ac.format=gc.timeFormat,Yl=Il.utc,Zl=Yl("%Y-%m-%dT%H:%M:%S.%LZ");Il.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Jo:Zl,Jo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Jo.toString=Zl.toString,ac.second=Ft(function(n){return new cc(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),ac.seconds=ac.second.range,ac.seconds.utc=ac.second.utc.range,ac.minute=Ft(function(n){return new cc(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),ac.minutes=ac.minute.range,ac.minutes.utc=ac.minute.utc.range,ac.hour=Ft(function(n){var t=n.getTimezoneOffset()/60;return new cc(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),ac.hours=ac.hour.range,ac.hours.utc=ac.hour.utc.range,ac.month=Ft(function(n){return n=ac.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),ac.months=ac.month.range,ac.months.utc=ac.month.utc.range;var Vl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Xl=[[ac.second,1],[ac.second,5],[ac.second,15],[ac.second,30],[ac.minute,1],[ac.minute,5],[ac.minute,15],[ac.minute,30],[ac.hour,1],[ac.hour,3],[ac.hour,6],[ac.hour,12],[ac.day,1],[ac.day,2],[ac.week,1],[ac.month,1],[ac.month,3],[ac.year,1]],$l=Il.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",Ne]]),Bl={range:function(n,t,e){return ta.range(Math.ceil(n/e)*e,+t,e).map(Ko)},floor:y,ceil:y};Xl.year=ac.year,ac.scale=function(){return Go(ta.scale.linear(),Xl,$l)};var Wl=Xl.map(function(n){return[n[0].utc,n[1]]}),Jl=Yl.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",Ne]]);Wl.year=ac.year.utc,ac.scale.utc=function(){return Go(ta.scale.linear(),Wl,Jl)},ta.text=At(function(n){return n.responseText}),ta.json=function(n,t){return Nt(n,"application/json",Qo,t)},ta.html=function(n,t){return Nt(n,"text/html",na,t)},ta.xml=At(function(n){return n.responseXML}),"function"==typeof define&&define.amd?define(ta):"object"==typeof module&&module.exports&&(module.exports=ta),this.d3=ta}();
//-->
</script>
<script>
function s(x) {return 1/(1+Math.exp(-x));}
var m = [40, 120, 50, 120];
var height = 290 - m[0] - m[2];
var width = 600 - m[1] - m[3];
var xmin = -5;
var xmax = 5;
var sample = 400;
var x1 = d3.scale.linear().domain([0, sample]).range([xmin, xmax]);
var data = d3.range(sample).map(function(d){ return {
        x: x1(d), 
        y: s(x1(d))}; 
    });
var x = d3.scale.linear().domain([xmin, xmax]).range([0, width]);
var y = d3.scale.linear()
                .domain([0, 1])
                .range([height, 0]);
var line = d3.svg.line()
    .x(function(d) { return x(d.x); })
    .y(function(d) { return y(d.y); })
var graph = d3.select("#sigmoid_graph")
    .append("svg")
    .attr("width", width + m[1] + m[3])
    .attr("height", height + m[0] + m[2])
    .append("g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");
var xAxis = d3.svg.axis()
                  .scale(x)
                  .tickValues(d3.range(-4, 5, 1))
                  .orient("bottom")
graph.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, " + height + ")")
    .call(xAxis);
var yAxis = d3.svg.axis()
                  .scale(y)
                  .tickValues(d3.range(0, 1.01, 0.2))
                  .orient("left")
                  .ticks(5)
graph.append("g")
    .attr("class", "y axis")
    .call(yAxis);
graph.append("path").attr("d", line(data));
graph.append("text")
     .attr("class", "x label")
     .attr("text-anchor", "end")
     .attr("x", width/2)
     .attr("y", height+35)
     .text("z");
graph.append("text")
        .attr("x", (width / 2))             
        .attr("y", -10)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .text("sigmoid function");
</script>
<p></p><p>This shape is a smoothed out version of a step function:</p><p>
</p><div id="step_graph"><svg width="600" height="290"><g transform="translate(120,40)"><g class="x axis" transform="translate(0, 200)"><g class="tick" transform="translate(36,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-4</text></g><g class="tick" transform="translate(72,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-3</text></g><g class="tick" transform="translate(108,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-2</text></g><g class="tick" transform="translate(144,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">-1</text></g><g class="tick" transform="translate(180,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">0</text></g><g class="tick" transform="translate(216,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">1</text></g><g class="tick" transform="translate(251.99999999999997,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">2</text></g><g class="tick" transform="translate(288,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">3</text></g><g class="tick" transform="translate(324,0)" style="opacity: 1;"><line y2="6" x2="0"></line><text dy=".71em" y="9" x="0" style="text-anchor: middle;">4</text></g><path class="domain" d="M0,6V0H360V6"></path></g><g class="y axis"><g class="tick" transform="translate(0,200)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.0</text></g><g class="tick" transform="translate(0,160)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.2</text></g><g class="tick" transform="translate(0,120)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.4</text></g><g class="tick" transform="translate(0,80)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.6</text></g><g class="tick" transform="translate(0,39.99999999999999)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">0.8</text></g><g class="tick" transform="translate(0,0)" style="opacity: 1;"><line x2="-6" y2="0"></line><text dy=".32em" x="-9" y="0" style="text-anchor: end;">1.0</text></g><path class="domain" d="M-6,0H0V200H-6"></path></g><path d="M0,200L0.8999999999999808,200L1.8000000000000256,200L2.6999999999999744,200L3.5999999999999868,200L4.5,200L5.400000000000013,200L6.299999999999993,200L7.1999999999999735,200L8.099999999999987,200L9,200L9.900000000000013,200L10.800000000000026,200L11.699999999999976,200L12.599999999999985,200L13.5,200L14.400000000000013,200L15.300000000000026,200L16.200000000000006,200L17.099999999999987,200L18,200L18.900000000000013,200L19.800000000000026,200L20.699999999999974,200L21.60000000000002,200L22.5,200L23.39999999999998,200L24.300000000000026,200L25.200000000000006,200L26.099999999999987,200L27,200L27.900000000000016,200L28.799999999999997,200L29.699999999999978,200L30.599999999999987,200L31.499999999999996,200L32.40000000000001,200L33.300000000000026,200L34.199999999999974,200L35.09999999999999,200L36,200L36.90000000000001,200L37.80000000000001,200L38.700000000000024,200L39.59999999999999,200L40.5,200L41.40000000000001,200L42.299999999999976,200L43.19999999999999,200L44.10000000000002,200L45,200L45.89999999999998,200L46.80000000000001,200L47.700000000000024,200L48.59999999999998,200L49.50000000000001,200L50.40000000000001,200L51.299999999999976,200L52.19999999999999,200L53.09999999999999,200L54,200L54.900000000000006,200L55.80000000000001,200L56.69999999999999,200L57.599999999999994,200L58.5,200L59.40000000000001,200L60.30000000000001,200L61.200000000000024,200L62.09999999999999,200L62.99999999999999,200L63.90000000000002,200L64.79999999999998,200L65.69999999999999,200L66.60000000000002,200L67.5,200L68.39999999999998,200L69.30000000000001,200L70.20000000000002,200L71.09999999999998,200L72,200L72.90000000000002,200L73.8,200L74.7,200L75.6,200L76.5,200L77.39999999999998,200L78.30000000000001,200L79.19999999999999,200L80.10000000000002,200L81,200L81.9,200L82.8,200L83.7,200L84.59999999999998,200L85.5,200L86.40000000000002,200L87.29999999999998,200L88.2,200L89.10000000000002,200L90,200L90.89999999999998,200L91.8,200L92.70000000000002,200L93.59999999999998,200L94.5,200L95.4,200L96.30000000000003,200L97.2,200L98.1,200L99.00000000000001,200L99.9,200L100.80000000000003,200L101.69999999999997,200L102.6,200L103.49999999999999,200L104.4,200L105.3,200L106.19999999999997,200L107.1,200L108,200L108.90000000000002,200L109.79999999999998,200L110.7,200L111.60000000000002,200L112.5,200L113.39999999999998,200L114.3,200L115.20000000000002,200L116.09999999999998,200L117,200L117.9,200L118.80000000000003,200L119.7,200L120.6,200L121.50000000000001,200L122.4,200L123.30000000000003,200L124.19999999999997,200L125.1,200L125.99999999999999,200L126.9,200L127.8,200L128.7,200L129.6,200L130.5,200L131.4,200L132.29999999999998,200L133.2,200L134.10000000000002,200L135,200L135.89999999999998,200L136.8,200L137.70000000000002,200L138.6,200L139.5,200L140.4,200L141.3,200L142.20000000000002,200L143.1,200L144,200L144.9,200L145.80000000000004,200L146.69999999999996,200L147.6,200L148.5,200L149.4,200L150.29999999999998,200L151.2,200L152.1,200L153,200L153.9,200L154.79999999999995,200L155.7,200L156.59999999999997,200L157.5,200L158.40000000000003,200L159.3,200L160.20000000000005,200L161.1,200L162,200L162.9,200L163.8,200L164.70000000000002,200L165.6,200L166.5,200L167.4,200L168.30000000000004,200L169.19999999999996,200L170.1,200L171,200L171.9,200L172.79999999999998,200L173.7,200L174.6,200L175.5,200L176.4,200L177.29999999999995,200L178.2,200L179.09999999999997,200L180,0L180.89999999999998,0L181.8,0L182.7,0L183.6,0L184.49999999999997,0L185.4,0L186.29999999999998,0L187.20000000000002,0L188.1,0L189,0L189.89999999999998,0L190.8,0L191.7,0L192.60000000000002,0L193.5,0L194.4,0L195.29999999999998,0L196.20000000000002,0L197.1,0L198.00000000000003,0L198.9,0L199.8,0L200.7,0L201.60000000000002,0L202.5,0L203.39999999999998,0L204.3,0L205.2,0L206.1,0L206.99999999999997,0L207.9,0L208.79999999999998,0L209.70000000000002,0L210.6,0L211.5,0L212.39999999999998,0L213.3,0L214.2,0L215.10000000000002,0L216,0L216.9,0L217.79999999999998,0L218.70000000000002,0L219.6,0L220.50000000000003,0L221.4,0L222.3,0L223.2,0L224.10000000000002,0L225,0L225.89999999999998,0L226.8,0L227.7,0L228.6,0L229.49999999999997,0L230.4,0L231.29999999999998,0L232.20000000000002,0L233.1,0L234,0L234.89999999999998,0L235.8,0L236.7,0L237.60000000000002,0L238.5,0L239.4,0L240.29999999999998,0L241.20000000000002,0L242.1,0L243.00000000000003,0L243.9,0L244.8,0L245.7,0L246.60000000000002,0L247.5,0L248.39999999999998,0L249.3,0L250.2,0L251.1,0L251.99999999999997,0L252.9,0L253.79999999999998,0L254.70000000000002,0L255.6,0L256.5,0L257.4,0L258.3,0L259.2,0L260.1,0L261,0L261.90000000000003,0L262.8,0L263.7,0L264.6,0L265.5,0L266.4,0L267.3,0L268.2,0L269.1,0L270,0L270.9,0L271.8,0L272.7,0L273.6,0L274.5,0L275.4,0L276.3,0L277.2,0L278.09999999999997,0L279,0L279.9,0L280.8,0L281.7,0L282.6,0L283.5,0L284.40000000000003,0L285.3,0L286.2,0L287.1,0L288,0L288.9,0L289.8,0L290.69999999999993,0L291.6000000000001,0L292.5,0L293.3999999999999,0L294.30000000000007,0L295.2,0L296.1,0L297,0L297.9,0L298.79999999999995,0L299.7,0L300.59999999999997,0L301.5,0L302.40000000000003,0L303.3,0L304.2,0L305.09999999999997,0L306,0L306.90000000000003,0L307.8,0L308.70000000000005,0L309.6,0L310.5,0L311.4,0L312.3,0L313.19999999999993,0L314.1000000000001,0L315,0L315.8999999999999,0L316.80000000000007,0L317.7,0L318.6,0L319.5,0L320.4,0L321.29999999999995,0L322.2,0L323.09999999999997,0L324,0L324.90000000000003,0L325.8,0L326.7,0L327.59999999999997,0L328.5,0L329.40000000000003,0L330.3,0L331.20000000000005,0L332.1,0L333,0L333.9,0L334.8,0L335.69999999999993,0L336.6000000000001,0L337.5,0L338.3999999999999,0L339.30000000000007,0L340.2,0L341.1,0L342,0L342.9,0L343.79999999999995,0L344.7,0L345.59999999999997,0L346.5,0L347.40000000000003,0L348.3,0L349.2,0L350.09999999999997,0L351,0L351.90000000000003,0L352.8,0L353.70000000000005,0L354.6,0L355.5,0L356.4,0L357.3,0L358.19999999999993,0L359.1000000000001,0"></path><text class="x label" text-anchor="end" x="180" y="235">z</text><text x="180" y="-10" text-anchor="middle" style="font-size: 16px;">step function</text></g></svg></div>
<script>
function s(x) {return x < 0 ? 0 : 1;}
var m = [40, 120, 50, 120];
var height = 290 - m[0] - m[2];
var width = 600 - m[1] - m[3];
var xmin = -5;
var xmax = 5;
var sample = 400;
var x1 = d3.scale.linear().domain([0, sample]).range([xmin, xmax]);
var data = d3.range(sample).map(function(d){ return {
        x: x1(d), 
        y: s(x1(d))}; 
    });
var x = d3.scale.linear().domain([xmin, xmax]).range([0, width]);
var y = d3.scale.linear()
                .domain([0,1])
                .range([height, 0]);
var line = d3.svg.line()
    .x(function(d) { return x(d.x); })
    .y(function(d) { return y(d.y); })
var graph = d3.select("#step_graph")
    .append("svg")
    .attr("width", width + m[1] + m[3])
    .attr("height", height + m[0] + m[2])
    .append("g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");
var xAxis = d3.svg.axis()
                  .scale(x)
                  .tickValues(d3.range(-4, 5, 1))
                  .orient("bottom")
graph.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0, " + height + ")")
    .call(xAxis);
var yAxis = d3.svg.axis()
                  .scale(y)
                  .tickValues(d3.range(0, 1.01, 0.2))
                  .orient("left")
                  .ticks(5)
graph.append("g")
    .attr("class", "y axis")
    .call(yAxis);
graph.append("path").attr("d", line(data));
graph.append("text")
     .attr("class", "x label")
     .attr("text-anchor", "end")
     .attr("x", width/2)
     .attr("y", height+35)
     .text("z");
graph.append("text")
        .attr("x", (width / 2))             
        .attr("y", -10)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .text("step function");
</script>
<p></p><p>If <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame"><nobr><span class="math" id="MathJax-Span-706" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-707"><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">\sigma</script> had in fact been a step function, then the sigmoid neuron
would <em>be</em> a perceptron, since the output would be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame"><nobr><span class="math" id="MathJax-Span-709" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-710"><span class="mn" id="MathJax-Span-711" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">1</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame"><nobr><span class="math" id="MathJax-Span-712" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-713"><span class="mn" id="MathJax-Span-714" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">0</script>
depending on whether <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame"><nobr><span class="math" id="MathJax-Span-715" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-716"><span class="mi" id="MathJax-Span-717" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-718" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">w\cdot x+b</script> was positive or
negative*<span class="marginnote">
*Actually, when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame"><nobr><span class="math" id="MathJax-Span-722" role="math" style="width: 5.723em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.56em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.334em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main; padding-left: 0.249em;"></span><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">x</span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">b</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.249em;">=</span><span class="mn" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.249em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.921em; vertical-align: -0.163em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">w \cdot x +b = 0</script> the perceptron
  outputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame"><nobr><span class="math" id="MathJax-Span-731" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-732"><span class="mn" id="MathJax-Span-733" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">0</script>, while the step function outputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame"><nobr><span class="math" id="MathJax-Span-734" role="math" style="width: 0.494em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.494em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.109em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-735"><span class="mn" id="MathJax-Span-736" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.838em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">1</script>.  So, strictly
  speaking, we'd need to modify the step function at that one point.
  But you get the idea.</span>.  By using the actual <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame"><nobr><span class="math" id="MathJax-Span-737" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-738"><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">\sigma</script> function we
get, as already implied above, a smoothed out perceptron.  Indeed,
it's the smoothness of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame"><nobr><span class="math" id="MathJax-Span-740" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-741"><span class="mi" id="MathJax-Span-742" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">\sigma</script> function that is the crucial fact,
not its detailed form.  The smoothness of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame"><nobr><span class="math" id="MathJax-Span-743" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">\sigma</script> means that small
changes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame"><nobr><span class="math" id="MathJax-Span-746" role="math" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-747"><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-749"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">\Delta w_j</script> in the weights and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame"><nobr><span class="math" id="MathJax-Span-752" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">\Delta b</script> in the bias will
produce a small change <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame"><nobr><span class="math" id="MathJax-Span-756" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-757"><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-759" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">\Delta \mbox{output}</script> in the output from the
neuron.  In fact, calculus tells us that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame"><nobr><span class="math" id="MathJax-Span-760" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-761"><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-763" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">\Delta \mbox{output}</script> is
well approximated by
<a class="displaced_anchor" name="eqtn5"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-111-Frame"><nobr><span class="math" id="MathJax-Span-764" role="math" style="width: 100%; display: inline-block; min-width: 24.806em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 24.806em;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.297em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-765"><span class="mtable" id="MathJax-Span-766" style="min-width: 25.297em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 24.806em;"><span style="display: inline-block; position: absolute; width: 19.561em; height: 0px; clip: rect(-1.762em 1000.002em 1.277em -999.998em); top: 0.002em; left: 50%; margin-left: -9.752em;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.297em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 19.561em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.493em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-773" style="font-family: MathJax_Main;">output</span><span class="mo" id="MathJax-Span-774" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="munderover" id="MathJax-Span-775" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-777" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-778" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -1.86em;"><span class="mrow" id="MathJax-Span-779"><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-781" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-782" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-783"><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-785"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-787" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.777em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-789"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-791" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-792" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-793" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -1.86em;"><span class="mrow" id="MathJax-Span-794"><span class="mi" id="MathJax-Span-795" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-796" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-797" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-798"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-800" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.777em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-1.125em 1000.002em 0.199em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="mjx-eqn-5"><span class="mrow" id="MathJax-Span-768"><span class="mtext" id="MathJax-Span-769" style="font-family: MathJax_Main;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.853em; vertical-align: -1.198em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-111">\begin{eqnarray} 
  \Delta \mbox{output} \approx \sum_j \frac{\partial \, \mbox{output}}{\partial w_j}
  \Delta w_j + \frac{\partial \, \mbox{output}}{\partial b} \Delta b,
\tag{5}\end{eqnarray}</script>
where the sum is over all the weights, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame"><nobr><span class="math" id="MathJax-Span-804" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-805"><span class="msubsup" id="MathJax-Span-806"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-808" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">w_j</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame"><nobr><span class="math" id="MathJax-Span-809" role="math" style="width: 5.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-810"><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-812" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-813" style="font-family: MathJax_Main;">output</span><span class="texatom" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-818"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\partial \,
\mbox{output} / \partial w_j</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame"><nobr><span class="math" id="MathJax-Span-821" role="math" style="width: 5.297em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.199em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-822"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-824" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-825" style="font-family: MathJax_Main;">output</span><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">\partial \, \mbox{output} /\partial
b</script> denote partial derivatives of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame"><nobr><span class="math" id="MathJax-Span-831" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-832"><span class="mtext" id="MathJax-Span-833" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">\mbox{output}</script> with respect to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame"><nobr><span class="math" id="MathJax-Span-834" role="math" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-835"><span class="msubsup" id="MathJax-Span-836"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-838" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">w_j</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame"><nobr><span class="math" id="MathJax-Span-839" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-840"><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">b</script>, respectively.  Don't panic if you're not comfortable
with partial derivatives!  While the expression above looks
complicated, with all the partial derivatives, it's actually saying
something very simple (and which is very good news): <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame"><nobr><span class="math" id="MathJax-Span-842" role="math" style="width: 3.875em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-845" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">\Delta
\mbox{output}</script> is a <em>linear function</em> of the changes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame"><nobr><span class="math" id="MathJax-Span-846" role="math" style="width: 1.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-849"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-850" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-851" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">\Delta w_j</script>
and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame"><nobr><span class="math" id="MathJax-Span-852" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-853"><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">\Delta b</script> in the weights and bias.  This linearity makes it easy
to choose small changes in the weights and biases to achieve any
desired small change in the output.  So while sigmoid neurons have
much of the same qualitative behaviour as perceptrons, they make it
much easier to figure out how changing the weights and biases will
change the output.</p><p>If it's the shape of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame"><nobr><span class="math" id="MathJax-Span-856" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-857"><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">\sigma</script> which really matters, and not its exact
form, then why use the particular form used for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame"><nobr><span class="math" id="MathJax-Span-859" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-860"><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">\sigma</script> in
Equation <span id="margin_249432488660_reveal" class="equation_link">(3)</span><span id="margin_249432488660" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn3" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-123-Frame"><nobr><span class="math" id="MathJax-Span-862" role="math" style="width: 7.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.061em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-863"><span class="mtable" id="MathJax-Span-864" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 4.953em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-865"><span class="mrow" id="MathJax-Span-866"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-870" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-871" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-872" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.336em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-873" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -3.331em; left: 50%; margin-left: -1.615em;"><span class="mrow" id="MathJax-Span-874"><span class="mn" id="MathJax-Span-875" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="msubsup" id="MathJax-Span-877" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.311em; left: 0.493em;"><span class="texatom" id="MathJax-Span-879"><span class="mrow" id="MathJax-Span-880"><span class="mo" id="MathJax-Span-881" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.336em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.252em; vertical-align: -0.847em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-123">\begin{eqnarray} 
  \sigma(z) \equiv \frac{1}{1+e^{-z}} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_249432488660_reveal').click(function() {$('#margin_249432488660').toggle('slow', function() {});});</script>?  In fact, later in the book we will
occasionally consider neurons where the output is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame"><nobr><span class="math" id="MathJax-Span-883" role="math" style="width: 5.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.1em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-884"><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-886" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-890" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-891" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">f(w \cdot x + b)</script>
for some other <em>activation function</em> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame"><nobr><span class="math" id="MathJax-Span-893" role="math" style="width: 1.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-894"><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-898" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">f(\cdot)</script>.  The main thing
that changes when we use a different activation function is that the
particular values for the partial derivatives in
Equation <span id="margin_947599817252_reveal" class="equation_link">(5)</span><span id="margin_947599817252" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn5" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-126-Frame"><nobr><span class="math" id="MathJax-Span-899" role="math" style="width: 19.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.561em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.297em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-900"><span class="mtable" id="MathJax-Span-901" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 19.267em; height: 0px;"><span style="position: absolute; clip: rect(2.257em 1000.002em 5.297em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 19.267em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.493em -999.998em); top: -4.213em; right: 0.002em;"><span class="mtd" id="MathJax-Span-902"><span class="mrow" id="MathJax-Span-903"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Main;"></span><span class="mtext" id="MathJax-Span-905" style="font-family: MathJax_Main;">output</span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="munderover" id="MathJax-Span-907" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-910" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -1.86em;"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-913" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-914" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -3.331em; left: 50%; margin-left: -0.831em;"><span class="mrow" id="MathJax-Span-915"><span class="mi" id="MathJax-Span-916" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-917"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-919" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.777em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-920" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-921"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-922" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-924" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-925" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 3.777em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -1.86em;"><span class="mrow" id="MathJax-Span-926"><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mspace" id="MathJax-Span-928" style="height: 0.002em; vertical-align: 0.002em; width: 0.15em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-929" style="font-family: MathJax_Main;">output</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-930"><span class="mi" id="MathJax-Span-931" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-932" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.777em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.853em; vertical-align: -1.198em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-126">\begin{eqnarray} 
  \Delta \mbox{output} \approx \sum_j \frac{\partial \, \mbox{output}}{\partial w_j}
  \Delta w_j + \frac{\partial \, \mbox{output}}{\partial b} \Delta b \nonumber\end{eqnarray}</script></a></span><script>$('#margin_947599817252_reveal').click(function() {$('#margin_947599817252').toggle('slow', function() {});});</script> change.  It turns out that when we
compute those partial derivatives later, using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame"><nobr><span class="math" id="MathJax-Span-935" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-936"><span class="mi" id="MathJax-Span-937" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">\sigma</script> will simplify
the algebra, simply because exponentials have lovely properties when
differentiated.  In any case, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame"><nobr><span class="math" id="MathJax-Span-938" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-939"><span class="mi" id="MathJax-Span-940" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">\sigma</script> is commonly-used in work on
neural nets, and is the activation function we'll use most often in
this book.</p><p>How should we interpret the output from a sigmoid neuron?  Obviously,
one big difference between perceptrons and sigmoid neurons is that
sigmoid neurons don't just output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame"><nobr><span class="math" id="MathJax-Span-941" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-942"><span class="mn" id="MathJax-Span-943" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-129">0</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame"><nobr><span class="math" id="MathJax-Span-944" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-945"><span class="mn" id="MathJax-Span-946" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">1</script>.  They can have as output
any real number between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame"><nobr><span class="math" id="MathJax-Span-947" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-948"><span class="mn" id="MathJax-Span-949" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame"><nobr><span class="math" id="MathJax-Span-950" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-951"><span class="mn" id="MathJax-Span-952" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">1</script>, so values such as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame"><nobr><span class="math" id="MathJax-Span-953" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-954"><span class="mn" id="MathJax-Span-955" style="font-family: MathJax_Main;">0.173</span><span class="mo" id="MathJax-Span-956" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">0.173\ldots</script>
and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame"><nobr><span class="math" id="MathJax-Span-957" role="math" style="width: 3.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.581em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-958"><span class="mn" id="MathJax-Span-959" style="font-family: MathJax_Main;">0.689</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-134">0.689\ldots</script> are legitimate outputs.  This can be useful, for
example, if we want to use the output value to represent the average
intensity of the pixels in an image input to a neural network.  But
sometimes it can be a nuisance.  Suppose we want the output from the
network to indicate either "the input image is a 9" or "the input
image is not a 9".  Obviously, it'd be easiest to do this if the
output was a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame"><nobr><span class="math" id="MathJax-Span-961" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-962"><span class="mn" id="MathJax-Span-963" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-135">0</script> or a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame"><nobr><span class="math" id="MathJax-Span-964" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-965"><span class="mn" id="MathJax-Span-966" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-136">1</script>, as in a perceptron.  But in practice we can
set up a convention to deal with this, for example, by deciding to
interpret any output of at least <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame"><nobr><span class="math" id="MathJax-Span-967" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-968"><span class="mn" id="MathJax-Span-969" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-137">0.5</script> as indicating a "9", and any
output less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame"><nobr><span class="math" id="MathJax-Span-970" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-971"><span class="mn" id="MathJax-Span-972" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-138">0.5</script> as indicating "not a 9".  I'll always
explicitly state when we're using such a convention, so it shouldn't
cause any confusion.</p><p>
</p><h4><a name="exercises_191892"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercises_191892">Exercises</a></h4><ul>
<li><strong>Sigmoid neurons simulating perceptrons, part I</strong> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame"><nobr><span class="math" id="MathJax-Span-973" role="math" style="width: 0.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-974"><span class="mtext" id="MathJax-Span-975"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.102em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-139">\mbox{}</script> <br>
  Suppose we take all the weights and biases in a network of
  perceptrons, and multiply them by a positive constant, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame"><nobr><span class="math" id="MathJax-Span-976" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-980" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-140">c > 0</script>.
  Show that the behaviour of the network doesn't change.<p></p><p></p></li><li><strong>Sigmoid neurons simulating perceptrons, part II</strong> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame"><nobr><span class="math" id="MathJax-Span-981" role="math" style="width: 0.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.875em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-982"><span class="mtext" id="MathJax-Span-983"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.102em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-141">\mbox{}</script>
  <br> Suppose we have the same setup as the last problem - a
  network of perceptrons.  Suppose also that the overall input to the
  network of perceptrons has been chosen.  We won't need the actual
  input value, we just need the input to have been fixed.  Suppose the
  weights and biases are such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-142-Frame"><nobr><span class="math" id="MathJax-Span-984" role="math" style="width: 5.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.64em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-985"><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-991" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-992" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-142">w \cdot x + b \neq 0</script> for the
  input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-143-Frame"><nobr><span class="math" id="MathJax-Span-993" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-994"><span class="mi" id="MathJax-Span-995" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-143">x</script> to any particular perceptron in the network.  Now replace
  all the perceptrons in the network by sigmoid neurons, and multiply
  the weights and biases by a positive constant <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-144-Frame"><nobr><span class="math" id="MathJax-Span-996" role="math" style="width: 2.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-997"><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-999" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-1000" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-144">c > 0</script>. Show that in
  the limit as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame"><nobr><span class="math" id="MathJax-Span-1001" role="math" style="width: 3.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.042em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1002"><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1004" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1005" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.653em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-145">c \rightarrow \infty</script> the behaviour of this network of
  sigmoid neurons is exactly the same as the network of perceptrons.
  How can this fail when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame"><nobr><span class="math" id="MathJax-Span-1006" role="math" style="width: 5.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.64em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1007"><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1009" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">x</span><span class="mo" id="MathJax-Span-1011" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-1012" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-1013" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1014" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-146">w \cdot x + b = 0</script> for one of the
  perceptrons?
</li></ul><p></p><p></p><h3><a name="the_architecture_of_neural_networks"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#the_architecture_of_neural_networks">The architecture of neural networks</a></h3><p></p><p>In the next section I'll introduce a neural network that can do a
pretty good job classifying handwritten digits.  In preparation for
that, it helps to explain some terminology that lets us name different
parts of a network.  Suppose we have the network:
</p><center>
<img src="./Neural networks and deep learning 1_files/tikz10.png">
</center>
As mentioned earlier, the leftmost layer in this network is called the
input layer, and the neurons within the
layer are called <em>input neurons</em>.
The rightmost or <em>output</em> layer
contains the <em>output neurons</em>, or,
as in this case, a single output neuron.  The middle layer is called a
<em>hidden layer</em>, since the neurons in
this layer are neither inputs nor outputs.  The term "hidden"
perhaps sounds a little mysterious - the first time I heard the term
I thought it must have some deep philosophical or mathematical
significance - but it really means nothing more than "not an input
or an output".  The network above has just a single hidden layer, but
some networks have multiple hidden layers.  For example, the following
four-layer network has two hidden layers:
<center>
<img src="./Neural networks and deep learning 1_files/tikz11.png">
</center>
Somewhat confusingly, and for historical reasons, such multiple layer
networks are sometimes called <em>multilayer perceptrons</em> or
<em>MLPs</em>, despite being made up of sigmoid neurons, not
perceptrons.  I'm not going to use the MLP terminology in this book,
since I think it's confusing, but wanted to warn you of its existence.<p></p><p>The design of the input and output layers in a network is often
straightforward.  For example, suppose we're trying to determine
whether a handwritten image depicts a "9" or not.  A natural way to
design the network is to encode the intensities of the image pixels
into the input neurons. If the image is a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame"><nobr><span class="math" id="MathJax-Span-1015" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1016"><span class="mn" id="MathJax-Span-1017" style="font-family: MathJax_Main;">64</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-147">64</script> by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame"><nobr><span class="math" id="MathJax-Span-1018" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1019"><span class="mn" id="MathJax-Span-1020" style="font-family: MathJax_Main;">64</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-148">64</script> greyscale
image, then we'd have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame"><nobr><span class="math" id="MathJax-Span-1021" role="math" style="width: 7.208em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.061em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1022"><span class="mn" id="MathJax-Span-1023" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-1024" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1025" style="font-family: MathJax_Main; padding-left: 0.15em;">096</span><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1027" style="font-family: MathJax_Main; padding-left: 0.297em;">64</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-1029" style="font-family: MathJax_Main; padding-left: 0.248em;">64</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-149">4,096 = 64 \times 64</script> input neurons, with the
intensities scaled appropriately between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame"><nobr><span class="math" id="MathJax-Span-1030" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1031"><span class="mn" id="MathJax-Span-1032" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-150">0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-151-Frame"><nobr><span class="math" id="MathJax-Span-1033" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1034"><span class="mn" id="MathJax-Span-1035" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-151">1</script>.  The output
layer will contain just a single neuron, with output values of less
than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame"><nobr><span class="math" id="MathJax-Span-1036" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1037"><span class="mn" id="MathJax-Span-1038" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-152">0.5</script> indicating "input image is not a 9", and values greater
than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame"><nobr><span class="math" id="MathJax-Span-1039" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1040"><span class="mn" id="MathJax-Span-1041" style="font-family: MathJax_Main;">0.5</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-153">0.5</script> indicating "input image is a 9 ".</p><p></p><p></p><p>
While the design of the input and output layers of a neural network is
often straightforward, there can be quite an art to the design of the
hidden layers.  In particular, it's not possible to sum up the design
process for the hidden layers with a few simple rules of thumb.
Instead, neural networks researchers have developed many design
heuristics for the hidden layers, which help people get the behaviour
they want out of their nets.  For example, such heuristics can be used
to help determine how to trade off the number of hidden layers against
the time required to train the network.  We'll meet several such
design heuristics later in this book. </p><p>Up to now, we've been discussing neural networks where the output from
one layer is used as input to the next layer.  Such networks are
called <em>feedforward</em>
neural networks.  This means there are no loops in the network -
information is always fed forward, never fed back.  If we did have
loops, we'd end up with situations where the input to the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame"><nobr><span class="math" id="MathJax-Span-1042" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1043"><span class="mi" id="MathJax-Span-1044" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-154">\sigma</script>
function depended on the output.  That'd be hard to make sense of, and
so we don't allow such loops.</p><p>However, there are other models of artificial neural networks in which
feedback loops are possible.  These models are called
<a href="http://en.wikipedia.org/wiki/Recurrent_neural_network">recurrent
  neural networks</a>. The idea in these models is to have neurons which
fire for some limited duration of time, before becoming quiescent.
That firing can stimulate other neurons, which may fire a little while
later, also for a limited duration.  That causes still more neurons to
fire, and so over time we get a cascade of neurons firing.  Loops
don't cause problems in such a model, since a neuron's output only
affects its input at some later time, not instantaneously.</p><p></p><p>Recurrent neural nets have been less influential than feedforward
networks, in part because the learning algorithms for recurrent nets
are (at least to date) less powerful.  But recurrent networks are
still extremely interesting.  They're much closer in spirit to how our
brains work than feedforward networks.  And it's possible that
recurrent networks can solve important problems which can only be
solved with great difficulty by feedforward networks.  However, to
limit our scope, in this book we're going to concentrate on the more
widely-used feedforward networks.</p><p></p><h3><a name="a_simple_network_to_classify_handwritten_digits"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#a_simple_network_to_classify_handwritten_digits">A simple network to classify handwritten digits</a></h3><p></p><p>Having defined neural networks, let's return to handwriting
recognition.  We can split the problem of recognizing handwritten
digits into two sub-problems.  First, we'd like a way of breaking an
image containing many digits into a sequence of separate images, each
containing a single digit.  For example, we'd like to break the image</p><p></p><center><img src="./Neural networks and deep learning 1_files/digits.png" width="300px"></center><p></p><p>into six separate images,</p><p></p><center><img src="./Neural networks and deep learning 1_files/digits_separate.png" width="440px"></center> <p></p><p>We humans solve this <em>segmentation
  problem</em> with ease, but it's challenging
for a computer program to correctly break up the image.  Once the
image has been segmented, the program then needs to classify each
individual digit.  So, for instance, we'd like our program to
recognize that the first digit above,</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_first_digit.png" width="64px"></center><p></p><p>is a 5.</p><p>We'll focus on writing a program to solve the second problem, that is,
classifying individual digits.  We do this because it turns out that
the segmentation problem is not so difficult to solve, once you have a
good way of classifying individual digits.  There are many approaches
to solving the segmentation problem.  One approach is to trial many
different ways of segmenting the image, using the individual digit
classifier to score each trial segmentation.  A trial segmentation
gets a high score if the individual digit classifier is confident of
its classification in all segments, and a low score if the classifier
is having a lot of trouble in one or more segments.  The idea is that
if the classifier is having trouble somewhere, then it's probably
having trouble because the segmentation has been chosen incorrectly.
This idea and other variations can be used to solve the segmentation
problem quite well.  So instead of worrying about segmentation we'll
concentrate on developing a neural network which can solve the more
interesting and difficult problem, namely, recognizing individual
handwritten digits.</p><p>To recognize individual digits we will use a three-layer neural
network:</p><p></p><center>
<img src="./Neural networks and deep learning 1_files/tikz12.png">
</center><p></p><p>The input layer of the network contains neurons encoding the values of
the input pixels.  As discussed in the next section, our training data
for the network will consist of many <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-155-Frame"><nobr><span class="math" id="MathJax-Span-1045" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1046"><span class="mn" id="MathJax-Span-1047" style="font-family: MathJax_Main;">28</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-155">28</script> by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame"><nobr><span class="math" id="MathJax-Span-1048" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1049"><span class="mn" id="MathJax-Span-1050" style="font-family: MathJax_Main;">28</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-156">28</script> pixel images of
scanned handwritten digts, and so the input layer contains <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame"><nobr><span class="math" id="MathJax-Span-1051" role="math" style="width: 6.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1052"><span class="mn" id="MathJax-Span-1053" style="font-family: MathJax_Main;">784</span><span class="mo" id="MathJax-Span-1054" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1055" style="font-family: MathJax_Main; padding-left: 0.297em;">28</span><span class="mo" id="MathJax-Span-1056" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-1057" style="font-family: MathJax_Main; padding-left: 0.248em;">28</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-157">784 = 28
\times 28</script> neurons.  For simplicity I've omitted most of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame"><nobr><span class="math" id="MathJax-Span-1058" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1059"><span class="mn" id="MathJax-Span-1060" style="font-family: MathJax_Main;">784</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-158">784</script>
input neurons in the diagram above.  The input pixels are greyscale,
with a value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-159-Frame"><nobr><span class="math" id="MathJax-Span-1061" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1062"><span class="mn" id="MathJax-Span-1063" style="font-family: MathJax_Main;">0.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-159">0.0</script> representing white, a value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame"><nobr><span class="math" id="MathJax-Span-1064" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1065"><span class="mn" id="MathJax-Span-1066" style="font-family: MathJax_Main;">1.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-160">1.0</script>
representing black, and in between values representing gradually
darkening shades of grey.</p><p>The second layer of the network is a hidden layer.  We denote the
number of neurons in this hidden layer by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame"><nobr><span class="math" id="MathJax-Span-1067" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1068"><span class="mi" id="MathJax-Span-1069" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-161">n</script>, and we'll experiment
with different values for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame"><nobr><span class="math" id="MathJax-Span-1070" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1071"><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-162">n</script>.  The example shown illustrates a small
hidden layer, containing just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-163-Frame"><nobr><span class="math" id="MathJax-Span-1073" role="math" style="width: 3.042em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.993em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1077" style="font-family: MathJax_Main; padding-left: 0.297em;">15</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-163">n = 15</script> neurons.</p><p>The output layer of the network contains 10 neurons.  If the first
neuron fires, i.e., has an output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame"><nobr><span class="math" id="MathJax-Span-1078" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1079"><span class="mo" id="MathJax-Span-1080" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1081" style="font-family: MathJax_Main; padding-left: 0.297em;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-164">\approx 1</script>, then that will indicate
that the network thinks the digit is a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-165-Frame"><nobr><span class="math" id="MathJax-Span-1082" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1083"><span class="mn" id="MathJax-Span-1084" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-165">0</script>.  If the second neuron
fires then that will indicate that the network thinks the digit is a
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame"><nobr><span class="math" id="MathJax-Span-1085" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1086"><span class="mn" id="MathJax-Span-1087" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-166">1</script>.  And so on.  A little more precisely, we number the output
neurons from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame"><nobr><span class="math" id="MathJax-Span-1088" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1089"><span class="mn" id="MathJax-Span-1090" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-167">0</script> through <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-168-Frame"><nobr><span class="math" id="MathJax-Span-1091" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1092"><span class="mn" id="MathJax-Span-1093" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-168">9</script>, and figure out which neuron has the
highest activation value.  If that neuron is, say, neuron number <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame"><nobr><span class="math" id="MathJax-Span-1094" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1095"><span class="mn" id="MathJax-Span-1096" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-169">6</script>,
then our network will guess that the input digit was a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-170-Frame"><nobr><span class="math" id="MathJax-Span-1097" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1098"><span class="mn" id="MathJax-Span-1099" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-170">6</script>.  And so on
for the other output neurons.</p><p>You might wonder why we use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-171-Frame"><nobr><span class="math" id="MathJax-Span-1100" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1101"><span class="mn" id="MathJax-Span-1102" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-171">10</script> output neurons.  After all, the goal
of the network is to tell us which digit (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-172-Frame"><nobr><span class="math" id="MathJax-Span-1103" role="math" style="width: 5.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.051em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1104"><span class="mn" id="MathJax-Span-1105" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1106" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1107" style="font-family: MathJax_Main; padding-left: 0.15em;">1</span><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1109" style="font-family: MathJax_Main; padding-left: 0.15em;">2</span><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1111" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-1112" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="mn" id="MathJax-Span-1113" style="font-family: MathJax_Main; padding-left: 0.15em;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-172">0, 1, 2, \ldots, 9</script>)
corresponds to the input image.  A seemingly natural way of doing that
is to use just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame"><nobr><span class="math" id="MathJax-Span-1114" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1115"><span class="mn" id="MathJax-Span-1116" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-173">4</script> output neurons, treating each neuron as taking on a
binary value, depending on whether the neuron's output is closer to
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-174-Frame"><nobr><span class="math" id="MathJax-Span-1117" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1118"><span class="mn" id="MathJax-Span-1119" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-174">0</script> or to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame"><nobr><span class="math" id="MathJax-Span-1120" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1121"><span class="mn" id="MathJax-Span-1122" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">1</script>.  Four neurons are enough to encode the answer, since
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame"><nobr><span class="math" id="MathJax-Span-1123" role="math" style="width: 3.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.287em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1124"><span class="msubsup" id="MathJax-Span-1125"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mn" id="MathJax-Span-1126" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-1127" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1128" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1129" style="font-family: MathJax_Main; padding-left: 0.297em;">16</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-176">2^4 = 16</script> is more than the 10 possible values for the input digit.
Why should our network use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame"><nobr><span class="math" id="MathJax-Span-1130" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1131"><span class="mn" id="MathJax-Span-1132" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-177">10</script> neurons instead?  Isn't that
inefficient?  The ultimate justification is empirical: we can try out
both network designs, and it turns out that, for this particular
problem, the network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-178-Frame"><nobr><span class="math" id="MathJax-Span-1133" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1134"><span class="mn" id="MathJax-Span-1135" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-178">10</script> output neurons learns to recognize
digits better than the network with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-179-Frame"><nobr><span class="math" id="MathJax-Span-1136" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1137"><span class="mn" id="MathJax-Span-1138" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-179">4</script> output neurons.  But that
leaves us wondering <em>why</em> using <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-180-Frame"><nobr><span class="math" id="MathJax-Span-1139" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1140"><span class="mn" id="MathJax-Span-1141" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-180">10</script> output neurons works better.
Is there some heuristic that would tell us in advance that we should
use the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame"><nobr><span class="math" id="MathJax-Span-1142" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1143"><span class="mn" id="MathJax-Span-1144" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-181">10</script>-output encoding instead of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame"><nobr><span class="math" id="MathJax-Span-1145" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1146"><span class="mn" id="MathJax-Span-1147" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-182">4</script>-output encoding?</p><p>To understand why we do this, it helps to think about what the neural
network is doing from first principles.  Consider first the case where
we use <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame"><nobr><span class="math" id="MathJax-Span-1148" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1149"><span class="mn" id="MathJax-Span-1150" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-183">10</script> output neurons.  Let's concentrate on the first output
neuron, the one that's trying to decide whether or not the digit is a
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-184-Frame"><nobr><span class="math" id="MathJax-Span-1151" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1152"><span class="mn" id="MathJax-Span-1153" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-184">0</script>.  It does this by weighing up evidence from the hidden layer of
neurons.  What are those hidden neurons doing?  Well, just suppose for
the sake of argument that the first neuron in the hidden layer detects
whether or not an image like the following is present:</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_top_left_feature.png" width="130px"></center><p></p><p>It can do this by heavily weighting input pixels which overlap with
the image, and only lightly weighting the other inputs.  In a similar
way, let's suppose for the sake of argument that the second, third,
and fourth neurons in the hidden layer detect whether or not the
following images are present:</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_other_features.png" width="424px"></center><p></p><p>As you may have guessed, these four images together make up the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-185-Frame"><nobr><span class="math" id="MathJax-Span-1154" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1155"><span class="mn" id="MathJax-Span-1156" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-185">0</script>
image that we saw in the line of digits shown <a href="http://neuralnetworksanddeeplearning.com/chap1.html#complete_zero">earlier</a>:</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_complete_zero.png" width="130px"></center><p></p><p>So if all four of these hidden neurons are firing then we can conclude
that the digit is a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-186-Frame"><nobr><span class="math" id="MathJax-Span-1157" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1158"><span class="mn" id="MathJax-Span-1159" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-186">0</script>.  Of course, that's not the <em>only</em> sort
of evidence we can use to conclude that the image was a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-187-Frame"><nobr><span class="math" id="MathJax-Span-1160" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1161"><span class="mn" id="MathJax-Span-1162" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-187">0</script> - we
could legitimately get a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-188-Frame"><nobr><span class="math" id="MathJax-Span-1163" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1164"><span class="mn" id="MathJax-Span-1165" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-188">0</script> in many other ways (say, through
translations of the above images, or slight distortions).  But it
seems safe to say that at least in this case we'd conclude that the
input was a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-189-Frame"><nobr><span class="math" id="MathJax-Span-1166" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1167"><span class="mn" id="MathJax-Span-1168" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-189">0</script>.</p><p></p><p></p><p></p><p>Supposing the neural network functions in this way, we can give a
plausible explanation for why it's better to have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame"><nobr><span class="math" id="MathJax-Span-1169" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1170"><span class="mn" id="MathJax-Span-1171" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-190">10</script> outputs from
the network, rather than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-191-Frame"><nobr><span class="math" id="MathJax-Span-1172" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1173"><span class="mn" id="MathJax-Span-1174" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-191">4</script>.  If we had <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-192-Frame"><nobr><span class="math" id="MathJax-Span-1175" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1176"><span class="mn" id="MathJax-Span-1177" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-192">4</script> outputs, then the first
output neuron would be trying to decide what the most significant bit
of the digit was.  And there's no easy way to relate that most
significant bit to simple shapes like those shown above.  It's hard to
imagine that there's any good historical reason the component shapes
of the digit will be closely related to (say) the most significant bit
in the output.</p><p>Now, with all that said, this is all just a heuristic.  Nothing says
that the three-layer neural network has to operate in the way I
described, with the hidden neurons detecting simple component shapes.
Maybe a clever learning algorithm will find some assignment of weights
that lets us use only <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-193-Frame"><nobr><span class="math" id="MathJax-Span-1178" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1179"><span class="mn" id="MathJax-Span-1180" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-193">4</script> output neurons.  But as a heuristic the way
of thinking I've described works pretty well, and can save you a lot
of time in designing good neural network architectures.</p><p></p><h4><a name="exercise_513527"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercise_513527">Exercise</a></h4><ul>
<li> There is a way of determining the bitwise representation of a
  digit by adding an extra layer to the three-layer network above.
  The extra layer converts the output from the previous layer into a
  binary representation, as illustrated in the figure below.  Find a
  set of weights and biases for the new output layer.  Assume that the
  first <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-194-Frame"><nobr><span class="math" id="MathJax-Span-1181" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1182"><span class="mn" id="MathJax-Span-1183" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-194">3</script> layers of neurons are such that the correct output in the
  third layer (i.e., the old output layer) has activation at least
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-195-Frame"><nobr><span class="math" id="MathJax-Span-1184" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1185"><span class="mn" id="MathJax-Span-1186" style="font-family: MathJax_Main;">0.99</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">0.99</script>, and incorrect outputs have activation less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame"><nobr><span class="math" id="MathJax-Span-1187" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1188"><span class="mn" id="MathJax-Span-1189" style="font-family: MathJax_Main;">0.01</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-196">0.01</script>.
</li></ul><p></p><p></p><center>
<img src="./Neural networks and deep learning 1_files/tikz13.png">
</center><p></p><p></p><p></p><p></p><p></p><h3><a name="learning_with_gradient_descent"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent">Learning with gradient descent</a></h3><p></p><p></p><p>Now that we have a design for our neural network, how can it learn to
recognize digits?  The first thing we'll need is a data set to learn
from - a so-called training data set.  We'll use the
 <a href="http://yann.lecun.com/exdb/mnist/">MNIST
  data set</a>, which contains tens of thousands of scanned images of
handwritten digits, together with their correct classifications.
MNIST's name comes from the fact that it is a modified subset of two
data sets collected by
<a href="http://en.wikipedia.org/wiki/National_Institute_of_Standards_and_Technology">NIST</a>,
the United States' National Institute of Standards and
Technology. Here's a few images from MNIST:</p><p></p><center><img src="./Neural networks and deep learning 1_files/digits_separate.png" width="420px"></center> <p></p><p>As you can see, these digits are, in fact, the same as those shown
at the <a href="http://neuralnetworksanddeeplearning.com/chap1.html#complete_zero">beginning of this chapter</a> as a challenge
to recognize.  Of course, when testing our network we'll ask it to
recognize images which aren't in the training set!</p><p>The MNIST data comes in two parts.  The first part contains 60,000
images to be used as training data.  These images are scanned
handwriting samples from 250 people, half of whom were US Census
Bureau employees, and half of whom were high school students.  The
images are greyscale and 28 by 28 pixels in size.  The second part of
the MNIST data set is 10,000 images to be used as test data.  Again,
these are 28 by 28 greyscale images.  We'll use the test data to
evaluate how well our neural network has learned to recognize digits.
To make this a good test of performance, the test data was taken from
a <em>different</em> set of 250 people than the original training data
(albeit still a group split between Census Bureau employees and high
school students).  This helps give us confidence that our system can
recognize digits from people whose writing it didn't see during
training.</p><p>We'll use the notation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-197-Frame"><nobr><span class="math" id="MathJax-Span-1190" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1191"><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-197">x</script> to denote a training input.  It'll be
convenient to regard each training input <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-198-Frame"><nobr><span class="math" id="MathJax-Span-1193" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1194"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-198">x</script> as a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-199-Frame"><nobr><span class="math" id="MathJax-Span-1196" role="math" style="width: 6.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1197"><span class="mn" id="MathJax-Span-1198" style="font-family: MathJax_Main;">28</span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mn" id="MathJax-Span-1200" style="font-family: MathJax_Main; padding-left: 0.248em;">28</span><span class="mo" id="MathJax-Span-1201" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-1202" style="font-family: MathJax_Main; padding-left: 0.297em;">784</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-199">28 \times 28 =
784</script>-dimensional vector.  Each entry in the vector represents the grey
value for a single pixel in the image.  We'll denote the corresponding
desired output by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame"><nobr><span class="math" id="MathJax-Span-1203" role="math" style="width: 3.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.728em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1210" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">y = y(x)</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-201-Frame"><nobr><span class="math" id="MathJax-Span-1211" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1212"><span class="mi" id="MathJax-Span-1213" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-201">y</script> is a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-202-Frame"><nobr><span class="math" id="MathJax-Span-1214" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1215"><span class="mn" id="MathJax-Span-1216" style="font-family: MathJax_Main;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-202">10</script>-dimensional vector.
For example, if a particular training image, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame"><nobr><span class="math" id="MathJax-Span-1217" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1218"><span class="mi" id="MathJax-Span-1219" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-203">x</script>, depicts a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-204-Frame"><nobr><span class="math" id="MathJax-Span-1220" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1221"><span class="mn" id="MathJax-Span-1222" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-204">6</script>, then
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame"><nobr><span class="math" id="MathJax-Span-1223" role="math" style="width: 13.728em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.434em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1224"><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1226" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1228" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1229" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1230" style="font-family: MathJax_Main; padding-left: 0.297em;">(</span><span class="mn" id="MathJax-Span-1231" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1232" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1233" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1234" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1235" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1236" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1237" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1238" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1239" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1240" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1241" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1243" style="font-family: MathJax_Main; padding-left: 0.15em;">1</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1245" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1246" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1247" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="mo" id="MathJax-Span-1248" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1249" style="font-family: MathJax_Main; padding-left: 0.15em;">0</span><span class="msubsup" id="MathJax-Span-1250"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1251" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-205">y(x) = (0, 0, 0, 0, 0, 0, 1, 0, 0, 0)^T</script> is the desired output from
the network.  Note that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame"><nobr><span class="math" id="MathJax-Span-1253" role="math" style="width: 0.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.689em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1254"><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-206">T</script> here is the transpose operation, turning a
row vector into an ordinary (column) vector.</p><p>What we'd like is an algorithm which lets us find weights and biases
so that the output from the network approximates <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame"><nobr><span class="math" id="MathJax-Span-1256" role="math" style="width: 1.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1260" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1261" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-207">y(x)</script> for all
training inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-208-Frame"><nobr><span class="math" id="MathJax-Span-1262" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1263"><span class="mi" id="MathJax-Span-1264" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-208">x</script>.  To quantify how well we're achieving this goal
we define a <em>cost function</em>*<span class="marginnote">
*Sometimes referred to as a
  <em>loss</em> or <em>objective</em> function.  We use the term cost
  function throughout this book, but you should note the other
  terminology, since it's often used in research papers and other
  discussions of neural networks. </span>:
<a class="displaced_anchor" name="eqtn6"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-209-Frame"><nobr><span class="math" id="MathJax-Span-1265" role="math" style="width: 100%; display: inline-block; min-width: 18.434em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 18.434em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1266"><span class="mtable" id="MathJax-Span-1267" style="min-width: 18.777em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.434em;"><span style="display: inline-block; position: absolute; width: 13.042em; height: 0px; clip: rect(-1.664em 1000.002em 1.13em -999.998em); top: 0.002em; left: 50%; margin-left: -6.517em;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 13.042em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1271"><span class="mrow" id="MathJax-Span-1272"><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1274" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1275" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1276" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1277" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1278" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1279" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1280" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1281" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-1282"><span class="mn" id="MathJax-Span-1283" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1284" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1285" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1286" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1287" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1288" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1290" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1292" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-1295"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1296" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1298" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-1.076em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-6"><span class="mrow" id="MathJax-Span-1269"><span class="mtext" id="MathJax-Span-1270" style="font-family: MathJax_Main;">(6)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-209">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2.
\tag{6}\end{eqnarray}</script>
Here, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-210-Frame"><nobr><span class="math" id="MathJax-Span-1299" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1300"><span class="mi" id="MathJax-Span-1301" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-210">w</script> denotes the collection of all weights in the network, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-211-Frame"><nobr><span class="math" id="MathJax-Span-1302" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1303"><span class="mi" id="MathJax-Span-1304" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-211">b</script>
all the biases, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-212-Frame"><nobr><span class="math" id="MathJax-Span-1305" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1306"><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-212">n</script> is the total number of training inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame"><nobr><span class="math" id="MathJax-Span-1308" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1309"><span class="mi" id="MathJax-Span-1310" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-213">a</script> is the
vector of outputs from the network when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-214-Frame"><nobr><span class="math" id="MathJax-Span-1311" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1312"><span class="mi" id="MathJax-Span-1313" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-214">x</script> is input, and the sum is
over all training inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame"><nobr><span class="math" id="MathJax-Span-1314" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1315"><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-215">x</script>.  Of course, the output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame"><nobr><span class="math" id="MathJax-Span-1317" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1318"><span class="mi" id="MathJax-Span-1319" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-216">a</script> depends on
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame"><nobr><span class="math" id="MathJax-Span-1320" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1321"><span class="mi" id="MathJax-Span-1322" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-217">x</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-218-Frame"><nobr><span class="math" id="MathJax-Span-1323" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1324"><span class="mi" id="MathJax-Span-1325" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-218">w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame"><nobr><span class="math" id="MathJax-Span-1326" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1327"><span class="mi" id="MathJax-Span-1328" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-219">b</script>, but to keep the notation simple I haven't explicitly
indicated this dependence.  The notation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame"><nobr><span class="math" id="MathJax-Span-1329" role="math" style="width: 1.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1330"><span class="mo" id="MathJax-Span-1331" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1332" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1333" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-220">\| v \|</script> just denotes the
usual length function for a vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame"><nobr><span class="math" id="MathJax-Span-1334" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1335"><span class="mi" id="MathJax-Span-1336" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-221">v</script>.  We'll call <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame"><nobr><span class="math" id="MathJax-Span-1337" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1338"><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-222">C</script> the
<em>quadratic</em> cost function; it's also
sometimes known as the <em>mean squared error</em> or just <em>MSE</em>.
Inspecting the form of the quadratic cost function, we see that
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame"><nobr><span class="math" id="MathJax-Span-1340" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1343" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1344" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1345" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1346" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1347" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-223">C(w,b)</script> is non-negative, since every term in the sum is non-negative.
Furthermore, the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame"><nobr><span class="math" id="MathJax-Span-1348" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1349"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1351" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1352" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1353" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1354" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1355" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-224">C(w,b)</script> becomes small, i.e., <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame"><nobr><span class="math" id="MathJax-Span-1356" role="math" style="width: 5.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1357"><span class="mi" id="MathJax-Span-1358" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1359" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1360" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1362" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1363" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1364" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-1365" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-225">C(w,b) \approx
0</script>, precisely when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame"><nobr><span class="math" id="MathJax-Span-1366" role="math" style="width: 1.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1367"><span class="mi" id="MathJax-Span-1368" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1369" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-226">y(x)</script> is approximately equal to the output, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame"><nobr><span class="math" id="MathJax-Span-1372" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1373"><span class="mi" id="MathJax-Span-1374" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-227">a</script>,
for all training inputs, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-228-Frame"><nobr><span class="math" id="MathJax-Span-1375" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1376"><span class="mi" id="MathJax-Span-1377" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-228">x</script>.  So our training algorithm has done a
good job if it can find weights and biases so that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame"><nobr><span class="math" id="MathJax-Span-1378" role="math" style="width: 5.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1379"><span class="mi" id="MathJax-Span-1380" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1381" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1382" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1383" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1384" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1385" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1386" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-1387" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-229">C(w,b) \approx 0</script>.
By contrast, it's not doing so well when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame"><nobr><span class="math" id="MathJax-Span-1388" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1389"><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1391" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1392" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1393" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1394" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1395" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-230">C(w,b)</script> is large - that
would mean that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame"><nobr><span class="math" id="MathJax-Span-1396" role="math" style="width: 1.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1397"><span class="mi" id="MathJax-Span-1398" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1399" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1400" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1401" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-231">y(x)</script> is not close to the output <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame"><nobr><span class="math" id="MathJax-Span-1402" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1403"><span class="mi" id="MathJax-Span-1404" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-232">a</script> for a large
number of inputs.  So the aim of our training algorithm will be to
minimize the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame"><nobr><span class="math" id="MathJax-Span-1405" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1406"><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1408" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1409" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1412" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-233">C(w,b)</script> as a function of the weights and biases.
In other words, we want to find a set of weights and biases which make
the cost as small as possible.  We'll do that using an algorithm known
as <em>gradient descent</em>.</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p>
Why introduce the quadratic cost?  After all, aren't we primarily
interested in the number of images correctly classified by the
network?  Why not try to maximize that number directly, rather than
minimizing a proxy measure like the quadratic cost?  The problem with
that is that the number of images correctly classified is not a smooth
function of the weights and biases in the network.  For the most part,
making small changes to the weights and biases won't cause any change
at all in the number of training images classified correctly.  That
makes it difficult to figure out how to change the weights and biases
to get improved performance.  If we instead use a smooth cost function
like the quadratic cost it turns out to be easy to figure out how to
make small changes in the weights and biases so as to get an
improvement in the cost.  That's why we focus first on minimizing the
quadratic cost, and only after that will we examine the classification
accuracy.</p><p></p><p>Even given that we want to use a smooth cost function, you may still
wonder why we choose the quadratic function used in
Equation <span id="margin_945768473407_reveal" class="equation_link">(6)</span><span id="margin_945768473407" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-234-Frame"><nobr><span class="math" id="MathJax-Span-1413" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1414"><span class="mtable" id="MathJax-Span-1415" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1416"><span class="mrow" id="MathJax-Span-1417"><span class="mi" id="MathJax-Span-1418" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1419" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1420" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1421" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1422" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1424" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1425" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1426" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-1427"><span class="mn" id="MathJax-Span-1428" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1429" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1430" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1433" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1436" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1437" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1438" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1439" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-1440"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1441" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-234">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_945768473407_reveal').click(function() {$('#margin_945768473407').toggle('slow', function() {});});</script>.  Isn't this a rather <em>ad
  hoc</em> choice?  Perhaps if we chose a different cost function we'd get
a totally different set of minimizing weights and biases?  This is a
valid concern, and later we'll revisit the cost function, and make
some modifications.  However, the quadratic cost function of
Equation <span id="margin_620646483247_reveal" class="equation_link">(6)</span><span id="margin_620646483247" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-235-Frame"><nobr><span class="math" id="MathJax-Span-1443" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1444"><span class="mtable" id="MathJax-Span-1445" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1446"><span class="mrow" id="MathJax-Span-1447"><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1449" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1450" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1451" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1452" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1453" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1454" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1455" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-1456" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-1457"><span class="mn" id="MathJax-Span-1458" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-1459" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1460" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1461" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-1462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-1464" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1465" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1466" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1468" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1469" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-1470"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1471" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-1472" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-235">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_620646483247_reveal').click(function() {$('#margin_620646483247').toggle('slow', function() {});});</script> works perfectly well for
understanding the basics of learning in neural networks, so we'll
stick with it for now.</p><p>Recapping, our goal in training a neural network is to find weights
and biases which minimize the quadratic cost function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame"><nobr><span class="math" id="MathJax-Span-1473" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1474"><span class="mi" id="MathJax-Span-1475" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1476" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1477" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-1478" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1479" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-1480" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-236">C(w, b)</script>.  This
is a well-posed problem, but it's got a lot of distracting structure
as currently posed - the interpretation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-237-Frame"><nobr><span class="math" id="MathJax-Span-1481" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1482"><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-237">w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame"><nobr><span class="math" id="MathJax-Span-1484" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1485"><span class="mi" id="MathJax-Span-1486" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-238">b</script> as weights
and biases, the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-239-Frame"><nobr><span class="math" id="MathJax-Span-1487" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1488"><span class="mi" id="MathJax-Span-1489" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-239">\sigma</script> function lurking in the background, the
choice of network architecture, MNIST, and so on.  It turns out that
we can understand a tremendous amount by ignoring most of that
structure, and just concentrating on the minimization aspect.  So for
now we're going to forget all about the specific form of the cost
function, the connection to neural networks, and so on.  Instead,
we're going to imagine that we've simply been given a function of many
variables and we want to minimize that function.  We're going to
develop a technique called <em>gradient descent</em> which can be used
to solve such minimization problems.  Then we'll come back to the
specific function we want to minimize for neural networks.</p><p>Okay, let's suppose we're trying to minimize some function, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-240-Frame"><nobr><span class="math" id="MathJax-Span-1490" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1491"><span class="mi" id="MathJax-Span-1492" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1493" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1494" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1495" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-240">C(v)</script>.
This could be any real-valued function of many variables, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-241-Frame"><nobr><span class="math" id="MathJax-Span-1496" role="math" style="width: 5.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1497"><span class="mi" id="MathJax-Span-1498" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1499" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-1500" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1501" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1502" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1503" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1504" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1506" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1507" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1508" style="font-family: MathJax_Main; padding-left: 0.15em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-241">v = v_1,
v_2, \ldots</script>.  Note that I've replaced the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-242-Frame"><nobr><span class="math" id="MathJax-Span-1509" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1510"><span class="mi" id="MathJax-Span-1511" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-242">w</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-243-Frame"><nobr><span class="math" id="MathJax-Span-1512" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1513"><span class="mi" id="MathJax-Span-1514" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-243">b</script> notation by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-244-Frame"><nobr><span class="math" id="MathJax-Span-1515" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1516"><span class="mi" id="MathJax-Span-1517" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-244">v</script>
to emphasize that this could be any function - we're not
specifically thinking in the neural networks context any more.  To
minimize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-245-Frame"><nobr><span class="math" id="MathJax-Span-1518" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1519"><span class="mi" id="MathJax-Span-1520" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1521" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1523" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">C(v)</script> it helps to imagine <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-246-Frame"><nobr><span class="math" id="MathJax-Span-1524" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1525"><span class="mi" id="MathJax-Span-1526" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">C</script> as a function of just two
variables, which we'll call <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame"><nobr><span class="math" id="MathJax-Span-1527" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1528"><span class="msubsup" id="MathJax-Span-1529"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1530" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1531" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">v_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-248-Frame"><nobr><span class="math" id="MathJax-Span-1532" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1533"><span class="msubsup" id="MathJax-Span-1534"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1535" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1536" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-248">v_2</script>:</p><p></p><center><img src="./Neural networks and deep learning 1_files/valley.png" width="542px"></center><p></p><p>What we'd like is to find where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-249-Frame"><nobr><span class="math" id="MathJax-Span-1537" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1538"><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-249">C</script> achieves its global minimum.  Now,
of course, for the function plotted above, we can eyeball the graph
and find the minimum.  In that sense, I've perhaps shown slightly
<em>too</em> simple a function! A general function, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-250-Frame"><nobr><span class="math" id="MathJax-Span-1540" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1541"><span class="mi" id="MathJax-Span-1542" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-250">C</script>, may be a
complicated function of many variables, and it won't usually be
possible to just eyeball the graph to find the minimum.</p><p>One way of attacking the problem is to use calculus to try to find the
minimum analytically.  We could compute derivatives and then try using
them to find places where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-251-Frame"><nobr><span class="math" id="MathJax-Span-1543" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1544"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-251">C</script> is an extremum.  With some luck that
might work when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-252-Frame"><nobr><span class="math" id="MathJax-Span-1546" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-252">C</script> is a function of just one or a few variables.  But
it'll turn into a nightmare when we have many more variables.  And for
neural networks we'll often want <em>far</em> more variables - the
biggest neural networks have cost functions which depend on billions
of weights and biases in an extremely complicated way.  Using calculus
to minimize that just won't work!</p><p>(After asserting that we'll gain insight by imagining <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-253-Frame"><nobr><span class="math" id="MathJax-Span-1549" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1550"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">C</script> as a
function of just two variables, I've turned around twice in two
paragraphs and said, "hey, but what if it's a function of many more
than two variables?"  Sorry about that.  Please believe me when I say
that it really does help to imagine <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-254-Frame"><nobr><span class="math" id="MathJax-Span-1552" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1553"><span class="mi" id="MathJax-Span-1554" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">C</script> as a function of two
variables.  It just happens that sometimes that picture breaks down,
and the last two paragraphs were dealing with such breakdowns.  Good
thinking about mathematics often involves juggling multiple intuitive
pictures, learning when it's appropriate to use each picture, and when
it's not.)</p><p><a name="gradient_descent"></a></p><p>Okay, so calculus doesn't work.  Fortunately, there is a beautiful
analogy which suggests an algorithm which works pretty well.  We start
by thinking of our function as a kind of a valley.  If you squint just
a little at the plot above, that shouldn't be too hard.  And we
imagine a ball rolling down the slope of the valley.  Our everyday
experience tells us that the ball will eventually roll to the bottom
of the valley.  Perhaps we can use this idea as a way to find a
minimum for the function?  We'd randomly choose a starting point for
an (imaginary) ball, and then simulate the motion of the ball as it
rolled down to the bottom of the valley.  We could do this simulation
simply by computing derivatives (and perhaps some second derivatives)
of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-255-Frame"><nobr><span class="math" id="MathJax-Span-1555" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1556"><span class="mi" id="MathJax-Span-1557" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-255">C</script> - those derivatives would tell us everything we need to know
about the local "shape" of the valley, and therefore how our ball
should roll.</p><p>Based on what I've just written, you might suppose that we'll be
trying to write down Newton's equations of motion for the ball,
considering the effects of friction and gravity, and so on.  Actually,
we're not going to take the ball-rolling analogy quite that seriously
- we're devising an algorithm to minimize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-256-Frame"><nobr><span class="math" id="MathJax-Span-1558" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1559"><span class="mi" id="MathJax-Span-1560" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-256">C</script>, not developing an
accurate simulation of the laws of physics!  The ball's-eye view is
meant to stimulate our imagination, not constrain our thinking.  So
rather than get into all the messy details of physics, let's simply
ask ourselves: if we were declared God for a day, and could make up
our own laws of physics, dictating to the ball how it should roll,
what law or laws of motion could we pick that would make it so the
ball always rolled to the bottom of the valley?</p><p>To make this question more precise, let's think about what happens
when we move the ball a small amount <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-257-Frame"><nobr><span class="math" id="MathJax-Span-1561" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1562"><span class="mi" id="MathJax-Span-1563" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1564"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1565" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-257">\Delta v_1</script> in the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-258-Frame"><nobr><span class="math" id="MathJax-Span-1567" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1568"><span class="msubsup" id="MathJax-Span-1569"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1570" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1571" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-258">v_1</script>
direction, and a small amount <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-259-Frame"><nobr><span class="math" id="MathJax-Span-1572" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1573"><span class="mi" id="MathJax-Span-1574" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1575"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1576" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1577" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-259">\Delta v_2</script> in the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-260-Frame"><nobr><span class="math" id="MathJax-Span-1578" role="math" style="width: 0.983em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1579"><span class="msubsup" id="MathJax-Span-1580"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1581" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1582" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">v_2</script> direction.
Calculus tells us that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-261-Frame"><nobr><span class="math" id="MathJax-Span-1583" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1584"><span class="mi" id="MathJax-Span-1585" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">C</script> changes as follows:
<a class="displaced_anchor" name="eqtn7"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-262-Frame"><nobr><span class="math" id="MathJax-Span-1586" role="math" style="width: 100%; display: inline-block; min-width: 17.11em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 17.11em;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1587"><span class="mtable" id="MathJax-Span-1588" style="min-width: 17.453em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.11em;"><span style="display: inline-block; position: absolute; width: 11.669em; height: 0px; clip: rect(-1.517em 1000.002em 1.032em -999.998em); top: 0.002em; left: 50%; margin-left: -5.831em;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.669em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.002em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1592"><span class="mrow" id="MathJax-Span-1593"><span class="mi" id="MathJax-Span-1594" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1595" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1596" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1597" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1598"><span class="mi" id="MathJax-Span-1599" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1601"><span class="mi" id="MathJax-Span-1602" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1603"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1605" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-1606" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1607"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1608" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1609" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1610" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-1611" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1612"><span class="mi" id="MathJax-Span-1613" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1614" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1615"><span class="mi" id="MathJax-Span-1616" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1617"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1618" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-1620" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1621"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1622" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1623" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1624" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-7"><span class="mrow" id="MathJax-Span-1590"><span class="mtext" id="MathJax-Span-1591" style="font-family: MathJax_Main;">(7)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.353em; vertical-align: -0.948em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-262">\begin{eqnarray} 
  \Delta C \approx \frac{\partial C}{\partial v_1} \Delta v_1 +
  \frac{\partial C}{\partial v_2} \Delta v_2.
\tag{7}\end{eqnarray}</script>
We're going to find a way of choosing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-263-Frame"><nobr><span class="math" id="MathJax-Span-1625" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1626"><span class="mi" id="MathJax-Span-1627" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1628"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1629" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">\Delta v_1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-264-Frame"><nobr><span class="math" id="MathJax-Span-1631" role="math" style="width: 1.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1632"><span class="mi" id="MathJax-Span-1633" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1634"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1635" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1636" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">\Delta v_2</script> so
as to make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-265-Frame"><nobr><span class="math" id="MathJax-Span-1637" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1638"><span class="mi" id="MathJax-Span-1639" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1640" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-265">\Delta C</script> negative; i.e., we'll choose them so the ball is
rolling down into the valley.  To figure out how to make such a choice
it helps to define <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-266-Frame"><nobr><span class="math" id="MathJax-Span-1641" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1642"><span class="mi" id="MathJax-Span-1643" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1644" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">\Delta v</script> to be the vector of changes in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-267-Frame"><nobr><span class="math" id="MathJax-Span-1645" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1646"><span class="mi" id="MathJax-Span-1647" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-267">v</script>,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-268-Frame"><nobr><span class="math" id="MathJax-Span-1648" role="math" style="width: 8.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1649"><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1651" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1652" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main; padding-left: 0.297em;">(</span><span class="mi" id="MathJax-Span-1654" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1655"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1656" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1657" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1658" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1659" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-1660"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1661" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1662" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1663"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1664" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mi" id="MathJax-Span-1665" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-268">\Delta v \equiv (\Delta v_1, \Delta v_2)^T</script>, where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-269-Frame"><nobr><span class="math" id="MathJax-Span-1666" role="math" style="width: 0.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.689em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1667"><span class="mi" id="MathJax-Span-1668" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-269">T</script> is again the
transpose operation, turning row vectors into column vectors.  We'll
also define the <em>gradient</em> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-270-Frame"><nobr><span class="math" id="MathJax-Span-1669" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1670"><span class="mi" id="MathJax-Span-1671" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-270">C</script>
to be the vector of partial derivatives, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-271-Frame"><nobr><span class="math" id="MathJax-Span-1672" role="math" style="width: 5.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.502em 1000.002em 4.806em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1673"><span class="msubsup" id="MathJax-Span-1674"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px;"><span style="position: absolute; clip: rect(2.748em 1000.002em 4.806em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1675"><span class="mo" id="MathJax-Span-1676" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mfrac" id="MathJax-Span-1677"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.458em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1678"><span class="mi" id="MathJax-Span-1679" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.267em -999.998em); top: -3.625em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-1681"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1683"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1684" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.346em;"><span class="mn" id="MathJax-Span-1685" style="font-size: 50%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.179em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1686" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-1687" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.458em; left: 50%; margin-left: -0.488em;"><span class="mrow" id="MathJax-Span-1688"><span class="mi" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.267em -999.998em); top: -3.625em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-1691"><span class="mi" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1693"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px;"><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1694" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.346em;"><span class="mn" id="MathJax-Span-1695" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.179em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1696" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.9em; left: 4.414em;"><span class="mi" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.152em; vertical-align: -0.698em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-271">\left(\frac{\partial
    C}{\partial v_1}, \frac{\partial C}{\partial v_2}\right)^T</script>.  We
denote the gradient vector by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-272-Frame"><nobr><span class="math" id="MathJax-Span-1698" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1699"><span class="mi" id="MathJax-Span-1700" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-272">\nabla C</script>, i.e.:
<a class="displaced_anchor" name="eqtn8"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-273-Frame"><nobr><span class="math" id="MathJax-Span-1702" role="math" style="width: 100%; display: inline-block; min-width: 14.855em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.855em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1703"><span class="mtable" id="MathJax-Span-1704" style="min-width: 15.15em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.855em;"><span style="display: inline-block; position: absolute; width: 9.414em; height: 0px; clip: rect(-1.713em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -4.703em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 9.414em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.1em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1708"><span class="mrow" id="MathJax-Span-1709"><span class="mi" id="MathJax-Span-1710" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1711" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1712" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msubsup" id="MathJax-Span-1713" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 6.13em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1714"><span class="mo" id="MathJax-Span-1715" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-1716"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1717"><span class="mi" id="MathJax-Span-1718" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1719" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1720"><span class="mi" id="MathJax-Span-1721" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1722"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1723" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1724" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1725" style="font-family: MathJax_Main;">,</span><span class="mfrac" id="MathJax-Span-1726" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1727"><span class="mi" id="MathJax-Span-1728" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1729" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1730"><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1732"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1733" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1734" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-1735" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -5.194em; left: 5.591em;"><span class="mi" id="MathJax-Span-1736" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1737" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-8"><span class="mrow" id="MathJax-Span-1706"><span class="mtext" id="MathJax-Span-1707" style="font-family: MathJax_Main;">(8)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.752em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-273">\begin{eqnarray} 
  \nabla C \equiv \left( \frac{\partial C}{\partial v_1}, 
  \frac{\partial C}{\partial v_2} \right)^T.
\tag{8}\end{eqnarray}</script>
In a moment we'll rewrite the change <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-274-Frame"><nobr><span class="math" id="MathJax-Span-1738" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1739"><span class="mi" id="MathJax-Span-1740" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1741" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">\Delta C</script> in terms of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-275-Frame"><nobr><span class="math" id="MathJax-Span-1742" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1743"><span class="mi" id="MathJax-Span-1744" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1745" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-275">\Delta v</script>
and the gradient, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-276-Frame"><nobr><span class="math" id="MathJax-Span-1746" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1747"><span class="mi" id="MathJax-Span-1748" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1749" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-276">\nabla C</script>.  Before getting to that, though, I want
to clarify something that sometimes gets people hung up on the
gradient.  When meeting the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-277-Frame"><nobr><span class="math" id="MathJax-Span-1750" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1751"><span class="mi" id="MathJax-Span-1752" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1753" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">\nabla C</script> notation for the first time,
people sometimes wonder how they should think about the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-278-Frame"><nobr><span class="math" id="MathJax-Span-1754" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1755"><span class="mi" id="MathJax-Span-1756" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-278">\nabla</script>
symbol.  What, exactly, does <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-279-Frame"><nobr><span class="math" id="MathJax-Span-1757" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1758"><span class="mi" id="MathJax-Span-1759" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-279">\nabla</script> mean?  In fact, it's perfectly
fine to think of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-280-Frame"><nobr><span class="math" id="MathJax-Span-1760" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1761"><span class="mi" id="MathJax-Span-1762" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1763" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-280">\nabla C</script> as a single mathematical object - the
vector defined above - which happens to be written using two
symbols.  In this point of view, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-281-Frame"><nobr><span class="math" id="MathJax-Span-1764" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1765"><span class="mi" id="MathJax-Span-1766" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-281">\nabla</script> is just a piece of
notational flag-waving, telling you "hey, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-282-Frame"><nobr><span class="math" id="MathJax-Span-1767" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1768"><span class="mi" id="MathJax-Span-1769" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1770" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-282">\nabla C</script> is a gradient
vector".  There are more advanced points of view where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-283-Frame"><nobr><span class="math" id="MathJax-Span-1771" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1772"><span class="mi" id="MathJax-Span-1773" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-283">\nabla</script> can
be viewed as an independent mathematical entity in its own right (for
example, as a differential operator), but we won't need such points of
view.</p><p>With these definitions, the expression <span id="margin_131854609478_reveal" class="equation_link">(7)</span><span id="margin_131854609478" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn7" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-284-Frame"><nobr><span class="math" id="MathJax-Span-1774" role="math" style="width: 11.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.718em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1775"><span class="mtable" id="MathJax-Span-1776" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 11.424em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.051em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.424em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.002em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1777"><span class="mrow" id="MathJax-Span-1778"><span class="mi" id="MathJax-Span-1779" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1780" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1781" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-1782" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1783"><span class="mi" id="MathJax-Span-1784" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1785" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1786"><span class="mi" id="MathJax-Span-1787" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1788"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1789" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1790" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-1791" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1792"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1793" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1794" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1795" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mfrac" id="MathJax-Span-1796" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-1797"><span class="mi" id="MathJax-Span-1798" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-1800"><span class="mi" id="MathJax-Span-1801" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1802"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1803" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1804" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mi" id="MathJax-Span-1805" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-1806"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1807" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-1808" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.353em; vertical-align: -0.948em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-284">\begin{eqnarray} 
  \Delta C \approx \frac{\partial C}{\partial v_1} \Delta v_1 +
  \frac{\partial C}{\partial v_2} \Delta v_2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_131854609478_reveal').click(function() {$('#margin_131854609478').toggle('slow', function() {});});</script> for
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-285-Frame"><nobr><span class="math" id="MathJax-Span-1809" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1810"><span class="mi" id="MathJax-Span-1811" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-285">\Delta C</script> can be rewritten as
<a class="displaced_anchor" name="eqtn9"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-286-Frame"><nobr><span class="math" id="MathJax-Span-1813" role="math" style="width: 100%; display: inline-block; min-width: 12.453em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.453em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1814"><span class="mtable" id="MathJax-Span-1815" style="min-width: 12.699em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.453em;"><span style="display: inline-block; position: absolute; width: 6.914em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.478em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.914em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1819"><span class="mrow" id="MathJax-Span-1820"><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1822" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1823" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1824" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1825" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1826" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1827" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1828" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1829" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.277em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-9"><span class="mrow" id="MathJax-Span-1817"><span class="mtext" id="MathJax-Span-1818" style="font-family: MathJax_Main;">(9)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-286">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v.
\tag{9}\end{eqnarray}</script>
This equation helps explain why <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-287-Frame"><nobr><span class="math" id="MathJax-Span-1830" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1831"><span class="mi" id="MathJax-Span-1832" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1833" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-287">\nabla C</script> is called the gradient
vector: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-288-Frame"><nobr><span class="math" id="MathJax-Span-1834" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1835"><span class="mi" id="MathJax-Span-1836" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1837" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-288">\nabla C</script> relates changes in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-289-Frame"><nobr><span class="math" id="MathJax-Span-1838" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1839"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-289">v</script> to changes in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-290-Frame"><nobr><span class="math" id="MathJax-Span-1841" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1842"><span class="mi" id="MathJax-Span-1843" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-290">C</script>, just as
we'd expect something called a gradient to do.  But what's really
exciting about the equation is that it lets us see how to choose
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-291-Frame"><nobr><span class="math" id="MathJax-Span-1844" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1845"><span class="mi" id="MathJax-Span-1846" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1847" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-291">\Delta v</script> so as to make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-292-Frame"><nobr><span class="math" id="MathJax-Span-1848" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1849"><span class="mi" id="MathJax-Span-1850" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1851" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-292">\Delta C</script> negative.  In particular, suppose
we choose
<a class="displaced_anchor" name="eqtn10"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-293-Frame"><nobr><span class="math" id="MathJax-Span-1852" role="math" style="width: 100%; display: inline-block; min-width: 12.355em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.355em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1853"><span class="mtable" id="MathJax-Span-1854" style="min-width: 12.6em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.355em;"><span style="display: inline-block; position: absolute; width: 5.836em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -2.939em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.836em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1858"><span class="mrow" id="MathJax-Span-1859"><span class="mi" id="MathJax-Span-1860" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1862" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1863" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1864" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1865" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1866" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-10"><span class="mrow" id="MathJax-Span-1856"><span class="mtext" id="MathJax-Span-1857" style="font-family: MathJax_Main;">(10)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-293">\begin{eqnarray} 
  \Delta v = -\eta \nabla C,
\tag{10}\end{eqnarray}</script>
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-294-Frame"><nobr><span class="math" id="MathJax-Span-1868" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1869"><span class="mi" id="MathJax-Span-1870" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-294">\eta</script> is a small, positive parameter (known as the
<em>learning rate</em>).
Then Equation <span id="margin_593892680829_reveal" class="equation_link">(9)</span><span id="margin_593892680829" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn9" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-295-Frame"><nobr><span class="math" id="MathJax-Span-1871" role="math" style="width: 7.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1872"><span class="mtable" id="MathJax-Span-1873" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1874"><span class="mrow" id="MathJax-Span-1875"><span class="mi" id="MathJax-Span-1876" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1877" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1878" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1879" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1880" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1881" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1882" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1883" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-295">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v \nonumber\end{eqnarray}</script></a></span><script>$('#margin_593892680829_reveal').click(function() {$('#margin_593892680829').toggle('slow', function() {});});</script> tell us us that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-296-Frame"><nobr><span class="math" id="MathJax-Span-1884" role="math" style="width: 14.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.875em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1885"><span class="mi" id="MathJax-Span-1886" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1888" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mo" id="MathJax-Span-1889" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1890" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1892" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1893" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1894" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1895" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1896" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1897" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1898" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1899" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1900" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1901" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1902"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1903" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-1904" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-296">\Delta C \approx
-\eta \nabla C \cdot \nabla C = -\eta \|\nabla C\|^2</script>.  Because <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-297-Frame"><nobr><span class="math" id="MathJax-Span-1905" role="math" style="width: 5.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.904em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1906"><span class="mo" id="MathJax-Span-1907" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1908" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1909" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-1910"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-1911" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.493em;"><span class="mn" id="MathJax-Span-1912" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1913" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-1914" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-297">\|
\nabla C \|^2 \geq 0</script>, this guarantees that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-298-Frame"><nobr><span class="math" id="MathJax-Span-1915" role="math" style="width: 3.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1916"><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1918" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1919" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mn" id="MathJax-Span-1920" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-298">\Delta C \leq 0</script>, i.e.,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-299-Frame"><nobr><span class="math" id="MathJax-Span-1921" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1922"><span class="mi" id="MathJax-Span-1923" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-299">C</script> will always decrease, never increase, if we change <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-300-Frame"><nobr><span class="math" id="MathJax-Span-1924" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1925"><span class="mi" id="MathJax-Span-1926" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-300">v</script> according
to the prescription in <span id="margin_251867137358_reveal" class="equation_link">(10)</span><span id="margin_251867137358" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn10" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-301-Frame"><nobr><span class="math" id="MathJax-Span-1927" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1928"><span class="mtable" id="MathJax-Span-1929" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1930"><span class="mrow" id="MathJax-Span-1931"><span class="mi" id="MathJax-Span-1932" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1933" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1934" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1935" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1936" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1937" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1938" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-301">\begin{eqnarray} 
  \Delta v = -\eta \nabla C \nonumber\end{eqnarray}</script></a></span><script>$('#margin_251867137358_reveal').click(function() {$('#margin_251867137358').toggle('slow', function() {});});</script>.  (Within, of
course, the limits of the approximation in
Equation <span id="margin_676629878539_reveal" class="equation_link">(9)</span><span id="margin_676629878539" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn9" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-302-Frame"><nobr><span class="math" id="MathJax-Span-1939" role="math" style="width: 7.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1940"><span class="mtable" id="MathJax-Span-1941" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1942"><span class="mrow" id="MathJax-Span-1943"><span class="mi" id="MathJax-Span-1944" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1945" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1947" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1948" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-1949" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1950" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1951" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-302">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v \nonumber\end{eqnarray}</script></a></span><script>$('#margin_676629878539_reveal').click(function() {$('#margin_676629878539').toggle('slow', function() {});});</script>).  This is exactly the property we wanted!
And so we'll take Equation <span id="margin_537242775154_reveal" class="equation_link">(10)</span><span id="margin_537242775154" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn10" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-303-Frame"><nobr><span class="math" id="MathJax-Span-1952" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1953"><span class="mtable" id="MathJax-Span-1954" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1955"><span class="mrow" id="MathJax-Span-1956"><span class="mi" id="MathJax-Span-1957" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1958" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1959" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1960" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1961" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1962" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-303">\begin{eqnarray} 
  \Delta v = -\eta \nabla C \nonumber\end{eqnarray}</script></a></span><script>$('#margin_537242775154_reveal').click(function() {$('#margin_537242775154').toggle('slow', function() {});});</script> to define the
"law of motion" for the ball in our gradient descent algorithm.
That is, we'll use Equation <span id="margin_430113365367_reveal" class="equation_link">(10)</span><span id="margin_430113365367" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn10" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-304-Frame"><nobr><span class="math" id="MathJax-Span-1964" role="math" style="width: 6.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1965"><span class="mtable" id="MathJax-Span-1966" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1967"><span class="mrow" id="MathJax-Span-1968"><span class="mi" id="MathJax-Span-1969" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1970" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1971" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-1972" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-1973" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1974" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1975" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-304">\begin{eqnarray} 
  \Delta v = -\eta \nabla C \nonumber\end{eqnarray}</script></a></span><script>$('#margin_430113365367_reveal').click(function() {$('#margin_430113365367').toggle('slow', function() {});});</script> to compute a
value for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-305-Frame"><nobr><span class="math" id="MathJax-Span-1976" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1977"><span class="mi" id="MathJax-Span-1978" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1979" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-305">\Delta v</script>, then move the ball's position <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-306-Frame"><nobr><span class="math" id="MathJax-Span-1980" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1981"><span class="mi" id="MathJax-Span-1982" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-306">v</script> by that
amount:
<a class="displaced_anchor" name="eqtn11"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-307-Frame"><nobr><span class="math" id="MathJax-Span-1983" role="math" style="width: 100%; display: inline-block; min-width: 14.806em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.806em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-1984"><span class="mtable" id="MathJax-Span-1985" style="min-width: 15.1em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.806em;"><span style="display: inline-block; position: absolute; width: 8.336em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -4.164em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.336em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-1989"><span class="mrow" id="MathJax-Span-1990"><span class="mi" id="MathJax-Span-1991" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-1992" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-1993" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-1994" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-1995" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-1996" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-1997" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">v</span><span class="mo" id="MathJax-Span-1998" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-1999" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2000" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2001" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2002" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-11"><span class="mrow" id="MathJax-Span-1987"><span class="mtext" id="MathJax-Span-1988" style="font-family: MathJax_Main;">(11)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-307">\begin{eqnarray}
  v \rightarrow v' = v -\eta \nabla C.
\tag{11}\end{eqnarray}</script>
Then we'll use this update rule again, to make another move.  If we
keep doing this, over and over, we'll keep decreasing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-308-Frame"><nobr><span class="math" id="MathJax-Span-2003" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2004"><span class="mi" id="MathJax-Span-2005" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-308">C</script> until - we
hope - we reach a global minimum.</p><p>Summing up, the way the gradient descent algorithm works is to
repeatedly compute the gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-309-Frame"><nobr><span class="math" id="MathJax-Span-2006" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2007"><span class="mi" id="MathJax-Span-2008" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2009" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-309">\nabla C</script>, and then to move in the
<em>opposite</em> direction, "falling down" the slope of the valley.
We can visualize it like this:</p><p></p><center><img src="./Neural networks and deep learning 1_files/valley_with_ball.png" width="542px"></center><p></p><p>Notice that with this rule gradient descent doesn't reproduce real
physical motion.  In real life a ball has momentum, and that momentum
may allow it to roll across the slope, or even (momentarily) roll
uphill.  It's only after the effects of friction set in that the ball
is guaranteed to roll down into the valley.  By contrast, our rule for
choosing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-310-Frame"><nobr><span class="math" id="MathJax-Span-2010" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2011"><span class="mi" id="MathJax-Span-2012" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2013" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-310">\Delta v</script> just says "go down, right now".  That's still a
pretty good rule for finding the minimum!</p><p>To make gradient descent work correctly, we need to choose the
learning rate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-311-Frame"><nobr><span class="math" id="MathJax-Span-2014" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2015"><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-311">\eta</script> to be small
enough that Equation <span id="margin_375725396117_reveal" class="equation_link">(9)</span><span id="margin_375725396117" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn9" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-312-Frame"><nobr><span class="math" id="MathJax-Span-2017" role="math" style="width: 7.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2018"><span class="mtable" id="MathJax-Span-2019" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2020"><span class="mrow" id="MathJax-Span-2021"><span class="mi" id="MathJax-Span-2022" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2023" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2024" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2025" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2026" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2027" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2028" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2029" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-312">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v \nonumber\end{eqnarray}</script></a></span><script>$('#margin_375725396117_reveal').click(function() {$('#margin_375725396117').toggle('slow', function() {});});</script> is a good approximation.  If
we don't, we might end up with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-313-Frame"><nobr><span class="math" id="MathJax-Span-2030" role="math" style="width: 3.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.483em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2031"><span class="mi" id="MathJax-Span-2032" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2033" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2034" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-2035" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">\Delta C > 0</script>, which obviously would
not be good!  At the same time, we don't want <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-314-Frame"><nobr><span class="math" id="MathJax-Span-2036" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2037"><span class="mi" id="MathJax-Span-2038" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">\eta</script> to be too small,
since that will make the changes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-315-Frame"><nobr><span class="math" id="MathJax-Span-2039" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2040"><span class="mi" id="MathJax-Span-2041" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2042" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">\Delta v</script> tiny, and thus the
gradient descent algorithm will work very slowly.  In practical
implementations, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-316-Frame"><nobr><span class="math" id="MathJax-Span-2043" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2044"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-316">\eta</script> is often varied so that
Equation <span id="margin_374416260169_reveal" class="equation_link">(9)</span><span id="margin_374416260169" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn9" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-317-Frame"><nobr><span class="math" id="MathJax-Span-2046" role="math" style="width: 7.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2047"><span class="mtable" id="MathJax-Span-2048" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2049"><span class="mrow" id="MathJax-Span-2050"><span class="mi" id="MathJax-Span-2051" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2052" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2053" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2054" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2055" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2056" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2057" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2058" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-317">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v \nonumber\end{eqnarray}</script></a></span><script>$('#margin_374416260169_reveal').click(function() {$('#margin_374416260169').toggle('slow', function() {});});</script> remains a good approximation, but the
algorithm isn't too slow.  We'll see later how this
works. </p><p>I've explained gradient descent when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-318-Frame"><nobr><span class="math" id="MathJax-Span-2059" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2060"><span class="mi" id="MathJax-Span-2061" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-318">C</script> is a function of just two
variables.  But, in fact, everything works just as well even when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-319-Frame"><nobr><span class="math" id="MathJax-Span-2062" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2063"><span class="mi" id="MathJax-Span-2064" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-319">C</script>
is a function of many more variables.  Suppose in particular that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-320-Frame"><nobr><span class="math" id="MathJax-Span-2065" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2066"><span class="mi" id="MathJax-Span-2067" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-320">C</script>
is a function of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-321-Frame"><nobr><span class="math" id="MathJax-Span-2068" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2069"><span class="mi" id="MathJax-Span-2070" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-321">m</script> variables, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-322-Frame"><nobr><span class="math" id="MathJax-Span-2071" role="math" style="width: 4.365em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.267em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2072"><span class="msubsup" id="MathJax-Span-2073"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2074" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-2075" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2076" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2077" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-2078" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="msubsup" id="MathJax-Span-2079" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2080" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2081" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-322">v_1,\ldots,v_m</script>.  Then the change
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-323-Frame"><nobr><span class="math" id="MathJax-Span-2082" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2083"><span class="mi" id="MathJax-Span-2084" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2085" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-323">\Delta C</script> in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-324-Frame"><nobr><span class="math" id="MathJax-Span-2086" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2087"><span class="mi" id="MathJax-Span-2088" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-324">C</script> produced by a small change <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-325-Frame"><nobr><span class="math" id="MathJax-Span-2089" role="math" style="width: 10.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.002em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2090"><span class="mi" id="MathJax-Span-2091" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2092" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2093" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-2094" style="font-family: MathJax_Main; padding-left: 0.297em;">(</span><span class="mi" id="MathJax-Span-2095" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-2096"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2097" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-2098" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2099" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2100" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-2101" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="mi" id="MathJax-Span-2102" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-2103"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2104" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2106"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2107" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="mi" id="MathJax-Span-2108" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-325">\Delta v = (\Delta v_1,
\ldots, \Delta v_m)^T</script> is
<a class="displaced_anchor" name="eqtn12"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-326-Frame"><nobr><span class="math" id="MathJax-Span-2109" role="math" style="width: 100%; display: inline-block; min-width: 13.434em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 13.434em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2110"><span class="mtable" id="MathJax-Span-2111" style="min-width: 13.679em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.434em;"><span style="display: inline-block; position: absolute; width: 6.914em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.478em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.914em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2115"><span class="mrow" id="MathJax-Span-2116"><span class="mi" id="MathJax-Span-2117" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2118" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2119" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2120" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2122" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2123" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2124" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2125" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-12"><span class="mrow" id="MathJax-Span-2113"><span class="mtext" id="MathJax-Span-2114" style="font-family: MathJax_Main;">(12)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-326">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v,
\tag{12}\end{eqnarray}</script>
where the gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-327-Frame"><nobr><span class="math" id="MathJax-Span-2126" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2127"><span class="mi" id="MathJax-Span-2128" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2129" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-327">\nabla C</script> is the vector 
<a class="displaced_anchor" name="eqtn13"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-328-Frame"><nobr><span class="math" id="MathJax-Span-2130" role="math" style="width: 100%; display: inline-block; min-width: 17.797em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 17.797em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2131"><span class="mtable" id="MathJax-Span-2132" style="min-width: 18.189em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 17.797em;"><span style="display: inline-block; position: absolute; width: 11.424em; height: 0px; clip: rect(-1.713em 1000.002em 1.179em -999.998em); top: 0.002em; left: 50%; margin-left: -5.684em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.199em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 11.424em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.1em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2136"><span class="mrow" id="MathJax-Span-2137"><span class="mi" id="MathJax-Span-2138" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2139" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2140" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msubsup" id="MathJax-Span-2141" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 8.189em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2142"><span class="mo" id="MathJax-Span-2143" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-2144"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2145"><span class="mi" id="MathJax-Span-2146" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2147" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.733em;"><span class="mrow" id="MathJax-Span-2148"><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2150"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2151" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mn" id="MathJax-Span-2152" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2154" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="mfrac" id="MathJax-Span-2156" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2157"><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2159" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-2160"><span class="mi" id="MathJax-Span-2161" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2162"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2163" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2165" style="vertical-align: 0.002em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -5.194em; left: 7.6em;"><span class="mi" id="MathJax-Span-2166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.1em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2167" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.782em 1000.002em 0.493em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.919em; right: 0.002em;"><span class="mtd" id="mjx-eqn-13"><span class="mrow" id="MathJax-Span-2134"><span class="mtext" id="MathJax-Span-2135" style="font-family: MathJax_Main;">(13)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.752em; vertical-align: -1.097em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-328">\begin{eqnarray}
  \nabla C \equiv \left(\frac{\partial C}{\partial v_1}, \ldots, 
  \frac{\partial C}{\partial v_m}\right)^T.
\tag{13}\end{eqnarray}</script>
Just as for the two variable case, we can
choose
<a class="displaced_anchor" name="eqtn14"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-329-Frame"><nobr><span class="math" id="MathJax-Span-2168" role="math" style="width: 100%; display: inline-block; min-width: 12.355em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 12.355em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2169"><span class="mtable" id="MathJax-Span-2170" style="min-width: 12.6em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 12.355em;"><span style="display: inline-block; position: absolute; width: 5.836em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -2.939em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 5.836em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2174"><span class="mrow" id="MathJax-Span-2175"><span class="mi" id="MathJax-Span-2176" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2177" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2178" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-2179" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2180" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2181" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2182" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2183" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-14"><span class="mrow" id="MathJax-Span-2172"><span class="mtext" id="MathJax-Span-2173" style="font-family: MathJax_Main;">(14)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.153em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-329">\begin{eqnarray}
  \Delta v = -\eta \nabla C,
\tag{14}\end{eqnarray}</script>
and we're guaranteed that our (approximate)
expression <span id="margin_921159525724_reveal" class="equation_link">(12)</span><span id="margin_921159525724" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn12" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-330-Frame"><nobr><span class="math" id="MathJax-Span-2184" role="math" style="width: 7.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.963em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2185"><span class="mtable" id="MathJax-Span-2186" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2187"><span class="mrow" id="MathJax-Span-2188"><span class="mi" id="MathJax-Span-2189" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2190" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2191" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2192" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2193" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2194" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2195" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2196" style="font-family: MathJax_Math-italic;">v</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-330">\begin{eqnarray} 
  \Delta C \approx \nabla C \cdot \Delta v \nonumber\end{eqnarray}</script></a></span><script>$('#margin_921159525724_reveal').click(function() {$('#margin_921159525724').toggle('slow', function() {});});</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-331-Frame"><nobr><span class="math" id="MathJax-Span-2197" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2198"><span class="mi" id="MathJax-Span-2199" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2200" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-331">\Delta C</script> will be negative.
This gives us a way of following the gradient to a minimum, even when
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-332-Frame"><nobr><span class="math" id="MathJax-Span-2201" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2202"><span class="mi" id="MathJax-Span-2203" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-332">C</script> is a function of many variables, by repeatedly applying the update
rule
<a class="displaced_anchor" name="eqtn15"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-333-Frame"><nobr><span class="math" id="MathJax-Span-2204" role="math" style="width: 100%; display: inline-block; min-width: 14.806em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 14.806em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2205"><span class="mtable" id="MathJax-Span-2206" style="min-width: 15.1em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.806em;"><span style="display: inline-block; position: absolute; width: 8.336em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -4.164em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.336em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2210"><span class="mrow" id="MathJax-Span-2211"><span class="mi" id="MathJax-Span-2212" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2213" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msup" id="MathJax-Span-2214" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2215" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mo" id="MathJax-Span-2216" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2217" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2218" style="font-family: MathJax_Math-italic; padding-left: 0.297em;">v</span><span class="mo" id="MathJax-Span-2219" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2220" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2221" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2222" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2223" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-15"><span class="mrow" id="MathJax-Span-2208"><span class="mtext" id="MathJax-Span-2209" style="font-family: MathJax_Main;">(15)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-333">\begin{eqnarray}
  v \rightarrow v' = v-\eta \nabla C.
\tag{15}\end{eqnarray}</script>
You can think of this update rule as <em>defining</em> the gradient
descent algorithm.  It gives us a way of repeatedly changing the
position <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-334-Frame"><nobr><span class="math" id="MathJax-Span-2224" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2225"><span class="mi" id="MathJax-Span-2226" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-334">v</script> in order to find a minimum of the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-335-Frame"><nobr><span class="math" id="MathJax-Span-2227" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2228"><span class="mi" id="MathJax-Span-2229" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-335">C</script>.  The rule
doesn't always work - several things can go wrong and prevent
gradient descent from finding the global minimum of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-336-Frame"><nobr><span class="math" id="MathJax-Span-2230" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2231"><span class="mi" id="MathJax-Span-2232" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-336">C</script>, a point we'll
return to explore in later chapters.  But, in practice gradient
descent often works extremely well, and in neural networks we'll find
that it's a powerful way of minimizing the cost function, and so
helping the net learn.</p><p></p><p></p><p>Indeed, there's even a sense in which gradient descent is the optimal
strategy for searching for a minimum.  Let's suppose that we're trying
to make a move <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-337-Frame"><nobr><span class="math" id="MathJax-Span-2233" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2234"><span class="mi" id="MathJax-Span-2235" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2236" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-337">\Delta v</script> in position so as to decrease <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-338-Frame"><nobr><span class="math" id="MathJax-Span-2237" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2238"><span class="mi" id="MathJax-Span-2239" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-338">C</script> as much as
possible.  This is equivalent to minimizing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-339-Frame"><nobr><span class="math" id="MathJax-Span-2240" role="math" style="width: 6.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2241"><span class="mi" id="MathJax-Span-2242" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2243" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2244" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2245" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2246" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2247" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2248" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2249" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-339">\Delta C \approx \nabla C
\cdot \Delta v</script>.  We'll constrain the size of the move so that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-340-Frame"><nobr><span class="math" id="MathJax-Span-2250" role="math" style="width: 4.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.12em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2251"><span class="mo" id="MathJax-Span-2252" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2253" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2254" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2255" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-2256" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2257" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-340">\|
\Delta v \| = \epsilon</script> for some small fixed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-341-Frame"><nobr><span class="math" id="MathJax-Span-2258" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2259"><span class="mi" id="MathJax-Span-2260" style="font-family: MathJax_Math-italic;"></span><span class="mo" id="MathJax-Span-2261" style="font-family: MathJax_Main; padding-left: 0.297em;">&gt;</span><span class="mn" id="MathJax-Span-2262" style="font-family: MathJax_Main; padding-left: 0.297em;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-341">\epsilon > 0</script>.  In other
words, we want a move that is a small step of a fixed size, and we're
trying to find the movement direction which decreases <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-342-Frame"><nobr><span class="math" id="MathJax-Span-2263" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2264"><span class="mi" id="MathJax-Span-2265" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-342">C</script> as much as
possible.  It can be proved that the choice of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-343-Frame"><nobr><span class="math" id="MathJax-Span-2266" role="math" style="width: 1.375em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.326em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2267"><span class="mi" id="MathJax-Span-2268" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2269" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-343">\Delta v</script> which
minimizes <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-344-Frame"><nobr><span class="math" id="MathJax-Span-2270" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2271"><span class="mi" id="MathJax-Span-2272" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2273" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2274" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2275" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2276" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-344">\nabla C \cdot \Delta v</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-345-Frame"><nobr><span class="math" id="MathJax-Span-2277" role="math" style="width: 5.738em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2278"><span class="mi" id="MathJax-Span-2279" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2280" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2281" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mo" id="MathJax-Span-2282" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2283" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2284" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2285" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.052em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-345">\Delta v = - \eta \nabla C</script>,
where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-346-Frame"><nobr><span class="math" id="MathJax-Span-2286" role="math" style="width: 5.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2287"><span class="mi" id="MathJax-Span-2288" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2289" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2290" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span><span class="texatom" id="MathJax-Span-2291"><span class="mrow" id="MathJax-Span-2292"><span class="mo" id="MathJax-Span-2293" style="font-family: MathJax_Main;">/</span></span></span><span class="mo" id="MathJax-Span-2294" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2295" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2296" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2297" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-346">\eta = \epsilon / \|\nabla C\|</script> is determined by the size
constraint <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-347-Frame"><nobr><span class="math" id="MathJax-Span-2298" role="math" style="width: 4.218em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.12em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2299"><span class="mo" id="MathJax-Span-2300" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2301" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2302" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-2303" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-2304" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2305" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-347">\|\Delta v\| = \epsilon</script>.  So gradient descent can be
viewed as a way of taking small steps in the direction which does the
most to immediately decrease <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-348-Frame"><nobr><span class="math" id="MathJax-Span-2306" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2307"><span class="mi" id="MathJax-Span-2308" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-348">C</script>.</p><p></p><h4><a name="exercises_647181"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercises_647181">Exercises</a></h4><ul>
<li> Prove the assertion of the last paragraph.  <em>Hint:</em> If
    you're not already familiar with the
    <a href="http://en.wikipedia.org/wiki/Cauchy%E2%80%93Schwarz_inequality">Cauchy-Schwarz
      inequality</a>, you may find it helpful to familiarize yourself
    with it.<p></p><p></p></li><li> I explained gradient descent when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-349-Frame"><nobr><span class="math" id="MathJax-Span-2309" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2310"><span class="mi" id="MathJax-Span-2311" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-349">C</script> is a function of two
  variables, and when it's a function of more than two variables.
  What happens when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-350-Frame"><nobr><span class="math" id="MathJax-Span-2312" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2313"><span class="mi" id="MathJax-Span-2314" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-350">C</script> is a function of just one variable?  Can you
  provide a geometric interpretation of what gradient descent is doing
  in the one-dimensional case?
</li></ul><p></p><p></p><p>People have investigated many variations of gradient descent,
including variations that more closely mimic a real physical ball.
These ball-mimicking variations have some advantages, but also have a
major disadvantage: it turns out to be necessary to compute second
partial derivatives of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-351-Frame"><nobr><span class="math" id="MathJax-Span-2315" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2316"><span class="mi" id="MathJax-Span-2317" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-351">C</script>, and this can be quite costly.  To see why
it's costly, suppose we want to compute all the second partial
derivatives <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-352-Frame"><nobr><span class="math" id="MathJax-Span-2318" role="math" style="width: 5.346em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.248em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2319"><span class="msubsup" id="MathJax-Span-2320"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2321" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.64em;"><span class="mn" id="MathJax-Span-2322" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2323" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-2324"><span class="mrow" id="MathJax-Span-2325"><span class="mo" id="MathJax-Span-2326" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2328"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2329" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2330" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2331" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2332"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2333" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2334" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.252em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-352">\partial^2 C/ \partial v_j \partial v_k</script>.  If there are a
million such <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-353-Frame"><nobr><span class="math" id="MathJax-Span-2335" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2336"><span class="msubsup" id="MathJax-Span-2337"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2338" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2339" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-353">v_j</script> variables then we'd need to compute something like
a trillion (i.e., a million squared) second partial
derivatives*<span class="marginnote">
*Actually, more like half a trillion, since
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-354-Frame"><nobr><span class="math" id="MathJax-Span-2340" role="math" style="width: 12.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.769em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.945em 1000.004em 4.579em -999.996em); top: -3.999em; left: 0.004em;"><span class="mrow" id="MathJax-Span-2341"><span class="msubsup" id="MathJax-Span-2342"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px;"><span style="position: absolute; clip: rect(3.027em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2343" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.658em;"><span class="mn" id="MathJax-Span-2344" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-2345" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.086em;"></span></span><span class="texatom" id="MathJax-Span-2346"><span class="mrow" id="MathJax-Span-2347"><span class="mo" id="MathJax-Span-2348" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2349" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="msubsup" id="MathJax-Span-2350"><span style="display: inline-block; position: relative; width: 0.821em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2351" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.494em;"><span class="mi" id="MathJax-Span-2352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-2353" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="msubsup" id="MathJax-Span-2354"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2355" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.494em;"><span class="mi" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-2357" style="font-family: MathJax_Main; padding-left: 0.249em;">=</span><span class="msubsup" id="MathJax-Span-2358" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 1.066em; height: 0px;"><span style="position: absolute; clip: rect(3.027em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2359" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.326em; left: 0.658em;"><span class="mn" id="MathJax-Span-2360" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-2361" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.086em;"></span></span><span class="texatom" id="MathJax-Span-2362"><span class="mrow" id="MathJax-Span-2363"><span class="mo" id="MathJax-Span-2364" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2365" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="msubsup" id="MathJax-Span-2366"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2367" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.494em;"><span class="mi" id="MathJax-Span-2368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-2369" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="msubsup" id="MathJax-Span-2370"><span style="display: inline-block; position: relative; width: 0.821em; height: 0px;"><span style="position: absolute; clip: rect(3.354em 1000.004em 4.252em -999.996em); top: -3.999em; left: 0.004em;"><span class="mi" id="MathJax-Span-2371" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.836em; left: 0.494em;"><span class="mi" id="MathJax-Span-2372" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span><span style="border-left-width: 0.004em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.338em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-354">\partial^2 C/ \partial v_j \partial v_k = \partial^2 C/ \partial
  v_k \partial v_j</script>.  Still, you get the point.</span>!  That's going to be
computationally costly.  With that said, there are tricks for avoiding
this kind of problem, and finding alternatives to gradient descent is
an active area of investigation.  But in this book we'll use gradient
descent (and variations) as our main approach to learning in neural
networks.</p><p>How can we apply gradient descent to learn in a neural network?  The
idea is to use gradient descent to find the weights <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-355-Frame"><nobr><span class="math" id="MathJax-Span-2373" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2374"><span class="msubsup" id="MathJax-Span-2375"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2376" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2377" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-355">w_k</script> and biases
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-356-Frame"><nobr><span class="math" id="MathJax-Span-2378" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2379"><span class="msubsup" id="MathJax-Span-2380"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2381" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2382" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-356">b_l</script> which minimize the cost in
Equation <span id="margin_242703978050_reveal" class="equation_link">(6)</span><span id="margin_242703978050" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-357-Frame"><nobr><span class="math" id="MathJax-Span-2383" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2384"><span class="mtable" id="MathJax-Span-2385" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2386"><span class="mrow" id="MathJax-Span-2387"><span class="mi" id="MathJax-Span-2388" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2389" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2390" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-2391" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2392" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-2393" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2394" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2395" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2396" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2397"><span class="mn" id="MathJax-Span-2398" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-2399" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2400" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2401" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-2402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2403" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-2404" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2405" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2406" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2407" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2408" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2409" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-2410"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2411" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-357">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_242703978050_reveal').click(function() {$('#margin_242703978050').toggle('slow', function() {});});</script>.  To see how this works, let's
restate the gradient descent update rule, with the weights and biases
replacing the variables <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-358-Frame"><nobr><span class="math" id="MathJax-Span-2413" role="math" style="width: 0.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2414"><span class="msubsup" id="MathJax-Span-2415"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2416" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.493em;"><span class="mi" id="MathJax-Span-2417" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-358">v_j</script>.  In other words, our "position" now
has components <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-359-Frame"><nobr><span class="math" id="MathJax-Span-2418" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2419"><span class="msubsup" id="MathJax-Span-2420"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2421" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2422" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-359">w_k</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-360-Frame"><nobr><span class="math" id="MathJax-Span-2423" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2424"><span class="msubsup" id="MathJax-Span-2425"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2426" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2427" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-360">b_l</script>, and the gradient vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-361-Frame"><nobr><span class="math" id="MathJax-Span-2428" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2429"><span class="mi" id="MathJax-Span-2430" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2431" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-361">\nabla C</script> has
corresponding components <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-362-Frame"><nobr><span class="math" id="MathJax-Span-2432" role="math" style="width: 3.63em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.532em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2433"><span class="mi" id="MathJax-Span-2434" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2435" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-2436"><span class="mrow" id="MathJax-Span-2437"><span class="mo" id="MathJax-Span-2438" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2439" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2440"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2441" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-362">\partial C / \partial w_k</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-363-Frame"><nobr><span class="math" id="MathJax-Span-2443" role="math" style="width: 3.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2444"><span class="mi" id="MathJax-Span-2445" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2446" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="texatom" id="MathJax-Span-2447"><span class="mrow" id="MathJax-Span-2448"><span class="mo" id="MathJax-Span-2449" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-2450" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2451"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2452" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.297em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-363">\partial C
/ \partial b_l</script>.  Writing out the gradient descent update rule in
terms of components, we have
<a class="displaced_anchor" name="eqtn16"></a><a class="displaced_anchor" name="eqtn17"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-364-Frame"><nobr><span class="math" id="MathJax-Span-2454" role="math" style="width: 100%; display: inline-block; min-width: 16.963em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 16.963em;"><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2455"><span class="mtable" id="MathJax-Span-2456" style="min-width: 17.306em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 16.963em;"><span style="display: inline-block; position: absolute; width: 10.591em; height: 0px; clip: rect(-2.792em 1000.002em 2.306em -999.998em); top: 0.002em; left: 50%; margin-left: -5.292em;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.738em -999.998em); top: -4.115em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -5.243em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2460"><span class="mrow" id="MathJax-Span-2461"><span class="msubsup" id="MathJax-Span-2462"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2463" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2464" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2493"><span class="mrow" id="MathJax-Span-2494"><span class="msubsup" id="MathJax-Span-2495"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2496" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.12em;"></span></span><span style="position: absolute; clip: rect(2.159em 1000.002em 5.542em -999.998em); top: -4.066em; left: 1.424em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -5.243em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2465"><span class="mrow" id="MathJax-Span-2466"><span class="mi" id="MathJax-Span-2467"></span><span class="mo" id="MathJax-Span-2468" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -2.743em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2498"><span class="mrow" id="MathJax-Span-2499"><span class="mi" id="MathJax-Span-2500"></span><span class="mo" id="MathJax-Span-2501" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.071em;"></span></span><span style="position: absolute; clip: rect(2.993em 1000.002em 8.091em -999.998em); top: -5.782em; left: 2.993em;"><span style="display: inline-block; position: relative; width: 7.551em; height: 0px;"><span style="position: absolute; clip: rect(2.502em 1000.002em 5.002em -999.998em); top: -5.243em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2469"><span class="mrow" id="MathJax-Span-2470"><span class="msubsup" id="MathJax-Span-2471"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2472" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.738em;"><span class="mo" id="MathJax-Span-2473" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.738em;"><span class="mi" id="MathJax-Span-2474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2475" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2476" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2477" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2478" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2479" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2480" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-2481"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2482"><span class="mi" id="MathJax-Span-2483" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2484" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-2485"><span class="mi" id="MathJax-Span-2486" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2487"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2488" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2489" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.502em 1000.002em 5.002em -999.998em); top: -2.743em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2502"><span class="mrow" id="MathJax-Span-2503"><span class="msubsup" id="MathJax-Span-2504"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2505" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.444em;"><span class="mo" id="MathJax-Span-2506" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-2507" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2508" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2509" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2510" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2512" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2513" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mfrac" id="MathJax-Span-2514"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.684em;"><span class="mrow" id="MathJax-Span-2515"><span class="mi" id="MathJax-Span-2516" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mi" id="MathJax-Span-2517" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-2518"><span class="mi" id="MathJax-Span-2519" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2520"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2521" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.424em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2523" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.154em 1000.002em 1.669em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.243em; right: 0.002em;"><span class="mtd" id="mjx-eqn-16"><span class="mrow" id="MathJax-Span-2458"><span class="mtext" id="MathJax-Span-2459" style="font-family: MathJax_Main;">(16)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.743em; right: 0.002em;"><span class="mtd" id="mjx-eqn-17"><span class="mrow" id="MathJax-Span-2491"><span class="mtext" id="MathJax-Span-2492" style="font-family: MathJax_Main;">(17)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.787em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.952em; vertical-align: -2.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-364">\begin{eqnarray}
  w_k & \rightarrow & w_k' = w_k-\eta \frac{\partial C}{\partial w_k} \tag{16}\\
  b_l & \rightarrow & b_l' = b_l-\eta \frac{\partial C}{\partial b_l}.
\tag{17}\end{eqnarray}</script>
By repeatedly applying this update rule we can "roll down the hill",
and hopefully find a minimum of the cost function.  In other words,
this is a rule which can be used to learn in a neural network.</p><p>There are a number of challenges in applying the gradient descent
rule.  We'll look into those in depth in later chapters.  But for now
I just want to mention one problem.  To understand what the problem
is, let's look back at the quadratic cost in
Equation <span id="margin_585462673915_reveal" class="equation_link">(6)</span><span id="margin_585462673915" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-365-Frame"><nobr><span class="math" id="MathJax-Span-2524" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2525"><span class="mtable" id="MathJax-Span-2526" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2527"><span class="mrow" id="MathJax-Span-2528"><span class="mi" id="MathJax-Span-2529" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2530" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2531" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-2532" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2533" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-2534" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2535" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2536" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2537" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2538"><span class="mn" id="MathJax-Span-2539" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-2540" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2541" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2542" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-2543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2544" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-2545" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2546" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2547" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2548" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2549" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2550" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-2551"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2552" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-2553" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-365">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_585462673915_reveal').click(function() {$('#margin_585462673915').toggle('slow', function() {});});</script>.  Notice that this cost
function has the form <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-366-Frame"><nobr><span class="math" id="MathJax-Span-2554" role="math" style="width: 6.081em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.934em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2555"><span class="mi" id="MathJax-Span-2556" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2557" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2558" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2559" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-2560" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.542em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2561" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2562" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2564" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2565" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-366">C = \frac{1}{n} \sum_x C_x</script>, that is, it's an
average over costs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-367-Frame"><nobr><span class="math" id="MathJax-Span-2567" role="math" style="width: 6.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.65em 1000.002em 4.561em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2568"><span class="msubsup" id="MathJax-Span-2569"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2570" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2572" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2573" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.385em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.605em; left: 50%; margin-left: -1.615em;"><span class="mrow" id="MathJax-Span-2574"><span class="mo" id="MathJax-Span-2575" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2576" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2577" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2578" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2579" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2580" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-2582"><span style="display: inline-block; position: relative; width: 0.64em; height: 0px;"><span style="position: absolute; clip: rect(3.336em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2583" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.346em;"><span class="mn" id="MathJax-Span-2584" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.625em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2585" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.385em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.752em; vertical-align: -0.447em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-367">C_x \equiv \frac{\|y(x)-a\|^2}{2}</script> for individual
training examples.  In practice, to compute the gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-368-Frame"><nobr><span class="math" id="MathJax-Span-2586" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2587"><span class="mi" id="MathJax-Span-2588" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2589" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-368">\nabla C</script> we
need to compute the gradients <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-369-Frame"><nobr><span class="math" id="MathJax-Span-2590" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2591"><span class="mi" id="MathJax-Span-2592" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-2593"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2594" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-369">\nabla C_x</script> separately for each
training input, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-370-Frame"><nobr><span class="math" id="MathJax-Span-2596" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2597"><span class="mi" id="MathJax-Span-2598" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-370">x</script>, and then average them, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-371-Frame"><nobr><span class="math" id="MathJax-Span-2599" role="math" style="width: 7.748em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.6em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2600"><span class="mi" id="MathJax-Span-2601" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2602" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2603" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mfrac" id="MathJax-Span-2604" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2605" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-2606" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.542em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2607" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2608" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2609" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2610" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-2611"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2612" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2613" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-371">\nabla C = \frac{1}{n}
\sum_x \nabla C_x</script>.  Unfortunately, when the number of training inputs
is very large this can take a long time, and learning thus occurs
slowly.</p><p>An idea called <em>stochastic gradient descent</em> can be used to speed
up learning.  The idea is to estimate the gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-372-Frame"><nobr><span class="math" id="MathJax-Span-2614" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2615"><span class="mi" id="MathJax-Span-2616" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2617" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-372">\nabla C</script> by
computing <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-373-Frame"><nobr><span class="math" id="MathJax-Span-2618" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2619"><span class="mi" id="MathJax-Span-2620" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-2621"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2622" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-373">\nabla C_x</script> for a small sample of randomly chosen training
inputs.  By averaging over this small sample it turns out that we can
quickly get a good estimate of the true gradient <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-374-Frame"><nobr><span class="math" id="MathJax-Span-2624" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.218em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2625"><span class="mi" id="MathJax-Span-2626" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2627" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.098em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-374">\nabla C</script>, and this
helps speed up gradient descent, and thus learning.</p><p>To make these ideas more precise, stochastic gradient descent works by
randomly picking out a small number <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-375-Frame"><nobr><span class="math" id="MathJax-Span-2628" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2629"><span class="mi" id="MathJax-Span-2630" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-375">m</script> of randomly chosen training
inputs.  We'll label those random training inputs <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-376-Frame"><nobr><span class="math" id="MathJax-Span-2631" role="math" style="width: 6.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.669em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2632"><span class="msubsup" id="MathJax-Span-2633"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2634" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mn" id="MathJax-Span-2635" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2636" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2637" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2638" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mn" id="MathJax-Span-2639" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2640" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2641" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-2642" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="msubsup" id="MathJax-Span-2643" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2644" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mi" id="MathJax-Span-2645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-376">X_1, X_2, \ldots,
X_m</script>, and refer to them as a <em>mini-batch</em>.  Provided the sample
size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-377-Frame"><nobr><span class="math" id="MathJax-Span-2646" role="math" style="width: 0.934em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.885em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2647"><span class="mi" id="MathJax-Span-2648" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-377">m</script> is large enough we expect that the average value of the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-378-Frame"><nobr><span class="math" id="MathJax-Span-2649" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2650"><span class="mi" id="MathJax-Span-2651" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-2652"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2653" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2654"><span class="mrow" id="MathJax-Span-2655"><span class="msubsup" id="MathJax-Span-2656"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2657" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-2658" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-378">\nabla C_{X_j}</script> will be roughly equal to the average over all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-379-Frame"><nobr><span class="math" id="MathJax-Span-2659" role="math" style="width: 2.061em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.012em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2660"><span class="mi" id="MathJax-Span-2661" style="font-family: MathJax_Main;"></span><span class="msubsup" id="MathJax-Span-2662"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2663" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-379">\nabla
C_x</script>, that is,
<a class="displaced_anchor" name="eqtn18"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-380-Frame"><nobr><span class="math" id="MathJax-Span-2665" role="math" style="width: 100%; display: inline-block; min-width: 20.346em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 20.346em;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2666"><span class="mtable" id="MathJax-Span-2667" style="min-width: 20.738em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 20.346em;"><span style="display: inline-block; position: absolute; width: 13.973em; height: 0px; clip: rect(-1.566em 1000.002em 1.081em -999.998em); top: 0.002em; left: 50%; margin-left: -7.007em;"><span style="position: absolute; clip: rect(2.453em 1000.002em 5.1em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 13.973em; height: 0px;"><span style="position: absolute; clip: rect(2.208em 1000.002em 4.855em -999.998em); top: -3.772em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2671"><span class="mrow" id="MathJax-Span-2672"><span class="mfrac" id="MathJax-Span-2673"><span style="display: inline-block; position: relative; width: 5.051em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.61em -999.998em); top: -4.9em; left: 50%; margin-left: -2.449em;"><span class="mrow" id="MathJax-Span-2674"><span class="munderover" id="MathJax-Span-2675"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2676" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -4.507em; left: 1.081em;"><span class="mi" id="MathJax-Span-2677" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.316em -999.998em); top: -3.723em; left: 1.081em;"><span class="texatom" id="MathJax-Span-2678"><span class="mrow" id="MathJax-Span-2679"><span class="mi" id="MathJax-Span-2680" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2681" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2682" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2683" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-2684"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2685" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2686"><span class="mrow" id="MathJax-Span-2687"><span class="msubsup" id="MathJax-Span-2688"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="texatom" id="MathJax-Span-2690"><span class="mrow" id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2693" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 5.051em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2694" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2695" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 3.826em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.463em -999.998em); top: -4.752em; left: 50%; margin-left: -1.86em;"><span class="mrow" id="MathJax-Span-2696"><span class="munderover" id="MathJax-Span-2697"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2698" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-2699" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2700" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-2701"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2702" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2703" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-2704" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 3.826em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2705" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-2706" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mi" id="MathJax-Span-2707" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2708" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.635em 1000.002em 0.64em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.772em; right: 0.002em;"><span class="mtd" id="mjx-eqn-18"><span class="mrow" id="MathJax-Span-2669"><span class="mtext" id="MathJax-Span-2670" style="font-family: MathJax_Main;">(18)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.552em; vertical-align: -0.997em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-380">\begin{eqnarray}
  \frac{\sum_{j=1}^m \nabla C_{X_{j}}}{m} \approx \frac{\sum_x \nabla C_x}{n} = \nabla C,
\tag{18}\end{eqnarray}</script>
where the second sum is over the entire set of training data.
Swapping sides we get
<a class="displaced_anchor" name="eqtn19"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-381-Frame"><nobr><span class="math" id="MathJax-Span-2709" role="math" style="width: 100%; display: inline-block; min-width: 15.15em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 15.15em;"><span style="position: absolute; clip: rect(2.159em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2710"><span class="mtable" id="MathJax-Span-2711" style="min-width: 15.444em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 15.15em;"><span style="display: inline-block; position: absolute; width: 8.679em; height: 0px; clip: rect(-1.86em 1000.002em 1.326em -999.998em); top: 0.002em; left: 50%; margin-left: -4.36em;"><span style="position: absolute; clip: rect(2.159em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 8.679em; height: 0px;"><span style="position: absolute; clip: rect(2.306em 1000.002em 5.493em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2715"><span class="mrow" id="MathJax-Span-2716"><span class="mi" id="MathJax-Span-2717" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2718" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2719" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2720" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2721" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2723" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2724" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.15em;"><span class="texatom" id="MathJax-Span-2725"><span class="mrow" id="MathJax-Span-2726"><span class="mi" id="MathJax-Span-2727" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2728" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2729" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.169em -999.998em); top: -5.145em; left: 0.395em;"><span class="mi" id="MathJax-Span-2730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mi" id="MathJax-Span-2731" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="msubsup" id="MathJax-Span-2732"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2733" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2734"><span class="mrow" id="MathJax-Span-2735"><span class="msubsup" id="MathJax-Span-2736"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="texatom" id="MathJax-Span-2738"><span class="mrow" id="MathJax-Span-2739"><span class="mi" id="MathJax-Span-2740" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2741" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-1.027em 1000.002em 0.248em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="mjx-eqn-19"><span class="mrow" id="MathJax-Span-2713"><span class="mtext" id="MathJax-Span-2714" style="font-family: MathJax_Main;">(19)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.052em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-381">\begin{eqnarray}
  \nabla C \approx \frac{1}{m} \sum_{j=1}^m \nabla C_{X_{j}},
\tag{19}\end{eqnarray}</script>
confirming that we can estimate the overall gradient by computing
gradients just for the randomly chosen mini-batch. </p><p>To connect this explicitly to learning in neural networks, suppose
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-382-Frame"><nobr><span class="math" id="MathJax-Span-2742" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2743"><span class="msubsup" id="MathJax-Span-2744"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2745" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2746" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.703em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-382">w_k</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-383-Frame"><nobr><span class="math" id="MathJax-Span-2747" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2748"><span class="msubsup" id="MathJax-Span-2749"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2750" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2751" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-383">b_l</script> denote the weights and biases in our neural network.
Then stochastic gradient descent works by picking out a randomly
chosen mini-batch of training inputs, and training with those,
<a class="displaced_anchor" name="eqtn20"></a><a class="displaced_anchor" name="eqtn21"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-384-Frame"><nobr><span class="math" id="MathJax-Span-2752" role="math" style="width: 100%; display: inline-block; min-width: 19.904em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 19.904em;"><span style="position: absolute; clip: rect(3.581em 1000.002em 9.904em -999.998em); top: -7.007em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-2753"><span class="mtable" id="MathJax-Span-2754" style="min-width: 20.297em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 19.904em;"><span style="display: inline-block; position: absolute; width: 13.532em; height: 0px; clip: rect(-3.429em 1000.002em 2.895em -999.998em); top: 0.002em; left: 50%; margin-left: -6.762em;"><span style="position: absolute; clip: rect(2.453em 1000.002em 6.522em -999.998em); top: -4.752em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -5.733em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2758"><span class="mrow" id="MathJax-Span-2759"><span class="msubsup" id="MathJax-Span-2760"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2761" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2762" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -2.596em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2802"><span class="mrow" id="MathJax-Span-2803"><span class="msubsup" id="MathJax-Span-2804"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2805" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2806" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.757em;"></span></span><span style="position: absolute; clip: rect(2.306em 1000.002em 6.326em -999.998em); top: -4.703em; left: 1.424em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -5.733em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2763"><span class="mrow" id="MathJax-Span-2764"><span class="mi" id="MathJax-Span-2765"></span><span class="mo" id="MathJax-Span-2766" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -2.596em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2807"><span class="mrow" id="MathJax-Span-2808"><span class="mi" id="MathJax-Span-2809"></span><span class="mo" id="MathJax-Span-2810" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.708em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 9.904em -999.998em); top: -7.007em; left: 2.993em;"><span style="display: inline-block; position: relative; width: 10.493em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -5.733em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2767"><span class="mrow" id="MathJax-Span-2768"><span class="msubsup" id="MathJax-Span-2769"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2770" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.738em;"><span class="mo" id="MathJax-Span-2771" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.738em;"><span class="mi" id="MathJax-Span-2772" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2773" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2774" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2775" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2776" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2777" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-2778" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-2779" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2780" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2781" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2782" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-2783" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2784" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-2785"><span class="mi" id="MathJax-Span-2786" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2787"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2788" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2789"><span class="mrow" id="MathJax-Span-2790"><span class="msubsup" id="MathJax-Span-2791"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2792" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-2793" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-2794"><span class="mi" id="MathJax-Span-2795" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2796"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2797" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -2.596em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2811"><span class="mrow" id="MathJax-Span-2812"><span class="msubsup" id="MathJax-Span-2813"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2814" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.444em;"><span class="mo" id="MathJax-Span-2815" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-2816" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2817" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2818" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2819" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2820" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2821" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-2822" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-2823" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2824" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2825" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2826" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-2827" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2828" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-2829"><span class="mi" id="MathJax-Span-2830" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2831"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2832" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2833"><span class="mrow" id="MathJax-Span-2834"><span class="msubsup" id="MathJax-Span-2835"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-2837" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-2838"><span class="mi" id="MathJax-Span-2839" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2840"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2841" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2842" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="mo" id="MathJax-Span-2843" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.012em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-2.645em 1000.002em 1.816em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -5.733em; right: 0.002em;"><span class="mtd" id="mjx-eqn-20"><span class="mrow" id="MathJax-Span-2756"><span class="mtext" id="MathJax-Span-2757" style="font-family: MathJax_Main;">(20)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -2.596em; right: 0.002em;"><span class="mtd" id="mjx-eqn-21"><span class="mrow" id="MathJax-Span-2800"><span class="mtext" id="MathJax-Span-2801" style="font-family: MathJax_Main;">(21)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.012em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 6.252em; vertical-align: -2.848em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-384">\begin{eqnarray} 
  w_k & \rightarrow & w_k' = w_k-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial w_k} \tag{20}\\
  
  b_l & \rightarrow & b_l' = b_l-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial b_l},
\tag{21}\end{eqnarray}</script>
where the sums are over all the training examples <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-385-Frame"><nobr><span class="math" id="MathJax-Span-2844" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2845"><span class="msubsup" id="MathJax-Span-2846"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2847" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.836em;"><span class="mi" id="MathJax-Span-2848" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-385">X_j</script> in the current
mini-batch.  Then we pick out another randomly chosen mini-batch and
train with those.  And so on, until we've exhausted the training
inputs, which is said to complete an
<em>epoch</em> of training.  At that point
we start over with a new training epoch.</p><p>Incidentally, it's worth noting that conventions vary about scaling of
the cost function and of mini-batch updates to the weights and biases.
In Equation <span id="margin_184221599708_reveal" class="equation_link">(6)</span><span id="margin_184221599708" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn6" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-386-Frame"><nobr><span class="math" id="MathJax-Span-2849" role="math" style="width: 13.385em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.091em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2850"><span class="mtable" id="MathJax-Span-2851" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 12.748em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.346em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2852"><span class="mrow" id="MathJax-Span-2853"><span class="mi" id="MathJax-Span-2854" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="mo" id="MathJax-Span-2855" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2856" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-2857" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2858" style="font-family: MathJax_Math-italic; padding-left: 0.15em;">b</span><span class="mo" id="MathJax-Span-2859" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2860" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="mfrac" id="MathJax-Span-2861" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.228em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-2862" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.537em;"><span class="mrow" id="MathJax-Span-2863"><span class="mn" id="MathJax-Span-2864" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-2865" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 1.228em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2866" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2867" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.267em -999.998em); top: -2.988em; left: 0.542em;"><span class="mi" id="MathJax-Span-2868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2869" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mi" id="MathJax-Span-2870" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2871" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2872" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2873" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2874" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-2875" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">a</span><span class="msubsup" id="MathJax-Span-2876"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2877" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.493em;"><span class="mn" id="MathJax-Span-2878" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-386">\begin{eqnarray}  C(w,b) \equiv
  \frac{1}{2n} \sum_x \| y(x) - a\|^2 \nonumber\end{eqnarray}</script></a></span><script>$('#margin_184221599708_reveal').click(function() {$('#margin_184221599708').toggle('slow', function() {});});</script> we scaled the overall cost
function by a factor <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-387-Frame"><nobr><span class="math" id="MathJax-Span-2879" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2880"><span class="mfrac" id="MathJax-Span-2881"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2882" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-2883" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.542em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-387">\frac{1}{n}</script>.  People sometimes omit the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-388-Frame"><nobr><span class="math" id="MathJax-Span-2884" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2885"><span class="mfrac" id="MathJax-Span-2886"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2887" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.194em;"><span class="mi" id="MathJax-Span-2888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.542em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-388">\frac{1}{n}</script>, summing over the costs of individual training examples
instead of averaging.  This is particularly useful when the total
number of training examples isn't known in advance.  This can occur if
more training data is being generated in real time, for instance.
And, in a similar way, the mini-batch update rules <span id="margin_647289677581_reveal" class="equation_link">(20)</span><span id="margin_647289677581" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn20" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-389-Frame"><nobr><span class="math" id="MathJax-Span-2889" role="math" style="width: 14.12em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.826em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2890"><span class="mtable" id="MathJax-Span-2891" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 13.532em; height: 0px;"><span style="position: absolute; clip: rect(3.287em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.316em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2892"><span class="mrow" id="MathJax-Span-2893"><span class="msubsup" id="MathJax-Span-2894"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2895" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2896" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.022em -999.998em); top: -4.017em; left: 1.424em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.164em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2897"><span class="mrow" id="MathJax-Span-2898"><span class="mi" id="MathJax-Span-2899"></span><span class="mo" id="MathJax-Span-2900" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 2.993em;"><span style="display: inline-block; position: relative; width: 10.493em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -4.164em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2901"><span class="mrow" id="MathJax-Span-2902"><span class="msubsup" id="MathJax-Span-2903"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2904" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.738em;"><span class="mo" id="MathJax-Span-2905" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.738em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2908" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2909" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2911" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-2912" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-2913" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2914" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2915" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2916" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-2917" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2918" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-2919"><span class="mi" id="MathJax-Span-2920" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2921"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2922" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2923"><span class="mrow" id="MathJax-Span-2924"><span class="msubsup" id="MathJax-Span-2925"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-2927" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.88em;"><span class="mrow" id="MathJax-Span-2928"><span class="mi" id="MathJax-Span-2929" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2930"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2931" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-2932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.002em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-389">\begin{eqnarray} 
  w_k & \rightarrow & w_k' = w_k-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial w_k}  \nonumber\end{eqnarray}</script></a></span><script>$('#margin_647289677581_reveal').click(function() {$('#margin_647289677581').toggle('slow', function() {});});</script>
and <span id="margin_501377173417_reveal" class="equation_link">(21)</span><span id="margin_501377173417" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn21" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-390-Frame"><nobr><span class="math" id="MathJax-Span-2933" role="math" style="width: 12.748em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.502em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2934"><span class="mtable" id="MathJax-Span-2935" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 12.208em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.316em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-2936"><span class="mrow" id="MathJax-Span-2937"><span class="msubsup" id="MathJax-Span-2938"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2939" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2940" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.238em 1000.002em 4.022em -999.998em); top: -4.017em; left: 0.983em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.164em; left: 50%; margin-left: -0.635em;"><span class="mtd" id="MathJax-Span-2941"><span class="mrow" id="MathJax-Span-2942"><span class="mi" id="MathJax-Span-2943"></span><span class="mo" id="MathJax-Span-2944" style="font-family: MathJax_Main; padding-left: 0.297em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(2.208em 1000.002em 5.346em -999.998em); top: -4.017em; left: 2.551em;"><span style="display: inline-block; position: relative; width: 9.61em; height: 0px;"><span style="position: absolute; clip: rect(2.355em 1000.002em 5.493em -999.998em); top: -4.164em; left: 0.002em;"><span class="mtd" id="MathJax-Span-2945"><span class="mrow" id="MathJax-Span-2946"><span class="msubsup" id="MathJax-Span-2947"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2948" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.444em;"><span class="mo" id="MathJax-Span-2949" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-2950" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2951" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-2952" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2953" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2954" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-2955" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mfrac" id="MathJax-Span-2956" style="padding-left: 0.248em;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mi" id="MathJax-Span-2957" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -3.331em; left: 50%; margin-left: -0.439em;"><span class="mi" id="MathJax-Span-2958" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.983em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2959" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(2.944em 1000.002em 4.61em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-2960" style="font-family: MathJax_Size2; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.414em -999.998em); top: -2.939em; left: 0.591em;"><span class="mi" id="MathJax-Span-2961" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-2962" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 2.306em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.85em; left: 50%; margin-left: -1.076em;"><span class="mrow" id="MathJax-Span-2963"><span class="mi" id="MathJax-Span-2964" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2965"><span style="display: inline-block; position: relative; width: 1.62em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2966" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-2967"><span class="mrow" id="MathJax-Span-2968"><span class="msubsup" id="MathJax-Span-2969"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2970" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.919em; left: 0.591em;"><span class="mi" id="MathJax-Span-2971" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.316em -999.998em); top: -3.331em; left: 50%; margin-left: -0.635em;"><span class="mrow" id="MathJax-Span-2972"><span class="mi" id="MathJax-Span-2973" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-2974"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-2975" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-2976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 2.306em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.002em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-390">\begin{eqnarray}  
  b_l & \rightarrow & b_l' = b_l-\frac{\eta}{m}
  \sum_j \frac{\partial C_{X_j}}{\partial b_l} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_501377173417_reveal').click(function() {$('#margin_501377173417').toggle('slow', function() {});});</script> sometimes omit the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-391-Frame"><nobr><span class="math" id="MathJax-Span-2977" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.993em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2978"><span class="mfrac" id="MathJax-Span-2979"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -4.409em; left: 50%; margin-left: -0.194em;"><span class="mn" id="MathJax-Span-2980" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.581em 1000.002em 4.169em -999.998em); top: -3.674em; left: 50%; margin-left: -0.292em;"><span class="mi" id="MathJax-Span-2981" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 0.738em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-391">\frac{1}{m}</script> term out the
front of the sums.  Conceptually this makes little difference, since
it's equivalent to rescaling the learning rate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-392-Frame"><nobr><span class="math" id="MathJax-Span-2982" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2983"><span class="mi" id="MathJax-Span-2984" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-392">\eta</script>.  But when doing
detailed comparisons of different work it's worth watching out for.</p><p>We can think of stochastic gradient descent as being like political
polling: it's much easier to sample a small mini-batch than it is to
apply gradient descent to the full batch, just as carrying out a poll
is easier than running a full election.  For example, if we have a
training set of size <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-393-Frame"><nobr><span class="math" id="MathJax-Span-2985" role="math" style="width: 5.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.904em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2986"><span class="mi" id="MathJax-Span-2987" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2988" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-2989" style="font-family: MathJax_Main; padding-left: 0.297em;">60</span><span class="mo" id="MathJax-Span-2990" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2991" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-393">n = 60,000</script>, as in MNIST, and choose a
mini-batch size of (say) <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-394-Frame"><nobr><span class="math" id="MathJax-Span-2992" role="math" style="width: 3.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2993"><span class="mi" id="MathJax-Span-2994" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-2995" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-2996" style="font-family: MathJax_Main; padding-left: 0.297em;">10</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-394">m = 10</script>, this means we'll get a factor of
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-395-Frame"><nobr><span class="math" id="MathJax-Span-2997" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-2998"><span class="mn" id="MathJax-Span-2999" style="font-family: MathJax_Main;">6</span><span class="mo" id="MathJax-Span-3000" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3001" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-395">6,000</script> speedup in estimating the gradient!  Of course, the estimate
won't be perfect - there will be statistical fluctuations - but it
doesn't need to be perfect: all we really care about is moving in a
general direction that will help decrease <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-396-Frame"><nobr><span class="math" id="MathJax-Span-3002" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3003"><span class="mi" id="MathJax-Span-3004" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-396">C</script>, and that means we don't
need an exact computation of the gradient.  In practice, stochastic
gradient descent is a commonly used and powerful technique for
learning in neural networks, and it's the basis for most of the
learning techniques we'll develop in this book.</p><p></p><p></p><p></p><p></p><p></p><p></p><h4><a name="exercise_263792"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercise_263792">Exercise</a></h4><ul>
<li> An extreme version of gradient descent is to use a mini-batch
  size of just 1.  That is, given a training input, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-397-Frame"><nobr><span class="math" id="MathJax-Span-3005" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3006"><span class="mi" id="MathJax-Span-3007" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-397">x</script>, we update our
  weights and biases according to the rules <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-398-Frame"><nobr><span class="math" id="MathJax-Span-3008" role="math" style="width: 12.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.208em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3009"><span class="msubsup" id="MathJax-Span-3010"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3011" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3013" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msubsup" id="MathJax-Span-3014" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3015" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.738em;"><span class="mo" id="MathJax-Span-3016" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.738em;"><span class="mi" id="MathJax-Span-3017" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3018" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3019" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3020" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3021" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3022" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3023" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3024" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3025"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3026" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3028"><span class="mrow" id="MathJax-Span-3029"><span class="mo" id="MathJax-Span-3030" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3031" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3032"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3033" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3034" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-398">w_k \rightarrow w_k' =
  w_k - \eta \partial C_x / \partial w_k</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-399-Frame"><nobr><span class="math" id="MathJax-Span-3035" role="math" style="width: 10.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.512em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3036"><span class="msubsup" id="MathJax-Span-3037"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3038" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-3039" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3040" style="font-family: MathJax_Main; padding-left: 0.297em;"></span><span class="msubsup" id="MathJax-Span-3041" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3042" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.483em 1000.002em 4.12em -999.998em); top: -4.311em; left: 0.444em;"><span class="mo" id="MathJax-Span-3043" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.385em 1000.002em 4.169em -999.998em); top: -3.674em; left: 0.444em;"><span class="mi" id="MathJax-Span-3044" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3045" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="msubsup" id="MathJax-Span-3046" style="padding-left: 0.297em;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3047" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-3048" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3049" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3050" style="font-family: MathJax_Math-italic; padding-left: 0.248em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-3051" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3052"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3053" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3054" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3055"><span class="mrow" id="MathJax-Span-3056"><span class="mo" id="MathJax-Span-3057" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3058" style="font-family: MathJax_Main;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span><span class="msubsup" id="MathJax-Span-3059"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3060" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.444em;"><span class="mi" id="MathJax-Span-3061" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.398em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-399">b_l \rightarrow b_l' =
  b_l - \eta \partial C_x / \partial b_l</script>.  Then we choose another
  training input, and update the weights and biases again.  And so on,
  repeatedly.  This procedure is known as <em>online</em>,
  <em>on-line</em>, or <em>incremental</em> learning.  In online learning,
  a neural network learns from just one training input at a time (just
  as human beings do).  Name one advantage and one disadvantage of
  online learning, compared to stochastic gradient descent with a
  mini-batch size of, say, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-400-Frame"><nobr><span class="math" id="MathJax-Span-3062" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3063"><span class="mn" id="MathJax-Span-3064" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-400">20</script>.
</li></ul><p></p><p>Let me conclude this section by discussing a point that sometimes bugs
people new to gradient descent.  In neural networks the cost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-401-Frame"><nobr><span class="math" id="MathJax-Span-3065" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3066"><span class="mi" id="MathJax-Span-3067" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-401">C</script> is,
of course, a function of many variables - all the weights and biases
- and so in some sense defines a surface in a very high-dimensional
space.  Some people get hung up thinking: "Hey, I have to be able to
visualize all these extra dimensions".  And they may start to worry:
"I can't think in four dimensions, let alone five (or five
million)".  Is there some special ability they're missing, some
ability that "real" supermathematicians have?  Of course, the answer
is no.  Even most professional mathematicians can't visualize four
dimensions especially well, if at all.  The trick they use, instead,
is to develop other ways of representing what's going on.  That's
exactly what we did above: we used an algebraic (rather than visual)
representation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-402-Frame"><nobr><span class="math" id="MathJax-Span-3068" role="math" style="width: 1.62em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.571em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3069"><span class="mi" id="MathJax-Span-3070" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-3071" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-402">\Delta C</script> to figure out how to move so as to
decrease <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-403-Frame"><nobr><span class="math" id="MathJax-Span-3072" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3073"><span class="mi" id="MathJax-Span-3074" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.051em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-403">C</script>.  People who are good at thinking in high dimensions have
a mental library containing many different techniques along these
lines; our algebraic trick is just one example.  Those techniques may
not have the simplicity we're accustomed to when visualizing three
dimensions, but once you build up a library of such techniques, you
can get pretty good at thinking in high dimensions.  I won't go into
more detail here, but if you're interested then you may enjoy reading
<a href="http://mathoverflow.net/questions/25983/intuitive-crutches-for-higher-dimensional-thinking">this
  discussion</a> of some of the techniques professional mathematicians
use to think in high dimensions.  While some of the techniques
discussed are quite complex, much of the best content is intuitive and
accessible, and could be mastered by anyone.</p><p></p><p>
</p><h3><a name="implementing_our_network_to_classify_digits"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits">Implementing our network to classify digits</a></h3><p></p><p>Alright, let's write a program that learns how to recognize
handwritten digits, using stochastic gradient descent and the MNIST
training data.  The first thing we need is to get the MNIST data.  If
you're a <tt>git</tt> user then you can obtain the data by cloning the
code repository for this book,</p><p></p><div class="highlight"><pre>git clone https://github.com/mnielsen/neural-networks-and-deep-learning.git
</pre></div>
<p></p><p>If you don't use <tt>git</tt> then you can download the data and code
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/archive/master.zip">here</a>.</p><p>Incidentally, when I described the MNIST data earlier, I said it was
split into 60,000 training images, and 10,000 test images.  That's the
official MNIST description.  Actually, we're going to split the data a
little differently.  We'll leave the test images as is, but split the
60,000-image MNIST training set into two parts: a set of 50,000
images, which we'll use to train our neural network, and a separate
10,000 image <em>validation set</em>.  We won't
use the validation data in this chapter, but later in the book we'll
find it useful in figuring out how to set certain
<em>hyper-parameters</em> of the neural network - things like the
learning rate, and so on, which aren't directly selected by our
learning algorithm.  Although the validation data isn't part of the
original MNIST specification, many people use MNIST in this fashion,
and the use of validation data is common in neural networks.  When I
refer to the "MNIST training data" from now on, I'll be referring to
our 50,000 image data set, not the original 60,000 image data
set*<span class="marginnote">
*As noted earlier, the MNIST data set is based on two data
  sets collected by NIST, the United States' National Institute of
  Standards and Technology.  To construct MNIST the NIST data sets
  were stripped down and put into a more convenient format by Yann
  LeCun, Corinna Cortes, and Christopher J. C. Burges.  See
  <a href="http://yann.lecun.com/exdb/mnist/">this link</a> for more
  details.  The data set in my repository is in a form that makes it
  easy to load and manipulate the MNIST data in Python.  I obtained
  this particular form of the data from the LISA machine learning
  laboratory at the University of Montreal
  (<a href="http://www.deeplearning.net/tutorial/gettingstarted.html">link</a>).</span>.</p><p></p><p>Apart from the MNIST data we also need a Python library called
<a href="http://numpy.org/">Numpy</a>, for doing fast linear algebra.  If you
don't already have Numpy installed, you can get it
<a href="http://www.scipy.org/install.html">here</a>.</p><p>Let me explain the core features of the neural networks code, before
giving a full listing, below.  The centrepiece is a <tt>Network</tt>
class, which we use to represent a neural network.  Here's the code we
use to initialize a <tt>Network</tt> object:</p><p>
</p><div class="highlight"><pre><span class="k">class</span> <span class="nc">Network</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sizes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
</pre></div>
<p></p><p>In this code, the list <tt>sizes</tt> contains the number of neurons in
the respective layers.  So, for example, if we want to create a
<tt>Network</tt> object with 2 neurons in the first layer, 3 neurons in
the second layer, and 1 neuron in the final layer, we'd do this with
the code:
</p><div class="highlight"><pre><span class="n">net</span> <span class="o">=</span> <span class="n">Network</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

<a name="weight_initialization"></a> The biases
and weights in the <tt>Network</tt> object are all initialized randomly,
using the Numpy <tt>np.random.randn</tt> function to generate Gaussian
distributions with mean <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-404-Frame"><nobr><span class="math" id="MathJax-Span-3075" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3076"><span class="mn" id="MathJax-Span-3077" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-404">0</script> and standard deviation <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-405-Frame"><nobr><span class="math" id="MathJax-Span-3078" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3079"><span class="mn" id="MathJax-Span-3080" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-405">1</script>.  This random
initialization gives our stochastic gradient descent algorithm a place
to start from.  In later chapters we'll find better ways of
initializing the weights and biases, but this will do for now.  Note
that the <tt>Network</tt> initialization code assumes that the first
layer of neurons is an input layer, and omits to set any biases for
those neurons, since biases are only ever used in computing the
outputs from later layers.<p></p><p>Note also that the biases and weights are stored as lists of Numpy
matrices.  So, for example <tt>net.weights[1]</tt> is a Numpy matrix
storing the weights connecting the second and third layers of neurons.
(It's not the first and second layers, since Python's list indexing
starts at <tt>0</tt>.)  Since <tt>net.weights[1]</tt> is rather verbose,
let's just denote that matrix <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-406-Frame"><nobr><span class="math" id="MathJax-Span-3081" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3082"><span class="mi" id="MathJax-Span-3083" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-406">w</script>.  It's a matrix such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-407-Frame"><nobr><span class="math" id="MathJax-Span-3084" role="math" style="width: 1.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3085"><span class="msubsup" id="MathJax-Span-3086"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3087" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="texatom" id="MathJax-Span-3088"><span class="mrow" id="MathJax-Span-3089"><span class="mi" id="MathJax-Span-3090" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mi" id="MathJax-Span-3091" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.853em; vertical-align: -0.348em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-407">w_{jk}</script>
is the weight for the connection between the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-408-Frame"><nobr><span class="math" id="MathJax-Span-3092" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3093"><span class="msubsup" id="MathJax-Span-3094"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3095" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="texatom" id="MathJax-Span-3096"><span class="mrow" id="MathJax-Span-3097"><span class="mi" id="MathJax-Span-3098" style="font-size: 70.7%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: MathJax_Main;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-408">k^{\rm th}</script> neuron in the
second layer, and the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-409-Frame"><nobr><span class="math" id="MathJax-Span-3100" role="math" style="width: 1.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3101"><span class="msubsup" id="MathJax-Span-3102"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3103" style="font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.395em;"><span class="texatom" id="MathJax-Span-3104"><span class="mrow" id="MathJax-Span-3105"><span class="mi" id="MathJax-Span-3106" style="font-size: 70.7%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-3107" style="font-size: 70.7%; font-family: MathJax_Main;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-409">j^{\rm th}</script> neuron in the third layer.  This ordering
of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-410-Frame"><nobr><span class="math" id="MathJax-Span-3108" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3109"><span class="mi" id="MathJax-Span-3110" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-410">j</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-411-Frame"><nobr><span class="math" id="MathJax-Span-3111" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3112"><span class="mi" id="MathJax-Span-3113" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-411">k</script> indices may seem strange - surely it'd make more
sense to swap the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-412-Frame"><nobr><span class="math" id="MathJax-Span-3114" role="math" style="width: 0.395em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.395em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3115"><span class="mi" id="MathJax-Span-3116" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-412">j</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-413-Frame"><nobr><span class="math" id="MathJax-Span-3117" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3118"><span class="mi" id="MathJax-Span-3119" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-413">k</script> indices around?  The big advantage of
using this ordering is that it means that the vector of activations of
the third layer of neurons is:
<a class="displaced_anchor" name="eqtn22"></a><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display"><span class="MathJax" id="MathJax-Element-414-Frame"><nobr><span class="math" id="MathJax-Span-3120" role="math" style="width: 100%; display: inline-block; min-width: 13.238em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 102%; min-width: 13.238em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em; width: 100%;"><span class="mrow" id="MathJax-Span-3121"><span class="mtable" id="MathJax-Span-3122" style="min-width: 13.483em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 13.238em;"><span style="display: inline-block; position: absolute; width: 6.767em; height: 0px; clip: rect(-0.929em 1000.002em 0.444em -999.998em); top: 0.002em; left: 50%; margin-left: -3.38em;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3126"><span class="mrow" id="MathJax-Span-3127"><span class="msup" id="MathJax-Span-3128"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3129" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mo" id="MathJax-Span-3130" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3131" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-3132" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3133" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3134" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-3135" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3136" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3137" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3138" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3139" style="font-family: MathJax_Main;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.767em; height: 0px; clip: rect(-0.88em 1000.002em 0.444em -999.998em); top: 0.002em; right: 0.002em; margin-left: 0.787em; margin-right: 0.787em;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="mjx-eqn-22"><span class="mrow" id="MathJax-Span-3124"><span class="mtext" id="MathJax-Span-3125" style="font-family: MathJax_Main;">(22)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-414">\begin{eqnarray} 
  a' = \sigma(w a + b).
\tag{22}\end{eqnarray}</script>
There's quite a bit going on in this equation, so let's unpack it
piece by piece.  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-415-Frame"><nobr><span class="math" id="MathJax-Span-3140" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3141"><span class="mi" id="MathJax-Span-3142" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-415">a</script> is the vector of activations of the second layer
of neurons. To obtain <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-416-Frame"><nobr><span class="math" id="MathJax-Span-3143" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3144"><span class="msup" id="MathJax-Span-3145"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3146" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.36em; left: 0.542em;"><span class="mo" id="MathJax-Span-3147" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-416">a'</script> we multiply <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-417-Frame"><nobr><span class="math" id="MathJax-Span-3148" role="math" style="width: 0.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.542em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3149"><span class="mi" id="MathJax-Span-3150" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-417">a</script> by the weight matrix <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-418-Frame"><nobr><span class="math" id="MathJax-Span-3151" role="math" style="width: 0.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3152"><span class="mi" id="MathJax-Span-3153" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-418">w</script>,
and add the vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-419-Frame"><nobr><span class="math" id="MathJax-Span-3154" role="math" style="width: 0.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.444em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3155"><span class="mi" id="MathJax-Span-3156" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-419">b</script> of biases.  We then apply the function <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-420-Frame"><nobr><span class="math" id="MathJax-Span-3157" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3158"><span class="mi" id="MathJax-Span-3159" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-420">\sigma</script>
elementwise to every entry in the vector <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-421-Frame"><nobr><span class="math" id="MathJax-Span-3160" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.267em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3161"><span class="mi" id="MathJax-Span-3162" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-3163" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3164" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3165" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.148em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-421">w a +b</script>.  (This is called
<em>vectorizing</em> the function
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-422-Frame"><nobr><span class="math" id="MathJax-Span-3166" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3167"><span class="mi" id="MathJax-Span-3168" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-422">\sigma</script>.) It's easy to verify that
Equation <span id="margin_585712172308_reveal" class="equation_link">(22)</span><span id="margin_585712172308" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn22" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-423-Frame"><nobr><span class="math" id="MathJax-Span-3169" role="math" style="width: 6.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3170"><span class="mtable" id="MathJax-Span-3171" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3172"><span class="mrow" id="MathJax-Span-3173"><span class="msup" id="MathJax-Span-3174"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3175" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mo" id="MathJax-Span-3176" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3177" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-3178" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3179" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3180" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-3181" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3182" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3183" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3184" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-423">\begin{eqnarray} 
  a' = \sigma(w a + b) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_585712172308_reveal').click(function() {$('#margin_585712172308').toggle('slow', function() {});});</script> gives the same result as our
earlier rule, Equation <span id="margin_710786160786_reveal" class="equation_link">(4)</span><span id="margin_710786160786" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn4" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-424-Frame"><nobr><span class="math" id="MathJax-Span-3185" role="math" style="width: 11.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3186"><span class="mtable" id="MathJax-Span-3187" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.689em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.689em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.297em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3188"><span class="mrow" id="MathJax-Span-3189"><span class="mfrac" id="MathJax-Span-3190"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-3191" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -3.282em; left: 50%; margin-left: -5.145em;"><span class="mrow" id="MathJax-Span-3192"><span class="mn" id="MathJax-Span-3193" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3194" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3195" style="font-family: MathJax_Main; padding-left: 0.248em;">exp</span><span class="mo" id="MathJax-Span-3196"></span><span class="mo" id="MathJax-Span-3197" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-3198" style="font-family: MathJax_Main;"></span><span class="munderover" id="MathJax-Span-3199" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3200" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-3201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3202" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3203" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3205"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3206" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-3207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3208" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3209" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3210" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 10.444em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-424">\begin{eqnarray} 
  \frac{1}{1+\exp(-\sum_j w_j x_j-b)} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_710786160786_reveal').click(function() {$('#margin_710786160786').toggle('slow', function() {});});</script>, for
computing the output of a sigmoid neuron.</p><p></p><h4><a name="exercise_36214"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercise_36214">Exercise</a></h4><ul>
<li> Write out Equation <span id="margin_182460219938_reveal" class="equation_link">(22)</span><span id="margin_182460219938" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn22" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-425-Frame"><nobr><span class="math" id="MathJax-Span-3211" role="math" style="width: 6.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3212"><span class="mtable" id="MathJax-Span-3213" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3214"><span class="mrow" id="MathJax-Span-3215"><span class="msup" id="MathJax-Span-3216"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3217" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mo" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3219" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-3220" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3221" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3222" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-3223" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3224" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3225" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3226" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-425">\begin{eqnarray} 
  a' = \sigma(w a + b) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_182460219938_reveal').click(function() {$('#margin_182460219938').toggle('slow', function() {});});</script> in component
  form, and verify that it gives the same result as the
  rule <span id="margin_183572374297_reveal" class="equation_link">(4)</span><span id="margin_183572374297" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn4" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-426-Frame"><nobr><span class="math" id="MathJax-Span-3227" role="math" style="width: 11.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3228"><span class="mtable" id="MathJax-Span-3229" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 10.689em; height: 0px;"><span style="position: absolute; clip: rect(2.404em 1000.002em 5.15em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 10.689em; height: 0px;"><span style="position: absolute; clip: rect(2.551em 1000.002em 5.297em -999.998em); top: -4.164em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3230"><span class="mrow" id="MathJax-Span-3231"><span class="mfrac" id="MathJax-Span-3232"><span style="display: inline-block; position: relative; width: 10.444em; height: 0px; margin-right: 0.1em; margin-left: 0.1em;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.703em; left: 50%; margin-left: -0.243em;"><span class="mn" id="MathJax-Span-3233" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.14em 1000.002em 4.61em -999.998em); top: -3.282em; left: 50%; margin-left: -5.145em;"><span class="mrow" id="MathJax-Span-3234"><span class="mn" id="MathJax-Span-3235" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3236" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3237" style="font-family: MathJax_Main; padding-left: 0.248em;">exp</span><span class="mo" id="MathJax-Span-3238"></span><span class="mo" id="MathJax-Span-3239" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-3240" style="font-family: MathJax_Main;"></span><span class="munderover" id="MathJax-Span-3241" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.424em; height: 0px;"><span style="position: absolute; clip: rect(3.14em 1000.002em 4.414em -999.998em); top: -4.017em; left: 0.002em;"><span class="mo" id="MathJax-Span-3242" style="font-family: MathJax_Size1; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.723em; left: 1.081em;"><span class="mi" id="MathJax-Span-3243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3244" style="padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3245" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.738em;"><span class="mi" id="MathJax-Span-3246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3247"><span style="display: inline-block; position: relative; width: 0.934em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3248" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -3.87em; left: 0.591em;"><span class="mi" id="MathJax-Span-3249" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3250" style="font-family: MathJax_Main; padding-left: 0.248em;"></span><span class="mi" id="MathJax-Span-3251" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3252" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.885em 1000.002em 1.228em -999.998em); top: -1.272em; left: 0.002em;"><span style="border-left-width: 10.444em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.002em;"></span><span style="display: inline-block; width: 0px; height: 1.081em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.652em; vertical-align: -1.047em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-426">\begin{eqnarray} 
  \frac{1}{1+\exp(-\sum_j w_j x_j-b)} \nonumber\end{eqnarray}</script></a></span><script>$('#margin_183572374297_reveal').click(function() {$('#margin_183572374297').toggle('slow', function() {});});</script> for computing the output
  of a sigmoid neuron.
</li></ul><p></p><p>With all this in mind, it's easy to write code computing the output
from a <tt>Network</tt> instance.  We begin by defining the sigmoid
function, and then using Numpy to define a vectorized form of that
function:
</p><div class="highlight"><pre><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>

<span class="n">sigmoid_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>
</pre></div>

We then add a <tt>feedforward</tt> method to the <tt>Network</tt> class,
which, given an input <tt>a</tt> for the network, returns the
corresponding output.  All the method does is applies
Equation <span id="margin_729201138385_reveal" class="equation_link">(22)</span><span id="margin_729201138385" class="marginequation" style="display: none;"><a href="http://neuralnetworksanddeeplearning.com/chap1.html#eqtn22" style="padding-bottom: 5px;" onmouseover="this.style.borderBottom=&#39;1px solid #2A6EA6&#39;;" onmouseout="this.style.borderBottom=&#39;0px&#39;;"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-427-Frame"><nobr><span class="math" id="MathJax-Span-3253" role="math" style="width: 6.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.767em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3254"><span class="mtable" id="MathJax-Span-3255" style="padding-right: 0.15em; padding-left: 0.15em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.091em 1000.002em 4.463em -999.998em); top: -4.017em; left: 0.002em;"><span style="display: inline-block; position: relative; width: 6.473em; height: 0px;"><span style="position: absolute; clip: rect(3.042em 1000.002em 4.414em -999.998em); top: -3.968em; right: 0.002em;"><span class="mtd" id="MathJax-Span-3256"><span class="mrow" id="MathJax-Span-3257"><span class="msup" id="MathJax-Span-3258"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mi" id="MathJax-Span-3259" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.542em;"><span class="mo" id="MathJax-Span-3260" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span><span class="mo" id="MathJax-Span-3261" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mi" id="MathJax-Span-3262" style="font-family: MathJax_Math-italic; padding-left: 0.297em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3263" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3264" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-3265" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3266" style="font-family: MathJax_Main; padding-left: 0.248em;">+</span><span class="mi" id="MathJax-Span-3267" style="font-family: MathJax_Math-italic; padding-left: 0.248em;">b</span><span class="mo" id="MathJax-Span-3268" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.203em; vertical-align: -0.348em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-427">\begin{eqnarray} 
  a' = \sigma(w a + b) \nonumber\end{eqnarray}</script></a></span><script>$('#margin_729201138385_reveal').click(function() {$('#margin_729201138385').toggle('slow', function() {});});</script> for each layer:
<div class="highlight"><pre>    <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">"""Return the output of the network if "a" is input."""</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sigmoid_vec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>
</pre></div>
<p></p><p>Of course, the main thing we want our <tt>Network</tt> objects to do is
to learn.  To that end we'll give them an <tt>SGD</tt> method which
implements stochastic gradient descent.  Here's the code.  It's a
little mysterious in a few places, but I'll break it down below, after
the listing.</p><p></p><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">SGD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span>
            <span class="n">test_data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">"""Train the neural network using mini-batch stochastic</span>
<span class="sd">        gradient descent.  The "training_data" is a list of tuples</span>
<span class="sd">        "(x, y)" representing the training inputs and the desired</span>
<span class="sd">        outputs.  The other non-optional parameters are</span>
<span class="sd">        self-explanatory.  If "test_data" is provided then the</span>
<span class="sd">        network will be evaluated against the test data after each</span>
<span class="sd">        epoch, and partial progress printed out.  This is useful for</span>
<span class="sd">        tracking progress, but slows things down substantially."""</span>
        <span class="k">if</span> <span class="n">test_data</span><span class="p">:</span> <span class="n">n_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
            <span class="n">mini_batches</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">training_data</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="n">mini_batch_size</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">mini_batch</span> <span class="ow">in</span> <span class="n">mini_batches</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_mini_batch</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">test_data</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">"Epoch {0}: {1} / {2}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">),</span> <span class="n">n_test</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">"Epoch {0} complete"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</pre></div>
<p></p><p>The <tt>training_data</tt> is a list of tuples <tt>(x, y)</tt>
representing the training inputs and corresponding desired outputs.
The variables <tt>epochs</tt> and <tt>mini_batch_size</tt> are what you'd
expect - the number of epochs to train for, and the size of the
mini-batches to use when sampling.  <tt>eta</tt> is the learning rate,
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-428-Frame"><nobr><span class="math" id="MathJax-Span-3269" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3270"><span class="mi" id="MathJax-Span-3271" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-428">\eta</script>.  If the optional argument <tt>test_data</tt> is supplied, then
the program will evaluate the network after each epoch of training,
and print out partial progress.  This is useful for tracking progress,
but slows things down substantially.</p><p>The code works as follows.  In each epoch, it starts by randomly
shuffling the training data, and then partitions it into mini-batches
of the appropriate size.  This is an easy way of sampling randomly
from the training data.  Then for each <tt>mini_batch</tt> we apply a
single step of gradient descent.  This is done by the code
<tt>self.update_mini_batch(mini_batch, eta)</tt>, which updates the
network weights and biases according to a single iteration of gradient
descent, using just the training data in <tt>mini_batch</tt>.  Here's
the code for the <tt>update_mini_batch</tt> method:
</p><div class="highlight"><pre>    <span class="k">def</span> <span class="nf">update_mini_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
        <span class="sd">"""Update the network's weights and biases by applying</span>
<span class="sd">        gradient descent using backpropagation to a single mini batch.</span>
<span class="sd">        The "mini_batch" is a list of tuples "(x, y)", and "eta"</span>
<span class="sd">        is the learning rate."""</span>
        <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">]</span>
        <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">mini_batch</span><span class="p">:</span>
            <span class="n">delta_nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb</span><span class="o">+</span><span class="n">dnb</span> <span class="k">for</span> <span class="n">nb</span><span class="p">,</span> <span class="n">dnb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_b</span><span class="p">)]</span>
            <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">nw</span><span class="o">+</span><span class="n">dnw</span> <span class="k">for</span> <span class="n">nw</span><span class="p">,</span> <span class="n">dnw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_w</span><span class="p">,</span> <span class="n">delta_nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nw</span> 
                        <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">nw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nb</span> 
                       <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="n">nabla_b</span><span class="p">)]</span>
</pre></div>

Most of the work is done by the line
<div class="highlight"><pre>            <span class="n">delta_nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

This invokes something called the <em>backpropagation</em> algorithm,
which is a fast way of computing the gradient of the cost function.
So <tt>update_mini_batch</tt> works simply by computing these gradients
for every training example in the <tt>mini_batch</tt>, and then updating
<tt>self.weights</tt> and <tt>self.biases</tt> appropriately.<p></p><p>I'm not going to show the code for <tt>self.backprop</tt> right now.
We'll study how backpropagation works in the next chapter, including
the code for <tt>self.backprop</tt>.  For now, just assume that it
behaves as claimed, returning the appropriate gradient for the cost
associated to the training example <tt>x</tt>.</p><p>Let's look at the full program, including the documentation strings,
which I omitted above.  Apart from <tt>self.backprop</tt> the program is
self-explanatory - all the heavy lifting is done in <tt>self.SGD</tt>
and <tt>self.update_mini_batch</tt>, which we've already discussed.  The
<tt>self.backprop</tt> method makes use of a few extra functions to help
in computing the gradient, namely <tt>sigmoid_prime</tt>, which computes
the derivative of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-429-Frame"><nobr><span class="math" id="MathJax-Span-3272" role="math" style="width: 0.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.591em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3273"><span class="mi" id="MathJax-Span-3274" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.552em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-429">\sigma</script> function, its vectorized form
<tt>sigmoid_prime_vec</tt>, and <tt>self.cost_derivative</tt>, which I
won't describe here.  You can get the gist of these (and perhaps the
details) just by looking at the code and documentation strings.  We'll
look at them in detail in the next
chapter. 
Note that while the program appears lengthy, much of the code is
documentation strings intended to make the code easy to understand.
In fact, the program contains just 74 lines of non-whitespace,
non-comment code.  All the code may be found on GitHub
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network.py">here</a>.</p><p></p><p></p><div class="highlight"><pre><span class="sd">"""</span>
<span class="sd">network.py</span>
<span class="sd">~~~~~~~~~~</span>

<span class="sd">A module to implement the stochastic gradient descent learning</span>
<span class="sd">algorithm for a feedforward neural network.  Gradients are calculated</span>
<span class="sd">using backpropagation.  Note that I have focused on making the code</span>
<span class="sd">simple, easily readable, and easily modifiable.  It is not optimized,</span>
<span class="sd">and omits many desirable features.</span>
<span class="sd">"""</span>

<span class="c">#### Libraries</span>
<span class="c"># Standard library</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c"># Third-party libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">Network</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sizes</span><span class="p">):</span>
        <span class="sd">"""The list ``sizes`` contains the number of neurons in the</span>
<span class="sd">        respective layers of the network.  For example, if the list</span>
<span class="sd">        was [2, 3, 1] then it would be a three-layer network, with the</span>
<span class="sd">        first layer containing 2 neurons, the second layer 3 neurons,</span>
<span class="sd">        and the third layer 1 neuron.  The biases and weights for the</span>
<span class="sd">        network are initialized randomly, using a Gaussian</span>
<span class="sd">        distribution with mean 0, and variance 1.  Note that the first</span>
<span class="sd">        layer is assumed to be an input layer, and by convention we</span>
<span class="sd">        won't set any biases for those neurons, since biases are only</span>
<span class="sd">        ever used in computing the outputs from later layers."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizes</span> <span class="o">=</span> <span class="n">sizes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

    <span class="k">def</span> <span class="nf">feedforward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="sd">"""Return the output of the network if ``a`` is input."""</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sigmoid_vec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">SGD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span>
            <span class="n">test_data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">"""Train the neural network using mini-batch stochastic</span>
<span class="sd">        gradient descent.  The ``training_data`` is a list of tuples</span>
<span class="sd">        ``(x, y)`` representing the training inputs and the desired</span>
<span class="sd">        outputs.  The other non-optional parameters are</span>
<span class="sd">        self-explanatory.  If ``test_data`` is provided then the</span>
<span class="sd">        network will be evaluated against the test data after each</span>
<span class="sd">        epoch, and partial progress printed out.  This is useful for</span>
<span class="sd">        tracking progress, but slows things down substantially."""</span>
        <span class="k">if</span> <span class="n">test_data</span><span class="p">:</span> <span class="n">n_test</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
            <span class="n">mini_batches</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">training_data</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="n">mini_batch_size</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">mini_batch</span> <span class="ow">in</span> <span class="n">mini_batches</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_mini_batch</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">test_data</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">"Epoch {0}: {1} / {2}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_data</span><span class="p">),</span> <span class="n">n_test</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">"Epoch {0} complete"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_mini_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mini_batch</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
        <span class="sd">"""Update the network's weights and biases by applying</span>
<span class="sd">        gradient descent using backpropagation to a single mini batch.</span>
<span class="sd">        The ``mini_batch`` is a list of tuples ``(x, y)``, and ``eta``</span>
<span class="sd">        is the learning rate."""</span>
        <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">]</span>
        <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">mini_batch</span><span class="p">:</span>
            <span class="n">delta_nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb</span><span class="o">+</span><span class="n">dnb</span> <span class="k">for</span> <span class="n">nb</span><span class="p">,</span> <span class="n">dnb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_b</span><span class="p">,</span> <span class="n">delta_nabla_b</span><span class="p">)]</span>
            <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">nw</span><span class="o">+</span><span class="n">dnw</span> <span class="k">for</span> <span class="n">nw</span><span class="p">,</span> <span class="n">dnw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nabla_w</span><span class="p">,</span> <span class="n">delta_nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nw</span> 
                        <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">nw</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">nabla_w</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biases</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="o">-</span><span class="p">(</span><span class="n">eta</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">mini_batch</span><span class="p">))</span><span class="o">*</span><span class="n">nb</span> 
                       <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">nb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="n">nabla_b</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return a tuple ``(nabla_b, nabla_w)`` representing the</span>
<span class="sd">        gradient for the cost function C_x.  ``nabla_b`` and</span>
<span class="sd">        ``nabla_w`` are layer-by-layer lists of numpy arrays, similar</span>
<span class="sd">        to ``self.biases`` and ``self.weights``."""</span>
        <span class="n">nabla_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">]</span>
        <span class="n">nabla_w</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">]</span>
        <span class="c"># feedforward</span>
        <span class="n">activation</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">activations</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="c"># list to store all the activations, layer by layer</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># list to store all the z vectors, layer by layer</span>
        <span class="k">for</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">biases</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">activation</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
            <span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">activation</span> <span class="o">=</span> <span class="n">sigmoid_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">activations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="c"># backward pass</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_derivative</span><span class="p">(</span><span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> \
            <span class="n">sigmoid_prime_vec</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">nabla_b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>
        <span class="n">nabla_w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
        <span class="c"># Note that the variable l in the loop below is used a little</span>
        <span class="c"># differently to the notation in Chapter 2 of the book.  Here,</span>
        <span class="c"># l = 1 means the last layer of neurons, l = 2 is the</span>
        <span class="c"># second-last layer, and so on.  It's a renumbering of the</span>
        <span class="c"># scheme in the book, used here to take advantage of the fact</span>
        <span class="c"># that Python can use negative indices in lists.</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span><span class="p">):</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span>
            <span class="n">spv</span> <span class="o">=</span> <span class="n">sigmoid_prime_vec</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">spv</span>
            <span class="n">nabla_b</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>
            <span class="n">nabla_w</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">activations</span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nabla_b</span><span class="p">,</span> <span class="n">nabla_w</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
        <span class="sd">"""Return the number of test inputs for which the neural</span>
<span class="sd">        network outputs the correct result. Note that the neural</span>
<span class="sd">        network's output is assumed to be the index of whichever</span>
<span class="sd">        neuron in the final layer has the highest activation."""</span>
        <span class="n">test_results</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedforward</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">y</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">test_data</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">test_results</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">cost_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_activations</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">"""Return the vector of partial derivatives \partial C_x /</span>
<span class="sd">        \partial a for the output activations."""</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">output_activations</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> 

<span class="c">#### Miscellaneous functions</span>
<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">"""The sigmoid function."""</span>
    <span class="k">return</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">))</span>

<span class="n">sigmoid_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">sigmoid</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sigmoid_prime</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">"""Derivative of the sigmoid function."""</span>
    <span class="k">return</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

<span class="n">sigmoid_prime_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">sigmoid_prime</span><span class="p">)</span>
</pre></div>
<p></p><p>How well does the program recognize handwritten digits?  Well, let's
start by loading in the MNIST data.  I'll do this using a little
helper program, <tt>mnist_loader.py</tt>, to be described below.  We
execute the following commands in a Python shell,</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">mnist_loader</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> \
<span class="o">...</span> <span class="n">mnist_loader</span><span class="o">.</span><span class="n">load_data_wrapper</span><span class="p">()</span>
</pre></div>
<p></p><p>Of course, this could also be done in a separate Python program, but
if you're following along it's probably easiest to do in a Python
shell.  </p><p>After loading the MNIST data, we'll set up a <tt>Network</tt> with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-430-Frame"><nobr><span class="math" id="MathJax-Span-3275" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3276"><span class="mn" id="MathJax-Span-3277" style="font-family: MathJax_Main;">30</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-430">30</script>
hidden neurons.  We do this after importing the Python program listed
above, which is named <tt>network</tt>,</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">network</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
<p></p><p>Finally, we'll use stochastic gradient descent to learn from the MNIST
<tt>training_data</tt> over 30 epochs, with a mini-batch size of 10, and a
learning rate of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-431-Frame"><nobr><span class="math" id="MathJax-Span-3278" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3279"><span class="mi" id="MathJax-Span-3280" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3281" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3282" style="font-family: MathJax_Main; padding-left: 0.297em;">3.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-431">\eta = 3.0</script>, </p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
<p></p><p>Note that if you're running the code as you read along, it will take
some time to execute - for a typical machine (as of 2014) it will
likely take between one and a few minutes per training epoch.  I
suggest you set things running, continue to read, and periodically
check the output from the code.  If you're in a rush you can speed
things up by decreasing the number of epochs, by decreasing the number
of hidden neurons, or by using only part of the training data.  Note
that production code would be much, much faster: these Python scripts
are intended to help you understand how neural nets work, not to be
high-performance code!  And, of course, once we've trained a network
it can be run very quickly indeed, on almost any computing
platform. For example, once we've learned a good set of weights and
biases for a network, it can easily be ported to run in Javascript in
a web browser, or as a native app on a mobile device.  In any case,
here is a partial transcript of the output of one training run of the
neural network.  The transcript shows the number of test images
correctly recognized by the neural network after each epoch of
training.  As you can see, after just a single epoch this has reached
9,129 out of 10,000, and the number continues to grow,</p><p></p><div class="highlight"><pre>Epoch 0: 9129 / 10000
Epoch 1: 9295 / 10000
Epoch 2: 9348 / 10000
...
Epoch 27: 9528 / 10000
Epoch 28: 9542 / 10000
Epoch 29: 9534 / 10000
</pre></div>
<p></p><p>That is, the trained network gives us a classification rate of about
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-432-Frame"><nobr><span class="math" id="MathJax-Span-3283" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3284"><span class="mn" id="MathJax-Span-3285" style="font-family: MathJax_Main;">95</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-432">95</script> percent - <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-433-Frame"><nobr><span class="math" id="MathJax-Span-3286" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3287"><span class="mn" id="MathJax-Span-3288" style="font-family: MathJax_Main;">95.42</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-433">95.42</script> percent at its peak ("Epoch 28")!  That's
quite encouraging as a first attempt.  I should warn you, however,
that if you run the code then your results are not necessarily going
to be quite the same as mine, since we'll be initializing our network
using (different) random weights and biases.  To generate results in
this chapter I've taken best-of-three runs.</p><p>Let's rerun the above experiment, changing the number of hidden
neurons to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-434-Frame"><nobr><span class="math" id="MathJax-Span-3289" role="math" style="width: 1.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.522em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3290"><span class="mn" id="MathJax-Span-3291" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-434">100</script>.  As was the case earlier, if you're running the code
as you read along, you should be warned that it takes quite a while to
execute (in this case, many minutes for each training epoch), so it's
wise to continue reading in parallel while the code executes.</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
<p></p><p>Sure enough, this improves the results to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-435-Frame"><nobr><span class="math" id="MathJax-Span-3292" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3293"><span class="mn" id="MathJax-Span-3294" style="font-family: MathJax_Main;">96.59</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-435">96.59</script> percent.  At least
in this case, using more hidden neurons helps us get better
results*<span class="marginnote">
*Reader feedback indicates quite some variation in
  results for this experiment, and some training runs give results
  quite a bit worse.  Using the techniques introduced in chapter 3
  will greatly reduce the variation in performance across different
  training runs for our networks.</span>.</p><p>Of course, to obtain these accuracies I had to make specific choices
for the number of epochs of training, the mini-batch size, and the
learning rate, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-436-Frame"><nobr><span class="math" id="MathJax-Span-3295" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.434em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3296"><span class="mi" id="MathJax-Span-3297" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.753em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-436">\eta</script>.  As I mentioned above, these are known as
hyper-parameters for our neural network, in order to distinguish them
from the parameters (weights and biases) learnt by our learning
algorithm.  If we choose our hyper-parameters poorly, we can get bad
results.  Suppose, for example, that we'd chosen the learning rate to
be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-437-Frame"><nobr><span class="math" id="MathJax-Span-3298" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3299"><span class="mi" id="MathJax-Span-3300" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3301" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3302" style="font-family: MathJax_Main; padding-left: 0.297em;">0.001</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-437">\eta = 0.001</script>,</p><p></p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
<p></p><p>The results are much less encouraging,
</p><div class="highlight"><pre>Epoch 0: 1139 / 10000
Epoch 1: 1136 / 10000
Epoch 2: 1135 / 10000
...
Epoch 27: 2101 / 10000
Epoch 28: 2123 / 10000
Epoch 29: 2142 / 10000
</pre></div>

However, you can see that the performance of the network is getting
slowly better over time.  That suggests increasing the learning rate,
say to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-438-Frame"><nobr><span class="math" id="MathJax-Span-3303" role="math" style="width: 3.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3304"><span class="mi" id="MathJax-Span-3305" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3306" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3307" style="font-family: MathJax_Main; padding-left: 0.297em;">0.01</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-438">\eta = 0.01</script>.  If we do that, we get better results, which
suggests increasing the learning rate again.  (If making a change
improves things, try doing more!)  If we do that several times over,
we'll end up with a learning rate of something like <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-439-Frame"><nobr><span class="math" id="MathJax-Span-3308" role="math" style="width: 3.238em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.14em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3309"><span class="mi" id="MathJax-Span-3310" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3311" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3312" style="font-family: MathJax_Main; padding-left: 0.297em;">1.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-439">\eta = 1.0</script> (and
perhaps fine tune to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-440-Frame"><nobr><span class="math" id="MathJax-Span-3313" role="math" style="width: 1.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3314"><span class="mn" id="MathJax-Span-3315" style="font-family: MathJax_Main;">3.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-440">3.0</script>), which is close to our earlier
experiments.  So even though we initially made a poor choice of
hyper-parameters, we at least got enough information to help us
improve our choice of hyper-parameters.<p></p><p>In general, debugging a neural network can be challenging.  This is
especially true when the initial choice of hyper-parameters produces
results no better than random noise.  Suppose we try the successful 30
hidden neuron network architecture from earlier, but with the learning
rate changed to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-441-Frame"><nobr><span class="math" id="MathJax-Span-3316" role="math" style="width: 4.267em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3317"><span class="mi" id="MathJax-Span-3318" style="font-family: MathJax_Math-italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-3319" style="font-family: MathJax_Main; padding-left: 0.297em;">=</span><span class="mn" id="MathJax-Span-3320" style="font-family: MathJax_Main; padding-left: 0.297em;">100.0</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-441">\eta = 100.0</script>:
</p><div class="highlight"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">net</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">Network</span><span class="p">([</span><span class="mi">784</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">net</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>

At this point we've actually gone too far, and the learning rate is
too high:
<div class="highlight"><pre><span class="n">Epoch</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">Epoch</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">Epoch</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">Epoch</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1009</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="o">...</span>
<span class="n">Epoch</span> <span class="mi">27</span><span class="p">:</span> <span class="mi">982</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">Epoch</span> <span class="mi">28</span><span class="p">:</span> <span class="mi">982</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">Epoch</span> <span class="mi">29</span><span class="p">:</span> <span class="mi">982</span> <span class="o">/</span> <span class="mi">10000</span>
</pre></div>

Now imagine that we were coming to this problem for the first time.
Of course, we <em>know</em> from our earlier experiments that the right
thing to do is to decrease the learning rate.  But if we were coming
to this problem for the first time then there wouldn't be much in the
output to guide us on what to do.  We might worry not only about the
learning rate, but about every other aspect of our neural network.  We
might wonder if we've initialized the weights and biases in a way that
makes it hard for the network to learn?  Or maybe we don't have enough
training data to get meaningful learning?  Perhaps we haven't run for
enough epochs?  Or maybe it's impossible for a neural network with
this architecture to learn to recognize handwritten digits?  Maybe the
learning rate is too <em>low</em>?  Or, maybe, the learning rate is too
high?  When you're coming to a problem for the first time, you're not
always sure.<p></p><p>The lesson to take away from this is that debugging a neural network
is not trivial, and, just as for ordinary programming, there is an art
to it.  You need to learn that art of debugging in order to get good
results from neural networks.  More generally, we need to develop
heuristics for choosing good hyper-parameters and a good architecture.
We'll discuss all these at length through the book, including how I
chose the hyper-parameters above.</p><p>
</p><h4><a name="exercise_420023"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#exercise_420023">Exercise</a></h4><ul><p></p><p></p><li> Try creating a network with just two layers - an input and an
  output layer, no hidden layer - with 784 and 10 neurons,
  respectively.  Train the network using stochastic gradient descent.
  What classification accuracy can you achieve?
</li></ul><p></p><p></p><p>Earlier, I skipped over the details of how the MNIST data is loaded.
It's pretty straightforward.  For completeness, here's the code.  The
data structures used to store the MNIST data are described in the
documentation strings - it's straightforward stuff, tuples and lists
of Numpy <tt>ndarray</tt> objects (think of them as vectors if you're
not familiar with <tt>ndarray</tt>s):</p><p></p><div class="highlight"><pre><span class="sd">"""</span>
<span class="sd">mnist_loader</span>
<span class="sd">~~~~~~~~~~~~</span>

<span class="sd">A library to load the MNIST image data.  For details of the data</span>
<span class="sd">structures that are returned, see the doc strings for ``load_data``</span>
<span class="sd">and ``load_data_wrapper``.  In practice, ``load_data_wrapper`` is the</span>
<span class="sd">function usually called by our neural network code.</span>
<span class="sd">"""</span>

<span class="c">#### Libraries</span>
<span class="c"># Standard library</span>
<span class="kn">import</span> <span class="nn">cPickle</span>
<span class="kn">import</span> <span class="nn">gzip</span>

<span class="c"># Third-party libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">load_data</span><span class="p">():</span>
    <span class="sd">"""Return the MNIST data as a tuple containing the training data,</span>
<span class="sd">    the validation data, and the test data.</span>

<span class="sd">    The ``training_data`` is returned as a tuple with two entries.</span>
<span class="sd">    The first entry contains the actual training images.  This is a</span>
<span class="sd">    numpy ndarray with 50,000 entries.  Each entry is, in turn, a</span>
<span class="sd">    numpy ndarray with 784 values, representing the 28 * 28 = 784</span>
<span class="sd">    pixels in a single MNIST image.</span>

<span class="sd">    The second entry in the ``training_data`` tuple is a numpy ndarray</span>
<span class="sd">    containing 50,000 entries.  Those entries are just the digit</span>
<span class="sd">    values (0...9) for the corresponding images contained in the first</span>
<span class="sd">    entry of the tuple.</span>

<span class="sd">    The ``validation_data`` and ``test_data`` are similar, except</span>
<span class="sd">    each contains only 10,000 images.</span>

<span class="sd">    This is a nice data format, but for use in neural networks it's</span>
<span class="sd">    helpful to modify the format of the ``training_data`` a little.</span>
<span class="sd">    That's done in the wrapper function ``load_data_wrapper()``, see</span>
<span class="sd">    below.</span>
<span class="sd">    """</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">'../data/mnist.pkl.gz'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
    <span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">load_data_wrapper</span><span class="p">():</span>
    <span class="sd">"""Return a tuple containing ``(training_data, validation_data,</span>
<span class="sd">    test_data)``. Based on ``load_data``, but the format is more</span>
<span class="sd">    convenient for use in our implementation of neural networks.</span>

<span class="sd">    In particular, ``training_data`` is a list containing 50,000</span>
<span class="sd">    2-tuples ``(x, y)``.  ``x`` is a 784-dimensional numpy.ndarray</span>
<span class="sd">    containing the input image.  ``y`` is a 10-dimensional</span>
<span class="sd">    numpy.ndarray representing the unit vector corresponding to the</span>
<span class="sd">    correct digit for ``x``.</span>

<span class="sd">    ``validation_data`` and ``test_data`` are lists containing 10,000</span>
<span class="sd">    2-tuples ``(x, y)``.  In each case, ``x`` is a 784-dimensional</span>
<span class="sd">    numpy.ndarry containing the input image, and ``y`` is the</span>
<span class="sd">    corresponding classification, i.e., the digit values (integers)</span>
<span class="sd">    corresponding to ``x``.</span>

<span class="sd">    Obviously, this means we're using slightly different formats for</span>
<span class="sd">    the training data and the validation / test data.  These formats</span>
<span class="sd">    turn out to be the most convenient for use in our neural network</span>
<span class="sd">    code."""</span>
    <span class="n">tr_d</span><span class="p">,</span> <span class="n">va_d</span><span class="p">,</span> <span class="n">te_d</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
    <span class="n">training_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tr_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">training_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">vectorized_result</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">tr_d</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">training_inputs</span><span class="p">,</span> <span class="n">training_results</span><span class="p">)</span>
    <span class="n">validation_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">va_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">validation_data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">validation_inputs</span><span class="p">,</span> <span class="n">va_d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">test_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">te_d</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">,</span> <span class="n">te_d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">validation_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vectorized_result</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
    <span class="sd">"""Return a 10-dimensional unit vector with a 1.0 in the jth</span>
<span class="sd">    position and zeroes elsewhere.  This is used to convert a digit</span>
<span class="sd">    (0...9) into a corresponding desired output from the neural</span>
<span class="sd">    network."""</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">e</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">e</span>
</pre></div>
<p></p><p>I said above that our program gets pretty good results.  What does
that mean?  Good compared to what?  It's informative to have some
simple (non-neural-network) baseline tests to compare against, to
understand what it means to perform well.  The simplest baseline of
all, of course, is to randomly guess the digit.  That'll be right
about ten percent of the time.  We're doing much better than that!</p><p>What about a less trivial baseline?  Let's try an extremely simple
idea: we'll look at how <em>dark</em> an image is.  For instance, an
image of a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-442-Frame"><nobr><span class="math" id="MathJax-Span-3321" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3322"><span class="mn" id="MathJax-Span-3323" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-442">2</script> will typically be quite a bit darker than an image of a
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-443-Frame"><nobr><span class="math" id="MathJax-Span-3324" role="math" style="width: 0.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3325"><span class="mn" id="MathJax-Span-3326" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-443">1</script>, just because more pixels are blackened out, as the following
examples illustrate:</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_2_and_1.png" width="256px"></center><p></p><p>This suggests using the training data to compute average darknesses
for each digit, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-444-Frame"><nobr><span class="math" id="MathJax-Span-3327" role="math" style="width: 5.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.051em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3328"><span class="mn" id="MathJax-Span-3329" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-3330" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3331" style="font-family: MathJax_Main; padding-left: 0.15em;">1</span><span class="mo" id="MathJax-Span-3332" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3333" style="font-family: MathJax_Main; padding-left: 0.15em;">2</span><span class="mo" id="MathJax-Span-3334" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3335" style="font-family: MathJax_Main; padding-left: 0.15em;"></span><span class="mo" id="MathJax-Span-3336" style="font-family: MathJax_Main; padding-left: 0.15em;">,</span><span class="mn" id="MathJax-Span-3337" style="font-family: MathJax_Main; padding-left: 0.15em;">9</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-444">0, 1, 2,\ldots, 9</script>.  When presented with a new image,
we compute how dark the image is, and then guess that it's whichever
digit has the closest average darkness.  This is a simple procedure,
and is easy to code up, so I won't explicitly write out the code -
if you're interested it's in the
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/mnist_average_darkness.py">GitHub
  repository</a>.  But it's a big improvement over random guessing,
getting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-445-Frame"><nobr><span class="math" id="MathJax-Span-3338" role="math" style="width: 2.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.453em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3339"><span class="mn" id="MathJax-Span-3340" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3341" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3342" style="font-family: MathJax_Main; padding-left: 0.15em;">225</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-445">2,225</script> of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-446-Frame"><nobr><span class="math" id="MathJax-Span-3343" role="math" style="width: 2.993em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.944em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.365em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3344"><span class="mn" id="MathJax-Span-3345" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-3346" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-3347" style="font-family: MathJax_Main; padding-left: 0.15em;">000</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.002em; vertical-align: -0.247em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-446">10,000</script> test images correct, i.e., <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-447-Frame"><nobr><span class="math" id="MathJax-Span-3348" role="math" style="width: 2.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3349"><span class="mn" id="MathJax-Span-3350" style="font-family: MathJax_Main;">22.25</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-447">22.25</script>
percent accuracy.</p><p><a name="SVM"></a></p><p>It's not difficult to find other ideas which achieve accuracies in the
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-448-Frame"><nobr><span class="math" id="MathJax-Span-3351" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3352"><span class="mn" id="MathJax-Span-3353" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-448">20</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-449-Frame"><nobr><span class="math" id="MathJax-Span-3354" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3355"><span class="mn" id="MathJax-Span-3356" style="font-family: MathJax_Main;">50</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-449">50</script> percent range.  If you work a bit harder you can get up
over <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-450-Frame"><nobr><span class="math" id="MathJax-Span-3357" role="math" style="width: 1.032em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.983em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.189em 1000.002em 4.169em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3358"><span class="mn" id="MathJax-Span-3359" style="font-family: MathJax_Main;">50</span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.802em; vertical-align: -0.048em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-450">50</script> percent.  But to get much higher accuracies it helps to use
established machine learning algorithms.  Let's try using one of the
best known algorithms, the <em>support vector
  machine</em>
or <em>SVM</em>.  If you're not
familiar with SVMs, not to worry, we're not going to need to
understand the details of how SVMs work.  Instead, we'll use a Python
library called
<a href="http://scikit-learn.org/stable/">scikit-learn</a>,
which provides a simple Python interface to a fast C-based library for
SVMs known as
<a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">LIBSVM</a>.</p><p>If we run scikit-learn's SVM classifier using the default settings,
then it gets 9,435 of 10,000 test images correct.  (The code is
available
<a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/mnist_svm.py">here</a>.)
That's a big improvement over our naive approach of classifying an
image based on how dark it is.  Indeed, it means that the SVM is
performing roughly as well as our neural networks, just a little
worse.  In later chapters we'll introduce new techniques that enable
us to improve our neural networks so that they perform much better
than the SVM.</p><p>That's not the end of the story, however.  The 9,435 of 10,000 result
is for scikit-learn's default settings for SVMs.  SVMs have a number
of tunable parameters, and it's possible to search for parameters
which improve this out-of-the-box performance.  I won't explicitly do
this search, but instead refer you to
<a href="http://peekaboo-vision.blogspot.de/2010/09/mnist-for-ever.html">this
  blog post</a> by <a href="http://peekaboo-vision.blogspot.ca/">Andreas
  Mueller</a> if you'd like to know more.  Mueller shows that with some
work optimizing the SVM's parameters it's possible to get the
performance up above 98.5 percent accuracy.  In other words, a
well-tuned SVM only makes an error on about one digit in 70.  That's
pretty good!  Can neural networks do better?</p><p>In fact, they can.  At present, well-designed neural networks
outperform every other technique for solving MNIST, including SVMs.
The current (2013) record is classifying 9,979 of 10,000 images
correctly.  This was done by <a href="http://www.cs.nyu.edu/~wanli/">Li
  Wan</a>, <a href="http://www.matthewzeiler.com/">Matthew Zeiler</a>, Sixin
Zhang, <a href="http://yann.lecun.com/">Yann LeCun</a>, and
<a href="http://cs.nyu.edu/~fergus/pmwiki/pmwiki.php">Rob Fergus</a>.
We'll see most of the techniques they used later in the book.  At that
level the performance is close to human-equivalent, and is arguably
better, since quite a few of the MNIST images are difficult even for
humans to recognize with confidence, for example:</p><p></p><center><img src="./Neural networks and deep learning 1_files/mnist_really_bad_images.png" width="560px"></center><p></p><p>I trust you'll agree that those are tough to classify!  With images
like these in the MNIST data set it's remarkable that neural networks
can accurately classify all but 21 of the 10,000 test images.
Usually, when programming we believe that solving a complicated
problem like recognizing the MNIST digits requires a sophisticated
algorithm.  But even the neural networks in the Wan <em>et al</em> paper
just mentioned involve quite simple algorithms, variations on the
algorithm we've seen in this chapter.  All the complexity is learned,
automatically, from the training data. In some sense, the moral of
both our results and those in more sophisticated papers, is that for
some problems:
</p><center>
  sophisticated algorithm <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-451-Frame"><nobr><span class="math" id="MathJax-Span-3360" role="math" style="width: 0.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.787em; height: 0px; font-size: 102%;"><span style="position: absolute; clip: rect(3.238em 1000.002em 4.316em -999.998em); top: -4.017em; left: 0.002em;"><span class="mrow" id="MathJax-Span-3361"><span class="mo" id="MathJax-Span-3362" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span></span><span style="border-left-width: 0.003em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.198em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-451">\leq</script> simple learning algorithm + good
  training data.
</center><p></p><p></p><h3><a name="toward_deep_learning"></a><a href="http://neuralnetworksanddeeplearning.com/chap1.html#toward_deep_learning">Toward deep learning</a></h3><p></p><p>While our neural network gives impressive performance, that
performance is somewhat mysterious.  The weights and biases in the
network were discovered automatically.  And that means we don't
immediately have an explanation of how the network does what it does.
Can we find some way to understand the principles by which our network
is classifying handwritten digits?  And, given such principles, can we
do better?</p><p>To put these questions more starkly, suppose that a few decades hence
neural networks lead to artificial intelligence (AI).  Will we
understand how such intelligent networks work?  Perhaps the networks
will be opaque to us, with weights and biases we don't understand,
because they've been learned automatically.  In the early days of AI
research people hoped that the effort to build an AI would also help
us understand the principles behind intelligence and, maybe, the
functioning of the human brain.  But perhaps the outcome will be that
we end up understanding neither the brain nor how artificial
intelligence works!</p><p>To address these questions, let's think back to the interpretation of
artificial neurons that I gave at the start of the chapter, as a means
of weighing evidence.  Suppose we want to determine whether an image
shows a human face or not:</p><p> </p><p>  <span class="marginnote">Credits: 1. <a href="http://commons.wikimedia.org/wiki/User:ST">Ester Inbar</a>. 2.
  Unknown. 3. NASA, ESA, G. Illingworth, D. Magee, and P. Oesch
  (University of California, Santa Cruz), R. Bouwens (Leiden
  University), and the HUDF09 Team.  Click on the images for more
  details.</span></p><p>  <a href="http://commons.wikimedia.org/wiki/File:Kangaroo_ST_03.JPG"><img src="./Neural networks and deep learning 1_files/Kangaroo.JPG" height="190px"></a> <a href="http://commons.wikimedia.org/wiki/File:Albert_Einstein_at_the_age_of_three_(1882).jpg"><img src="./Neural networks and deep learning 1_files/Einstein_crop.jpg" height="190px"></a> <a href="http://commons.wikimedia.org/wiki/File:The_Hubble_eXtreme_Deep_Field.jpg"><img src="./Neural networks and deep learning 1_files/hubble.jpg" height="190px"></a> </p><p>We could attack this problem the same way we attacked handwriting
recognition - by using the pixels in the image as input to a neural
network, with the output from the network a single neuron indicating
either "Yes, it's a face" or "No, it's not a face".</p><p>Let's suppose we do this, but that we're not using a learning
algorithm.  Instead, we're going to try to design a network by hand,
choosing appropriate weights and biases.  How might we go about it?
Forgetting neural networks entirely for the moment, a heuristic we
could use is to decompose the problem into sub-problems: does the
image have an eye in the top left?  Does it have an eye in the top
right?  Does it have a nose in the middle?  Does it have a mouth in
the bottom middle?  Is there hair on top?  And so on.</p><p>If the answers to several of these questions are "yes", or even just
"probably yes", then we'd conclude that the image is likely to be a
face.  Conversely, if the answers to most of the questions are "no",
then the image probably isn't a face.</p><p>Of course, this is just a rough heuristic, and it suffers from many
deficiencies.  Maybe the person is bald, so they have no hair.  Maybe
we can only see part of the face, or the face is at an angle, so some
of the facial features are obscured.  Still, the heuristic suggests
that if we can solve the sub-problems using neural networks, then
perhaps we can build a neural network for face-detection, by combining
the networks for the sub-problems.  Here's a possible architecture,
with rectangles denoting the sub-networks.  Note that this isn't
intended as a realistic approach to solving the face-detection
problem; rather, it's to help us build intuition about how networks
function.  Here's the architecture:</p><p></p><center>
<img src="./Neural networks and deep learning 1_files/tikz14.png">
</center><p></p><p>It's also plausible that the sub-networks can be decomposed.  Suppose
we're considering the question: "Is there an eye in the top left?"
This can be decomposed into questions such as: "Is there an
eyebrow?"; "Are there eyelashes?"; "Is there an iris?"; and so
on.  Of course, these questions should really include positional
information, as well - "Is the eyebrow in the top left, and above
the iris?", that kind of thing - but let's keep it simple.  The
network to answer the question "Is there an eye in the top left?"
can now be decomposed:</p><p></p><center>
<img src="./Neural networks and deep learning 1_files/tikz15.png">
</center><p></p><p>Those questions too can be broken down, further and further through
multiple layers.  Ultimately, we'll be working with sub-networks that
answer questions so simple they can easily be answered at the level of
single pixels.  Those questions might, for example, be about the
presence or absence of very simple shapes at particular points in the
image.  Such questions can be answered by single neurons connected to
the raw pixels in the image.</p><p>The end result is a network which breaks down a very complicated
question - does this image show a face or not - into very simple
questions answerable at the level of single pixels.  It does this
through a series of many layers, with early layers answering very
simple and specific questions about the input image, and later layers
building up a hierarchy of ever more complex and abstract concepts.
Networks with this kind of many-layer structure - two or more hidden
layers - are called <em>deep neural networks</em>.</p><p></p><p></p><p>
Of course, I haven't said how to do this recursive decomposition into
sub-networks.  It certainly isn't practical to hand-design the weights
and biases in the network.  Instead, we'd like to use learning
algorithms so that the network can automatically learn the weights and
biases - and thus, the hierarchy of concepts - from training data.
Researchers in the 1980s and 1990s tried using stochastic gradient
descent and backpropagation to train deep networks.  Unfortunately,
except for a few special architectures, they didn't have much luck.
The networks would learn, but very slowly, and in practice often too
slowly to be useful.</p><p>Since 2006, a set of techniques has been developed that enable
learning in deep neural nets.  These deep learning techniques are
based on stochastic gradient descent and backpropagation, but also
introduce new ideas.  These techniques have enabled much deeper (and
larger) networks to be trained - people now routinely train networks
with 5 to 10 hidden layers.  And, it turns out that these perform far
better on many problems than shallow neural networks, i.e., networks
with just a single hidden layer.  The reason, of course, is the
ability of deep nets to build up a complex hierarchy of concepts.
It's a bit like the way conventional programming languages use modular
design and ideas about abstraction to enable the creation of complex
computer programs.  Comparing a deep network to a shallow network is a
bit like comparing a programming language with the ability to make
function calls to a stripped down language with no ability to make
such calls.  Abstraction takes a different form in neural networks
than it does in conventional programming, but it's just as important.</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p>
</p></div><div class="footer"> <span class="left_footer"> In academic work,
please cite this book as: Michael A. Nielsen, "Neural Networks and
Deep Learning", Determination Press, 2015

<br>
<br>

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB" style="color: #eee;">Creative Commons Attribution-NonCommercial 3.0
Unported License</a>.  This means you're free to copy, share, and
build on this book, but not to sell it.  If you're interested in
commercial use, please <a href="https://mail.google.com/mail/?view=cm&fs=1&tf=1&to=mn@michaelnielsen.org" target="_blank">contact me</a>.
</span>
<span class="right_footer">
Last update: Sun Dec 21 14:49:05 2014
<br>
<br>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB"><img alt="Creative Commons Licence" style="border-width:0" src="./Neural networks and deep learning 1_files/88x31.png"></a>
</span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44208967-1', 'neuralnetworksanddeeplearning.com');
  ga('send', 'pageview');

</script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_AMS, monospace;"></div></div></body></html>